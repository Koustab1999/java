Type.registerNamespace("_Ewa");_Ewa.BU=function(){};_Ewa.XL=function(){};_Ewa.sN=function(){};_Ewa.XM=function(){};_Ewa.XN=function(){};_Ewa.XO=function(){};_Ewa.XP=function(){};_Ewa.Cj=function(){};_Ewa.Yh=function(){};_Ewa.Yi=function(){};_Ewa.Ck=function(){};_Ewa.Yj=function(){};_Ewa.Cl=function(){};_Ewa.Cm=function(){};_Ewa.Cn=function(){};_Ewa.Yk=function(){};_Ewa.Yl=function(){};_Ewa.YJ=function(){};_Ewa.YK=function(){};_Ewa.YL=function(){};_Ewa.YM=function(){};_Ewa.YN=function(){};_Ewa.Cs=function(){};_Ewa.YO=function(){};_Ewa.YP=function(){};_Ewa.YQ=function(){};_Ewa.BU.registerClass("_Ewa.BU");_Ewa.sN.registerClass("_Ewa.sN");_Ewa.XM.registerClass("_Ewa.XM");_Ewa.XO.registerClass("_Ewa.XO");_Ewa.Yh.registerClass("_Ewa.Yh");_Ewa.Cj.registerClass("_Ewa.Cj",_Ewa.Yh);_Ewa.Ck.registerClass("_Ewa.Ck");_Ewa.Cl.registerClass("_Ewa.Cl",_Ewa.Yh);_Ewa.Cm.registerClass("_Ewa.Cm");_Ewa.Cn.registerClass("_Ewa.Cn");_Ewa.YJ.registerClass("_Ewa.YJ");_Ewa.YK.registerClass("_Ewa.YK",_Ewa.YJ);_Ewa.YL.registerClass("_Ewa.YL",_Ewa.YJ);_Ewa.YM.registerClass("_Ewa.YM",_Ewa.YJ);_Ewa.YN.registerClass("_Ewa.YN");_Ewa.Cs.registerClass("_Ewa.Cs");Type.registerNamespace("_Ewa");_Ewa.bhy=function(){};_Ewa.bhy.a=function(){Common.L.a('.LineageActivityPane{height:100%;display:flex;flex-direction:column;overflow:hidden;background-color:#edebe9}.LineageActivityPaneHeader{display:flex;flex-direction:row;position:relative;overflow:hidden;padding-right:16px;padding-left:16px;padding-top:16px;padding-bottom:11px;height:auto;background-color:#edebe9}.LineageActivityPaneTitle{max-width:240px;display:inline-flex;font-weight:bold;font-family:"Segoe UI Semi Bold","Segoe UI Web",Arial,Verdana,sans-serif;font-size:16px;line-height:16px;flex-grow:1;align-content:center;height:auto;text-overflow:ellipsis;overflow:hidden;background-color:#edebe9;margin:0}.LineageActivityCloseButton{display:inline-flex;align-self:center}.LineageActivityBody{height:100%;padding-left:16px;overflow:hidden;background-color:#edebe9}')};_Ewa.bhy.a();Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client");Microsoft.Office.Excel.WebUI.Client.a=function(){};Microsoft.Office.Excel.WebUI.Client.a.registerInterface("Microsoft.Office.Excel.WebUI.Client.a");Microsoft.Office.Excel.WebUI.Client.LineageTeachingCalloutTriggerManager=function(n){this.d=Function.createDelegate(this,this.h);this.b=n;this.b.a(939)&&this.b.y().bo()&&!Microsoft.Office.Excel.WebUI.Client.LineageTeachingCalloutTriggerManager.a&&(this.i(),Microsoft.Office.Excel.WebUI.Client.LineageTeachingCalloutTriggerManager.b?Diag.a.a(572400704,0,50,"LineageTeachingCalloutTriggerManager will not trigger WYWA waterline check as it was already checked in session"):this.j());Diag.a.a(578076752,0,50,"LineageTeachingCalloutTriggerManager is initialized.")};Microsoft.Office.Excel.WebUI.Client.LineageTeachingCalloutTriggerManager.prototype={b:null,c:!1,dispose:function(){this.e();this.b=null;Diag.a.a(578076751,0,50,"LineageTeachingCalloutTriggerManager is disposed.")},a:function(){Microsoft.Office.Excel.WebUI.Client.LineageTeachingCalloutTriggerManager.a||(Microsoft.Office.Excel.WebUI.Client.LineageTeachingCalloutTriggerManager.a=!0,Diag.a.a(578557781,0,50,"LineageTeachingCalloutTriggerManager.Disable as the pane was opened."));this.e()},j:function(){if(this.b.a(926)&&this.b.a(918)&&(!_Ewa.bS.a(this.b,"OfficeVSO:4914406_PreventWywaWaterlineCheckOnAnonymousUser")||!this.b.cW())){var n=this,t=function(t){var i=t.Result;Diag.a.a(578557780,0,50,"CheckLineageWywaChanges service call succeeded, hasnewchanges = {0}.",i);Microsoft.Office.Excel.WebUI.Client.LineageTeachingCalloutTriggerManager.b=!0;i&&n.f(0)},r=this,i=function(){Diag.a.a(578557779,0,10,"CheckLineageWywaChanges service call failed.")};_Ewa.l.D(this.b.d().a(),t,i,null)}},i:function(){this.b.a(925)&&(this.g()||(this.b.c().s(this.d),this.c=!0))},g:function(){return this.b.c()&&this.b.c().l()&&this.b.c().l().ShouldTriggerLineageCalloutOnMerge?(Diag.a.a(578557778,0,50,"LineageTeachingCalloutTriggerManager.TriggerLineageCalloutOnMerge"),this.f(1),!0):!1},h:function(){this.g()},f:function(n){if(Microsoft.Office.Excel.WebUI.Client.LineageTeachingCalloutTriggerManager.a){Diag.a.a(578557777,0,50,"LineageTeachingCalloutTriggerManager.TriggerCallout Will not trigger dialog as it was already shown in session");return}if(Microsoft.Office.Excel.WebUI.Client.LineageTeachingCalloutTriggerManager.a=!0,Diag.a.a(578557776,0,50,"LineageTeachingCalloutTriggerManager.TriggerCallout triggering callout due to reason {0}.",n),this.e(),this.b.a(668)){var t=new _Ewa.L(-847286761,_Ewa.G.a,this.b.s(),0,"Help");this.b.h().a(t,{CalloutName:5},null)}},e:function(){this.c&&(this.c=!1,this.b.c().u(this.d))}};Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Lineage");Microsoft.Office.Excel.WebUI.Client.Lineage.g=function(n,t){this.a=n;this.b=t};Microsoft.Office.Excel.WebUI.Client.Lineage.g.prototype={b:null,a:null,y:function(){return!1},w:function(n,t,i){var r=!1;switch(t.a){case 1834994092:t.b===9&&this.d();this.c(t,i);r=!0}return r?$$sc.a.a(Boolean,!0):_Ewa.V.a(t.a)},v:function(n,t){return t.a===1834994092},x:function(){return!1},c:function(n,t){Diag.a.a(593854557,0,50,"LineageActivityCommandHandler::ShowChangesCore command location: {0}",t.MenuItemId||n.b);var i=n.b===19&&!!t.MenuItemId;this.b.a(i,t.MenuItemId,n.b)},d:function(){if(_Ewa.c.a("OfficeVSO:4782323_SwitchRibbonTabOnDiscoverabilityCallout")){var n=_Ewa.k.a()?"Review":this.a.m()+"Ribbon.Review";n!==_Ewa.cp.a(this.a).a().a()&&_Ewa.cp.a(this.a).a().b(n)}}};Microsoft.Office.Excel.WebUI.Client.Lineage.c=function(n){Microsoft.Office.Excel.WebUI.Client.Lineage.c.initializeBase(this,[n])};Microsoft.Office.Excel.WebUI.Client.Lineage.c.a=function(n){_Ewa.bg.a(363,new Microsoft.Office.Excel.WebUI.Client.Lineage.c(n))};Microsoft.Office.Excel.WebUI.Client.Lineage.c.prototype={m:function(){var n=this;_Ewa.g.a(_Ewa.n.b(Microsoft.Office.Excel.WebUI.Client.a,this.h.b(),366,367,this.j,null),function(t){var i=t.a();n.n([new Microsoft.Office.Excel.WebUI.Client.Lineage.g(n.h,i)],null)},this.i(),3,null,null)}};Microsoft.Office.Excel.WebUI.Client.Lineage.h=function(n,t,i,r){this.k=Function.createDelegate(this,this.bn);this.z=Function.createDelegate(this,this.br);this.h=Function.createDelegate(this,this.bp);this.y=Function.createDelegate(this,this.bq);this.u=Function.createDelegate(this,this.bj);this.x=Function.createDelegate(this,this.bo);this.t=Function.createDelegate(this,this.bh);this.A=Function.createDelegate(this,this.bt);this.H=Function.createDelegate(this,this.bf);this.G=Function.createDelegate(this,this.be);this.E=Function.createDelegate(this,this.bc);this.F=Function.createDelegate(this,this.bd);this.J=Function.createDelegate(this,this.bi);this.K=Function.createDelegate(this,this.bm);this.L=Function.createDelegate(this,this.bs);this.I=Function.createDelegate(this,this.bg);this.D=Function.createDelegate(this,this.bb);this.s=Function.createDelegate(this,this.V);this.M=Function.createDelegate(this,this.by);this.C=Function.createDelegate(this,this.U);this.r=Function.createDelegate(this,this.T);this.w=Function.createDelegate(this,this.bl);this.v=Function.createDelegate(this,this.bk);this.b=n;t.b(Microsoft.Office.Excel.WebUI.Client.a,366,this);this.e=_Ewa.b.a(this.b);this.d=i;this.n=this.d.l();this.B=50;this.g=r;this.f=this.b.n().b("UserAction","LineagePaneLoadingShimmerStopWatch");this.q=Common.Utils.a.a().a(Common.App.People.i,null);this.ba();this.S()};Microsoft.Office.Excel.WebUI.Client.Lineage.h.prototype={d:null,b:null,c:null,B:0,n:null,e:null,q:null,o:0,i:0,g:null,f:null,dispose:function(){this.bx();this.b=null;this.d&&(this.d.m(this.v),this.d.o(this.w),this.d=null);this.c=null;this.n=null;this.q=null;this.f=null},a:function(n,t,i){var u,f,r;if(this.d.b()&&!n){this.d.k();return}this.f.d();this.g&&(_Ewa.F.a().c(this.f.c(),this.g.c(),_Ewa.bb.toString(0),_Ewa.bb.toString(0),!0),this.g.a(),this.g=null);this.d.e()||Diag.a.a(591161311,0,50,"LineageManager::ShowLineageTaskPane pane reopened by user via {0}",n?t:i);this.i=this.b.c().c();u=null;n&&(f=_Ewa.h.d(this.e.a().a().c(),this.b),u=(r=new _Ewa.mt,r.rangeList=t.toString()==="GridContextMenu"?this.l(f.Ranges):null,r.sheetName=f.SheetName,r));this.c.createLineagePane(this.n,u);this.d.c(!0);this.b.z(-71295319,-1,0,null)},ba:function(){var n,i=(n=new _Ewa.LL,n.paneOpenLineageActivitiesRequest=this.r,n.filterChangedLineageActivitiesRequest=this.r,n.lineageActivitiesUpdatesRequest=this.C,n.tryParseRangeInfo=this.M,n.refreshPillLineageActivitiesRequest=this.s,n.isFeatureEnabled=this.D,n.onActivitySelected=this.I,n.onVersionHistoryButtonClicked=this.L,n.loadMoreLineageActivitiesRequest=this.s,n.onRangeFilterInputEnabled=this.K,n.onLearnMoreLinkClicked=this.J,n.lineageOpenPaneOrChangeFilterRequest=this.F,n.lineageLoadMoreRequest=this.E,n.lineageRefreshViewRequest=this.G,n.lineageUpdateViewRequest=this.H,n),t=this;Common.cW.a(function(){var n;t.c=cellLineage.LineageActivityControllerFactoryGlobal.createLineageActivityController((n=new _Ewa.LN,n.clientBatchSize=t.B,n.filterableSheetList=t.m(),n.uiCulture=t.b.f().UICultureTag,n.dataCulture=t.b.f().DataCultureTag,n.logger=new UlsExternalLogger,n.lineageAppCallbacks=i,n))})},bd:function(n,t){var i,f,r,u;this.f.a();_Ewa.ba.a(this.b).a(_Ewa.y.bf,{},null,!1);this.P();f=(i=new _Ewa.Cm,i.ClientViewCapacity=n.clientViewCapacity,i);r=null;t&&(r=(u=new _Ewa.Cn,u.FilterSheetMultiRange=this.R(t.filterSheetMultiRange),u));var h=this,o=function(){Diag.a.a(575447172,0,10,"LineageManager::LineageOpenPaneOrChangeFilter service call failed.")},e=this,s=function(n,t){return Microsoft.Office.Excel.WebUI.Client.Lineage.a.f(e.b.d().a(),f,r,_Ewa.p.a(n,e.j("LineageOpenPaneOrChangeFilter")),_Ewa.p.b(t,o),null,null)};this.b.g().a(new _Ewa.be(1010,0,s,16,null),null)},bc:function(n){_Ewa.ba.a(this.b).a(_Ewa.y.be,{},null,!1);var u=this,i=function(){Diag.a.a(575447171,0,10,"LineageManager::LineageLoadMore service call failed.")},t=this,r=function(r,u){return Microsoft.Office.Excel.WebUI.Client.Lineage.a.e(t.b.d().a(),n,_Ewa.p.a(r,t.j("LineageLoadMore")),_Ewa.p.b(u,i),null,null)};this.b.g().a(new _Ewa.be(1011,0,r,16,null),null)},be:function(){_Ewa.ba.a(this.b).a(_Ewa.y.bg,{},null,!1);var r=this,t=function(){Diag.a.a(575447170,0,10,"LineageManager::LineageRefreshView service call failed.")},n=this,i=function(i,r){return Microsoft.Office.Excel.WebUI.Client.Lineage.a.g(n.b.d().a(),_Ewa.p.a(i,n.j("LineageRefreshView")),_Ewa.p.b(r,t),null,null)};this.b.g().a(new _Ewa.be(1012,0,i,16,null),null)},T:function(n){this.f.a();_Ewa.ba.a(this.b).a(_Ewa.y.k,{},null,!1);this.P();var t,i=(t=new _Ewa.Cj,t.BaseLineActivityId=n.baseLineActivityId,t.RequestedActivitiesCount=n.requestedActivitiesCount,t.FetchFromBelow=n.fetchFromBelow,t.FilterSheetMultiRange=this.R(n.filterSheetMultiRange),t),r=this.j("GetLineageActivities"),o=this,u=function(){Diag.a.a(593854552,0,10,"LineageManager::GetLineageActivities service call failed.")},f=this,e=function(n,t){return Microsoft.Office.Excel.WebUI.Client.Lineage.a.a(f.b.d().a(),i,_Ewa.p.a(n,r),_Ewa.p.b(t,u),null,null)};this.b.g().a(new _Ewa.be(1004,0,e,16,null),null)},V:function(n){_Ewa.ba.a(this.b).a(_Ewa.y.k,{},null,!1);var t,i=(t=new _Ewa.Cl,t.BaseLineActivityId=n.baseLineActivityId,t.RequestedActivitiesCount=n.requestedActivitiesCount,t.FetchFromBelow=n.fetchFromBelow,t),r=this.j("GetLineageActivitiesWithServerAdjustedFilter"),o=this,u=function(){Diag.a.a(587588252,0,10,"LineageManager::GetLineageActivitiesWithServerAdjustedFilter service call failed.")},f=this,e=function(n,t){return Microsoft.Office.Excel.WebUI.Client.Lineage.a.c(f.b.d().a(),i,_Ewa.p.a(n,r),_Ewa.p.b(t,u),null,null)};this.b.g().a(new _Ewa.be(1007,0,e,16,null),null)},j:function(n){var t=this;return function(i){var r=_Ewa.O.a(i)?null:i.Result,f,u,e;if(!r){Diag.a.b(592724495,0,!!r,"LineageManager."+n+" returned null response.");return}f={CountOfActivities:r.ActivityList.length};_Ewa.ba.a(t.b).a(_Ewa.y.bc,f,null,!1);e=(u=new _Ewa.LK,u.activityList=t.p(r.ActivityList),u.latestActivityId=r.LastSearchedActivityId,u.oldestActivityId=r.FirstSearchedActivityId,u.serverMessageCode=r.LineageResponseCode,u.lastSearchedActivityTimestamp=new Date(r.EcmaLastSearchedDate),u.serverFirstActivityId=r.ServerFirstActivityId,u.serverLastActivityId=r.ServerLastActivityId,u.showLoadPrevious=r.ShowLoadPrevious,u);t.c.onLineageActivitiesResponse(e)}},bf:function(){var n,i;if(!this.b.a(777)){i=(n=new _Ewa.oq,n.activityList=null,n.latestActivityId=0,n.oldestActivityId=0,n.serverMessageCode=0,n.lastSearchedActivityTimestamp=new Date,n.hasNewActivities=!0,n.serverFirstActivityId=0,n.serverLastActivityId=0,n);this.c.onLineageActivitiesUpdateResponse(i);return}var t=this,r=function(n){var i=_Ewa.O.a(n)?null:n.Result,u,r,f;if(!i){Diag.a.b(575447168,0,!!i,"LineageManager.LineageUpdateView returned null response.");return}u={CountOfUpdatedActivities:i.LineageActivitiesResponse.ActivityList.length};_Ewa.ba.a(t.b).a(_Ewa.y.bh,u,null,!1);f=(r=new _Ewa.oq,r.activityList=t.p(i.LineageActivitiesResponse.ActivityList),r.latestActivityId=i.LineageActivitiesResponse.LastSearchedActivityId,r.oldestActivityId=i.LineageActivitiesResponse.FirstSearchedActivityId,r.serverMessageCode=i.LineageActivitiesResponse.LineageResponseCode,r.lastSearchedActivityTimestamp=new Date(i.LineageActivitiesResponse.EcmaLastSearchedDate),r.hasNewActivities=i.HasNewActivities,r.filterSheetMultiRange=t.Q(i.LineageActivitiesResponse.FilterSheetMultiRange),r.serverFirstActivityId=i.LineageActivitiesResponse.ServerFirstActivityId,r.serverLastActivityId=i.LineageActivitiesResponse.ServerLastActivityId,r.showLoadPrevious=i.LineageActivitiesResponse.ShowLoadPrevious,r);t.c.onLineageActivitiesUpdateResponse(f)},f=this,u=function(){Diag.a.a(575447139,0,10,"LineageManager::LineageUpdateView service call failed.")};Microsoft.Office.Excel.WebUI.Client.Lineage.a.h(this.b.d().a(),r,u,null,null)},U:function(n){var t,u;if(!this.b.a(777)){u=(t=new _Ewa.oq,t.activityList=null,t.latestActivityId=n.latestActivityId,t.oldestActivityId=n.oldestActivityId,t.serverMessageCode=0,t.lastSearchedActivityTimestamp=new Date,t.hasNewActivities=!0,t);this.c.onLineageActivitiesUpdateResponse(u);return}var i,f=(i=new _Ewa.Ck,i.FirstActivityId=n.oldestActivityId,i.LastActivityId=n.latestActivityId,i),r=this,e=function(n){var t=_Ewa.O.a(n)?null:n.Result,u,i,f;if(!t){Diag.a.b(592724492,0,!!t,"LineageManager.GetLineageActivitiesUpdate returned null response.");return}u={CountOfUpdatedActivities:t.LineageActivitiesResponse.ActivityList.length};_Ewa.ba.a(r.b).a(_Ewa.y.bd,u,null,!1);f=(i=new _Ewa.oq,i.activityList=r.p(t.LineageActivitiesResponse.ActivityList),i.latestActivityId=t.LineageActivitiesResponse.LastSearchedActivityId,i.oldestActivityId=t.LineageActivitiesResponse.FirstSearchedActivityId,i.serverMessageCode=t.LineageActivitiesResponse.LineageResponseCode,i.lastSearchedActivityTimestamp=new Date(t.LineageActivitiesResponse.EcmaLastSearchedDate),i.hasNewActivities=t.HasNewActivities,i.filterSheetMultiRange=r.Q(t.LineageActivitiesResponse.FilterSheetMultiRange),i);r.c.onLineageActivitiesUpdateResponse(f)},s=this,o=function(){Diag.a.a(592724491,0,10,"LineageManager::GetLineageActivitiesUpdate service call failed.")};Microsoft.Office.Excel.WebUI.Client.Lineage.a.b(this.b.d().a(),f,e,o,null,null)},Q:function(n){if(_Ewa.bx.a(n.Ranges)&&_Ewa.f.a(n.SheetName))return null;var t;return t=new _Ewa.mt,t.rangeList=this.l(n.Ranges),t.sheetName=n.SheetName,t},l:function(n){for(var i,t,e,u=[],f=n,o=f.length,r=0;r<o;++r)i=f[r],e=(t=new _Ewa.xP,t.firstCol=i.FirstColumn,t.firstRow=i.FirstRow,t.lastRow=i.LastRow,t.lastCol=i.LastColumn,t),u.push(e);return u},R:function(n){if(!n)return null;var t={};return t.Ranges=this.X(n.rangeList),t.SheetName=n.sheetName,t},X:function(n){var r=[],i,t;if(_Ewa.bx.a(n))return r;for(var f=n,e=f.length,u=0;u<e;++u)i=f[u],t={},t.FirstColumn=i.firstCol,t.FirstRow=i.firstRow,t.LastRow=i.lastRow,t.LastColumn=i.lastCol,r.push(t);return r},bg:function(n){var t=n.rangeHighlightLocation;if(t)t.rangeList.length?this.Y(t.sheetName,t.rangeList):this.Z(t.sheetName);else return},Z:function(n){var t=this.b.e().b(n);if(t){if(!!t.R)return;t.f(!0)}return},Y:function(n,t){for(var r,i,e,s,u=[],o=t,h=o.length,f=0;f<h;++f)r=o[f],i={},i.FirstColumn=r.firstCol,i.FirstRow=r.firstRow,i.LastRow=r.lastRow,i.LastColumn=r.lastCol,u.push(_Ewa.h.b(i));e=u.length-1;s=u[e].e();_Ewa.b.a(this.b).bj(u,e,n,null,s,null,null,3,_Ewa.H.X,!0,!0,null,!0,!0)},bi:function(){if(_Ewa.c.a("OfficeVSO:4597686_LineageLearnMoreLinkEnabled")){var n=new _Ewa.L(-859308420,_Ewa.G.a,this.b.s(),12,_Ewa.c.a("OfficeVSO:4894065_LaunchHelpPaneWithHelpArticleKey")?null:_Ewa.k.a()?"Help":"Ribbon.Help"),t={CommandValueId:"HelpID=XLO_LineageTS",InputMethod:_Ewa.G.a,MenuItemId:_Ewa.c.a("OfficeVSO:4894065_LaunchHelpPaneWithHelpArticleKey")?"HelpArticle":"HelpArticle",ShouldCanvasTakeFocus:!0};this.b.h().a(n,t,null)}},bs:function(n){this.b.h().a(new _Ewa.L(-1112508866,n,this.b.s(),12,null),null,null)},bb:function(n){switch(n){case"CellLineageLiveUpdateFlight":case"CellLineageLiveUpdate":return this.b.a(777);case"LineageCallbacksV2":case"LineageManagerV2":return this.b.a(994);case"LineageEviction":case"LineageModelEviction":return this.b.a(1041);case"ScrollToIndexAndSeparatorEnabled":return _Ewa.c.a("OfficeVSO:4879296_ScrollToIndexAndSeparatorEnabled");default:return!1}},bh:function(){this.O()},O:function(){this.c&&this.d.b()&&(this.i=this.b.c().c(),this.c.onRefreshRequired())},bt:function(){var n=this.b.c().l().LineageVersion;n!==this.o&&(Diag.a.a(591696593,0,50,"LineageManager.OnWorkbookMetadataChanged: lineageVersion: {0}, this.lineageVersion: {1}",n,this.o),this.o=n,this.O())},S:function(){this.d.f(this.v);this.d.j(this.w);this.b.a(777)?this.b.c().s(this.A):this.b.c().x(this.t);this.b.c().h(this.x);this.b.c().E(this.u);var n=this.b.e();n.k(this.y);n.m(this.h);n.s(this.z);n.o(this.h)},bx:function(){this.b.a(777)?this.b.c().u(this.A):this.b.c().w(this.t);this.e.a().m(this.k);this.b.c().i(this.x);this.b.c().F(this.u);var n=this.b.e();n.l(this.y);n.n(this.h);n.y(this.z);n.A(this.h)},N:function(){this.c.onStaleActivitiesDetected()},bo:function(n,t){this.c&&!this.d.e()&&t.a&&(Diag.a.a(587220563,0,50,"LineageManager::SessionIdChanged detected."),this.N())},bj:function(){this.c&&!this.d.e()&&(Diag.a.a(587220562,0,50,"LineageManager::LoadOnDemandOccurred detected."),this.N())},bq:function(n,t){var r=this.m(),u=t,i,f=(i=new _Ewa.xO,i.sheetChangeType=0,i.oldSheetName=u.a.a(),i.newSheetName="",i);this.c.onFilterableSheetListChanged(r,f)},br:function(n,t){var u=this.m(),r=t,i,f=(i=new _Ewa.xO,i.sheetChangeType=1,i.oldSheetName=r.b,i.newSheetName=r.a,i);this.c.onFilterableSheetListChanged(u,f)},bp:function(){var n=this.m();this.c.onFilterableSheetListChanged(n,null)},m:function(){for(var n,u=this.b.e(),f=u.j(),i=[],r=f,e=r.length,t=0;t<e;++t)n=r[t],n.j()&&!_Ewa.C.e(n)&&i.push(n.b());return i},bk:function(){this.c.onPaneClosed();var i=this,n=function(){Diag.a.a(591692937,0,10,"LineageManager::OnUpdateLineagePaneStateFailed service call failed.")},r=this,t=function(){Diag.a.a(575022273,0,10,"LineageManager::OnLineageClosePaneFailed service call failed.")};this.b.a(994)?Microsoft.Office.Excel.WebUI.Client.Lineage.a.d(this.b.d().a(),null,t,null,null):Microsoft.Office.Excel.WebUI.Client.Lineage.a.i(this.b.d().a(),!0,null,n,null,null)},bm:function(n){n?this.e.a().l(this.k):this.e.a().m(this.k)},bn:function(){var i=this.e.a().a().e(),t=_Ewa.h.e(i,this.b),n,r=(n=new _Ewa.mt,n.rangeList=this.l(t.Ranges),n.sheetName=t.SheetName,n);this.c.onSelectedRangeUpdated(r)},by:function(n){var r,t,e,o,s,h,c,y=(c=_Ewa.h.h(n,this.b.e(),o={val:t},s={val:e},h={val:r}),t=o.val,e=s.val,r=h.val,c),l,a,u,f,i,v;return y?(t||(l=this.b.e(),a=l.a(),t=a.b()),u=[],u.push(r),f=_Ewa.h.l(t,null,u),v=(i=new _Ewa.mt,i.rangeList=this.l(f.Ranges),i.sheetName=f.SheetName,i),v):null},bl:function(){var n=this.i!==this.b.c().c();this.c&&this.d.b()&&n&&(this.i=this.b.c().c(),this.c.onRefreshRequired())},P:function(){var n,i,t;this.b.a(939)&&(n=this.b.b().a(_Ewa.jo,403,!1,null),n&&n.a(),i=new _Ewa.L(-847286761,_Ewa.G.a,this.b.s(),0,"Help"),t={InputMethod:_Ewa.G.a},t.CalloutName=6,this.b.h().a(i,t,null))},p:function(n){for(var t,i,e,u=[],f=n,o=f.length,r=0;r<o;++r)t=f[r],e=(i=new _Ewa.LO,i.activityId=Number.parseLocale(t.UserActivity.Id),i.activityGuid=t.Uid,i.activityType=t.UserActivity.Type,i.author=this.W(t.UserActivity.Person),i.sheetName=t.SheetName,i.displayTimestamp=new Date(t.UserActivity.DisplayTimestamp),i.gridLocation=t.DisplayLocation,i.valueChanges=this.bw(t.LineageValueChangeList),i.isBulkEditOverflow=t.IsBulkEditOverFlow,i.rangeHighlightLocation=this.bv(t.UserActivity.LocationList,t.UserActivity.Type),i.nestedActivityList=this.bu(t.NestedActivityList),i),u.push(e);return u},bv:function(n,t){var r,u,e,f,i,p,o;if(!n)return Diag.a.a(593601666,0,15,"LineageManager:: RangeHighlightLocation.ActivityLocationList is null"),null;if(!n.length)return Diag.a.a(593601665,0,50,"LineageManager:: RangeHighlightLocation.ActivityLocationList is empty"),null;var s=[],h=[],c="";t===21?h.push(n[0]):h=n;for(var v=h,w=v.length,l=0;l<w;++l){r=v[l];switch(r.Type){case 1:break;case 2:c=r.SheetName;break;case 0:if(u=r,!u.RangeList){Diag.a.a(593601635,0,50,"LineageManager:: RangeHighlightLocation.RangeActivityLocation is null");break}c=u.RangeList[0].SheetName;e=[];t===21?e.push(u.RangeList[0]):e=u.RangeList;for(var y=e,b=y.length,a=0;a<b;++a)f=y[a],p=(i=new _Ewa.xP,i.firstCol=f.FirstColumn,i.firstRow=f.FirstRow,i.lastRow=f.LastRow,i.lastCol=f.LastColumn,i),s.push(p);break;default:Diag.a.a(593601634,0,50,"LineageManager:: RangeHighlightLocation.ActivityLocationList is of type: ",r.Type)}}return!s.length,o=new _Ewa.mt,o.sheetName=c,o.rangeList=s,o},bw:function(n){for(var t,i,e,u=[],f=n,o=f.length,r=0;r<o;++r)t=f[r],e=(i=new _Ewa.LP,i.hasNewValue=t.HasNewValue,i.hasOldValue=t.HasOldValue,i.newValue=t.HasNewValue?t.NewValue:null,i.oldValue=t.HasOldValue?t.OldValue:null,i.cellLocation=t.CellLocation,i),u.push(e);return u},bu:function(n){return n?this.p(n):null},W:function(n){var i=null,t;return _Ewa.c.a("OfficeVSO:4947893_ShowChangesUserProfilePictureSupportEnabled")&&Common.a.a.a("IsUserProfilePictureResolutionEnabled")&&(i=this.q.a(n.Email,n.Provider,Common.a.i,0)),t=new _Ewa.LM,t.id=n.Id,t.provider=n.Provider,t.displayName=n.DisplayName,t.email=n.Email,t.imageUrl=i,t}};Microsoft.Office.Excel.WebUI.Client.Lineage.d=function(n){Microsoft.Office.Excel.WebUI.Client.Lineage.d.initializeBase(this);this.h=n;this.l()};Microsoft.Office.Excel.WebUI.Client.Lineage.d.a=function(n){n.b().b(_Ewa.bgS.$$(Microsoft.Office.Excel.WebUI.Client.a),367,new Microsoft.Office.Excel.WebUI.Client.Lineage.d(n))};Microsoft.Office.Excel.WebUI.Client.Lineage.d.prototype={m:null,h:null,n:null,p:function(n){var t=this;_Ewa.g.a(n,function(){t.k(t.h.b().a(Microsoft.Office.Excel.WebUI.Client.a,366,!1,null)||new Microsoft.Office.Excel.WebUI.Client.Lineage.h(t.h,t.h.b(),t.m,t.n))},this.h.i(),3,null,null)},b:function(){this.n=this.h.n().a("UserAction","LineagePaneSeenStopwatch");this.n.d();var t=_Ewa.n.b(_Ewa.kS,this.h.b(),365,364,this.j,null),i=_Ewa.cn.a(this.h),r=_Ewa.n.b(Common.bn,this.h.b(),283,284,this.j,null),n=this;_Ewa.g.a(_Ewa.g.b([t,i,r],this.h.i(),3),function(){n.m=t.a();i.a().f(_Ewa.kS,n.m);n.p($$sc.h.a(Object,r.a().a().loadScript("cellLineage")))},this.h.i(),3,null,null)}};Microsoft.Office.Excel.WebUI.Client.Lineage.f=function(n){Microsoft.Office.Excel.WebUI.Client.Lineage.f.initializeBase(this);this.h=n;this.l()};Microsoft.Office.Excel.WebUI.Client.Lineage.f.a=function(n){n.b().b(_Ewa.bgS.$$(_Ewa.jo),402,new Microsoft.Office.Excel.WebUI.Client.Lineage.f(n))};Microsoft.Office.Excel.WebUI.Client.Lineage.f.prototype={h:null,b:function(){var n=new Microsoft.Office.Excel.WebUI.Client.LineageTeachingCalloutTriggerManager(this.h);this.k(n)}};Microsoft.Office.Excel.WebUI.Client.Lineage.a=function(){};Microsoft.Office.Excel.WebUI.Client.Lineage.a.f=function(n,t,i,r,u,f,e){var o=n.a(1,e);return o.clientParams=t,o.lineageFilter=i,_Ewa.l.a(n,"LineageOpenPaneOrChangeFilter",o,r,u,f,0,null,null)};Microsoft.Office.Excel.WebUI.Client.Lineage.a.e=function(n,t,i,r,u,f){var e=n.a(1,f);return e.fetchFromBelow=t,_Ewa.l.a(n,"LineageLoadMore",e,i,r,u,0,null,null)};Microsoft.Office.Excel.WebUI.Client.Lineage.a.g=function(n,t,i,r,u){var f=n.a(1,u);return _Ewa.l.a(n,"LineageRefreshView",f,t,i,r,0,null,null)};Microsoft.Office.Excel.WebUI.Client.Lineage.a.h=function(n,t,i,r,u){var f=n.a(1,u);return _Ewa.l.a(n,"LineageUpdateView",f,t,i,r,0,null,null)};Microsoft.Office.Excel.WebUI.Client.Lineage.a.d=function(n,t,i,r,u){var f=n.a(1,u);return _Ewa.l.a(n,"LineageClosePane",f,t,i,r,0,null,null)};Microsoft.Office.Excel.WebUI.Client.Lineage.a.a=function(n,t,i,r,u,f){var e=n.a(1,f);return e.lineageActivitiesRequestParams=t,_Ewa.l.a(n,"GetLineageActivities",e,i,r,u,0,null,null)};Microsoft.Office.Excel.WebUI.Client.Lineage.a.b=function(n,t,i,r,u,f){var e=n.a(1,f);return e.lineageActivitiesUpdateRequestParams=t,_Ewa.l.a(n,"GetLineageActivitiesUpdate",e,i,r,u,0,null,null)};Microsoft.Office.Excel.WebUI.Client.Lineage.a.i=function(n,t,i,r,u,f){var e=n.a(1,f);return e.paneClosed=t,_Ewa.l.a(n,"UpdateLineagePaneState",e,i,r,u,0,null,null)};Microsoft.Office.Excel.WebUI.Client.Lineage.a.c=function(n,t,i,r,u,f){var e=n.a(1,f);return e.lineageActivitiesWithServerAdjustedFilterRequestParams=t,_Ewa.l.a(n,"GetLineageActivitiesWithServerAdjustedFilter",e,i,r,u,0,null,null)};Microsoft.Office.Excel.WebUI.Client.Lineage.b=function(n,t,i){this.s=Function.createDelegate(this,this.G);this.C=Function.createDelegate(this,this.H);this.b=this.cx;this.d=this.cw;Microsoft.Office.Excel.WebUI.Client.Lineage.b.initializeBase(this,[n,null]);this.p=t;this.r=i;this.p.G(this.C);_Ewa.bm.a(this.p).a(this)};Microsoft.Office.Excel.WebUI.Client.Lineage.b.a=function(n,t){var r=n.m(),i=document.getElementById(r+"m_LineageTaskPane"),u;return i||(i=document.createElement("div"),i.id=n.m()+"m_LineageTaskPane",Sys.UI.DomElement.addCssClass(i,"LineageActivityPane"),u=document.getElementById(r+"novTaskpaneBody"),u.appendChild(i)),n.b().a(Microsoft.Office.Excel.WebUI.Client.Lineage.b,365,!1,null)||n.b().b(Microsoft.Office.Excel.WebUI.Client.Lineage.b,365,new Microsoft.Office.Excel.WebUI.Client.Lineage.b(i,n,t))};Microsoft.Office.Excel.WebUI.Client.Lineage.b.prototype={r:null,p:null,q:null,E:null,A:!0,t:function(n){this.get_events().addHandler("LineageTaskPaneRemove",n)},y:function(n){this.get_events().removeHandler("LineageTaskPaneRemove",n)},j:function(n){this.cy("LineageTaskPaneVisibilityChanged",n)},o:function(n){this.cC("LineageTaskPaneVisibilityChanged",n)},f:function(n){this.get_events().addHandler("LineageTaskPaneClose",n)},m:function(n){this.get_events().removeHandler("LineageTaskPaneClose",n)},cx:function(){return _Ewa.bau.prototype.cx.call(this)},cw:function(n){var t=_Ewa.bau.prototype.cx.call(this)!==n;return t&&(_Ewa.bau.prototype.cw.call(this,n),this.ct("LineageTaskPaneVisibilityChanged",null)),n},e:function(){return this.A},bB:function(){return this.cx()},a:function(){return 15},bl:function(){return"LTP"},u:function(){return"ewanov_showChangesExcel"},v:function(){return _Ewa.ClientStringManager.a().a(971)},i:function(){return 300},D:0,w:function(){return this.D},X:function(n){return this.D=n,n},U:function(){return!1},B:function(){return this.cr()},z:!1,V:function(){return _Ewa.ClientStringManager.a().a(1177)},n:function(){},T:function(){},g:function(){return this.z},h:function(){return this.z},x:function(){},W:function(){return!1},cJ:function(){},bL:function(){},dispose:function(){this.p&&(this.p.H(this.C),_Ewa.bm.a(this.p).c(this));this.q&&(Common.i.a().b("click",this.q,this.s),Common.h.a().d(this.q,this.E));this.p=null;this.r=null;this.q=null;_Ewa.bau.prototype.dispose.call(this)},K:function(n,t){if(!t){var i=_Ewa.a.a(this.cr(),"LineagePaneFilterButton");if(!i)return!1;_Ewa.a.c(i,!1)}return!t},dR:function(n){return _Ewa.a.f(this.B(),n)},c:function(n){var t,i;this.z=n;t=this.r;this.cw(n);n&&(this.p.r().Y.c("LineagePane"),this.A=!1);this.r.b();i=!!this.r.a()&&this.r.a().a().a()===15;n&&t.d().length>0&&(!i||t.e())&&t.c(Microsoft.Office.Excel.WebUI.Client.Lineage.b,this,!0);this.p.v()},l:function(){var i=this.p.m(),t=document.getElementById(i+"m_LineageTaskPane"),r=this.F(),n;return t.appendChild(r),n=CommonUI.a.b("div","LineagePaneBodyId","LineageActivityBody"),t.appendChild(n),this.I(),n},k:function(){var n=this.p.r().Y.n;this.p.r().Y.c(n||"app");this.A=!0;this.c(!1);this.ct("LineageTaskPaneClose",null)},I:function(){this.p.r().Y.b("LineagePane");var n=this.p.r().Y.a("LineagePane");n.d="app";n.e=!0},H:function(n,t){t.a||this.k()},F:function(){var n=CommonUI.a.b("div","LineagePaneHeaderId","LineageActivityPaneHeader"),t=CommonUI.a.b("h1","LineagePaneTitleId","cui-taskpane cui-taskPaneTitle LineageActivityPaneTitle");return t.innerText=this.V(),this.q=CommonUI.e.a("LineagePaneCloseButtonId","StandardButton LineageActivityCloseButton",_Ewa.ClientStringManager.a().a(10),"ClosePaneGlyph_16x16x32",!1),Sys.UI.DomElement.addCssClass(this.q,Common.a.h?"FloatLeft":"FloatRight"),Common.i.a().a("click",this.q,this.s),this.E=Common.h.a().c(this.q,this.s,13),n.appendChild(t),n.appendChild(this.q),n},G:function(){return this.k(),!0}};Microsoft.Office.Excel.WebUI.Client.Lineage.e=function(n){Microsoft.Office.Excel.WebUI.Client.Lineage.e.initializeBase(this);this.h=n;this.l()};Microsoft.Office.Excel.WebUI.Client.Lineage.e.a=function(n){n.b().b(_Ewa.bgS.$$(_Ewa.kS),364,new Microsoft.Office.Excel.WebUI.Client.Lineage.e(n))};Microsoft.Office.Excel.WebUI.Client.Lineage.e.prototype={m:null,n:null,p:function(){if(!this.m){var n=this;this.m=_Ewa.g.a(_Ewa.cn.a(this.h),function(t){n.n=Microsoft.Office.Excel.WebUI.Client.Lineage.b.a(n.h,t.a())},this.i(),3,null,null)}return this.m},h:null,b:function(){var t=_Ewa.n.a(Sys.IDisposable,this.h.b(),203,this.i(),this.j,null),i=_Ewa.n.a(Object,this.h.b(),155,this.i(),this.j,null),r=this,n=this;_Ewa.g.a(_Ewa.g.ts(_Ewa.g.b([t,i],this.i(),3),function(){return r.p()},this.i(),3,null),function(){n.k(n.n)},this.i(),3,null,null)},dispose:function(){this.h=null;this.m=null;this.n=null;_Ewa.rR.prototype.dispose.call(this)}};Microsoft.Office.Excel.WebUI.Client.LineageTeachingCalloutTriggerManager.registerClass("Microsoft.Office.Excel.WebUI.Client.LineageTeachingCalloutTriggerManager",null,_Ewa.jo,Sys.IDisposable);Microsoft.Office.Excel.WebUI.Client.Lineage.g.registerClass("Microsoft.Office.Excel.WebUI.Client.Lineage.g",null,_Ewa.kR);Microsoft.Office.Excel.WebUI.Client.Lineage.c.registerClass("Microsoft.Office.Excel.WebUI.Client.Lineage.c",_Ewa.bg);Microsoft.Office.Excel.WebUI.Client.Lineage.d.registerClass("Microsoft.Office.Excel.WebUI.Client.Lineage.d",_Ewa.rR.$$(Microsoft.Office.Excel.WebUI.Client.a));Microsoft.Office.Excel.WebUI.Client.Lineage.f.registerClass("Microsoft.Office.Excel.WebUI.Client.Lineage.f",_Ewa.rR.$$(_Ewa.jo));Microsoft.Office.Excel.WebUI.Client.Lineage.b.registerClass("Microsoft.Office.Excel.WebUI.Client.Lineage.b",_Ewa.bau,_Ewa.kS,Sys.IDisposable,_Ewa.LH,_Ewa.oj);Microsoft.Office.Excel.WebUI.Client.Lineage.e.registerClass("Microsoft.Office.Excel.WebUI.Client.Lineage.e",_Ewa.rR.$$(_Ewa.kS));Microsoft.Office.Excel.WebUI.Client.LineageTeachingCalloutTriggerManager.a=!1;Microsoft.Office.Excel.WebUI.Client.LineageTeachingCalloutTriggerManager.b=!1;Type.registerNamespace("_Ewa");_Ewa.bhu=function(){};_Ewa.bhu.a=function(){_Ewa.m.a(function(n){Microsoft.Office.Excel.WebUI.Client.Lineage.e.a(n);Microsoft.Office.Excel.WebUI.Client.Lineage.d.a(n);Microsoft.Office.Excel.WebUI.Client.Lineage.f.a(n);Microsoft.Office.Excel.WebUI.Client.Lineage.c.a(n)})};_Ewa.bhu.a();Type.registerNamespace("_Ewa");_Ewa.bbc=function(){};_Ewa.bbc.registerInterface("_Ewa.bbc");_Ewa.EU=function(n,t){this.b=n;this.a=t};_Ewa.EU.prototype={a:null,b:null,y:function(n,t){return this.a?t===-876699925?!this.a.a():!1:!0},w:function(n,t){var i=!1;switch(t.a){case-876699925:i=this.a.c()}return i?$$sc.a.a(Boolean,!0):_Ewa.V.a(t.a)},v:function(n,t){return this.b.a(588)&&t.a===-876699925?!0:!1},x:function(){return!1}};_Ewa.uf=function(n){_Ewa.uf.initializeBase(this,[n])};_Ewa.uf.a=function(n){_Ewa.bg.a(285,new _Ewa.uf(n))};_Ewa.uf.prototype={m:function(){var n=this;this.h.b().c(_Ewa.hv,286,function(t){n.n([new _Ewa.EU(n.h,t)],null)},null)}};_Ewa.EV=function(n,t){this.a=n;this.b=t};_Ewa.EV.prototype={a:null,b:!1,doesContentExist:function(n){var t,i;if(!n)return Diag.a.a(590348556,3012,10,"Null activity: DoesContentExist. Default to false."),!1;switch(n.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:return n.navigationId?(t={},t.NavigationId=atob(n.navigationId),i=this.a.b(567929329,2,t,null),i===32):(Diag.a.a(590348555,3012,10,"Null activity.NavigationId: DoesContentExist. Default to false."),!1);default:return!1}}};_Ewa.Fa=function(n,t,i){_Ewa.Fa.initializeBase(this);this.c=n;this.a=t;this.b=i};_Ewa.Fa.prototype={c:null,a:null,b:!1};_Ewa.EW=function(n){_Ewa.EW.initializeBase(this);this.a=n};_Ewa.EW.prototype={a:!1};_Ewa.ny=function(n,t,i){this.d=[];_Ewa.ny.initializeBase(this,[!1]);this.h=n;this.a=t;this.f=i;this.l()};_Ewa.ny.prototype={c:null,h:null,f:null,k:function(n){this.dW("cuahscek",n)},p:function(n){this.dX("cuahscek",n)},r:function(n){this.dW("cuasfek",n)},u:function(n){this.dX("cuasfek",n)},q:function(n){this.dW("cuadfek",n)},t:function(n){this.dX("cuadfek",n)},a:null,dispose:function(){System.a.b([this.a]);System.a.b(this.d);this.a=null;this.d=null;this.f=null;_Ewa.cb.prototype.dispose.call(this)},n:function(n){if((!n||this.a.a!==2)&&(n||this.a.a===2)){var t=this.a.a;this.a.a=n?2:this.f.a()?0:1;this.i(t)}},g:function(n){if((!n||this.a.a!==3)&&(n||this.a.a===3)){!n&&this.c&&this.j(this.c,!0);var t=this.a.a;this.a.a=n?3:this.f.a()?0:1;this.i(t)}},m:function(n,t){n&&(t&&(this.c=n),Sys.UI.DomElement.addCssClass(n,"CatchUpActivityHighlightEnlargedDot"))},j:function(n,t){if(t){if(this.c){Sys.UI.DomElement.removeCssClass(this.c,"CatchUpActivityHighlightEnlargedDot");this.c=null;return}}else{if(!n)return;if(this.c&&this.c.id===n.id)return;Sys.UI.DomElement.removeCssClass(n,"CatchUpActivityHighlightEnlargedDot")}},v:function(n){if((!n||this.a.a!==1)&&(n||this.a.a)){var t=this.a.a;this.a.a=n?1:0;this.i(t)}},o:function(n,t){var i=new _Ewa.Fa(this.a.b,n,t);this.dU("cuasfek",i,this)},s:function(n){var t=new _Ewa.EW(n);this.dU("cuadfek",t,this)},i:function(n){var t=new _Ewa.EY(this.a.b,this.a.a,n);this.dU("cuahscek",t,this)}};_Ewa.EX=function(n){this.w=Function.createDelegate(this,this.I);this.C=Function.createDelegate(this,this.Q);this.A=Function.createDelegate(this,this.N);this.o=Function.createDelegate(this,this.T);this.z=Function.createDelegate(this,this.M);this.y=Function.createDelegate(this,this.L);this.B=Function.createDelegate(this,this.O);this.x=Function.createDelegate(this,this.K);this.g={};this.l=n;this.f=_Ewa.b.a(this.l);this.k=this.f.a();this.p=this.f.g();this.k.z(this.x);this.k.j(this.B);this.f.L(this.y);this.p.d(this.z);this.m=null;this.h=null;this.n=!1;this.s={}};_Ewa.EX.prototype={l:null,f:null,k:null,p:null,i:null,h:null,m:null,n:!1,q:null,j:null,s:null,u:null,c:function(n){return this.i=n,n},D:!1,a:function(){return this.D},v:function(){return this.u||(this.u=this.l.b().a(_Ewa.dD,65,!1,null)),this.u},F:function(){return this.q||(this.q=new _Ewa.Fb),this.q},dispose:function(){this.k.B(this.x);this.k.k(this.B);this.f.M(this.y);this.p.c(this.z);this.G();this.f=null;this.k=null;this.p=null;this.j=null;this.m=null;this.h=null;this.s=null},d:function(n){var t,i,u,f,o;if(this.G(),!_Ewa.bx.a(n)){if(Diag.a.a(42795989,0,50,"In CatchUpActivityHighlightManager:ProcessActivityPayloadHighlights()."),this.g=this.F().f(this.l,n,this),this.g){t=this.g;for(i in t){u={key:i,value:t[i]};f=u.value;for(var e=f,s=e.length,r=0;r<s;++r)o=e[r],this.H(o)}}this.F().i(this.l)}},e:function(n){var t,i,u,f,o;if(n&&this.D){Diag.a.b(40482380,0,!1,"CatchUpActivityHighlightManager.ShowOrHideAllHighlights - Trying to show all highlights when marked as read");return}if(n||this.r(),this.g){t=this.g;for(i in t){u={key:i,value:t[i]};f=u.value;for(var e=f,s=e.length,r=0;r<s;++r)o=e[r],o.v(n)}}},b:function(n){var t,u;if(this.h&&this.t(!0),this.E(),t=this.g[n.activityId],!t){Diag.a.a(40482385,0,50,"CatchUpActivityHighlightManager.OnSelectHighlight - Controllers not found during select");return}for(var r=t,f=r.length,i=0;i<f;++i)u=r[i],u.g(!0)},G:function(){var n,t,u,f,r;if(this.g){n=this.g;for(t in n){u={key:t,value:n[t]};f=u.value;for(var e=f,o=e.length,i=0;i<o;++i)r=e[i],this.P(r),r.dispose()}}this.g={};this.F().h();this.q=null},N:function(n,t){switch(t.a){case 0:case 1:t.c===3&&(this.J(),this.j=null);break;case 2:break;case 3:this.E();this.j=t.b;this.R();break;default:Diag.a.b(40482382,0,!1,"CatchUpActivityHighlightManager.OnHighlightStateChanged - Invalid CatchUpActivityHighlightState:"+t.a)}},R:function(){var n,t;if(this.v()&&(n=this.g[this.j],n&&n.length>0&&n[0].a.e===3)){if(t=n[0],!t){Diag.a.b(50606102,0,!1,"RangeCatchUpActivityHighlightController::ShowCommentFlyoutOnSelectedActivity RangeController is Null.");return}this.v().bG(t.z())}},J:function(){this.v()&&this.v().bg()},E:function(){var n,r;if(this.j){if(n=this.g[this.j],!n){Diag.a.a(40482386,0,50,"CatchUpActivityHighlightManager.DeselectCurrentlySelected - Controllers not found for deselection");return}for(var i=n,u=i.length,t=0;t<u;++t)r=i[t],r.g(!1);this.j=null}},K:function(){this.r()},O:function(){this.r()},L:function(){this.r()},M:function(){this.r()},r:function(){this.E();this.t(!0)},Q:function(n,t){var r,i;if(this.i&&t.a!==this.h){if(t.b&&this.t(!0),r=this.S(t.a),!r){Diag.a.b(41996808,0,!1,"CatchUpActivityHighlightManager::ShowActivityFlyoutHandler FlyoutContainer is null.");return}this.i.createActivityIndicatorTooltip((i=new _Ewa.BJ,i.target=t.a,i.container=r,i.activityIds=[t.c],i.isSticky=t.b,i.dirHint=this.f.d()?12:9,i));t.b?(this.h=t.a,Diag.a.a(51172352,0,50,"CatchUpActivityHighlightManager::ShowActivityFlyoutHandler: Activity Indicator Raising Selected/Unselected Event.")):(this.m=t.a,Diag.a.a(51172353,0,50,"CatchUpActivityHighlightManager::ShowActivityFlyoutHandler: Activity Indicator Raising Hover/Unhover Event."));this.n||(this.f.i().d(this.o),this.f.w(this.o),this.n=!0)}},S:function(n){if(!n)return Diag.a.b(41996809,0,!1,"CatchUpActivityHighlightManager::TryGetFlyoutContainer HighlightDot is null."),null;var i=String.format("{0}-{1}",n.id,"Flyout"),t=this.s[i];if(!t){if(!this.f.j())return Diag.a.b(41996810,0,!1,"CatchUpActivityHighlightManager::TryGetFlyoutContainer gridView.DOMElement is null."),null;t=document.createElement("Div");t.className="CatchUpActivityFlyoutContainer";t.id=i;this.f.j().appendChild(t);this.s[i]=t}return t},I:function(n,t){this.t(t.a)},T:function(){var n,t;if(!this.i){Diag.a.b(578421981,0,!1,"CatchUpActivityHighlightManager::UpdateActivityFlyouts ActivityIndicatorTooltipManager is null.");return}this.h&&this.i.updateActivityIndicatorTooltip((n=new _Ewa.sL,n.target=this.h,n.isSticky=!0,n));this.m&&this.i.updateActivityIndicatorTooltip((t=new _Ewa.sL,t.target=this.h,t.isSticky=!1,t))},t:function(n){if(this.i){var t;this.i.dismissActivityIndicatorTooltips((t=new _Ewa.BK,t.clearSticky=n,t));this.m=null;n&&(this.h=null);this.n&&!this.h&&(this.f.i().c(this.o),this.f.y(this.o),this.n=!1)}},H:function(n){n.k(this.A);n.r(this.C);n.q(this.w)},P:function(n){n.p(this.A);n.u(this.C);n.t(this.w)}};_Ewa.bbb=function(n,t,i,r){_Ewa.bbb.initializeBase(this,[!1]);this.h=n;this.b=t;this.e=i;this.g=r;this.a=0};_Ewa.bbb.prototype={h:null,g:0,a:0,b:null,e:0,dispose:function(){this.b=null;_Ewa.bdj.prototype.dispose.call(this)}};_Ewa.EY=function(n,t,i){_Ewa.EY.initializeBase(this);this.b=n;this.a=t;this.c=i};_Ewa.EY.prototype={b:null,a:0,c:0};_Ewa.CatchUpActivityManager=function(n,t,i){this.l=Function.createDelegate(this,this.t);this.d=n;this.e=new _Ewa.EX(this.d);this.j=new _Ewa.EV(Common.a.c(),this.d.a(622));this.i=new _Ewa.eT(this.d,this);this.k=new _Ewa.EZ(Common.a.c());var r=this;this.q(function(n){r.s(n)},t);this.r();this.g=i||new _Ewa.pF;this.n=new _Ewa.Fc(this.d,this.g);this.h=null};_Ewa.CatchUpActivityManager.prototype={f:null,d:null,e:null,i:null,k:null,j:null,n:null,g:null,o:!1,h:null,a:function(){var n=this.g.a;return n&&!this.o&&(Diag.a.a(590144352,3012,50,"Catch Up Flyout is ready and button is enabled."),this.o=!0),n},b:function(){return this.g.b},m:!1,dispose:function(){this.h=null;this.f&&this.f.getWywaEvent().removeListener(this.l);this.d=null;this.f=null;System.a.a(this.e);this.e=null;this.i=null;this.k=null;this.j=null;this.n=null;this.g=null},c:function(){return this.g.e(),!0},u:function(n){if(this.d.v(),!n||!n.length){Diag.a.a(41457609,0,50,"CatchUpActivityManager.OnWywaAuthorsReady: AuthorNames were null or empty");return}this.m=!0;Diag.a.a(41457610,0,50,"CatchUpActivityManager.OnWywaAuthorsReady: GetWywaAuthors succeeded with returned author count - {0}",n.length)},p:function(n){n&&(this.h=n.ActivityList)},r:function(){Diag.a.a(589608192,3012,50,"Catch Up script is loaded and Flyout is enabled.");this.d.a(733)&&Diag.a.a(594401288,3012,50,"Tasks and outstanding data is enabled")},t:function(n){(this.e.d(this.h),this.h=null,this.e.e(!0),n.wywaActivities&&n.wywaActivities.length&&n.wywaActivities[0].type!==2)&&this.e.b(n.wywaActivities[0])},q:function(n,t){_Ewa.pE.a("ScriptDownload");var i=this;_Ewa.g.a(_Ewa.n.b(Common.bn,this.d.b(),283,284,t,null),function(t){n($$sc.h.a(Object,t.a().a().loadScript("catchUpActivity")))},this.d.b().d(),3,null,null)},s:function(n){var t=this;_Ewa.g.a(n,function(){if(Common.cW.a(function(){var n;t.f=catchUpActivity.FactoryGlobal.getExcelCatchUpAppInstance((n=new _Ewa.BN,n.activityContentManager=$$as(_Ewa.sI,t.j),n.activityNavigationManager=$$as(_Ewa.sJ,t.k),n.activityRequestManager=$$as(_Ewa.sK,t.i),n.dataCulture=t.d.f().DataCultureTag,n.flyoutFocus=null,n.flyoutRibbonButton=$$as(_Ewa.pF,t.g),n.uiCulture=t.d.f().UICultureTag,n.ulsLogger=new UlsExternalLogger,n))}),t.e.c(t.f.getActivityIndicatorTooltipManager()),_Ewa.kC.a(t.d),t.f.getWywaEvent().addListener(t.l),t.d.a(588)){_Ewa.pE.a("InitializeCatchUpApp");var n;t.f.initialize((n=new _Ewa.BI,n.featuredActivityGroupsEnabled=!1,n.flyoutEnabled=!0,n.openedViaDeeplink=!1,n.summaryStringEnabled=!1,n))}else t.i.m()},this.d.i(),3,null,null)}};_Ewa.ug=function(n){_Ewa.ug.initializeBase(this);this.h=n;this.l()};_Ewa.ug.a=function(n){n.b().b(_Ewa.bgS.$$(_Ewa.hv),287,new _Ewa.ug(n))};_Ewa.ug.prototype={h:null,b:function(){this.k(this.h.b().a(_Ewa.hv,286,!1,null)||new _Ewa.CatchUpActivityManager(this.h,this.j,null))}};_Ewa.EZ=function(n){this.b=n};_Ewa.EZ.prototype={b:null,navigateToActivity:function(n){var r=n.activity,t,i,u,f;if(!this.c(r))return this.a(4);if(!this.d(r))return this.a(7);t={};try{if(i=window.self.atob(r.navigationId),!i||!i.length)return this.a(5);t.NavigationId=i}catch(e){return Diag.a.a(590956161,3012,10,"Exception thrown when trying to decode activity NavigationID: {0}",e),this.a(5)}return this.b.b(567929329,2,t,null)===8?(this.b.d(1938400843,2,null),this.a(2)):(u=this.b.b(36098707,2,t,null),f=u===32?1:6,this.a(f))},c:function(n){return!n||!n.navigationId?!1:!0},d:function(n){switch(n.type){case 3:case 4:case 6:case 7:case 9:case 8:return!0;default:return!1}},a:function(n){return Promise.resolve(n)}};_Ewa.pD=function(){};_Ewa.pD.b=function(n,t,i,r,u,f){var e=n.a(1,f);return e.getWywaActivitiesDataRequest=t,_Ewa.l.a(n,"GetWywaActivitiesData",e,i,r,u,0,null,null)};_Ewa.pD.c=function(n,t,i,r,u){var f=n.a(1,u);return _Ewa.l.a(n,"GetWywaAuthors",f,t,i,r,4,null,null)};_Ewa.pD.a=function(n,t,i,r,u,f){var e=n.a(1,f);return e.getRelevantActivitiesDataRequest=t,_Ewa.l.a(n,"GetRelevantActivitiesData",e,i,r,u,0,null,null)};_Ewa.Fb=function(){this.b=new($$sc.u.$$(_Ewa.dc));this.a={};this.c={}};_Ewa.Fb.prototype={b:null,a:null,c:null,h:function(){this.b=null;this.a=null;this.c=null},i:function(n){_Ewa.b.a(n).l().c([24],null,null)},f:function(n,t,i){for(var r,e,o,u,d,g,v,f,tt,y,s={},p=t,it=p.length,h=0;h<it;++h)if(r=p[h],r&&!_Ewa.bx.a(r.LocationList)){for(var w=[],c={},b=[],k=r.LocationList,rt=k.length,l=0;l<rt;++l){if(e=k[l],!e){Diag.a.b(50731148,0,!1,"CatchUpActivityHighlightManagerHelper.CreateControllersAndHighlights - Location is Null for activityId : "+r.Id);break}switch(e.Type){case 0:o=e;u=null;"0"in c?(u=c["0"],g=o.RangeList,u.w(g)):(d=o.RangeList,u=new _Ewa.Fd(n,new _Ewa.uh(n,r.Id,r.Type,0,d),i),w.push(u),c["0"]=u);for(var nt=o.RangeList,ut=nt.length,a=0;a<ut;++a)v=nt[a],f=new _Ewa.dc(_Ewa.h.b(v),_Ewa.C.b(n.e().b(v.SheetName))),this.d(f)in this.a?(tt=this.a[this.d(f)],tt.push(u)):(y=[],y.push(u),this.a[this.d(f)]=y),b.push(f),this.b.b(f);break;default:Diag.a.a(50731149,0,10,"CatchUpHighlightControllersCreator.CreateControllersAndHighlights(): Failed.Invalid ActivityLocationType")}}Diag.a.b(50731150,0,!(r.Id in s),"CatchUpHighlightControllersCreator.CreateAndUpdateControllers - highlightControllers already has activity: "+r.Id);this.c[r.Id]=b;s[r.Id]=w}return this.g(n,this.b.g(),this.a),s},e:function(n){var r=n,t,u,f,o;for(t in r){u={key:t,value:r[t]};f=u.value;for(var e=f,s=e.length,i=0;i<s;++i)o=e[i],o.C()}},d:function(n){return String.format("{0}-{1}",n.a,n.b)},g:function(n,t,i){this.e(i);var r=_Ewa.b.a(n).l(),u=this;r.d(t,[24],!0,function(n,t){var h=new _Ewa.dc(n.b,n.i),e=u.d(h),o=i[e],f;if(!o){Diag.a.b(50731151,0,!1,"CatchUpHighlightControllersCreator.CreateHighlightsAndUpdateControllers(), Missing Controller for SheetRangeKey "+e);return}for(var s=o,c=s.length,r=0;r<c;++r)f=s[r],f.x(t),n.h=f},!0)}};_Ewa.pE=function(){};_Ewa.pE.a=function(n){window.performance&&typeof window.performance.mark=="function"&&window.performance.mark("CatchUpInit."+n)};_Ewa.eT=function(n,t){this.a=n;this.b=t;this.d=Common.Utils.a.a().a(Common.App.People.c,null);this.e=Common.Utils.a.a().a(Common.App.People.i,null)};_Ewa.eT.h=function(n){switch(n){case 1:return 1;case 2:return 1002;case 3:return 2;case 5:return 1003;case 8:return 1006;case 7:return 1005;case 9:return 1007;default:return 1}};_Ewa.eT.g=function(n){switch(n){case 1:return 3;case 2:return 4;case 3:return 6;case 4:return 7;case 6:return 8;case 5:return 9;case 7:return 10;default:return Diag.a.b(51499465,3012,!1,"ExcelCatchUpActivityRequestManager.TranslateRelevantActivityTypeToActivityType: unknown RelevantActivityType"),1}};_Ewa.eT.c=function(n){return String.format("{0}/{1}",n.Provider,n.Id)};_Ewa.eT.f=function(n){var f=_Ewa.eT.e(n);if(_Ewa.bx.a(f))return null;var i,t=(i=new _Ewa.BL,i.region=f.join(_Ewa.eT.b),i.type=100,i.subregion=[],i),r=0,u=0,e,o;return _Ewa.eT.d(n,e={val:r},o={val:u}),r=e.val,u=o.val,u?r||(u===1?t.type=107:u>1&&(t.type=107)):r===1?(t.type=105,t.subregion.push(_Ewa.h.b(n[0].RangeList[0]).toString())):r>1&&(t.type=106),t};_Ewa.eT.e=function(n){var r,t,i,o,f,s;if(!n)return null;r=[];t="";for(var e=n,h=e.length,u=0;u<h;++u)i=e[u],i.Type===1?(o=i,t=o.SheetName):i.Type?i.Type===2&&(s=i,t=s.SheetName):(f=i,t=f.RangeList?f.RangeList[0].SheetName:null),!t||!t.length||Array.contains(r,t)||r.push(t);return r};_Ewa.eT.d=function(n,t,i){var r,f,e;t.val=i.val=0;for(var o=n,s=o.length,u=0;u<s;++u)r=o[u],r.Type?r.Type===1&&(e=r,i.val+=e.XluidList?e.XluidList.length:0):(f=r,t.val+=f.RangeList?f.RangeList.length:0)};_Ewa.eT.prototype={a:null,b:null,d:null,e:null,m:function(){var n=this,t=function(t){var i=_Ewa.O.a(t)?null:t.Result;n.b.u(i?i.AuthorNames:null)},f=this,i=function(){Diag.a.a(41457612,0,10,"ExcelCatchUpActivityRequestManager::GetWywaAuthors service call failed.")},r=this,u=function(n,u){return _Ewa.pD.c(r.a.d().a(),_Ewa.p.a(n,t),_Ewa.p.b(u,i),null,null)};this.a.g().a(new _Ewa.be(536,0,u,16,null),null)},requestWYWAActivities:function(){if(this.b.m){var n,t=(n=new _Ewa.sN,n.LowWaterline="",n.HighWaterline="",n);return this.g(t)}return Promise.resolve(_Ewa.eT.a)},requestActivities:function(n,t){if(t&&t.length){var i,r=(i=new _Ewa.sN,i.LowWaterline=t,i.HighWaterline=n,i);return this.g(r)}return Promise.resolve(_Ewa.eT.a)},requestRelevantActivities:function(){var n,i=(n=new _Ewa.BU,n.SetDaysBack=Common.a.a.c("AppWaterlineOverrideDaysValue",0),n.SetTimestamp=Common.a.a.c("AppWaterlineOverrideTimestampValue",0),n),t=this;return new Promise(function(n,r){var u=function(i){var r=_Ewa.eT.a,u;i?_Ewa.O.a(i)?Diag.a.a(578353159,3012,10,"ExcelCatchUpActivityRequestManager::GetRelevantActivitiesData call returned errors codes: {0}",_Ewa.j.a(i.Errors,",")):(u=i.Result,r=t.k(u)):Diag.a.a(51499462,3012,10,"ExcelCatchUpActivityRequestManager::GetRelevantActivitiesData call returned Null result.");n(r)},f=function(n){var t=_Ewa.Y.a(n.b);Diag.a.a(51499463,3012,10,"ExcelCatchUpActivityRequestManager::GetRelevantActivitiesData call has failed - Errors: [{0}]",_Ewa.j.a(t,","));r(null)};_Ewa.pD.a(t.a.d().a(),i,u,f,null,null)})},g:function(n){var t=this;return new Promise(function(i,r){var u=function(n){var r=_Ewa.O.a(n)?null:n.Result,u=_Ewa.eT.a;r?u=t.i(r):Diag.a.a(39978721,0,10,"ExcelCatchUpActivityRequestManager::GetWywaActivitiesData call returned Null result.");t.b.p(r);i(u)},f=function(){Diag.a.a(39978720,0,10,"GetWywaActivitiesData call to WFE has Failed. Rejecting Promise.");t.b.p(null);r(null)},e=function(i,r){return _Ewa.pD.b(t.a.d().a(),n,_Ewa.p.a(i,u),_Ewa.p.b(r,f),null,null)};t.a.g().a(new _Ewa.be(535,0,e,16,null),null)})},i:function(n){var t,i=(t=new _Ewa.nk,t.activities=this.o(n.ActivityList),t.actors=this.l(n.ActivityList),t.hasMore=n.HasMore,t.highWaterline=n.HighWaterline||"<WywaWaterline>DefaultWaterline<\/WywaWaterline>",t.lowWaterline=n.LowWaterline||"<WywaWaterline>DefaultWaterline<\/WywaWaterline>",t.wywaWaterline=n.WywaWaterline||"<WywaWaterline>DefaultWaterline<\/WywaWaterline>",t);return _Ewa.bx.a(i.activities)&&(Diag.a.b(39978723,0,i.lowWaterline==="<WywaWaterline>DefaultWaterline<\/WywaWaterline>","LowWaterline was not set to DefaultExcelWaterline when Activities Array was Null or Empty"),Diag.a.b(39978722,0,i.highWaterline==="<WywaWaterline>DefaultWaterline<\/WywaWaterline>","HighWaterline was not set to DefaultExcelWaterline when Activities Array was Null or Empty"),Diag.a.b(39978752,0,i.wywaWaterline==="<WywaWaterline>DefaultWaterline<\/WywaWaterline>","WywaWaterline was not set to DefaultExcelWaterline when Activities Array was Null or Empty")),Diag.a.a(42002571,0,50,"ExcelCatchUpActivityRequestManager::GetActivityRequestPayload: Count of unique authors in CatchUp pane: {0}",i.actors.length),i},k:function(n){var t,i,f,o,u;if(!n)return Diag.a.a(578110038,3012,10,"ExcelCatchUpActivityRequestManager::GetRelevantActivityRequestPayload response is null."),t=new _Ewa.nk,t.activities=new Array(0),t;i=this.h(n.NewActivities,2);f=this.h(n.OutstandingActivities,3);for(var e=f,s=e.length,r=0;r<s;++r)o=e[r],i.push(o);return u=new _Ewa.nk,u.activities=i,u},o:function(n){for(var t,i,e,u=[],f=n,o=f.length,r=0;r<o;++r)t=f[r],t&&(Diag.a.b(42501920,0,!(!t.Id||!t.Id.length),"ExcelCatchUpActivityRequestManager.TranslateUserActivityListToActivities:userActivity.Id is null or empty"),Diag.a.b(42501921,0,!_Ewa.bx.a(t.LocationList),"ExcelCatchUpActivityRequestManager.TranslateUserActivityListToActivities:userActivity.LocationList is null or empty"),Diag.a.b(42501922,0,!!t.DisplayTimestamp,"ExcelCatchUpActivityRequestManager.TranslateUserActivityListToActivities:userActivity.DisplayTimestamp is 0"),Diag.a.b(42501923,0,!!t.Person,"ExcelCatchUpActivityRequestManager.TranslateUserActivityListToActivities:userActivity.Person is null"),e=(i=new _Ewa.sH,i.activityId=t.Id,i.type=_Ewa.eT.h(t.Type),i.actors=this.j(t.Person),i.location=_Ewa.eT.f(t.LocationList),i.displayTimestamp=new Date(t.DisplayTimestamp),i),u.push(e));return u},h:function(n,t){var e=[],i,f,r,u;if(!n||!n.length)return e;for(var s=n,h=s.length,o=0;o<h;++o){if(i=s[o],!i){Diag.a.b(51499464,3012,!1,"ExcelCatchUpActivityRequestManager.TranslateRelevantActivitiesToActivities: relevantActivity is null");continue}f=_Ewa.eT.g(i.Type);f===6||f===7||f===9||f===8?e.push((r=new _Ewa.BO,r.activityId=i.Id,r.type=f,r.displayTimestamp=new Date(i.DisplayTimestamp),r.navigationId=i.NavigationId,r.actors=this.f(i.People),r.relevancy=t,r.relationship=this.n(i.Relationship),r)):e.push((u=new _Ewa.sH,u.activityId=i.Id,u.type=f,u.displayTimestamp=new Date(i.DisplayTimestamp),u.navigationId=i.NavigationId,u.actors=this.f(i.People),u.relevancy=t,u))}return e},n:function(n){switch(n){case 1:return 1;case 2:return 2;case 3:return 3}return Diag.a.a(575522897,0,10,"Unexpected Relationship."),1},j:function(n){return[this.c(n)]},f:function(n){var t=[],r;if(!n||!n.length)return t;for(var u=n,f=u.length,i=0;i<f;++i)(r=u[i],r)&&t.push(this.c(r));return t},c:function(n){var t;return t=new _Ewa.BM,t.id=n.Id,t.provider=n.Provider,t.displayName=n.DisplayName,t.email=n.Email,t.imageUrl=this.e.a(n.Email,n.Provider,Common.a.i,0),t.color=this.d.a(new Common.App.People.d(null,null,n.DisplayName,null,!1,null),6,!0),t},l:function(n){for(var r,u,t=new _Ewa.w(!1),f=n,e=f.length,i=0;i<e;++i)r=f[i],u=_Ewa.eT.c(r.Person),t.d(u)||t.c(u,this.c(r.Person));return t.a}};_Ewa.Fc=function(n,t){this.b=n;this.c=t;_Ewa.bm.a(this.b).a(this);this.a=!1};_Ewa.Fc.prototype={b:null,c:null,a:!1,dispose:function(){_Ewa.bm.a(this.b).c(this)},B:function(){return document.getElementById("catchUpFlyoutContainer")},bB:function(){return this.c.b&&!this.a},bl:function(){return"CUF"},K:function(n,t){if(t)return!1;var i=document.getElementById("flyoutItem0");return i?(i.focus(),this.d(i),!0):(Diag.a.a(587747732,3012,10,"Could not find firstItem in flyout when setting up focus"),!1)},dR:function(n){return this.B()?_Ewa.a.f(this.B(),n):!1},cJ:function(){this.a=!0},bL:function(){this.a=!1},d:function(n){var i,t;Sys.Browser.agent===Sys.Browser.Firefox?(i=document.createEvent("KeyboardEvent"),i.initKeyEvent("keydown",!0,!0,window.self,!1,!1,!1,!1,40,0),n.dispatchEvent(i)):(t=document.createEvent("Events"),t.initEvent("keydown",!0,!0),t.keyCode=40,t.which=40,n.dispatchEvent(t))}};_Ewa.pF=function(){this.a=!1;this.b=!1;this.d=new Date};_Ewa.pF.prototype={a:!1,b:!1,c:null,d:null,registerButtonClickedEvent:function(n){this.c&&Diag.a.a(587747731,3012,15,"RegisterButtonClickedEvent: Button clicked callback should only be registered once.");this.c=n.buttonClickedCallback},onFlyoutInitialized:function(){this.a&&Diag.a.a(587747730,3012,15,"OnFlyoutInitialized: Flyout should only be initialized once.");var n=(new Date).getTime()-this.d.getTime();Diag.a.a(593601546,3012,50,"Time from retrieve activities to initialize Flyout: {0}",n);this.a=!0;_Ewa.cR.a()&&_Ewa.cR.a().e(!0)},logFlightTriggers:function(){},e:function(){if(!this.a){Diag.a.a(587747729,3012,10,"ToggleCatchUpFlyout: User clicked the button before the flyout was initialized.");return}if(!this.c){Diag.a.a(587747728,3012,10,"ToggleCatchUpFlyout: User clicked the button before the buttonClickedCallback was registered.");return}this.c()},onFlyoutVisibilityChanged:function(n){this.b!==n.flyoutIsVisible&&(this.b=n.flyoutIsVisible,_Ewa.cR.a()&&_Ewa.cR.a().e(!0))}};_Ewa.Fd=function(n,t,i){_Ewa.Fd.initializeBase(this,[n,t,i]);this.e=_Ewa.b.a(n);this.b=t};_Ewa.Fd.prototype={e:null,b:null,dispose:function(){this.e=null;_Ewa.ny.prototype.dispose.call(this)},x:function(n){var t=this.d[0];if(t){t.h(n);return}Diag.a.b(42795991,0,!1,"RangeCatchUpActivityHighlightController.AddViewElement - RangeCatchUpActivityView is null for activityId"+this.b.b)},C:function(){var n=this.d[0];n&&n.f()},w:function(n){var t=this.b;this.b.i(n)},z:function(){return this.b.e!==3?null:(Diag.a.b(50606105,0,this.b.d().length===1,"RangeCatchUpActivityHighlightController::GetCommentActivityRange Range Information Length should be 1."),_Ewa.h.b(this.b.d()[0]))},g:function(n){if(n){if(!this.b)return;this.B(this.D())}_Ewa.ny.prototype.g.call(this,n)},l:function(){var n=this.y();Array.add(this.d,n);return},y:function(){return new _Ewa.Fe(this)},B:function(n){if(!n){Diag.a.b(40482388,0,!1,"RangeCatchUpActivityHighlightController.NavigateToRange: Range is null. Either the location list is empty or sheet is hidden.");return}if(!n.SheetName){Diag.a.b(41493472,0,!1,"RangeCatchUpActivityHighlightController.NavigateToRange: SheetName in the range is null.");return}this.e.a().b().b(null,!0);this.e.o();this.e.cs(n,3,!1,_Ewa.H.bb)},D:function(){var i,n,t;return _Ewa.bx.a(this.b.d())?(Diag.a.b(42006230,0,!1,"RangeCatchUpActivityHighlightController.RetrieveRangeInformationForNavigation : SortedRanges is either null or empty."),null):(i=this.h.e().a(),Diag.a.b(42006231,0,!!i,"RangeCatchUpActivityHighlightController.RetrieveRangeInformationForNavigation : currentSheet is null."),n=this.E(i.M,this.b.d()),!n&&(n=this.A(this.b.d()),!n))?null:(t={},t.SheetName=n.SheetName,t.FirstColumn=n.FirstColumn,t.FirstRow=n.FirstRow,t.LastColumn=n.FirstColumn,t.LastRow=n.FirstRow,t)},A:function(n){var r,t,i,u;if(_Ewa.bx.a(n))return null;for(r=null,t=0;t<n.length;t++)if((i=n[t].SheetName,!_Ewa.f.b(i,r,!1))&&(r=i,u=this.h.e().b(i),u&&!u.R))return n[t];return null},E:function(n,t){var r;if(t)for(var u=t,f=u.length,i=0;i<f;++i)if(r=u[i],_Ewa.f.b(r.SheetName,n,!1))return r;return null}};_Ewa.uh=function(n,t,i,r,u){_Ewa.uh.initializeBase(this,[n,t,i,r]);this.c=u;this.f=!1};_Ewa.uh.a=function(n,t){var i=n,r=t,u;return!i.SheetName||!r.SheetName?(Diag.a.b(42006232,0,!1,"RangeCatchUpActivityHighlightModel.CompareSharedSheetRange : SheetName is null."),0):(u=i.SheetName.localeCompare(r.SheetName),u)?u:i.FirstColumn<r.FirstColumn||i.FirstColumn===r.FirstColumn&&i.FirstRow<r.FirstRow?-1:i.FirstColumn===r.FirstColumn&&i.FirstRow===r.FirstRow?0:1};_Ewa.uh.prototype={c:null,f:!1,d:function(){return this.f||(this.c.sort(_Ewa.uh.a),this.f=!0),this.c},i:function(n){for(var r,i=n,u=i.length,t=0;t<u;++t)r=i[t],this.c.push(r)},dispose:function(){this.c=null;_Ewa.bbb.prototype.dispose.call(this)}};_Ewa.Fe=function(n){this.c=Function.createDelegate(this,this.g);this.a=n;this.a.k(this.c);this.b=[]};_Ewa.Fe.prototype={b:null,a:null,dispose:function(){this.a.p(this.c);this.b=null},h:function(n){this.b.push(n)},f:function(){Array.clear(this.b)},g:function(){switch(this.a.a.a){case 1:this.d(!0);break;case 0:this.e(!1);break;case 2:case 3:this.e(!0);break;default:Diag.a.b(42795992,0,!1,"RangeCatchUpActivityView.OnHighlightStateChanged - Invalid CatchUpActivityHighlightState:"+this.a.a.a)}},d:function(n){for(var i,u,r=this.b,f=r.length,t=0;t<f;++t)i=r[t],i.className="CatchUpActivityHighlight",u=document.getElementById(String.format("{0}-{1}",i.id,"HighlightContainer")),_Ewa.a.b(u,n,!0)},e:function(n){for(var i,r=this.b,u=r.length,t=0;t<u;++t)i=r[t],i&&(n?i.className=this.a.a.a===2?"RangeCatchUpActivityHighlightHovered":"RangeCatchUpActivityHighlightSelected":this.d(!1))}};_Ewa.EU.registerClass("_Ewa.EU",null,_Ewa.kR);_Ewa.uf.registerClass("_Ewa.uf",_Ewa.bg);_Ewa.EV.registerClass("_Ewa.EV",null,_Ewa.sI);_Ewa.Fa.registerClass("_Ewa.Fa",Sys.EventArgs);_Ewa.EW.registerClass("_Ewa.EW",Sys.EventArgs);_Ewa.ny.registerClass("_Ewa.ny",_Ewa.cb);_Ewa.bbb.registerClass("_Ewa.bbb",_Ewa.bdj);_Ewa.EY.registerClass("_Ewa.EY",Sys.EventArgs);_Ewa.CatchUpActivityManager.registerClass("_Ewa.CatchUpActivityManager",null,_Ewa.hv,Sys.IDisposable);_Ewa.ug.registerClass("_Ewa.ug",_Ewa.rR.$$(_Ewa.hv));_Ewa.EZ.registerClass("_Ewa.EZ",null,_Ewa.sJ);_Ewa.eT.registerClass("_Ewa.eT",null,_Ewa.sK);_Ewa.Fc.registerClass("_Ewa.Fc",null,_Ewa.oj,Sys.IDisposable);_Ewa.pF.registerClass("_Ewa.pF");_Ewa.Fd.registerClass("_Ewa.Fd",_Ewa.ny);_Ewa.uh.registerClass("_Ewa.uh",_Ewa.bbb);_Ewa.Fe.registerClass("_Ewa.Fe",null,Sys.IDisposable);var $$t_0;_Ewa.eT.a=($$t_0=new _Ewa.nk,$$t_0.activities=[],$$t_0.actors=[],$$t_0.hasMore=!1,$$t_0.highWaterline="<WywaWaterline>DefaultWaterline<\/WywaWaterline>",$$t_0.lowWaterline="<WywaWaterline>DefaultWaterline<\/WywaWaterline>",$$t_0.wywaWaterline="<WywaWaterline>DefaultWaterline<\/WywaWaterline>",$$t_0);_Ewa.eT.b=", ";Type.registerNamespace("_Ewa");_Ewa.baZ=function(){};_Ewa.baZ.a=function(){_Ewa.m.a(function(n){_Ewa.pE.a("Begin");_Ewa.ug.a(n);_Ewa.uf.a(n)})};_Ewa.baZ.a();Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.VersionHistory");Microsoft.Office.Excel.WebUI.Client.VersionHistory.q=function(){};Microsoft.Office.Excel.WebUI.Client.VersionHistory.q.registerInterface("Microsoft.Office.Excel.WebUI.Client.VersionHistory.q");Microsoft.Office.Excel.WebUI.Client.VersionHistory.r=function(){};Microsoft.Office.Excel.WebUI.Client.VersionHistory.r.registerInterface("Microsoft.Office.Excel.WebUI.Client.VersionHistory.r");Microsoft.Office.Excel.WebUI.Client.VersionHistory.s=function(){};Microsoft.Office.Excel.WebUI.Client.VersionHistory.s.registerInterface("Microsoft.Office.Excel.WebUI.Client.VersionHistory.s");Microsoft.Office.Excel.WebUI.Client.VersionHistory.p=function(){};Microsoft.Office.Excel.WebUI.Client.VersionHistory.p.prototype={url:null,value:null};Microsoft.Office.Excel.WebUI.Client.VersionHistory.g=function(){};Microsoft.Office.Excel.WebUI.Client.VersionHistory.g.prototype={ulsLogger:null,actionUrl:null,hideEmbedFooter:!1,useFetch:!1};Microsoft.Office.Excel.WebUI.Client.VersionHistory.h=function(){};Microsoft.Office.Excel.WebUI.Client.VersionHistory.h.prototype={appBootSettings:null,rootDiv:null};Microsoft.Office.Excel.WebUI.Client.VersionHistory.i=function(){};Microsoft.Office.Excel.WebUI.Client.VersionHistory.i.prototype={selectedVersionInfo:null,baseVersionInfo:null,telemetryCollector:null};Microsoft.Office.Excel.WebUI.Client.VersionHistory.b=function(n,t,i,r){this.g=n;this.l=t;this.e=i;this.f={};this.h=r;this.m()};Microsoft.Office.Excel.WebUI.Client.VersionHistory.b.prototype={g:null,l:null,e:null,f:null,k:null,h:"0.4",j:function(){return[Microsoft.Office.Excel.WebUI.Client.VersionHistory.b.a]},i:function(){return this.k||(this.k=_Ewa.b.a(this.g).l())},d:function(n){n?this.i().c(this.j(),null,null):this.i().a(this.j())},b:function(){this.d(!1);this.i().k(new _Ewa.dc(null,_Ewa.C.b(this.g.j())),this.j(),!0)},c:function(n){var u,t,r,e,o;if(!this.e){Diag.a.a(41976974,0,10,"RangeVersionHistoryHighlightView.SelectView sheetRangeToColorMap is null");return}if(u=new _Ewa.dc(_Ewa.h.b(n),_Ewa.C.b(this.g.e().b(n.SheetName))),t=Microsoft.Office.Excel.WebUI.Client.VersionHistory.VersionHistoryHighlightManager.a(u),!(t in this.e)){Diag.a.a(41976975,0,10,"RangeVersionHistoryHighlightView.SelectView sheetRangeToColorMap doesn't contain entry for "+t);return}if(!(t in this.f)){Diag.a.a(41976976,0,10,"RangeVersionHistoryHighlightView.SelectView sheetRangeToDivMap doesn't contain entry for "+t);return}var s=this.e[t],i=_Ewa.R.a(s,null),f=this.f[t];for(r in f)e={key:r,value:f[r]},o=e.value,o.style.backgroundColor=String.format("rgba({0},{1},{2},{3})",i.c,i.b,i.a,"0.6");_Ewa.b.a(this.g).a().b().b(null,!0);_Ewa.b.a(this.g).cs(n,60,!0,_Ewa.H.bc)},a:function(n){var o=new _Ewa.dc(_Ewa.h.b(n),_Ewa.C.b(this.g.e().b(n.SheetName))),t=Microsoft.Office.Excel.WebUI.Client.VersionHistory.VersionHistoryHighlightManager.a(o),r,f,e;if(!(t in this.f)){Diag.a.a(41976978,0,10,"RangeVersionHistoryHighlightView.DeSelectView sheetRangeToDivMap doesn't contain entry for "+t);return}if(!(t in this.e)){Diag.a.a(42068037,0,10,"RangeVersionHistoryHighlightView.DeselectView sheetRangeToColorMap doesn't contain entry for "+t);return}var s=this.e[t],i=_Ewa.R.a(s,null),u=this.f[t];for(r in u)f={key:r,value:u[r]},e=f.value,e.style.backgroundColor=String.format("rgba({0},{1},{2},{3})",i.c,i.b,i.a,this.h)},m:function(){var n=this;this.i().d(this.l,[Microsoft.Office.Excel.WebUI.Client.VersionHistory.b.a],!1,function(t,i){var o,r,f,u,e;if(!t||!t.b||!t.i||!i){Diag.a.b(41244696,0,!!t,"RangeVersionHistoryHighlightView.AddSheetRangeList: state is null");Diag.a.b(41244697,0,!t||!!t.b,"RangeVersionHistoryHighlightView.AddSheetRangeList: state.Range is null");Diag.a.b(41244698,0,!t||!!t.i,"RangeVersionHistoryHighlightView.AddSheetRangeList: state.SheetId is null");Diag.a.b(41244699,0,!!i,"RangeVersionHistoryHighlightView.AddSheetRangeList: div is null");return}if(o=new _Ewa.dc(t.b,t.i),r=Microsoft.Office.Excel.WebUI.Client.VersionHistory.VersionHistoryHighlightManager.a(o),r in n.f||(n.f[r]={}),n.f[r][t.d.toString()]=i,!(r in n.e)){Diag.a.a(41976980,0,10,"RangeVersionHistoryHighlightView.InitializeSheetRangeList sheetRangeToColorMap doesn't contain entry for "+r);return}f=n.e[r];u=_Ewa.R.a(f,null);i.style.borderColor=f;i.style.backgroundColor=String.format("rgba({0},{1},{2},{3})",u.c,u.b,u.a,n.h);e=document.createElement("div");e.className="ewa-vhr-rectinnerborder";i.appendChild(e)},!0)}};Microsoft.Office.Excel.WebUI.Client.VersionHistory.RestoreResult=function(){};Microsoft.Office.Excel.WebUI.Client.VersionHistory.RestoreResult.prototype={Success:!1,Output:null};Microsoft.Office.Excel.WebUI.Client.VersionHistory.j=function(n,t,i,r,u){this.y=Function.createDelegate(this,this.C);this.z=Function.createDelegate(this,this.D);Microsoft.Office.Excel.WebUI.Client.VersionHistory.j.initializeBase(this,[n,t]);this.s=i;this.x=r;this.w=u};Microsoft.Office.Excel.WebUI.Client.VersionHistory.j.prototype={r:null,s:null,u:0,x:null,w:null,j:function(n){return this.r=n,this.u=3,this.B(),1},B:function(){var u=this.r.a().RVAqs,f=this.r.a().RVAvi,t={},i,n,r;t["Content-Type"]="application/json; charset=utf-8";i=String.format("{0}{1}",this.w,"restoreversion.ashx");n={};n.VersionId=f;n.QuerySignature=u;r=JSON.stringify(n);this.x.a(i,2,r,t,!1,2,this.z,this.y,null,null,!1,null,null,null,null,!1,null,!1,null)},D:function(n){var t,r,u,i;(u=this.E(n,r={val:t}),t=r.val,u)?t.Success?(Common.P.b(2138207060,!0,"",0,0,0,null),Diag.a.a(42287318,0,15,"RestoreVersionActivity:onRestoreSuccessCallback Restore version is successful")):(Common.P.b(2138207060,!1,"",0,0,0,null),Diag.a.a(42287317,0,10,"RestoreVersionActivity:onRestoreSuccessCallback Restore version failed with message {0}",t.Output),this.q=this.s):(Common.P.b(2138207060,!1,"",0,0,0,null),this.q=this.s);i=this.r.a().RVlvrt;i&&i();this.n();this.r.e()},C:function(){if(this.u>0){Diag.a.a(42287319,0,15,"RestoreVersionActivity:onRestoreFailureCallback Retrying version restore, retry count : {0}",this.u);this.u--;this.B();return}Diag.a.a(42287320,0,10,"RestoreVersionActivity:onRestoreFailureCallback Restore version failed");Common.P.b(2138207060,!1,"",0,0,0,null);this.q=this.s;var n=this.r.a().RVlvrt;n&&n();this.n();this.r.e()},E:function(n,t){t.val=null;var i=n?n.b?n.b.b:null:null;return!i||!i.length?(Diag.a.a(42287321,0,10,"RestoreVersionActivity:TryGetRestoreResult data returned from restoreversion call is null or empty"),!1):Common.bA.a(i,t)?!0:(Diag.a.a(42287322,0,10,"RestoreVersionActivity:TryGetRestoreResult Failed in deserialization of returned data from restore version"),!1)}};Microsoft.Office.Excel.WebUI.Client.VersionHistory.c=function(n,t,i){Microsoft.Office.Excel.WebUI.Client.VersionHistory.c.initializeBase(this);this.h=n;this.m=t;this.n=i;this.l()};Microsoft.Office.Excel.WebUI.Client.VersionHistory.c.a=function(n){n.b().b(_Ewa.bgS.$$(_Ewa.ev),320,new Microsoft.Office.Excel.WebUI.Client.VersionHistory.c("cw72","cw30","cw73"))};Microsoft.Office.Excel.WebUI.Client.VersionHistory.c.prototype={h:null,m:null,n:null,b:function(){this.k(new Microsoft.Office.Excel.WebUI.Client.VersionHistory.j(this.h,this.m,this.n,Common.a.e,Common.a.b().a().n()))}};Microsoft.Office.Excel.WebUI.Client.VersionHistory.k=function(n,t){Microsoft.Office.Excel.WebUI.Client.VersionHistory.k.initializeBase(this,[n,t])};Microsoft.Office.Excel.WebUI.Client.VersionHistory.k.prototype={j:function(n){var t=n.a().RVEAssea,i=this;return t(function(){i.n();n.e()}),1}};Microsoft.Office.Excel.WebUI.Client.VersionHistory.d=function(n,t){Microsoft.Office.Excel.WebUI.Client.VersionHistory.d.initializeBase(this);this.h=n;this.m=t;this.l()};Microsoft.Office.Excel.WebUI.Client.VersionHistory.d.a=function(n){n.b().b(_Ewa.bgS.$$(_Ewa.ev),321,new Microsoft.Office.Excel.WebUI.Client.VersionHistory.d("cw73","cw30"))};Microsoft.Office.Excel.WebUI.Client.VersionHistory.d.prototype={h:null,m:null,b:function(){this.k(new Microsoft.Office.Excel.WebUI.Client.VersionHistory.k(this.h,this.m))}};Microsoft.Office.Excel.WebUI.Client.VersionHistory.m=function(n,t){this.a=n;this.b=t};Microsoft.Office.Excel.WebUI.Client.VersionHistory.m.prototype={a:null,b:null,y:function(){return Common.a.a.a("IsAnonymousUser")?(Diag.a.a(42813647,0,15,"Verison History Command Handler: Anonymous user."),!0):!1},w:function(n,t){Diag.a.a(41739618,0,50,"VersionHistoryCommandHandler:ExecuteCommand called.");var i=!1;switch(t.a){case-1112508866:i=this.b.bi()}return Diag.a.a(41739619,0,50,"VersionHistoryCommandHandler:ExecuteCommand response{0}.",i),i?$$sc.a.a(Boolean,i):_Ewa.V.a(t.a)},v:function(n,t){return t.a===-1112508866&&this.a.bT()},x:function(){return!1}};Microsoft.Office.Excel.WebUI.Client.VersionHistory.e=function(n){Microsoft.Office.Excel.WebUI.Client.VersionHistory.e.initializeBase(this,[n])};Microsoft.Office.Excel.WebUI.Client.VersionHistory.e.a=function(n){_Ewa.bg.a(304,new Microsoft.Office.Excel.WebUI.Client.VersionHistory.e(n))};Microsoft.Office.Excel.WebUI.Client.VersionHistory.e.prototype={m:function(){var i=this.p(),t=_Ewa.n.b(Common.Q,this.h.b(),21,137,this.j,null),n=this;_Ewa.g.a(_Ewa.g.b([i,t],this.i(),3),function(){var u=t.a(),i=Common.l.h(n.h.f().VersionHistoryActionUrl),r;i!=="*"&&u.f(i);r=new Microsoft.Office.Excel.WebUI.Client.VersionHistory.a(n.h);n.n([new Microsoft.Office.Excel.WebUI.Client.VersionHistory.m(n.h,r)],null)},this.i(),3,null,null)},p:function(){var t=this,i=this,n=_Ewa.n.f(Common.bn,this.h.b(),283,284,this.j,null).then(function(n){return n.a().loadScript("excelVersionHistory")},function(n){return Diag.a.a(41239234,0,10,"versionHistoryManagerFactory: Dynamic Script Loading failed due to exception. {0}",n),Promise.reject(n)});return $$sc.h.a(Object,n)}};Microsoft.Office.Excel.WebUI.Client.VersionHistory.l=function(n,t,i){this.b=n;this.a=t;this.c=i};Microsoft.Office.Excel.WebUI.Client.VersionHistory.l.prototype={b:0,a:null,c:null};Microsoft.Office.Excel.WebUI.Client.VersionHistory.VersionHistoryHighlightManager=function(n,t,i,r){if(this.A=Function.createDelegate(this,this.J),this.C=Function.createDelegate(this,this.bc),this.D=Function.createDelegate(this,this.bd),this.B=Function.createDelegate(this,this.K),this.n=Function.createDelegate(this,this.U),this.u=Function.createDelegate(this,this.Z),this.t=Function.createDelegate(this,this.Y),this.v=Function.createDelegate(this,this.ba),this.j=-1,this.f=-1,Diag.a.a(41743366,0,50,"VersionHistoryHighlightManager::Constructor."),this.a=n,this.k=r,this.d=_Ewa.b.a(this.a),this.d.a().j(this.v),this.d.L(this.t),this.d.g().d(this.u),this.be(),t&&(this.s=n.n().a("UserAction","VersionHistoryDiffManagerStopWatch"),this.z()),this.b=i,this.b){var u=Common.l.h(this.a.f().VersionHistoryActionUrl)||"*";u!=="*"&&this.b.f(u);this.b.c("IterateNext");this.b.c("IteratePrevious");this.b.c("ToggleShowChanges");this.b.b("IterateNext",this.n);this.b.b("IteratePrevious",this.n);this.b.b("ToggleShowChanges",this.n)}};Microsoft.Office.Excel.WebUI.Client.VersionHistory.VersionHistoryHighlightManager.a=function(n){return String.format("{0}{1}",n.a,n.b)};Microsoft.Office.Excel.WebUI.Client.VersionHistory.VersionHistoryHighlightManager.prototype={g:null,e:null,h:null,a:null,d:null,q:!1,y:0,o:0,i:100,s:null,w:"0.4",x:"#696969",b:null,k:null,l:function(){return this.j===-1?null:this.c()[this.j]},c:function(){return this.q||(this.g.sort(this.B),this.q=!0),this.g},dispose:function(){(this.G(),this.e=null,this.g=null,this.d)&&(this.d.a()&&this.d.a().k(this.v),this.d.M(this.t),this.d.g()&&this.d.g().c(this.u),this.b&&(this.b.e("IteratePrevious"),this.b.e("IterateNext"),this.b.e("ToggleShowChanges")))},T:function(n,t){if(!n){Diag.a.b(40944519,0,!1,"VersionHistoryHighlightManager.Initialize - userActivityList was Null");return}this.G();this.j=-1;this.g=[];this.q=!1;this.e={};this.h={};this.X(t);this.N(n)},z:function(){Diag.a.a(41743367,0,50,"VersionHistoryHighlightManager: TryFetchUserActivityandTriggerDiff triggered: {0} --{1}",this.o.toString(),this.i.toString());this.o++;var n=this,t=function(t,i){return Microsoft.Office.Excel.WebUI.Client.VersionHistory.o.a(n.a.d().a(),_Ewa.p.a(t,n.D),_Ewa.p.b(i,n.C),null,null)};this.a.g().a(new _Ewa.be(537,0,t,16,null),null)},bd:function(n){var t=_Ewa.O.a(n)?null:n.Result,i,r;if(!t){this.i=this.i*2;i=this;$$sc.a.b(this.i).CW(function(){i.z()});Diag.a.a(41743368,0,10,"VersionHistoryHighlightManager::OnWebMethodSuccess call returned null result.");return}t.OperationWaitingForFileDownload?this.o<20?(this.i=this.i*2,r=this,$$sc.a.b(this.i).CW(function(){r.z()})):(this.r(),Diag.a.a(41743371,0,50,"VersionHistoryHighlightManager::OnWebMethodSuccess Next Operation enqueue failed")):t.ActivityList?(this.T(t.ActivityList,t.VersionAuthors),_Ewa.c.a("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")?this.bb():this.I(!0),this.s.a(),Diag.a.a(41743369,0,50,"VersionHistoryHighlightManager: Time taken For showing diffs in Ms:{0}",this.s.b().toString())):(this.r(),Diag.a.a(41743370,0,50,"VersionHistoryHighlightManager::OnWebMethodSuccess no activity list found."))},bc:function(){this.r();Diag.a.a(41743372,0,10,"VersionHistoryHighlightManager::OnWebMethodFailure service call failed.")},I:function(n){var u=this.e,t,i,r;for(t in u){if(i={key:t,value:u[t]},r=i.value,!r){Diag.a.b(41244700,0,!1,"VersionHistoryHighlightManager.ShowOrHideAllHighlights -"+i.key+"view was Null");continue}r.d(n)}},G:function(){var r=this.e,n,t,i;for(n in r){if(t={key:n,value:r[n]},i=t.value,!i){Diag.a.b(41244701,0,!1,"VersionHistoryHighlightManager.RemoveAllHighlights -"+t.key+"view was Null");continue}i.b()}this.e=null;this.g=null},H:function(n){var t,i,r,u,f,s=(f=this.Q(n,this.j,r={val:i},u={val:t}),i=r.val,t=u.val,f),e,o;if(s){if(Diag.a.b(41976982,0,!!t,"VersionHistoryHighlightManager.SelectNextOrPreviousChange - userActivityLocation is null"),this.p(),!(t.b.toString()in this.e)){Diag.a.b(41976983,0,!1,String.format("VersionHistoryHighlightManager.SelectNextOrPreviousChange - {0} view not present in views dictionary",t.b.toString()));return}e=this.e[t.b.toString()];e.c(t.a);o=_Ewa.h.b(t.a);this.k.b(!1);this.k.b(!0);this.k.a(String.format(_Ewa.ClientStringManager.a().c(110),i+1,this.c().length,o.B(!1),t.c.DisplayName));this.j=i}},U:function(n){Diag.a.a(50405838,0,50,"VersionHistoryHighlightManager.IterateMessageHandler called with MessageID:{0}",n.MessageId);switch(n.MessageId){case"IterateNext":this.V();this.f=(this.f+1)%this.c().length;this.m("SetCurrentChangeCount",this.f+1);break;case"IteratePrevious":this.W();this.f=this.f<0?0:this.f;this.f=(this.f+this.c().length-1)%this.c().length;this.m("SetCurrentChangeCount",this.f+1);break;case"ToggleShowChanges":var t=n.Values.ToggleValue;this.I(t)}},m:function(n,t){var i,r;if(!this.a.a(407)){Diag.a.a(50469003,0,50,"VersionHistoryHighlightManager.SendIteratorTextUpdateMessage VersionHistoryIterator BRS is turned off");return}if(!this.b){Diag.a.a(50469004,0,10,"VersionHistoryHighlightManager.SendIteratorTextUpdateMessage hostPostmessenger is null");return}i={};i.count=t;r=new Common.cB(n);r.Values=i;this.b.g(r,null)},Q:function(n,t,i,r){var u=!1,f,e;for(i.val=t,r.val=null,f=0;!u&&f<this.c().length;){if(i.val=n?this.P(i.val):this.R(i.val),r.val=this.c()[i.val],e=$$as(_Ewa.N,this.a.e().b(r.val.a.SheetName)),!e)return Diag.a.b(41980624,0,!1,String.format("VersionHistoryHighlightManager.GetNextorPreviousUserActivityLocationFromIndex - useractivitylocation contains sheetrange with null sheet")),!1;e.R||(u=!0);f++}return u},P:function(n){return n===-1?this.F():(n+1)%this.c().length},R:function(n){var t=n;return t===-1&&(t=this.F()),(t+this.c().length-1)%this.c().length},N:function(n){this.M(n);this.L()},S:function(n,t){var r=[],i,e;if(!n.RangeList)return Diag.a.b(41976984,0,!1,"VersionHistoryHighlightManager.GetUserActivityLocationFromRangeActivityLocation - ActivityLocationType.Range RangeList Null "),r;for(var f=n.RangeList,o=f.length,u=0;u<o;++u){if(i=f[u],!i||!this.a.e().f(i.SheetName)){Diag.a.b(41976985,0,!1,("VersionHistoryHighlightManager.GetUserActivityLocationFromRangeActivityLocation - "+i)?" Inavlid sheet name"+i.SheetName:"Null Sheet Range");continue}e=new Microsoft.Office.Excel.WebUI.Client.VersionHistory.l(0,i,t);r.push(e)}return r},M:function(n){for(var t,i,o,s,f=n,h=f.length,r=0;r<h;++r){if(t=f[r],!t||_Ewa.bx.a(t.LocationList)){Diag.a.a(41244702,0,50,("VersionHistoryHighlightManager.CreateUserActivityLocationList - "+t)?"Empty Location list":"Null user activity");continue}for(var e=t.LocationList,c=e.length,u=0;u<c;++u){if(i=e[u],!i){Diag.a.b(41244703,0,!1,"VersionHistoryHighlightManager.CreateUserActivityLocationList - LocationList contains Null");continue}switch(i.Type){case 0:o=i;(s=this.g).push.apply(s,this.S(o,t.Person));break;default:Diag.a.a(41244704,0,50,"VersionHistoryHighlightManager.CreateViews Failed. Invalid ActivityLocationType")}}}},L:function(){for(var n,f,e,s,i={},r=new($$sc.u.$$(_Ewa.Cs)),t=[],o=this.g,h=o.length,u=0;u<h;++u)(n=o[u],r.c(n.c)||r.b(n.c),n.b)||(f=new _Ewa.dc(_Ewa.h.b(n.a),_Ewa.C.b(this.a.e().b(n.a.SheetName))),e=Microsoft.Office.Excel.WebUI.Client.VersionHistory.VersionHistoryHighlightManager.a(f),e in i||t.push(f),i[e]=this.O(n.c));Diag.a.a(42541534,0,15,"VersionHistoryHighlightManager.CreateRangeHighlightView. Total activities : {0}, Highlightable activities: {1},Total userlist in activities : {0}, Total userlist from pane: {1} ",this.g.length,t.length,r.f.length,this.y);this.r();t.length>0&&(s=new Microsoft.Office.Excel.WebUI.Client.VersionHistory.b(this.a,t,i,this.w),this.e["0"]=s)},r:function(){var n=this.g?this.c().length:0;this.m("SetCurrentChangeCount",0);this.m("SetTotalChangesCount",n)},bb:function(){this.m("OnVHDiffReady",0)},X:function(n){var t,f;if(!n){Diag.a.a(42550406,0,15,"VersionHistoryHighlightManager.MapAuthorColorInfo: versionAuthors is null");return}var i=null,r=null,u=null;for(this.y=n.length,t=0;t<n.length;++t)r=n[t].EmailAddress,u=n[t].UserName,i=null,n[t].LoginName&&(f=n[t].LoginName.split("|"),f.length===3&&(i=f[2])),i?this.h[i]=n[t].InitialsColor:r?(Diag.a.a(42341888,0,15,String.format("VersionHistoryHighlightManager Map Author Color: LoginName is null")),this.h[r]=n[t].InitialsColor):u?(Diag.a.a(42341889,0,15,String.format("VersionHistoryHighlightManager Map Author Color: Email Address is null")),this.h[u]=n[t].InitialsColor):Diag.a.a(42341890,0,10,String.format("VersionHistoryHighlightManager Map Author Color: User name is null"))},be:function(){var i,t;if(_Ewa.f.a(this.a.f().VersionHistoryHighlightsSettings)){Diag.a.a(42504652,0,15,String.format("VersionHistoryHighlightManager.UpdateHighlightSettings Highlight Settings are null"));return}for(i=$$as(Array,Sys.Serialization.JavaScriptSerializer.deserialize(this.a.f().VersionHistoryHighlightsSettings)),t=0;t<i.length;t++){var n=i[t],r=n.key?n.key:n.Key?n.Key:"",u=n.value?n.value:n.Value?n.Value:"";r==="DefaultColor"?this.x=u:r==="InitialTint"?this.w=u:Diag.a.a(42504653,0,15,String.format("VersionHistoryHighlightManager.UpdateHighlightSettings Highlight Settings are incorrect"))}},O:function(n){return n.Email in this.h?this.h[n.Email]:n.DisplayName in this.h?this.h[n.DisplayName]:(Diag.a.a(42271374,0,15,String.format("VersionHistoryHighlightManager GetColorFromPerson - unable to associate corresponding author in dictionary")),this.x)},K:function(n,t){var i=n.a,r=t.a;return this.E(i,r)},J:function(n,t){var i=n.a,r=t;return this.E(i,r)},E:function(n,t){var r=$$as(_Ewa.N,this.a.e().b(n.SheetName)),u=$$as(_Ewa.N,this.a.e().b(t.SheetName)),i;return!r||!u?(Diag.a.a(41976986,0,10,"VersionHistoryHighlightManager.CompareSharedSheetRange - null sheet"),0):(i=_Ewa.i.h(r.V,u.V),i=i?i:_Ewa.i.h(n.FirstRow,t.FirstRow),i?i:_Ewa.i.h(n.FirstColumn,t.FirstColumn))},F:function(){var i=this.d.a().a().e(),r=this.a.e().a(),t=_Ewa.h.p(i,r),n;return t?(n=_Ewa.i.f(new _Ewa.dn(this.c()),0,this.c().length,t,this.A),n<0&&(n=~n),n%this.c().length):(Diag.a.a(41976988,0,10,"VersionHistoryHighlightManager.GetNearestLocationIndexFromCurrentSelection - SelectedSharedSheetRange is null "),0)},p:function(){if(this.l()){if(!(this.l().b.toString()in this.e)){Diag.a.b(41976989,0,!1,String.format("VersionHistoryHighlightManager.DeselectCurrentlySelectedView - {0} view not present in views dictionary",this.l().b.toString()));return}var n=this.e[this.l().b.toString()];n.a(this.l().a)}this.j=-1},ba:function(){this.p()},Y:function(){this.p()},Z:function(){this.p()},V:function(){this.H(!0)},W:function(){this.H(!1)}};Microsoft.Office.Excel.WebUI.Client.VersionHistory.f=function(n){Microsoft.Office.Excel.WebUI.Client.VersionHistory.f.initializeBase(this);this.h=n;this.l()};Microsoft.Office.Excel.WebUI.Client.VersionHistory.f.a=function(n){n.b().b(_Ewa.bgS.$$(_Ewa.nh),306,new Microsoft.Office.Excel.WebUI.Client.VersionHistory.f(n))};Microsoft.Office.Excel.WebUI.Client.VersionHistory.f.prototype={h:null,b:function(){var t=_Ewa.n.b(_Ewa.cu,this.h.b(),211,212,this.j,null),i=_Ewa.n.b(Common.Q,this.h.b(),21,137,this.j,null),n=this;_Ewa.g.a(_Ewa.g.b([t,i],this.h.i(),3),function(){n.k(n.h.b().a(_Ewa.nh,305,!1,null)||new Microsoft.Office.Excel.WebUI.Client.VersionHistory.VersionHistoryHighlightManager(n.h,!0,i.a(),t.a()))},this.h.i(),3,null,null)}};Microsoft.Office.Excel.WebUI.Client.VersionHistory.n=function(n,t){Microsoft.Office.Excel.WebUI.Client.VersionHistory.n.initializeBase(this,[n,t,null]);t!=="*"&&this.f(t);this.n("IterateNext");this.n("IteratePrevious");this.x("Wac_AppCompleted");this.x("Wac_AppFailed")};Microsoft.Office.Excel.WebUI.Client.VersionHistory.a=function(n){this.j=Function.createDelegate(this,this.bc);this.t=Function.createDelegate(this,this.R);this.z=Function.createDelegate(this,this.X);this.w=Function.createDelegate(this,this.U);this.A=Function.createDelegate(this,this.Y);this.v=Function.createDelegate(this,this.T);this.B=Function.createDelegate(this,this.M);this.y=Function.createDelegate(this,this.W);this.x=Function.createDelegate(this,this.V);this.u=Function.createDelegate(this,this.S);this.C=Function.createDelegate(this,this.Z);this.D=Function.createDelegate(this,this.ba);this.a=n;this.k=this.a.m()+"_excelVersionHistoryOverlay";this.o=!1;this.a.a(496)&&this.P();this.i="";this.n=0;this.h=[]};Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.a=function(n){if(!n)return"";return n.RevisionID?n.RevisionID:n.revisionID?n.revisionID:""};Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.b=function(n){if(!n)return"";return n.DownloadUrl?n.DownloadUrl:n.downloadUrl?n.downloadUrl:""};Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.prototype={a:null,k:null,l:null,m:null,b:null,g:null,f:null,e:null,G:!1,o:!1,p:!1,E:!0,r:null,q:null,s:null,d:null,h:null,F:null,i:null,n:null,c:null,J:null,dispose:function(){this.L()},bb:function(){var n=this;this.a.b().c(_Ewa.ge,15,function(t){n.m=t;n.m.a(2)},null)},P:function(){this.r=new Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.d(this);this.q=new Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.c(this);this.s=new Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.e(this)},bi:function(){if(Diag.a.a(41739649,0,15,"VersionHistoryPaneActor:ShowVersionHistoryDialogAction called"),Common.a.q("Microsoft.Office.Excel.Server.Flighting.IDenyListExcelVersionHistoryEnableODCSaveACopy"),Common.a.q("Microsoft.Office.Excel.Server.Flighting.IDenyListExcelVersionHistoryShowEvents"),Common.a.q("Microsoft.Office.Excel.Server.Flighting.IDenyListOneDriveConsumerSharedVersionHistory"),Common.a.q("Microsoft.Office.Excel.Server.Flighting.IDenyListVersionHistorySaveACopyOverFlowMenu"),Common.a.q("Microsoft.Office.Excel.Server.Flighting.IDenyListVersionHistoryLoadBlankOnOpen"),Common.a.q("Microsoft.Office.Excel.Server.Flighting.IDenyListExcelVersionHistoryRestoreSkipCoauthCheck"),Common.a.q("Microsoft.Office.Excel.Server.Flighting.IDenyListExcelVersionHistorySPODownloadEnabled"),this.d=excelVersionHistory.FactoryGlobal.getTelemetryCollector(),this.h=[],this.d.startTimer("TimeTakenShowVersionHistoryDialogAction"),!this.b){var n=this;if(Common.cW.a(function(){var t,i;n.b=versionHistory.FactoryGlobal.getVersionHistoryControllerInstance((i=new Common.App.VersionHistory.b,i.ulsLogger=new UlsExternalLogger,i.docId=Common.a.i,i.appSettings=(t=new Common.App.VersionHistory.a,t.appName=120,t.userSessionId=Common.a.j,t.wdEnableSaveACopy=n.a.a(462),t.wdEnableDownloadTokens=n.a.a(454),t.wacCluster=Common.a.e.c(),t.uiLocale=Common.a.D?Common.a.D:"en-us",t.wdEnableRestore=n.a.a(409)&&n.a.k(),t.wdEnableIterator=n.a.a(406)&&n.a.a(407),t.useXhr=Common.c.l(),t.wdEnableHiddenButtonsUntilVersionLoadComplete=n.a.a(562),t.disableSaveACopy=n.N(),t.wdEnableShowVersionChanges=n.a.a(406)&&n.a.a(408),t.wdEnableCompareVersionsByGroup=!0,t.wdEnableShowVersionEvents=n.a.a(669),t.disabledChangeGates=n.a.f().VHSDisabledChangeGates,t.wdEnableSaveACopyOverFlowMenu=n.a.a(789),t.isRtl=Common.a.h,t.wdLoadBlankVersionOnOpen=n.a.a(795),t.wdEnableDownloadVersion=n.a.a(885)||n.a.A().a(51),t),i.perfTelemetryInfos=n.h,i))}),!this.b)return Diag.a.a(41239235,0,10,"VersionHistoryPaneActor:ShowVersionHistoryDialogAction - VersionHistoryController should not be null"),Common.P.b(429638140,!1,"",0,0,0,null),!1}return this.bj(),this.d.endTimer("TimeTakenShowVersionHistoryDialogAction"),this.d.startTimer("TimeTillVersionHistoryDialogWasOpenMs"),Diag.a.a(41739650,0,50,"VersionHistoryPaneActor:ShowVersionHistoryDialogAction Returned Success"),Common.P.b(429638140,!0,"",0,0,0,null),!0},bj:function(){if(this.bd(),!document.getElementById(this.k)){var n=document.createElement("div");n.id=this.k;n.style.width="100%";n.style.height="100%";n.style.zIndex=998;n.style.display="block";n.style.position="absolute";this.a.be().insertBefore(n,this.a.be().firstChild);this.l=this.b.createVersionHistoryDialog(n)}document.getElementById(this.k).style.display="block";this.be();this.d.startTimer("TimeTakenGetVersionsToOnVersionsReady");this.b.getVersions("")},be:function(){this.a.a(496)&&(this.r.b(),this.q.b(),this.s.b(),this.bb())},bl:function(){this.a.a(496)&&(this.r.c(),this.q.c(),this.s.c(),this.m&&this.m.a(0))},bd:function(){this.b.getVersionsReadyEvent().addListener(this.D);this.b.getVersionSelectedEvent().addListener(this.C);this.b.getCloseSelectedEvent().addListener(this.u);this.b.getFullAppErrorEvent().addListener(this.x);this.b.getIteratorSelectedEvent().addListener(this.y);this.b.getShowVersionChangesToggledEvent().addListener(this.B);this.a.a(454)&&(this.b.getDownloadTokenReadyEvent().addListener(this.v),this.o=!0);this.a.a(462)&&(this.b.getSaveACopySelectedEvent().addListener(this.A),this.b.getDownloadVersionSelectedEvent().addListener(this.w));this.a.a(409)&&this.a.k()&&(this.b.getRestoreVersionSelectedEvent().addListener(this.z),this.p=!0);this.g&&this.g.getAppErrorEvent().addListener(this.t)},bk:function(){this.b.getVersionsReadyEvent().removeListener(this.D);this.b.getVersionSelectedEvent().removeListener(this.C);this.b.getCloseSelectedEvent().removeListener(this.u);this.b.getFullAppErrorEvent().removeListener(this.x);this.b.getIteratorSelectedEvent().removeListener(this.y);this.b.getShowVersionChangesToggledEvent().removeListener(this.B);this.a.a(462)&&(this.b.getSaveACopySelectedEvent().removeListener(this.A),this.b.getDownloadVersionSelectedEvent().removeListener(this.w));this.o&&(this.b.getDownloadTokenReadyEvent().removeListener(this.v),this.o=!1);this.p&&(this.b.getRestoreVersionSelectedEvent().removeListener(this.z),this.p=!1);this.g&&this.g.getAppErrorEvent().removeListener(this.t)},bg:function(){var n=!0,t;return this.a.a(919)&&!this.a.bm()?(Diag.a.a(579631304,0,15,"VersionHistoryPaneActor:ShouldTriggerRestore - Skipping coauth check with status "+this.a.c().G().toString()),!0):(this.a.c().G()||this.a.a(405)||(this.Q(),this.b.setCoauthRestoreError(),n=!1,t=new _Ewa.L(-729359593,0,this.a.s(),0,null),this.a.h().a(t,null,null)),this.a.bm()&&(Diag.a.a(42522439,0,10,"VersionHistoryPaneActor:ShouldTriggerRestore - Restore failed, Unsaved changes present"),n&&(n=!1,this.bh())),n)},X:function(n){var i,r,t,u,f,e;if(Diag.a.a(42553885,0,50,"VersionHistoryPaneActor:OnRestoreVersionSelected - Restore is triggered"),!this.bg()){Common.P.b(2138207060,!1,"",0,0,0,null);return}i=this;r=function(n){Common.P.b(2138207060,!1,"",0,0,0,null);i.b.setRestoreFailedAtServer(n)};this.d&&this.d.startTimer("TimeTakenVersionRestore");t=this;u=function(){t.d.endTimer("TimeTakenVersionRestore");t.K(t.d)};this.b.setRestoreInProgress();f=this;e=function(){var t=_Ewa.T.a(f.a).a().a();t.PUOAudna="cw74";t.CWMfsc=!0;t.CWMsbc=0;t.RVAvi=n;t.RVAqs=Common.a.i;t.RVlvrt=u;t.RVEAssea=r};_Ewa.x.a(this.a).b(new _Ewa.cL("cw8",5,e))},bh:function(){var t=_Ewa.j.b(1,0,1712,1711,0,-1603358883,"RestoreVersionUnsavedChangesError"),n=this.J||new _Ewa.dw(this.a,t);n.G();n.z(!1)},ba:function(n){var t=this;this.l.then(function(n){return n.enterFocusTrapZone(),null});Diag.a.a(41739651,0,50,"VersionHistoryPaneActor: OnVersionsReady called");this.d.endTimer("TimeTakenGetVersionsToOnVersionsReady");this.d.incrementCounter("CountOnVersionsReadyCalledinOneVHSession");Diag.a.a(41739652,0,50,"VersionHistoryPaneActor: OnVersionsReady TimeTakenGetVersionsToOnVersionsReady Ms:{0}",this.d.getTimerDuration("TimeTakenGetVersionsToOnVersionsReady"));this.bf(n.containerDiv);n.versions&&n.versions.length>0&&(this.F=Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.a(n.versions[n.versions.length-1]));this.f&&this.g&&this.H(this.f,this.e);Diag.a.a(41739654,0,50,"VersionHistoryPaneActor:OnVersionsReady Exit")},Z:function(n){(Diag.a.a(41739655,0,50,"VersionHistoryPaneActor:OnVersionSelected called. for Version:{0}, LastSelected:{1}",Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.a(n.currentVersion),Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.a(this.f)),this.d.incrementCounter("CountOnVersionSelectedCalledinOneVHSession"),this.f=n.currentVersion,this.e=n.baseVersion,this.G=n.noBaseToCompareTo,this.g)&&this.bm()&&(this.H(n.currentVersion,n.baseVersion),Diag.a.a(41739657,0,50,"VersionHistoryPaneActor:OnVersionSelected Exit"))},bm:function(){if(Diag.a.a(42472802,0,50,"VersionHistoryPaneActor:ValidateDiffDiffParameters called for BaseVersion{0}",this.e?Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.a(this.e):""),Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.a(this.f)===this.F)return Diag.a.a(42472832,0,15,"VersionHistoryPaneActor:ValidateDiffDiffParameters for last version"),!0;if(_Ewa.c.a("OfficeVSO:4381797_XLVHSkipBaseVersionValidateForGroupingUI")&&!this.e&&this.G)return Diag.a.a(588862345,0,50,"VersionHistoryPaneActor:ValidateDiffDiffParameters skipping diff last version"),!0;if(!this.e)return Diag.a.a(42472833,0,10,"VersionHistoryPaneActor:ValidateDiffDiffParameters for null BaseVersion"),!1;var n=Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.b(this.e);return(Diag.a.a(42472834,0,50,"downloadURL length {0}",n?n.length:0),!n||!n.length)?(Diag.a.a(42472835,0,50,"VersionHistoryPaneActor:ValidateDiffDiffParameters downloadURL is null"),!1):!0},T:function(n){var r,f;if(Diag.a.a(41739658,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady called. for Version:{0} UpdatedVersionsCount{1}, LastSelected:{2}",n&&n.versionSelected?Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.a(n.versionSelected.currentVersion):null,n&&n.updatedVersions?n.updatedVersions.length:0,Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.a(this.f)),this.d.incrementCounter("CountOnDownloadTokenReadyCalledinOneVHSession"),!this.e){Diag.a.a(41439557,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady baseVersionInfo is null in OnDownloadTokenReady callback.");return}if(n&&n.updatedVersions&&n.updatedVersions.length>=2){for(var t=null,i=null,e=Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.a(this.f),o=Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.a(this.e),s=n.updatedVersions,h=s.length,u=0;u<h;++u)if(r=s[u],f=Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.a(r),e===f?t=r:o===f&&(i=r),t&&i)break;t&&i?(this.f=t,this.e=i,Diag.a.a(41739659,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady -Calling versionsViewController:OnVersionSelected RevisionID[N]: {0}, RevisionID[N-1]: {1}.",Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.a(this.f),Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.a(this.e)),this.H(this.f,this.e)):Diag.a.a(41439558,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady - does not find currentVersion or baseVersion from UpdatedVersions. RevisionID[N]: {0}, RevisionID[N-1]: {1}.",e,o)}else Diag.a.a(41439559,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady - no diff call due to downloadTokenReadyObject or downloadTokenReadyObject.UpdatedVersions objects are null or not enough.");Diag.a.a(41739660,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady")},N:function(){return!this.a.ba()},S:function(){Diag.a.a(41739661,0,50,"VersionHistoryPaneActor:OnCloseVersionHistoryDialog Called");this.O();var n=new _Ewa.L(1470556788,0,this.a.s(),0,null);this.a.h().a(n,null,null)},O:function(){document.getElementById(this.k).style.display="none";var n=new _Ewa.L(-1423792966,0,this.a.s(),0,null);this.a.h().a(n,null,null);this.L()},L:function(){this.d&&(this.d.endTimer("TimeTillVersionHistoryDialogWasOpenMs"),this.K(this.d),this.d=null);this.bk();this.bl();this.h&&(Diag.a.a(42067140,0,15,this.h.toString()),this.h=null);this.c&&(this.c.e("Wac_AppCompleted"),this.c.e("Wac_AppFailed"),this.c.e("SetCurrentChangeCount"),this.c.e("SetTotalChangesCount"),_Ewa.c.a("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")&&this.c.e("OnVHDiffReady"),this.c.dispose(),this.c=null)},Y:function(n){Diag.a.a(41739662,0,50,"VersionHistoryPaneActor:OnSaveACopy Called");var t=new _Ewa.L(-1244760097,0,this.a.s(),0,null);this.a.a(713)&&this.a.A().a(51)&&(Diag.a.a(593367364,0,50,"VersionHistoryPaneActor:OnSaveACopy for ODConsumer Called"),t=new _Ewa.L(-309686558,0,this.a.s(),0,null));Common.P.b(1604651619,!0,"",0,0,0,null);this.a.h().a(t,{FileDownloadUrl:n},null)},U:function(n){var t,i;Diag.a.a(587830285,0,50,"VersionHistoryPaneActor:OnDownloadVersion Called");t=new Common.bu(n);t.a("fn",Common.a.bm);Diag.a.a(587830284,0,50,"VersionHistoryPaneActor:OnDownloadVersion URL Length is "+t.toString().length);i=this.a.r().D(!0,t.toString(),!0);i===8?(Diag.a.a(587830283,0,10,"VersionHistoryPaneActor:OnDownloadVersion failed"),Common.P.b(1316171850,!1,"",0,0,0,null)):Common.P.b(1316171850,!0,"",0,0,0,null)},R:function(n){this.b.setFullAppErrorCode(n)},bf:function(n){try{if(this.g)Common.gb.a(!1);else{Common.gb.a(!0);var t=this;Common.cW.a(function(){var i=new Microsoft.Office.Excel.WebUI.Client.VersionHistory.g,r;i.ulsLogger=new UlsExternalLogger;i.actionUrl=t.a.f().VersionHistoryActionUrl;i.hideEmbedFooter=!0;i.useFetch=t.a.a(548)&&!Common.c.h();t.g=excelVersionHistory.FactoryGlobal.getAppVersionControllerInstance((r=new Microsoft.Office.Excel.WebUI.Client.VersionHistory.h,r.appBootSettings=i,r.rootDiv=n,r))})}}catch(i){Diag.a.a(41239239,0,10,"VersionHistoryPaneActor: ResetAppVersionController failed due to exception. {0}",i)}},H:function(n){var r,t,i,u;if(Diag.a.a(42016800,0,50,"VersionHistoryPaneActor:SelectVersion called. for Version:{0}, LastSelected:{1}",Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.a(n),this.i),!n){Diag.a.a(42016801,0,50,"VersionHistoryPaneActor:SelectVersion selectedVersion is null");return}if(!Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.a(n).length){Diag.a.a(42016802,0,50,"VersionHistoryPaneActor:SelectVersion selectedVersion RevisionId is null");return}if(r=(new Date).getTime(),Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.a(n)===this.i&&r-this.n<1e3){Diag.a.a(42016803,0,50,"VersionHistoryPaneActor:SelectVersion reattempt within 1 sec");return}Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.a(n)!==this.i&&(Diag.a.a(51131787,0,50,"VersionHistoryPaneActor:Reset Iterator states if user clicks on different version"),this.b.setTotalChangesCount(-1),this.b.setCurrentChangeCount(-1));t=excelVersionHistory.FactoryGlobal.getTelemetryCollector();t.addEvent("SelectVersion",Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.a(n));try{this.bn(t);this.n=r;this.i=Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.a(n);i=new Microsoft.Office.Excel.WebUI.Client.VersionHistory.i;i.selectedVersionInfo=this.f;i.baseVersionInfo=this.e;i.telemetryCollector=t;this.g.onVersionSelectedWithParams(i);this.b&&this.a.a(462)&&this.b.setDisableSaveACopy(this.N());u=document.getElementById("vhs_frame");u&&!this.c&&(Diag.a.a(50405839,0,50,"VersionHistoryPaneActor: SelectVersion Lazy instantiate VersionHistoryMessenger"),this.c=new Microsoft.Office.Excel.WebUI.Client.VersionHistory.n(u.contentWindow,Common.l.h(this.a.f().VersionHistoryActionUrl)||"*"),this.c.b("Wac_AppCompleted",this.j),this.c.b("Wac_AppFailed",this.j),this.c.c("SetCurrentChangeCount"),this.c.c("SetTotalChangesCount"),_Ewa.c.a("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")&&this.c.c("OnVHDiffReady"),this.c.b("SetCurrentChangeCount",this.j),this.c.b("SetTotalChangesCount",this.j),_Ewa.c.a("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")&&this.c.b("OnVHDiffReady",this.j))}catch(f){this.n=0;this.i="";t.addEvent("Exception",f.toString());Diag.a.a(42016832,0,10,"VersionHistoryPaneActor: OnVersionSelected failed due to exception. {0}",f)}finally{Diag.a.a(42016833,0,50,t?t.getJsonForLogging():"");t=null}},bn:function(n){for(var r=this.h,e=r.length,i=0;i<e;++i){var t=r[i],u=t.TelemetryEventKey?t.TelemetryEventKey:t.telemetryEventKey?t.telemetryEventKey:"",f=t.TelemetryEventData?t.TelemetryEventData:t.telemetryEventData?t.telemetryEventData:"";u&&f&&n.addEvent(u,f)}Array.clear(this.h)},V:function(n){var t;switch(n){case 101:t="VHFailedToGetDownloadToken";break;case 100:t="VHFailedToLoadVersionList";break;case 104:t="VHVersioningNotEnabled";break;case 105:t="VHFileNotFound";break;case 106:t="VHVersionTooOld";break;default:t="None"}this.d.addEvent("OnFullAppError",t);Diag.a.a(42468675,0,10,"FullApp Error Event: {0}",t)},K:function(n){Diag.a.a(42553886,0,15,"VersionHistoryPaneActor:CaptureSessionTelemetry - {0} ",n?n.getJsonForLogging():"")},Q:function(){for(var n,u=this.a.c().v(),t={},i=null,f=u,e=f.length,r=0;r<e;++r)n=f[r],n.UserEmail&&(t[n.UserEmail]=n.UserEmail in t?t[n.UserEmail]+1:1),n.User.UserID===this.a.c().bK()&&(i=n.UserEmail);Diag.a.a(42522438,0,10,"VersionHistoryPaneActor:LogCoauthorsTelemetry Restore failed, TotalAuthors: {0}, TotalAuthorsAsYourself {1}",u.length,i?t[i]:-1)},M:function(n){this.E=n;Diag.a.a(51175900,0,50,"VersionHistoryPaneActor:Show Changes toggled to:{0}",n.toString());this.I("ToggleShowChanges",{ToggleValue:n})},W:function(n){Diag.a.a(50405840,0,50,"VersionHistoryPaneActor:OnIteratorSelected next: {0}",n);Common.P.b(1488635506,!0,"",0,0,0,null);var t={};n?this.I("IterateNext",t):this.I("IteratePrevious",t)},bc:function(n){var t,i;switch(n.MessageId){case"Wac_AppCompleted":Diag.a.a(50708956,0,50,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession WacAppCompleted ");this.a.a(562)&&this.b.setVersionLoadComplete();break;case"Wac_AppFailed":Diag.a.a(51128035,0,10,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession WacAppFailed");break;case"SetCurrentChangeCount":t=n.Values.count;Diag.a.a(50469005,0,50,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession SetCurrentChangeCount : {0}",t);this.b.setCurrentChangeCount(t);break;case"SetTotalChangesCount":i=n.Values.count;Diag.a.a(50469006,0,50,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession SetTotalChangesCount : {0}",i);this.b.setTotalChangesCount(i);break;case"OnVHDiffReady":this.M(this.E);break;default:Diag.a.a(51175901,0,15,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession MessageID:{0}",n.MessageId)}},I:function(n,t){var i,r,u,f;if(Diag.a.a(50405841,0,50,"VersionHistoryPaneActor.SendPostMessageToTheVHSession called with MessageID:{0}",n),!this.c){Diag.a.a(50405842,0,10,"VersionHistoryPaneActor.SendPostMessageToTheVHSession versionHistoryMessenger is null");return}if(i=new Common.cB(n),i.Values.wdUserSession=this.a.f().UserSessionId,t){r=t;for(u in r)f={key:u,value:r[u]},i.Values[f.key]=f.value}this.c.g(i,null)}};Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.d=function(n){this.a=n};Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.d.prototype={a:null,b:function(){_Ewa.bm.a(this.a.a).b("VHP")||_Ewa.bm.a(this.a.a).a(this)},c:function(){_Ewa.bm.a(this.a.a).b("VHP")&&_Ewa.bm.a(this.a.a).c(this)},bl:function(){return"VHP"},B:function(){return document.querySelector('[aria-describedby="versionHistoryPane"]')},bB:function(){return!0},dR:function(n){return _Ewa.a.f(this.B(),n)},cJ:function(){var n=this.a.a.r().Y.n;this.a.a.r().Y.b(n)},bL:function(){},K:function(n,t){if(!t){var i=this;this.a.l.then(function(n){return n.enterFocusTrapZone(),null})}return!t}};Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.c=function(n){this.a=n};Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.c.prototype={a:null,b:function(){_Ewa.bm.a(this.a.a).b("VHH")||_Ewa.bm.a(this.a.a).a(this)},c:function(){_Ewa.bm.a(this.a.a).b("VHH")&&_Ewa.bm.a(this.a.a).c(this)},bl:function(){return"VHH"},B:function(){return document.querySelector('[id="vhHeader"]')},bB:function(){return!0},dR:function(n){return _Ewa.a.f(this.B(),n)},cJ:function(){var n=this.a.a.r().Y.n;this.a.a.r().Y.b(n)},bL:function(){},K:function(n,t){if(!t){var i=this;this.a.l.then(function(n){return n.enterHeaderFocusTrapZone(),null})}return!t}};Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.e=function(n){this.a=n};Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.e.prototype={a:null,b:function(){_Ewa.bm.a(this.a.a).b("VHV")||_Ewa.bm.a(this.a.a).a(this)},c:function(){_Ewa.bm.a(this.a.a).b("VHV")&&_Ewa.bm.a(this.a.a).c(this)},bl:function(){return"VHV"},B:function(){return document.querySelector('[id="vhViewer"]')},bB:function(){return!0},dR:function(n){return _Ewa.a.f(this.B(),n)},cJ:function(){var n=this.a.a.r().Y.n;this.a.a.r().Y.b(n)},bL:function(){},K:function(n,t){if(!t){var i=this;this.a.l.then(function(n){return n.enterViewerFocusTrapZone(),null})}return!t}};Microsoft.Office.Excel.WebUI.Client.VersionHistory.o=function(){};Microsoft.Office.Excel.WebUI.Client.VersionHistory.o.a=function(n,t,i,r,u){var f=n.a(1,u);return _Ewa.l.a(n,"GetVersionHistoryHighlightActivitiesData",f,t,i,r,4,null,null)};Type.registerNamespace("Common.App.VersionHistory");Common.App.VersionHistory.i=function(){};Common.App.VersionHistory.h=function(){};Common.App.VersionHistory.h.registerInterface("Common.App.VersionHistory.h");Common.App.VersionHistory.g=function(){};Common.App.VersionHistory.f=function(){};Common.App.VersionHistory.a=function(){};Common.App.VersionHistory.a.prototype={appName:0,fileExtension:null,wdEnableDownloadTokens:!1,retryCount:0,wdEnableSaveACopy:!1,wdEnableRestore:!1,wdEnableIterator:!1,userSessionId:null,wacCluster:null,uiLocale:null,isRtl:!1,useXhr:!1,viewerRootPositionRelative:!1,wdEnableHiddenButtonsUntilVersionLoadComplete:!1,wdEnableShowVersionChanges:!1,disableSaveACopy:!1,wdEnableCompareVersionsByGroup:null,wdEnableShowVersionEvents:!1,disabledChangeGates:null,wdEnableDownloadVersion:!1,wdLoadBlankVersionOnOpen:!1,wdEnableSaveACopyOverFlowMenu:!1,wdEnableDeleteVersions:!1,wdEnableAppColorUpdate:null};Common.App.VersionHistory.j=function(){};Common.App.VersionHistory.j.prototype={telemetryEventKey:null,telemetryEventData:null};Common.App.VersionHistory.r=function(){};Common.App.VersionHistory.r.prototype={wopiDetails:null,alternateStreamDownloadUrl:null};Common.App.VersionHistory.o=function(){};Common.App.VersionHistory.o.prototype={revisionID:null,authorID:null,authors:null,time:null,downloadUrl:null,wopiInfo:null,events:null};Common.App.VersionHistory.c=function(){};Common.App.VersionHistory.c.prototype={userName:null,logOnName:null,emailAddress:null,initialsColor:null};Common.App.VersionHistory.e=function(){};Common.App.VersionHistory.e.prototype={type:0,time:null,author:null};Common.App.VersionHistory.m=function(){};Common.App.VersionHistory.m.prototype={versions:null};Common.App.VersionHistory.n=function(){};Common.App.VersionHistory.n.prototype={data:null,correlationID:null,errorCode:0,responseStatusCode:null,message:null};Common.App.VersionHistory.k=function(){};Common.App.VersionHistory.k.prototype={data:null,correlationID:null,isDirty:!1,errorCode:null,responseStatusCode:null,message:null};Common.App.VersionHistory.b=function(){};Common.App.VersionHistory.b.prototype={ulsLogger:null,serviceBase:null,latestStreamServiceBase:null,docId:null,appSettings:null,perfTelemetryInfos:null};Common.App.VersionHistory.p=function(){};Common.App.VersionHistory.p.prototype={currentVersion:null,baseVersion:null,correlationID:null,groupName:null,noBaseToCompareTo:!1};Common.App.VersionHistory.q=function(){};Common.App.VersionHistory.q.prototype={versions:null,containerDiv:null,correlationID:null};Common.App.VersionHistory.d=function(){};Common.App.VersionHistory.d.prototype={updatedVersions:null,versionSelected:null};Common.App.VersionHistory.l=function(){};Common.App.VersionHistory.l.prototype={tipVersion:null,updatedVersions:null,containerDiv:null,correlationID:null};Microsoft.Office.Excel.WebUI.Client.VersionHistory.b.registerClass("Microsoft.Office.Excel.WebUI.Client.VersionHistory.b",null,Microsoft.Office.Excel.WebUI.Client.VersionHistory.s);Microsoft.Office.Excel.WebUI.Client.VersionHistory.RestoreResult.registerClass("Microsoft.Office.Excel.WebUI.Client.VersionHistory.RestoreResult");Microsoft.Office.Excel.WebUI.Client.VersionHistory.j.registerClass("Microsoft.Office.Excel.WebUI.Client.VersionHistory.j",_Ewa.WorkflowActivity);Microsoft.Office.Excel.WebUI.Client.VersionHistory.c.registerClass("Microsoft.Office.Excel.WebUI.Client.VersionHistory.c",_Ewa.rR.$$(_Ewa.ev));Microsoft.Office.Excel.WebUI.Client.VersionHistory.k.registerClass("Microsoft.Office.Excel.WebUI.Client.VersionHistory.k",_Ewa.WorkflowActivity);Microsoft.Office.Excel.WebUI.Client.VersionHistory.d.registerClass("Microsoft.Office.Excel.WebUI.Client.VersionHistory.d",_Ewa.rR.$$(_Ewa.ev));Microsoft.Office.Excel.WebUI.Client.VersionHistory.m.registerClass("Microsoft.Office.Excel.WebUI.Client.VersionHistory.m",null,_Ewa.kR);Microsoft.Office.Excel.WebUI.Client.VersionHistory.e.registerClass("Microsoft.Office.Excel.WebUI.Client.VersionHistory.e",_Ewa.bg);Microsoft.Office.Excel.WebUI.Client.VersionHistory.l.registerClass("Microsoft.Office.Excel.WebUI.Client.VersionHistory.l");Microsoft.Office.Excel.WebUI.Client.VersionHistory.VersionHistoryHighlightManager.registerClass("Microsoft.Office.Excel.WebUI.Client.VersionHistory.VersionHistoryHighlightManager",null,_Ewa.nh,Sys.IDisposable);Microsoft.Office.Excel.WebUI.Client.VersionHistory.f.registerClass("Microsoft.Office.Excel.WebUI.Client.VersionHistory.f",_Ewa.rR.$$(_Ewa.nh));Microsoft.Office.Excel.WebUI.Client.VersionHistory.n.registerClass("Microsoft.Office.Excel.WebUI.Client.VersionHistory.n",Common.db);Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.d.registerClass("Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.d",null,_Ewa.oj);Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.c.registerClass("Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.c",null,_Ewa.oj);Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.e.registerClass("Microsoft.Office.Excel.WebUI.Client.VersionHistory.a.e",null,_Ewa.oj);Common.App.VersionHistory.o.registerClass("Common.App.VersionHistory.o");Common.App.VersionHistory.p.registerClass("Common.App.VersionHistory.p");Common.App.VersionHistory.d.registerClass("Common.App.VersionHistory.d");Microsoft.Office.Excel.WebUI.Client.VersionHistory.b.a=23;Type.registerNamespace("_Ewa");_Ewa.blH=function(){};_Ewa.blH.a=function(){_Ewa.m.a(Microsoft.Office.Excel.WebUI.Client.VersionHistory.e.a);_Ewa.m.a(Microsoft.Office.Excel.WebUI.Client.VersionHistory.f.a);_Ewa.m.a(Microsoft.Office.Excel.WebUI.Client.VersionHistory.d.a);_Ewa.m.a(Microsoft.Office.Excel.WebUI.Client.VersionHistory.c.a)};_Ewa.blH.a();