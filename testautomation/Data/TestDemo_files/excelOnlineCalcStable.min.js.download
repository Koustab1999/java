var excelOnlineCalc=function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=12)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(14);t.utils=n;var a=r(15);t.ULS=a.ULS,t.TraceLevel=a.TraceLevel,t.LogCategory=a.LogCategory,t.NulLogger=a.NulLogger,t.ConsoleLogger=a.ConsoleLogger;var i=r(16);t.browserSupport=i;var o=r(17);t.perfWatch=o;var u=r(18);t.initEwaUtils=u.initEwaUtils,t.ewaUtils=u.ewaUtils;var s=r(19);t.initStopwatchFactory=s.initStopwatchFactory;var c=r(20);t.getNewGuid=c.getNewGuid;var l=r(21);t.TextAreaVirtualKeyboardPolicy=l.TextAreaVirtualKeyboardPolicy,t.TextAreaInputMode=l.TextAreaInputMode},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(8);t.mathpack=n;var a=r(25);t.dtr=a;var i=r(6);t.isSupported=i.isSupported,r(4)._start()},function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"a",(function(){return i})),r.d(t,"c",(function(){return o}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function a(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function o(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),a=0;for(t=0;t<r;t++)for(var i=arguments[t],o=0,u=i.length;o<u;o++,a++)n[a]=i[o];return n}},function(e,t,r){"use strict";r.r(t);var n=r(2);function a(e){return i(e)&&"WorkerError"===e.name&&"object"==typeof e.info}function i(e){if(null==e)return!1;if(e instanceof Error)return!0;var t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}function o(e){return i(e)?e:new Error("(non-Error object) "+function(e){var t=typeof e;switch(t){case"function":case"symbol":case"undefined":return"<"+t+">";case"object":return JSON.stringify(e);default:return""+e}}(e))}function u(e){return{name:e.name,message:a(e)?e.baseMessage:e.message,stack:e.stack,info:a(e)?(t=e.info,Object(n.a)(Object(n.a)({},t),{error:t.error?u(t.error):void 0})):void 0};var t}function s(e){return i(e)?{isError:!0,value:u(e)}:{isError:!1,value:e}}var c=function(e){function t(t,r){var a,i=this.constructor,o=e.call(this,t+"; info = "+JSON.stringify(Object(n.a)(Object(n.a)({},r),{error:null===(a=r.error)||void 0===a?void 0:a.message})))||this;o.baseMessage=t,o.info=r,o.name="WorkerError";var u=i.prototype;return Object.getPrototypeOf(o)!==u&&(null!=Object.setPrototypeOf?Object.setPrototypeOf(o,u):o.__proto__=u),o}return Object(n.b)(t,e),t.isWorkerError=a,t}(Error);var l={Error:Error,EvalError:EvalError,RangeError:RangeError,ReferenceError:ReferenceError,SyntaxError:SyntaxError,TypeError:TypeError,URIError:URIError};function d(e){var t;if("WorkerError"===e.name)t=new c(e.message,function(e){return Object(n.a)(Object(n.a)({},e),{error:e.error?d(e.error):void 0})}(e.info));else{var r=l[e.name];r?t=new r(e.message):(t=new Error(e.message)).name=e.name}return null!=e.stack&&(t.stack=e.stack),t}function f(e){return e.isError?d(e.value):e.value}var h;function v(){return"undefined"!=typeof Blob&&"undefined"!=typeof URL&&void 0!==URL.createObjectURL&&void 0!==URL.revokeObjectURL&&"undefined"!=typeof Worker}function p(e){if(h)throw new TypeError("setConfig has already been called");h=e}function m(){var e=null!=h?h:{};return{createTimeout:e.createTimeout,createMode:e.createMode,importScriptUrls:e.importScriptUrls?Object(n.c)(e.importScriptUrls):void 0,typedWorkersUrl:e.typedWorkersUrl,typedWorkersName:e.typedWorkersName}}function g(e){setTimeout((function(){throw e}))}function S(){return"undefined"!=typeof self&&"__typed_workers_thread"in self?self:void 0}function y(e){var t=S();if(void 0!==t){var r={kind:1,error:s(e)};t.postMessage(r)}else console.warn(e)}function b(e){var t;try{(null!==(t=null==h?void 0:h.onWorkerError)&&void 0!==t?t:y)(e)}catch(t){console.warn(e),g(t)}}function E(e){var t=S();if(void 0!==t){var r={kind:2,stats:e};t.postMessage(r)}}function F(e){var t;try{(null!==(t=null==h?void 0:h.onCreateWorker)&&void 0!==t?t:E)(e)}catch(e){g(e)}}var C=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return C.transfer.apply(C,Object(n.c)([e,void 0],t))};function R(e,t){return e.then((function(e){return t(),e}),(function(e){return t(),Promise.reject(e)}))}C.transfer=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return{def:e,args:r,transferables:null!=t?t:[]}};var k;function N(e,t,r){if(e>1<<30)return r;var n=setTimeout(t,Math.max(0,e));return{resolve:function(e){clearTimeout(n),r.resolve(e)},reject:function(e){clearTimeout(n),r.reject(e)}}}function A(){var e=Object.create(null);return e.key=void 0,delete e.key,e}function T(){return null!=k?k:k=function(){try{return"function"==typeof Proxy&&!0===new Proxy({},{get:function(){return!0}}).k}catch(e){return!1}}()}function I(e,t){var r=A(),n=function(t,r){var n;return null!==(n=t[r])&&void 0!==n?n:t[r]=e(r)};return t?(t.forEach((function(e){return n(r,e)})),r):new Proxy(r,{get:n})}function O(e){throw e}var M=-1,w=function(){function e(e,t){var r,n,a=this;this.idInfo=e,this.port=t,this.isClosed=!1,this.exports={},this.unresolvedCalls=A();var i=function(){var e;return null===(e=a.onClose)||void 0===e?void 0:e.call(a)},o=((r={})[0]=this.onInvoke.bind(this),r[1]=this.onResult.bind(this),r[2]=function(e){var t,r=e.funcNames;null===(t=a.onImports)||void 0===t||t.call(a,I(a.createPostProxy.bind(a),r),I(a.createCallProxy.bind(a),r))},r[3]=i,r),u=((n={})[0]=this.onSendInvokeFailed.bind(this),n[1]=this.onSendResultFailed.bind(this),n[2]=i,n[3]=i,n);this.port.onmessage=function(e){var t=e.data;return o[t.kind](t)},this.port.onmessageerror=function(e){var t=e.data;return u[t.kind](t)}}return e.prototype.setExports=function(e){this.exports=e;var t={kind:2,funcNames:T()?void 0:function(e){for(var t=A();null!=e;){for(var r=0,n=Object.getOwnPropertyNames(e);r<n.length;r++){var a=n[r];try{"function"==typeof e[a]&&(t[a]=!0)}catch(e){}}e=Object.getPrototypeOf(e)}return Object.getOwnPropertyNames(t)}(e)};this.port.postMessage(t)},e.prototype.close=function(){if(!this.isClosed){this.isClosed=!0;for(var e in this.port.postMessage({kind:3}),this.port.close(),this.unresolvedCalls){var t=this.unresolvedCalls[e],r=t.reject,n=t.funcName,a={cause:"Connection",idInfo:this.idInfo,funcName:n};r(new c("Importing Endpoint closed while waiting for "+n+" result",a))}}},e.prototype.onInvoke=function(e){var t=this,r=e.callId,n=e.funcName,a=e.args,i=Promise.resolve().then((function(){var e=t.exports[n];if(e)return e.apply(t.exports,a);var i=r>=0?"call":"post",o={cause:"Connection",idInfo:t.idInfo,callId:r,funcName:n};throw new c("Exporting Endpoint received a "+i+" to unknown function "+n,o)}));r>=0?i.then((function(e){return t.sendResult(r,n,!0,e)}),(function(e){return t.sendResult(r,n,!1,e)})):i.catch((function(e){var a=o(e),i={cause:"UnhandledError",idInfo:t.idInfo,error:a,callId:r,funcName:n};b(new c("Exporting Endpoint's "+n+" implementation threw or rejected",i))}))},e.prototype.sendResult=function(e,t,r,n){var a={kind:1,callId:e,funcName:t,isFulfilled:r,resultValue:s(n)};try{this.port.postMessage(a,void 0)}catch(e){this.onSendResultFailed(a,o(e))}},e.prototype.onSendResultFailed=function(e,t){var r=e.callId,n=e.funcName,a=e.resultValue,i=t?"Exporting Endpoint failed to send "+n+" result":"Importing Endpoint failed to deserialize "+n+" result",o={cause:"MessageError",idInfo:this.idInfo,error:t,callId:r,funcName:n},u=new c(i,o);a.isError?b(u):this.sendResult(r,n,!1,u)},e.prototype.takeCallbacks=function(e){var t=this.unresolvedCalls[e];return t&&delete this.unresolvedCalls[e],t},e.prototype.setCallTimeout=function(e,t,r,n){var a=this;if(r>1<<30)return n;return N(r,(function(){var n=a.takeCallbacks(e);if(n){var i={cause:"Timeout",idInfo:a.idInfo,timeout:r,callId:e,funcName:t};n.reject(new c("Importing Endpoint's call to "+t+" timed out",i))}}),n)},e.prototype.sendCall=function(e,t,r,a){var i=this;return new Promise((function(u,s){var l=M+=1,d={kind:0,callId:l,funcName:e,args:t};i.unresolvedCalls[l]=Object(n.a)(Object(n.a)({},i.setCallTimeout(l,e,r,{resolve:u,reject:s})),{funcName:e});try{i.port.postMessage(d,a)}catch(t){var f=i.takeCallbacks(l);if(f){var h=o(t),v={cause:"MessageError",idInfo:i.idInfo,error:h,callId:l,funcName:e};f.reject(new c("Importing Endpoint failed to send call to "+e,v))}}}))},e.prototype.sendPost=function(e,t,r,n){var a={kind:0,callId:-1,funcName:e,args:t};try{this.port.postMessage(a,n)}catch(t){var i=o(t),u={cause:"MessageError",idInfo:this.idInfo,error:i,callId:-1,funcName:e};r(new c("Importing Endpoint failed to post to "+e,u))}},e.prototype.onSendInvokeFailed=function(e){var t,r=e.callId,n=e.funcName,a=r>=0?"call":"post",i={cause:"MessageError",idInfo:this.idInfo,callId:r,funcName:n},o=new c("Exporting Endpoint failed to deserialize "+a+" to "+n,i),u=r>=0?this.takeCallbacks(r):void 0;(null!==(t=null==u?void 0:u.reject)&&void 0!==t?t:b)(o)},e.prototype.onResult=function(e){var t=e.callId,r=e.funcName,n=e.isFulfilled,a=e.resultValue;if(t>=0){var i=this.takeCallbacks(t);if(i)(n?i.resolve:i.reject)(f(a))}else{var o={cause:"InternalError",idInfo:this.idInfo,callId:t,funcName:r};b(new c("Exporting Endpoint sent a result for a post to "+r,o))}},e.prototype.createPostProxy=function(e){var t=this,r=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.transfer.apply(r,Object(n.c)([void 0],e))};return r.transfer=function(n){for(var a,i,o,u=[],s=1;s<arguments.length;s++)u[s-1]=arguments[s];if(!t.isClosed){var c=null!==(o=null!==(a=r.onPostMessageError)&&void 0!==a?a:null===(i=t.getOnPostMessageError)||void 0===i?void 0:i.call(t))&&void 0!==o?o:O;t.sendPost(e,u,c,n)}},r},e.prototype.createCallProxy=function(e){var t=this,r=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.transfer.apply(r,Object(n.c)([void 0],e))};return r.transfer=function(n){for(var a,i,o,u=[],s=1;s<arguments.length;s++)u[s-1]=arguments[s];if(t.isClosed){var l={cause:"Connection",idInfo:t.idInfo,funcName:e};return Promise.reject(new c(t.idInfo.side+" Endpoint's call."+e+" called after close",l))}var d=null!==(o=null!==(a=r.callTimeout)&&void 0!==a?a:null===(i=t.getCallTimeout)||void 0===i?void 0:i.call(t))&&void 0!==o?o:1/0;return t.sendCall(e,u,d,n)},r.callTimeout=void 0,r},e}();var D=function(){function e(e,t,r){this.callTimeout=1/0,this.onPostMessageError=O,this._idInfo=e,this._state=t,this.createMode=r;var n=function(t){return function(){var r="Outside"===e.side?"inside":"outside",n={cause:"Connection",idInfo:e};throw new c(e.side+" Endpoint's "+t+" referenced before the "+r+" Endpoint started",n)}};Object.defineProperties(this,{post:{configurable:!0,enumerable:!1,get:n("post")},call:{configurable:!0,enumerable:!1,get:n("call")}})}return e._create=function(t,r,n){var a,i,o=r.port,u=r.options,s=r.createMode,l={type:"Endpoint",side:t,id:null==u?void 0:u.id};try{a=new w(l,o),i=new e(l,a,s)}catch(e){return Promise.reject(e)}return new Promise((function(e,r){var o;a.getCallTimeout=function(){return i.callTimeout},a.getOnPostMessageError=function(){return i.onPostMessageError},a.onImports=function(e,t){Object.defineProperties(i,{post:{configurable:!0,enumerable:!1,writable:!1,value:e},call:{configurable:!0,enumerable:!1,writable:!1,value:t}}),f.resolve()},a.onClose=function(){return i.close("Force")};var s,d=function(e){var t,r;return null!==(r=null!==(t=null==e?void 0:e.createTimeout)&&void 0!==t?t:null==h?void 0:h.createTimeout)&&void 0!==r?r:3e5}(u),f=N(d,(function(){var e=new c(t+" Endpoint timed out waiting for the "+("Outside"===t?"inside":"outside")+" to start",{cause:"Timeout",idInfo:l,timeout:d});f.reject(e)}),{resolve:e,reject:r});i._closedDuringCreate=function(){f.resolve()};try{s=n(i)}catch(e){return f.reject(e)}null===(o=i._state)||void 0===o||o.setExports(s)})).then((function(){return i._closedDuringCreate=void 0,i}),(function(e){return i._closedDuringCreate=void 0,i.close(),Promise.reject(e)}))},e.prototype.hasBeenClosed=function(){return void 0===this._state},e.prototype.close=function(e){var t,r;if(this._state){if(this._closedDuringCreate){if("Force"!==e){var n={cause:"Connection",idInfo:this._idInfo};throw new c(this._idInfo.side+" Endpoint's close called during creation",n)}this._closedDuringCreate()}var a=this._state;this._state=void 0;try{a.close(),null===(t=this._onClose)||void 0===t||t.call(this),null===(r=this.onClose)||void 0===r||r.call(this)}catch(e){n={cause:"Connection",idInfo:this._idInfo,error:o(e)};b(new c(this._idInfo.side+" Endpoint's close threw an error",n))}}},e.createOutside=function(t,r){return void 0===r&&(r=function(){}),e._create("Outside",t,r)},e.createInside=function(t,r){return e._create("Inside",t,r)},e}(),_='!function(r){var e={};function n(t){if(e[t])return e[t].exports;var o=e[t]={i:t,l:!1,exports:{}};return r[t].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=r,n.c=e,n.d=function(r,e,t){n.o(r,e)||Object.defineProperty(r,e,{enumerable:!0,get:t})},n.r=function(r){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},n.t=function(r,e){if(1&e&&(r=n(r)),8&e)return r;if(4&e&&"object"==typeof r&&r&&r.__esModule)return r;var t=Object.create(null);if(n.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:r}),2&e&&"string"!=typeof r)for(var o in r)n.d(t,o,function(e){return r[e]}.bind(null,o));return t},n.n=function(r){var e=r&&r.__esModule?function(){return r.default}:function(){return r};return n.d(e,"a",e),e},n.o=function(r,e){return Object.prototype.hasOwnProperty.call(r,e)},n.p="",n(n.s=0)}([function(r,e,n){"use strict";n.r(e);var t=function(){return(t=Object.assign||function(r){for(var e,n=1,t=arguments.length;n<t;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(r[o]=e[o]);return r}).apply(this,arguments)};function o(){for(var r=0,e=0,n=arguments.length;e<n;e++)r+=arguments[e].length;var t=Array(r),o=0;for(e=0;e<n;e++)for(var i=arguments[e],u=0,a=i.length;u<a;u++,o++)t[o]=i[u];return t}function i(r){return u(r)&&"WorkerError"===r.name&&"object"==typeof r.info}function u(r){if(null==r)return!1;if(r instanceof Error)return!0;var e=r;return"string"==typeof e.name&&"string"==typeof e.message&&(null==e.stack||"string"==typeof e.stack)}function a(r){return u(r)?r:new Error("(non-Error object) "+function(r){var e=typeof r;switch(e){case"function":case"symbol":case"undefined":return"<"+e+">";case"object":return JSON.stringify(r);default:return""+r}}(r))}function f(r){return{name:r.name,message:i(r)?r.baseMessage:r.message,stack:r.stack,info:i(r)?(e=r.info,t(t({},e),{error:e.error?f(e.error):void 0})):void 0};var e}function s(r){throw new ReferenceError(r+" is not defined")}function c(r,e,n){void 0===n&&(n=s);try{for(var t=e.split("."),o=0,i=t;o<i.length;o++){r=r[i[o]]}return null!=r?r:n(e)}catch(r){return n(e)}}var l=function(r){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return l.transfer.apply(l,o([r,void 0],e))};l.transfer=function(r,e){for(var n=[],t=2;t<arguments.length;t++)n[t-2]=arguments[t];return{def:r,args:n,transferables:null!=e?e:[]}};var p="undefined"!=typeof performance&&void 0!==performance.timeOrigin?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};function d(r,e,n){"Pending"===r.status&&(r.status=e,r.end=Math.max(r.start,null!=n?n:p()))}self.onmessage=function(r){var e,n=r.data,t=n.config,s=n.port,l=n.options,v=n.script,y=n.args;function g(){var r;if(e)return e;if(void 0===t.typedWorkersUrl)throw new TypeError("importTypedWorkers: typedWorkersUrl is not defined");return importScripts(t.typedWorkersUrl),(e=c(self,null!==(r=t.typedWorkersName)&&void 0!==r?r:"typedWorkers")).setConfig(t),e}self.onmessage=null,self.__typed_workers_thread=!0;var m={status:"Pending",start:p()};function h(r,e){var n,t={kind:0,error:r?void 0:u(n=a(e))?{isError:!0,value:f(n)}:{isError:!1,value:n},stopwatch:m};self.postMessage(t),r||setTimeout(self.close.bind(self),6e4)}try{(function(r,e){function n(e){throw d(r,i(e)&&"Timeout"===e.info.cause?"Timeout":"Error"),e}try{return e().then((function(e){var n;return null!==(n=d(r,"Success"))&&void 0!==n?n:e}),n)}catch(r){n(r)}})(m,(function(){var r,e;return importScripts.apply(void 0,o(null!==(e=null!==(r=null==l?void 0:l.importScriptUrls)&&void 0!==r?r:t.importScriptUrls)&&void 0!==e?e:[],void 0!==v.scriptUrl?[v.scriptUrl]:[])),c(self,v.insideInitName).apply(void 0,o([{config:t,importTypedWorkers:g,connection:{port:s,options:l,createMode:"Thread"}}],y))})).then((function(){return h(!0)}),(function(r){return h(!1,r)}))}catch(r){h(!1,r)}}}]);',L=-1;var U=function(){function e(e){var t,r;try{var n;t=function(e){var t="def"in e?e:C(e),r=t.def,n=t.args,a=t.transferables;if("function"!=typeof r)return[r,n,a,void 0];var i="__generatedInsideInit"+(L+=1);return[{scriptUrl:void 0,insideInitName:i},n,a,"var "+i+" = "+r.toString()+";"]}(e),this.script=t[0],this.args=t[1],this.transferables=t[2];var a=void 0===(n=t[3])?[_]:[n,"\n\n",_];this.blobUrl=URL.createObjectURL(new Blob(a,{type:"application/javascript"})),this.worker=new Worker(this.blobUrl)}catch(e){throw null===(r=this.worker)||void 0===r||r.terminate(),this.revokeBlobUrl(),e}}return e.prototype.revokeBlobUrl=function(){void 0!==this.blobUrl&&(URL.revokeObjectURL(this.blobUrl),this.blobUrl=void 0)},e.prototype.createInside=function(e,t){var r=this,o=e.port,u=e.options,s={type:"Thread",side:"Outside",id:u.id},l=this.worker;return R(new Promise((function(e,d){r.createCallbacks={resolve:e,reject:d};var h={config:m(),port:o,options:u,script:r.script,args:r.args};l.postMessage(h,Object(n.c)([o],r.transferables)),l.onerror=function(e){e.preventDefault();var t=function(e,t,r){if(i(r.error)){if(a(r.error))return r.error;var n={cause:"UnhandledError",idInfo:e,error:r.error};return new c(t+" received an unhandled error",n)}if(null==r.message)return new c(t+" received a non-error (worker script fetch probably failed)",{cause:"UnhandledError",idInfo:e});var o={cause:"UnhandledError",idInfo:e},u=r.message+" at "+r.filename+":"+r.lineno+":"+r.colno;return new c(t+" received an unhandled error: "+u,o)}(s,"worker.onerror",e);r.createCallbacks?r.createCallbacks.reject(t):b(t)},l.onmessage=function(e){var n,a,i=e.data;switch(i.kind){case 0:return t.insideInit=i.stopwatch,void 0===i.error?null===(n=r.createCallbacks)||void 0===n?void 0:n.resolve():null===(a=r.createCallbacks)||void 0===a?void 0:a.reject(f(i.error));case 1:return b(f(i.error));case 2:return F(i.stats)}}})),(function(){r.createCallbacks=void 0}))},e.prototype.terminate=function(){var e;if(this.worker){var t=this.worker;this.worker=void 0,null===(e=this.createCallbacks)||void 0===e||e.resolve(),t.terminate(),this.revokeBlobUrl()}},e}(),x="undefined"!=typeof performance&&void 0!==performance.timeOrigin?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};function B(){return{status:"Pending",start:x()}}function W(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,null!=r?r:x()))}function P(e,t){function r(t){throw W(e,a(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((function(t){var r;return null!==(r=W(e,"Success"))&&void 0!==r?r:t}),r)}catch(e){r(e)}}function V(e){return Math.round(1e3*e)/1e3}function G(e,t,r){return e<t?t:e>r?r:e}function H(e,t,r){var n,a,i,o=G(null!==(n=null==e?void 0:e.start)&&void 0!==n?n:1/0,t,r),u=G(null!==(a=null==e?void 0:e.end)&&void 0!==a?a:1/0,t,r);return{status:null!==(i=null==e?void 0:e.status)&&void 0!==i?i:"Pending",start:V(o-t),end:V(u-t),duration:V(u-o)}}var j=function(){return r(3)};function K(e,t,r,n,a){var i,o=new MessageChannel,u=o.port1,s=o.port2;return Promise.all([n({port:u,options:e,createMode:t}),P(r.createOutside=B(),(function(){return D.createOutside({port:s,options:e,createMode:t},(function(e){return a(i=e)}))}))]).then((function(){return i}),(function(e){return i?i.close("Force"):s.close(),Promise.reject(e)}))}function Y(e,t,r,a){return K(e,"Local",t,(function(e){return function(e,t,r){var a="def"in r?r:C(r),i=a.def,o=a.args;if("function"!=typeof i){var u={cause:"InternalError",idInfo:{type:"Endpoint",side:"Inside",id:e.options.id}};return Promise.reject(new c("Loading an InsideScript to create a local worker is unimplemented",u))}return Promise.resolve().then((function(){return P(t.insideInit=B(),(function(){return i.apply(void 0,Object(n.c)([{config:m(),importTypedWorkers:j,connection:e}],o)).then((function(){}))}))}))}(e,t,r)}),a)}function q(e,t,r,n){var a;t.createThread=B();try{a=new U(r)}catch(e){return W(t.createThread,"Error"),Promise.reject(e)}return W(t.createThread,"Success"),K(e,"Thread",t,(function(e){return a.createInside(e,t)}),n).then((function(e){return e.hasBeenClosed()?a.terminate():e._onClose=a.terminate.bind(a),e}),(function(e){return a.terminate(),Promise.reject(e)}))}function z(e,t,r){void 0===r&&(r=function(){});var n=function(e){var t,r,n=null!==(r=null!==(t=null==e?void 0:e.createMode)&&void 0!==t?t:null==h?void 0:h.createMode)&&void 0!==r?r:"Thread";return"ThreadOrLocal"===n?v()?"Thread":"Local":n}(e),a="local"in t?"Local"===n?t.local:t.thread:t,i="Local"===n?Y:q,o={id:e.id,createMode:n,createWorker:B()};return R(P(o.createWorker,(function(){return i(function(e){return{id:e.id,createTimeout:e.createTimeout,createMode:e.createMode,importScriptUrls:e.importScriptUrls}}(e),o,a,r)})),(function(){var e=function(e){var t=e.id,r=e.createMode,n=e.createWorker,a=e.insideInit,i=e.createOutside,o=e.createThread,u=n.status,s=n.start,c=n.end;if("Pending"!==u&&void 0!==c)return{id:t,createMode:r,createWorker:{status:u,absStart:s,duration:V(c-s)},createThread:"Thread"===r?H(o,s,c):void 0,createOutside:H(i,s,c),insideInit:H(a,s,c)}}(o);e&&F(e)}))}r.d(t,"WorkerError",(function(){return c})),r.d(t,"isThreadingSupported",(function(){return v})),r.d(t,"setConfig",(function(){return p})),r.d(t,"dispatchWorkerError",(function(){return b})),r.d(t,"paramInsideDef",(function(){return C})),r.d(t,"Endpoint",(function(){return D})),r.d(t,"createWorker",(function(){return z}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.__growWasmMemory=t.stackRestore=t.stackAlloc=t.stackSave=t.setThrew=t.__errno_location=t._start=t.Mathpack_Pack=t.Mathpack_FormatScientific=t.Mathpack_FormatFixed=t.Mathpack_FormatGetSign=t.Mathpack_FormatGetExponent=t.Mathpack_FormatGeneral=t.Mathpack_Atan2=t.Mathpack_Atan=t.Mathpack_Acos=t.Mathpack_Asin=t.Mathpack_Tan=t.Mathpack_Cos=t.Mathpack_Sin=t.Mathpack_Log=t.Mathpack_Ln=t.Mathpack_Exp=t.Mathpack_Sqrt=t.Mathpack_ViewRound=t.Mathpack_Equal=t.Mathpack_GetExp32=t.Mathpack_Compare=t.Mathpack_TenTo=t.Mathpack_RoundDown=t.Mathpack_RoundUp=t.Mathpack_Round=t.Mathpack_SFix=t.Mathpack_LFix=t.Mathpack_Fix=t.Mathpack_SFloat=t.Mathpack_Float=t.Mathpack_Neg=t.Mathpack_Abs=t.Mathpack_Floor=t.Mathpack_Ceil=t.Mathpack_Trunc=t.Mathpack_TakeMathError=t.Mathpack_Cond2=t.Mathpack_Cond=t.Mathpack_Power=t.Mathpack_Add=t.Mathpack_Sub=t.Mathpack_Mul=t.Mathpack_Div=t.Mathpack_Pi=t.Mathpack_One=t.Mathpack_Zero=t.Dtr_UtcToLocal=t.Dtr_ToTime=t.Dtr_ToDays=t.Dtr_Days=t.Dtr_ToNumWithDuration=t.Dtr_ToNum=t.Dtr_Write=t.Dtr_Rounding=t.Dtr_FracSec=t.Dtr_Wdy=t.Dtr_Sec=t.Dtr_Min=t.Dtr_Hour=t.Dtr_DOM=t.Dtr_Mon=t.Dtr_Yr=t.Dtr_FromNum=t.Dtr_DaysPerMonth=t.Base_StrBufSize=t.Base_StrBuf=t.memory=void 0;var n=r(22),a=r(23),i=r(24),o=new ArrayBuffer(8),u=new Int32Array(o),s=(new Float32Array(o),new Float64Array(o));function c(e){return u[e]}function l(e,t){u[e]=t}function d(){return s[0]}function f(e){s[0]=e}var h,v=new ArrayBuffer(65536),p=(h=new Uint8Array(v),function(e,t){var r,n;if("undefined"==typeof Buffer)for(r=atob(t),n=0;n<r.length;n++)h[e+n]=r.charCodeAt(n);else for(r=Buffer.from(t,"base64"),n=0;n<r.length;n++)h[e+n]=r[n]});p(1024,"GAwAAAEAAAACAAAAAwAAAAAAAAAE"),p(1056,"6AsAAPALAAD4CwAAAAwAAB8dHx4fHh8fHh8eHx8cHx4fHh8fHh8eHx8cHx4fHh8fHh8eHx8cHx4fHh8fHh8eHx8cHx4fHh8fHh8eHx8dHx4fHh8fHh8eHw=="),p(1152,"sAsAAMgLAADACwAA0As="),p(1199,"AQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQECAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsAAAAAHwA8AFsAeQCYALYA1QD0ABIBMQFPAW4B"),p(1599,"AQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwAAAAAAHwA7AFoAeACXALUA1ADzABEBMAFOAW0B"),p(1975,"oAQ="),p(1991,"yAc="),p(2007,"+go="),p(2022,"QJwO"),p(2038,"UMMR"),p(2054,"JPQU"),p(2069,"gJaYGA=="),p(2085,"ILy+Gw=="),p(2101,"KGvuHg=="),p(2117,"+QKVIg=="),p(2132,"QLdDuiU="),p(2148,"EKXU6Cg="),p(2164,"KueEkSw="),p(2179,"gPQg5rUv"),p(2195,"oDGpX+My"),p(2211,"BL/JG442AAAAAAAAAJ61cCuorcWdawAAAAAAAADXlUMOBY0pr6AAAAAAAAAA1abP/0kfeMLVAAAAAAAAAPz32oePeufXCgEAAAAAAACjFJvFFquz7z8BAAAAAAAAnjIjmcCtD4V1AQAAAAAAAOCM6YDJR7qTqgEAAAAAAADnptOoxbkCpN8BAAAAAAAAqhfmfyuhFrYUAgAAAAAAAJO/m4WRoijKSQIAAAAAAABrVSc5jfdw4H4CAAAAAAAARmGCNzUMLvmzAgAAAAAAADDJPOP/llKK6QIAAAAAAABmF7/W86aRmR4DAAAAAAAAjt75nfvrfqpTAwAAAAAAAM3MzMzMzMzM/f///wAAAAAK16NwPQrXo/r///8AAAAAO99PjZduEoP3////AAAAACxlGeJYF7fR8////wAAAAAjhEcbR6zFp/D///8AAAAAtmlsrwW9N4bt////AAAAALxCeuXVlL/W6f///wAAAAD9zmGEEXfMq+b///8AAAAAl6W0NkFfcInj////AAAAAL/V7b3O/ubb3////wAAAAD/qiTLC//rr9z///8AAAAAzIhQbwnMvIzZ////AAAAABMOtEtCEy7h1f///wAAAAAP2FwJNdwktNL///8AAAAA2aywOvd8HZDP////AAAAAFvhTcS+lJXmy////wAAAAC6lDlFrR6xz5b///8AAAAAWcF+sVN8Erth////AAAAAKXpOaUn6n+oLP///wAAAACmGQlrumDFl/f+//8AAAAAm1N1/fcCtIjC/v//AAAAAH3TZfC8NUP2jP7//wAAAACh5LxkfEbQ3Vf+//8AAAAAyYJTfG66ysci/v//AAAAAJOgc9uT4PSz7f3//wAAAAAwAMs42ycXorj9//8AAAAABswjVHeD/5GD/f//AAAAAGC8pD2p3oCDTv3//wAAAAC+TjFK7Dzl7Bj9//8AAAAA1+Eyz81fYNXj/P//AAAAADoZemMlQzHArvz//wAAAAAYLURU+yEJQAAAAAAAAOA/AAAAAAAAAEAYLURU+yH5PwAAAAAAAPA/"),p(3014,"WUAAAAAAAAAkQAAAAAAAQI9AAAAAAAAAOEAAAAAAAABOQClRzqDIRdg+IXQL5wZroz41IN+kpBFvPvZNfx3q2jg+AADA////30EAAAAAAADgwQQEAAAQBA=="),p(3728,"ME8=");var m=function(e,t,r){var n=new e.Int8Array(r),a=new e.Int16Array(r),i=new e.Int32Array(r),o=new e.Uint8Array(r),s=new e.Uint16Array(r),h=new e.Uint32Array(r),v=(new e.Float32Array(r),new e.Float64Array(r)),p=e.Math.imul,m=(e.Math.fround,e.Math.abs),g=e.Math.clz32,S=e.Math.min,y=(e.Math.max,e.Math.floor),b=e.Math.ceil,E=e.Math.sqrt,F=t.abort,C=(e.NaN,e.Infinity,t.Base_LocaleIsNumeral),R=t.Base_LocaleGetOrdinal,k=t.Base_LocaleDecimalSeparator,N=t.Math_log10,A=t.Math_log,T=(E=t.Math_sqrt,t.Math_sin),I=t.Math_cos,O=t.Math_tan,M=t.Math_atan,w=t.Math_exp,D=t.proc_exit,_=20112,L=0;function U(){}function x(e,t,r){e:if(e>>>0<=t>>>0){if(!r)break e;for(;n[0|e]=o[0|t],e=e+1|0,t=t+1|0,r=r+-1|0;);}else if(r)for(e=e+r|0,t=t+r|0;t=t+-1|0,n[0|(e=e+-1|0)]=o[0|t],r=r+-1|0;);}function B(e,t){var r,u,l=0,d=0,h=0,p=0;if(d=3680,_=r=_-48|0,i[r+40>>2]=0,a[r+30>>1]=0,a[r+32>>1]=0,v[460]=e,u=Y(e),v[460]=u,ye(u,r+40|0,r,15),s[r+42>>1]){l=(0|(l=de(t)<<16))<0?100:l>>16,f(+t),h=0|c(1),c(0),(p=-65536&h)&&(2146435072!=(2146435072&h)?l=(0|p)<1?0-l|0:l:i[922]=1);e:{if(!((0|(l=a[r+40>>1]+l|0))>=a[r+42>>1])){if((0|l)<1){d=3e3;break e}(255&l)>>>0>=o[r+30|0]||(n[r+30|0]=l)}Se(3100,3680,r)}e=v[d>>3]}return _=r+48|0,e}function W(e,t){var r,n=0,a=0,o=0;if(v[460]=e,f(+e),a=0|c(1),c(0),o=a,a=0,(n=-65536&o)&&(2146435072!=(2146435072&o)?a=(0|n)<1:(i[922]=1,a=0)),i[921]=2147483647&o,te(v[374]),n=-65536&(o=i[921]))if(2146435072!=(2146435072&o)){if(!((0|n)<1))return q(8),0}else i[922]=1;r=re(v[374],e),v[460]=re(v[372],r),ne(r),ve();e:{t:{if((n=i[921])>>>0>=65536){if(2146435072!=(2146435072&n))break t;i[922]=1}if(t){if(i[920]=0,i[921]=0,!a)break e;return t=i[741],i[920]=i[740],i[921]=t,v[460]}if(n=i[747],i[920]=i[746],i[921]=n,t=n,1^a|n>>>0<65536)break e;return i[921]=-2147483648^t,v[460]}Fe(e),pe(),t&&(v[460]=re(v[373],v[460]))}return v[460]}function P(e,t,r,n){var u,c=0,l=0,d=0,f=0,h=0,v=0,m=0;if(c=i[e+4>>2],h=-2146827284,!((0|(u=(l=s[e>>1])+(e=(0|(d=a[e+2>>1]))>=1?(d+-1|0)/12|0:(0|d)/-12^-1)<<16>>16))>9999|((r?1900:-9999)+(t?4:0)|0)>(0|u)||((d=d+p(e,-12)<<16>>16)+-1&65535)>>>0>11|(!c|1900==(0|u)&2==(0|d)&29==(0|c)?!r:0))){if(v=(0|(e=(f=(0|(l=u+1e4|0))/4|0)<<2))%100|0,m=(0|e)%400|0,c=(((f=p(f,1461)+c|0)+((0|(c=e+-1|0))/-100|0)|0)+((0|c)/400|0)|0)-1|0,l=(p(l-e|0,12)+d|0)-1|0)for(l=l+(e=m?v?0:12:0)|0;c=o[e+1072|0]+c|0,(0|l)!=(0|(e=e+1|0)););e:if(r||t){if(e=c+-4346385|0,!((0|u)>1900|(0|d)>=3))break e;e=c+-4346384|0}else e=c+-4346384|0;e>>>0>2958465||(i[n>>2]=e,h=0)}return h}function V(e,t,r){var n,u,s,c=0,l=0,d=0;l=d=Ae(e,t,711573504,201),i[r+28>>2]=(l+1>>>0)%7,c=l+p(n=(l>>>0)/146097|0,-146097)|0,u=(p(c,100)+75>>>0)/3652425|0,c=((s=p(u,-36524)+c|0)>>>0)/1461|0,l=(((l+(((c=((p(u,100)+p(n,400)|0)+(c<<2)|0)+((p(s+p(c,-1461)|0,100)+75>>>0)/36525|0)|0)>>>0)/100|0)|0)-(c>>>2)|0)-((c>>>0)/400|0)|0)+p(c,-365)|0,d=Ne(d,L,-864e5,-1),e=Ae(e,t,1e4,0)+d|0,d=!(((t=c+1|0)>>>0)%100)|3&t&&(t>>>0)%400|0?1936+((t=o[l+1568|0])<<1)|0:1536+((t=o[l+1168|0])<<1)|0,i[r+12>>2]=(e>>>0)/36e5,i[r+4>>2]=t+1,i[r>>2]=c+1601,t=(e>>>0)/1e3|0,i[r+20>>2]=(t>>>0)%60,i[r+16>>2]=((e>>>0)/6e4>>>0)%60,i[r+24>>2]=e-p(t,1e3),i[r+8>>2]=1+(l-a[d>>1]|0)}function G(e,t){var r=0,n=0,o=0,u=0,s=0,c=0,l=0,d=0,f=0,h=0,v=0,m=0;return(0|(u=i[e+4>>2]))<1||(d=u+-1|0)>>>0>11||(n=(r=i[e>>2])+-1601|0)>>>0>29226||(0|(s=i[e+8>>2]))<1||(o=1536,((c=65535&r)>>>0)%400&&(o=3&r?1936:(c>>>0)%100|0?1536:1936),(f=i[e+24>>2])>>>0>999||(c=i[e+20>>2])>>>0>59||(h=i[e+16>>2])>>>0>59||(v=i[e+12>>2])>>>0>23||(s=s+-1|0)>>>0>=a[o+(u<<1)>>1]-a[o+(d<<1)>>1]>>>0||(o=n>>>2,u=p(n,365),n=((e=65535&n)>>>0)/400|0,m=(e>>>0)/100|0,((l=65535&(r=r+-1600|0))>>>0)%400&&(e=1936,!((l>>>0)%100)|3&r)||(e=1536),l=1,r=(r=p(p(p(v,60)+h|0,60)+c|0,1e3)+f|0)+(n=Ne(e=a[(d<<1)+e>>1]+(n+((s+(u+o|0)|0)-m|0)|0)|0,e>>31,864e5,0))|0,e=L,i[t>>2]=Ne(r,r>>>0<n>>>0?e+1|0:e,1e4,0),i[t+4>>2]=L)),l}function H(e,t,r,n){var a,o=0,u=0,s=0,c=0;_=a=_-112|0,V(r,n,a+80|0);e:{if(i[e>>2]){if(!G(e,t))break e}else{if((0|(u=i[e+8>>2]))>5|!u)break e;if(r=i[e+4>>2],n=i[e+28>>2],o=i[a+80>>2],i[a+56>>2]=1,i[a+52>>2]=r,i[a+48>>2]=o,i[a+60>>2]=i[e+12>>2],i[a+64>>2]=i[e+16>>2],i[a+68>>2]=i[e+20>>2],e=i[e+24>>2],i[a+76>>2]=0,i[a+72>>2]=e,!G(a+48|0,a+8|0)){o=0;break e}e=n+8|0,r=n+1|0,s=(0|u)<2,V(i[a+8>>2],i[a+12>>2],a+16|0),c=a;t:{if((0|n)<(0|(o=i[a+44>>2])))e=e-o|0;else{if(e=1,(0|n)<=(0|o))break t;e=r-o|0}i[c+56>>2]=e}t:if(!s&&(r=e+7|0,i[a+56>>2]=r,o=1,G(a+48|0,a+8|0)))for(;;){if(V(i[a+8>>2],i[a+12>>2],a+16|0),e=i[a+24>>2],(0|u)==(0|(o=o+1|0)))break t;if(r=r+7|0,i[a+56>>2]=r,!G(a+48|0,a+8|0))break}if(i[a+56>>2]=e,!G(a+48|0,a+8|0)){o=0;break e}e=i[a+12>>2],i[t>>2]=i[a+8>>2],i[t+4>>2]=e}o=1}return _=a+112|0,o}function j(e,t,r){var n,o=0,u=0,c=0,l=0,d=0;if(_=n=_-16|0,r&&(c=r>>31,c^=c+r))for(r=(0|r)>0?1952:2448;(o=15&c)&&(u=a[(o=(o<<4)+r|0)+8>>1],d=K(v[e>>3],v[o>>3],n),t=t+u|0,a[n+14>>1]<=0?(o=s[n+6>>1],u=s[n+8>>1]):(u=i[n+4>>2],o=s[n+6>>1]<<1,a[n+6>>1]=o,l=i[n+8>>2],i[n+12>>2]=i[n+12>>2]<<1|l>>>31,u=l<<1|u>>>31,i[n+8>>2]=u,t=t+-1|0),(65535&o|1&u|0!=(0|d))>>>0<32769||(u=(o=i[n+8>>2])+1|0,i[n+8>>2]=u,u>>>0>=o>>>0||(u=(o=i[n+12>>2])+1|0,i[n+12>>2]=u,u>>>0>=o>>>0||(i[n+12>>2]=-2147483648,t=t+1|0))),o=i[n+12>>2],i[e>>2]=i[n+8>>2],i[e+4>>2]=o),r=r+240|0,c>>=4;);return _=n+16|0,t}function K(e,t,r){var n,i,o,u=0,s=0,l=0,d=0,h=0,v=0,m=0,g=0,S=0,y=0,b=0,E=0;return f(+t),d=0|c(1),h=65535&(s=0|c(0)),f(+e),y=0|c(1),u=0|c(0),l=y,i=p(g=65535&u,h),a[r>>1]=i,o=((65535&(b=p(S=u>>>16,h)))+(i>>>16)|0)+(65535&(m=p(s>>>=16,g)))|0,a[r+2>>1]=o,b=(((v=((65535&(u=p(n=65535&l,h)))+(b>>>16)|0)+(m>>>16)|0)+(65535&(m=p(s,S)))|0)+(65535&(E=p(y=65535&d,g)))|0)+(o>>>16)|0,a[r+4>>1]=b,m=(((((((65535&(v=p(d>>>=16,g)))+(u>>>16)|0)+(65535&(l=p(u=l>>>16,h)))|0)+(m>>>16)|0)+(E>>>16)|0)+(65535&(h=p(y,S)))|0)+(65535&(g=p(s,n)))|0)+(b>>>16)|0,a[r+6>>1]=m,S=((((((E=(l>>>16)+(v>>>16)|0)+(65535&(l=p(d,S)))|0)+(h>>>16)|0)+(g>>>16)|0)+(65535&(v=p(u,s)))|0)+(65535&(s=p(y,n)))|0)+(m>>>16)|0,a[r+8>>1]=S,v=((s=(((65535&(h=p(d,n)))+(l>>>16)|0)+(v>>>16)|0)+(s>>>16)|0)+(65535&(l=p(u,y)))|0)+(S>>>16)|0,a[r+10>>1]=v,u=(((65535&(d=p(u,d)))+(h>>>16)|0)+(l>>>16)|0)+(v>>>16)|0,a[r+12>>1]=u,a[r+14>>1]=(u>>>16)+(d>>>16),65535&(i|o|b)}function Y(e){var t,r,n=0,a=0,o=0,u=0,s=0,l=0;return _=t=_-16|0,v[t+8>>3]=e,f(+e),n=0|c(1),a=0|c(0),r=n,(n&=2146435072)&&(i[t+8>>2]=a<<11,i[t+12>>2]=r<<11|a>>>21|-2147483648,u=(n=p(a=(n>>>20)-1022|0,39457)>>17)+-14|0,o=j(t+8|0,a,14-n|0),a=i[t+8>>2],(0|o)>=(0|(h[t+12>>2]<(a>>>0<2147477094?-1243209483:-1243209484)>>>0?48:47))||(o=j(t+8|0,o,1),a=i[t+8>>2],u=n+-15|0),n=u,u=(u=a)+(a=-2147483648>>>(31&o))|0,i[t+8>>2]=u,u>>>0>=a>>>0||(l=(s=i[t+12>>2])+1|0,i[t+12>>2]=l,l>>>0>=s>>>0||(i[t+12>>2]=-2147483648,o=o+1|0)),i[t+8>>2]=u&0-(a<<1),o=j(t+8|0,o,n),3071&(n=i[t+8>>2])?(a=n+1024|0,i[t+8>>2]=a,n>>>0<4294966272||(u=(n=i[t+12>>2])+1|0,i[t+12>>2]=u,o=(u>>>0<n>>>0)+o|0)):a=n,(0|o)<=-1023?(i[t+8>>2]=0,i[t+12>>2]=0):(0|(n=1071644672+(o<<20)|0))<=-1||(o=i[t+12>>2],i[t+8>>2]=o<<21|a>>>11,i[t+12>>2]=o>>>11&1048575|n|-2147483648&r),e=v[t+8>>3]),_=t+16|0,e}function q(e){var t;return t=i[922],i[922]=e,t}function z(){var e,t,r;return e=i[920],t=i[921],$(1048576),$(2146435072),a[1843]<0?(i[920]=e,i[921]=t,-2147483648):(r=le(),i[920]=e,i[921]=t,-2147483648^r)}function J(e){var t,r=0,n=0,a=0,i=0;if(f(+e),r=0|c(1),t=0|c(0),i=r,a=0,!((r=2047&(n=r>>>20))>>>0<1023||(a=e,r>>>0>1075))){if(n=-1<<(19-n&31),r>>>0>=1044)return l(0,n&t),l(1,0|i),+d();i&=n,l(0,0),l(1,0|i),a=+d()}return a}function Q(e){var t=0,r=0,n=0;if(e+307>>>0<=615)return i[920]=0,i[921]=-2147483648,n=j(3680,1,e),r=i[920],e=i[921],3071&r&&(t=i[921],(e=i[920]+1024|0)>>>0<1024&&(t=t+1|0),i[920]=e,i[921]=t,r=e,e=t),i[920]=e<<21|r>>>11,void(i[921]=1071644672+(e>>>11&1048575|n<<20));(0|e)>=309&&(i[922]=1),i[920]=0,i[921]=0}function X(e,t,r,n){var o=0,u=0,c=0;e:{t:{r:{n:{if(!n){if(s[e>>1]<=52)break n;break t}if(!((0|n)<1)&&(0|n)<15)break r}return i[t>>2]=1,void(i[r>>2]=0)}if(s[(n<<1)+e>>1]<=52)break e;for(;;){if(c=s[(u=((o=n+-1|0)<<1)+e|0)>>1]+1|0,a[u>>1]=c,58!=(65535&c))break e;if(!(n=o))break}}return a[e>>1]=49,i[t>>2]=i[t>>2]+1,void(i[r>>2]=1)}for(;t=n,(0|n)>=2&&48==s[((n=t+-1|0)<<1)+e>>1];);i[r>>2]=t}function Z(){var e=0,t=0,r=0;e:{if(r=i[920],t=-65536&(e=i[921])){if(2146435072==(2146435072&e))return i[922]=1,void me();if((0|t)<1)break e}return void me()}me(),(0|r)==i[920]&&i[921]==(0|e)||te(1)}function $(e){v[460]=ee(v[460],e)}function ee(e,t){var r;return f(+(e+=t)),r=0|c(1),c(0),2146435072==(2146435072&r)&&(i[922]=1,e=v[375]),e}function te(e){v[460]=re(v[460],e)}function re(e,t){var r;return f(+(e-=t)),r=0|c(1),c(0),2146435072==(2146435072&r)&&(i[922]=1,e=v[375]),e}function ne(e){v[460]=ae(v[460],e)}function ae(e,t){var r,n=0,a=0,o=0;return f(+e*t),n=0|c(1),r=0|c(0),0|2146435072!=(0|(a=2146435072&n))?(o=(a=!(a|o))?i[750]:r,n=a?i[751]:n,l(0,0|o),l(1,0|n),+d()):(i[922]=1,n=i[751],l(0,i[750]),l(1,0|n),+d())}function ie(e){v[460]=oe(v[460],e)}function oe(e,t){var r=0,n=0,a=0,o=0;if(f(+t),r=0|c(1),c(0),2146435072&r){if(n=1,f(+e/t),r=0|c(1),a=0|c(0),!(!0&2146435072==(0|(o=2146435072&r))))return a=(n=!(0|o))?i[750]:a,r=n?i[751]:r,l(0,0|a),l(1,0|r),+d()}else n=4;return i[922]=n,r=i[751],l(0,i[750]),l(1,0|r),+d()}function ue(e){v[460]=e>>>0}function se(e){v[460]=0|e}function ce(){var e,t;e=+A(+v[460]),v[460]=e,f(+e),t=0|c(1),c(0),2146435072==(2146435072&t)&&(i[922]=8)}function le(){return de(v[460])}function de(e){var t,r=0,n=0,a=0,i=0;return f(+e),i=1106247680==(0|(a=2146435072&(r=0|c(1))))&i>>>0<0|a>>>0<1106247680,t=r&=2147483647,l(0,0|(n=0|c(0))),l(1,0|r),(e=+d())<0x10000000000000000&e>=0?(a=m(e)>=1?e>0?~~S(y(e/4294967296),4294967295)>>>0:~~b((e-+(~~e>>>0>>>0))/4294967296)>>>0:0,r=~~e>>>0):(a=0,r=0),n=i?r:n,!(r=i?a:t)&n>>>0<4294967295|r>>>0<0?n:-1}function fe(){return he(v[460])}function he(e){var t=0,r=0;return f(+e),t=0|c(1),c(0),r=1105199104==(0|(t&=2145386496))&r>>>0<0|t>>>0<1105199104,t=m(e)<2147483648?~~e:-2147483648,r?t:-2147483648}function ve(){var e,t;e=+E(+v[460]),v[460]=e,f(+e),t=0|c(1),c(0),2146435072==(2146435072&t)&&(i[922]=8)}function pe(){var e,t;e=+M(+v[460]),v[460]=e,f(+e),t=0|c(1),c(0),2146435072==(2146435072&t)&&(i[922]=8)}function me(){v[460]=J(v[460])}function ge(){var e,t;e=+w(+v[460]),v[460]=e,f(+e),t=0|c(1),c(0),2146435072==(2146435072&t)&&(i[922]=1)}function Se(e,t,r){return function(e,t,r){var n=0,u=0,l=0,d=0;if(n=o[r+30|0]){for(u=r;d=10*d+ +(0|Ie[i[i[e>>2]+4>>2]](e,s[u>>1])),u=u+2|0,l=(0|n)>1,n=n+-1|0,l;);if(f(+d),n=0|c(1),e=0|c(0),i[t>>2]=e<<11,i[t+4>>2]=2147481600&((2097151&n)<<11|e>>>21)|e>>>21|-2147483648,n=j(t,(n>>>20&2047)-1022|0,((32767&s[r+32>>1])-o[r+30|0]|0)-16384|0),3071&(u=i[t>>2])?(e=u+1024|0,i[t>>2]=e,u>>>0<4294966272||(l=(u=i[t+4>>2])+1|0,i[t+4>>2]=l,n=(l>>>0<u>>>0)+n|0)):e=u,!((0|n)<=-1022))return(0|(u=1071644672+(n<<20)|0))<0?1:(n=i[t+4>>2],i[t>>2]=n<<21|e>>>11,i[t+4>>2]=-2147483648&a[r+32>>1]|u|n>>>11&1048575,0)}return i[t>>2]=0,i[t+4>>2]=0,0}(e,t,r)}function ye(e,t,r,o){!function(e,t,r,o){var u,l,d=0,h=0,m=0,g=0,S=0,y=0,b=0,E=0,F=0,C=0;_=u=_-16|0,v[u+8>>3]=e,l=t,f(+e),h=0|c(1),m=0|c(0),g=d=h;e:if(h=2146435072&d){if(h=p(S=(h>>>20)-1022|0,39457)>>17,a[r+32>>1]=h+16385|d>>>16&32768,(0|o)<=14){if((0|(o=1+(o+h|0)|0))<=-1){n[r+30|0]=0,a[r+32>>1]=0,a[t+2>>1]=0,t=0;break e}o=(0|o)<15?o:15}if(i[u+8>>2]=m<<11,i[u+12>>2]=g<<11|m>>>21|-2147483648,(0|(d=j(u+8|0,S,-1^h)))>=1)for(m=r+32|0;h=s[m>>1],a[m>>1]=h+1&32767|32768&h,(0|(d=j(u+8|0,d,-1)))>0;);if(d?(h=(m=i[u+12>>2])>>>(g=0-d|0),i[u+12>>2]=h,d=m<<d+32|i[u+8>>2]>>>g,i[u+8>>2]=d):(d=i[u+8>>2],h=i[u+12>>2]),d=(m=h>>>0<(d>>>0<2576980377?429496730:429496729)>>>0?922:9223)+d|0,i[u+8>>2]=d,d>>>0<m>>>0&&(h=h+1|0,i[u+12>>2]=h),(0|o)<1)m=r;else{for(y=d>>>16,b=s[u+14>>1],E=r+32|0,C=15==(0|o),m=r,g=1;;){S=o;t:{r:{for(;;){if(o=p(y,10)+(p(65535&d,10)>>>16)>>>16,F=p(b,10)+(o+p(65535&h,10)>>>16)>>>16|48,a[m>>1]=F,b=(h=o+p(h,10)|0)>>>16,y=(d=p(d,10))>>>16,1&(-1^g|48!=(0|F)))break r;if(o=s[E>>1],a[E>>1]=o+-1&32767|32768&o,!C)break}g=1;break t}m=m+2|0,g=0}if(o=S+-1|0,!((0|S)>1))break}i[u+12>>2]=h,i[u+8>>2]=d}d=(o=m-r|0)>>1;t:{if((0|o)<=29){if((0|h)<=-1){a[m>>1]=57,h=d+1|0;break t}a[m>>1]=48}for(;;){if(h=d,(0|d)<1)break t;if(d=h+-1|0,48!=s[(m=m+-2|0)>>1])break}}n[r+30|0]=h,a[t+2>>1]=h,t=(32767&s[r+32>>1])-16384|0}else n[r+30|0]=0,a[r+32>>1]=0,a[t+2>>1]=0,t=0;a[l>>1]=t,_=u+16|0}(e,t,r,o)}function be(e){return re(v[460],e)}function Ee(e){return oe(v[460],e)}function Fe(e){v[460]=oe(e,v[460])}function Ce(e,t){v[460]=oe(e,t)}function F(){D(1),F()}function Re(e,t){var r,n;r=0|e,n=0|t,u[0]=r,u[1]=n}function ke(e,t,r,n){var a=0,i=0;return r=function(e,t,r,n){var a=0,i=0,o=0,u=0,s=0,c=0,l=0,d=0,f=0,h=0;e:{t:{r:{n:{a:{i:{o:{u:{s:{c:{if(o=t){if(!(a=r))break c;if(!(i=n))break s;if((a=g(i)-g(o)|0)>>>0<=31)break u;break t}if(1==(0|n)&r>>>0>=0|n>>>0>1)break t;return Re(e-p(t=(e>>>0)/(r>>>0)|0,r)|0,0),L=0,t}if(a=n,!e)break o;if(!a)break i;if((i=a+-1|0)&a)break i;return Re(e,o&i),e=o>>>(31&Te(a)),L=0,e}if(!((i=a+-1|0)&a))break a;s=(g(a)+33|0)-g(o)|0,c=0-s|0;break r}s=a+1|0,c=63-a|0;break r}return Re(0,o-p(e=(o>>>0)/(a>>>0)|0,a)|0),L=0,e}if((a=g(a)-g(o)|0)>>>0<31)break n;break t}if(Re(e&i,0),1==(0|a))break e;return r=Te(a),n=e,e=31&r,32<=(63&r)>>>0?(a=0,e=t>>>e):(a=t>>>e,e=((1<<e)-1&t)<<32-e|n>>>e),L=a,e}s=a+1|0,c=63-a|0}if(i=t,f=e,o=31&(a=63&s),32<=(63&a)>>>0?(a=0,u=i>>>o):(a=i>>>o,u=((1<<o)-1&i)<<32-o|f>>>o),i=a,o=e,e=31&(a=63&c),32<=(63&a)>>>0?(a=o<<e,e=0):(a=(1<<e)-1&o>>>32-e|t<<e,e=o<<e),t=a,s)for(a=n+-1|0,(o=r+-1|0)>>>0<4294967295&&(a=a+1|0),c=a;a=i<<1|u>>>31,i=u<<1,f=a,a=(u=c-((o>>>0<(i|=t>>>31)>>>0)+a|0)|0)>>31,u=(d=i)-(i=r&(l=u>>31))|0,i=f-((n&a)+(d>>>0<i>>>0)|0)|0,a=t<<1|e>>>31,e=h|e<<1,t=0|a,d=0,h=l&=1,s=s+-1|0;);return Re(u,i),L=(a=t<<1|e>>>31)|d,e=l|e<<1}Re(e,t),e=0,t=0}return L=t,e}((e^=a=t>>31)-a|0,i=((i=t>>31)^t)-((e>>>0<a>>>0)+i|0)|0,(r^=e=n>>31)-e|0,((a=n>>31)^n)-((r>>>0<e>>>0)+a|0)|0),L=((e=(t^=n)>>31)^L)-(((r^=t>>=31)>>>0<t>>>0)+e|0)|0,n=r-t|0}function Ne(e,t,r,n){return e=function(e,t,r,n){var a,i,o,u,s=0,c=0;return u=p(s=r>>>16,c=e>>>16),s=(65535&(c=((o=p(a=65535&r,i=65535&e))>>>16)+p(c,a)|0))+p(s,i)|0,e=(((p(t,r)+u|0)+p(e,n)|0)+(c>>>16)|0)+(s>>>16)|0,L=e,t=65535&o|s<<16}(e,t,r,n)}function Ae(e,t,r,n){return e=ke(e,t,r,n)}function Te(e){return e?31-g(e+-1^e)|0:32}var Ie=[null,function(e,t){return 0,0!=(0|C(0|(t|=0)))|0},function(e,t){return 0,0|R(0|(t|=0))},function(e){return 0,0|k()},function(e,t){return 0,(t|=0)+-48|0},U];return{memory:Object.create(Object.prototype,{grow:{},buffer:{get:function(){return r}}}),Base_StrBuf:function(){return 3104},Base_StrBufSize:function(){return 255},Dtr_DaysPerMonth:function(e,t,r){return 0|function(e,t,r){var n=0;n=3&t;e:if(r){if(n|(0|t)<2100)break e;n=!((t>>>0)%100)&0!=((t>>>0)%400|0)}else n||(n=!((0|t)%100)&0!=((0|t)%400|0));return o[1072+(((p(n,12)+e|0)-1|0)%48|0)|0]}(e|=0,t|=0,0!=(0|(r|=0)))},Dtr_FromNum:function(e,t,r,n,u){return e=+e,t|=0,n|=0,u|=0,r=p(r|=0,20)+3616|0,a[r>>1]=0,t=function(e,t,r,n,u){var h=0,m=0,g=0,S=0,y=0,b=0,E=0,F=0,C=0;e:if(!s[e>>1]){if(v[460]=t,f(+t),h=0|c(1),g=0|c(0),b=h,C=-65536&h)if(2146435072!=(2146435072&h)){if(!((0|C)>=1))return-2147467259}else i[922]=1;y=i[770],E=i[771],S=-1;t:{if(!((0|h)<(0|(m=E))||(S=1,(0|h)>(0|m)))){if((0|y)==(0|(m=g)))break t;S=m>>>0<y>>>0?-1:1}if(m=-2147467259,1==(0|((b&E)>-1?S:0-S|0)))break e}t:{if(y=i[772],m=i[773],E=m,S=-1,!((0|h)<(0|m)||(S=1,(0|h)>(0|E)))){if((0|g)==(0|y))break t;S=g>>>0<y>>>0?-1:1}if(y=S,-1==(0|((m&b)>-1?y:0-y|0)))return-2147467259}t:{r:{if(!(u|!C))if(2146435072!=(2146435072&h)){if((0|C)<1)break r}else i[922]=1;$(v[i[1056+(r<<2)>>2]>>3]),F=v[460];break t}Z(),te(t),b=i[921],g=b,l(0,0|(h=i[920])),l(1,0|g),F=+d(),i[750]==(0|h)&&i[751]==(0|g)||(m=i[921])>>>0<65536||(i[921]=-2147483648^m,f(+(F=v[460])),g=0|c(1),h=0|c(0)),b=g,y=g,g=i[1056+(r<<2)>>2],E=i[g+4>>2],m=i[g>>2],S=-1;r:{if(!((0|y)<(0|(g=E))||(S=1,(0|y)>(0|g)))){if((0|h)==(0|m)){v[460]=t;break r}S=h>>>0<m>>>0?-1:1}if(y=S,v[460]=t,-1==(0|((b&E)>-1?y:0-y|0)))break t}te(v[374])}if(a[e+18>>1]=r,h=fe(),m=-2147467259,!q(0)){if(n){if((0|h)>2957003)break e;h=h+1462|0}else if(h+4346018>>>0>7304483)break e;if(a[e+14>>1]=1+((h+6|0)%7|0),!u|h)if(h){if((0|h)<=-1?(g=-4-((n=(-1^h)/1461|0)<<2)|0,m=1461+(p(n,1461)+h|0)|0):(g=(n=(h+-1|0)/1461|0)<<2,m=p(n,-1461)+h|0),!(u&&(0|g)<=199))if((0|(m=(((0|(n=g+-101|0))/100|0)-((0|n)/400|0)|0)+m|0))>=1462){h=3&(n=g+1900|0);t:if(u){if(h|(0|g)<200)break t;h=!((n>>>0)%100)&0!=((n>>>0)%400|0)}else h||(h=!((0|n)%100)&0!=((0|n)%400|0));g=g+4|0,m=(12==(0|p(h,12))?-1460:-1461)+m|0}else(0|m)>0||(g=g+-4|0,m=m+1461|0);h=3&(n=g+1900|0);t:if(u){if(h|(0|g)<200)break t;h=!((n>>>0)%100)&0!=((n>>>0)%400|0)}else h||(h=!((0|n)%100)&0!=((0|n)%400|0));for(b=p(h,12),h=b;u=h,h=h+1|0,(0|(m=(n=m)-o[u+1072|0]|0))>0;);u=((m=u)-((0|b)<(0|(u=u+-11|0))?b:u)>>>0)/12|0,a[e>>1]=1900+(u+g|0),a[e+2>>1]=(p(u,-12)+h|0)-b}else i[e>>2]=788331,n=30;else i[e>>2]=67436;if(i[e+4>>2]=n,v[460]=F,me(),(n=i[921])>>>0>=65536&&(i[921]=-2147483648^n),$(F),ne(v[379]),t=v[460],n=le(),a[e+8>>1]=n,ue(n<<16>>16),(n=i[921])>>>0>=65536&&(i[921]=-2147483648^n),$(t),ne(v[380]),t=v[460],n=le(),a[e+10>>1]=n,ue(n<<16>>16),(n=i[921])>>>0>=65536&&(i[921]=-2147483648^n),$(t),ne(v[380]),!r)return r=le(),a[e+16>>1]=0,a[e+12>>1]=r,0;t=v[460],n=le(),a[e+12>>1]=n,ue(n<<16>>16),(n=i[921])>>>0>=65536&&(i[921]=-2147483648^n),$(t),ne(v[i[1152+(r<<2)>>2]>>3]),v[460]=Y(v[460]),a[e+16>>1]=le(),m=0}}return m}(r,e,t,0!=(0|n),0!=(0|u)),i[922]=0,0|t},Dtr_Yr:function(e){return a[p(e|=0,20)+3616>>1]},Dtr_Mon:function(e){return a[p(e|=0,20)+3618>>1]},Dtr_DOM:function(e){return i[p(e|=0,20)+3620>>2]},Dtr_Hour:function(e){return a[p(e|=0,20)+3624>>1]},Dtr_Min:function(e){return a[p(e|=0,20)+3626>>1]},Dtr_Sec:function(e){return a[p(e|=0,20)+3628>>1]},Dtr_Wdy:function(e){return a[p(e|=0,20)+3630>>1]},Dtr_FracSec:function(e){return a[p(e|=0,20)+3632>>1]},Dtr_Rounding:function(e){return a[p(e|=0,20)+3634>>1]},Dtr_Write:function(e,t,r,n,o,u,s,c,l,d){e|=0,t|=0,r|=0,n|=0,o|=0,u|=0,s|=0,c|=0,l|=0,d=p(d|=0,20),a[d+3634>>1]=l,a[d+3632>>1]=c,a[d+3630>>1]=s,a[d+3628>>1]=u,a[d+3626>>1]=o,a[d+3624>>1]=n,i[d+3620>>2]=r,a[d+3618>>1]=t,a[d+3616>>1]=e},Dtr_ToNum:function(e,t,r){return e|=0,t|=0,r|=0,i[920]=0,i[921]=0,function(e,t,r){var n,o=0;_=n=_-16|0;e:{t:{r:{if((s[e+2>>1]+-32767&65535)>>>0>1){if(a[e+18>>1]>=1?(se(a[e+16>>1]),o=Ee(v[i[1152+(a[e+18>>1]<<2)>>2]>>3]),se(a[e+12>>1]),$(o)):se(a[e+12>>1]),o=Ee(v[380]),se(a[e+10>>1]),$(o),o=Ee(v[380]),se(a[e+8>>1]),$(o),o=Ee(v[379]),!((0|P(e,t,r,n+12|0))<0)){if(e=i[n+12>>2],!t)break r;if(se(e+-1462|0),!((0|e)<1462)){if(e=i[921],!(t=-65536&e))break t;if(2146435072==(2146435072&e)){i[922]=1;break t}if((0|t)>=1)break t}}i[920]=0,i[921]=0}i[920]=0,i[921]=0,q(8);break e}ue(e)}$(o)}_=n+16|0}(p(e,20)+3616|0,0!=(0|t),0!=(0|r)),+v[460]},Dtr_ToNumWithDuration:function(e,t,r,n,o){return e|=0,t|=0,r|=0,n|=0,o|=0,i[920]=0,i[921]=0,function(e,t,r,n,o){var u,c=0;_=u=_-16|0;e:{t:{r:{if((s[e+2>>1]+-32767&65535)>>>0>1){n:if(a[e+18>>1]>=1){if(se(a[e+16>>1]),ie(v[i[1152+(a[e+18>>1]<<2)>>2]>>3]),c=v[460],2==(0|o)){v[460]=n,$(c);break n}se(a[e+12>>1]),$(c)}else 2!=(0|o)?se(a[e+12>>1]):v[460]=n;if(ie(v[380]),c=v[460],1!=(0|o)?se(a[e+10>>1]):v[460]=n,$(c),ie(v[380]),c=v[460],o?se(a[e+8>>1]):v[460]=n,$(c),ie(v[379]),n=v[460],!((0|P(e,t,r,u+12|0))<0)){if(e=i[u+12>>2],!t)break r;if(se(e+-1462|0),!((0|e)<1462)){if(e=i[921],!(t=-65536&e))break t;if(2146435072==(2146435072&e)){i[922]=1;break t}if((0|t)>=1)break t}}i[920]=0,i[921]=0}i[920]=0,i[921]=0,q(8);break e}ue(e)}$(n)}_=u+16|0}(p(e,20)+3616|0,0!=(0|t),0!=(0|r),+(0|o),n),+v[460]},Dtr_Days:function(){return i[919]},Dtr_ToDays:function(e,t,r){return t|=0,r|=0,0|P(p(e|=0,20)+3616|0,0!=(0|t),0!=(0|r),3676)},Dtr_ToTime:function(e,t,r){return function(e,t,r){v[460]=e,$(v[i[1056+(r<<2)>>2]>>3]);e:{if(t>>>0<=1){if(t-1)break e}else ne(v[380]);ne(v[380])}ne(v[379]),me()}(e=+e,t|=0,r|=0),+v[460]},Dtr_UtcToLocal:function(e,t,r,n,o,u,c,l){var d;return e|=0,t|=0,r|=0,n|=0,o|=0,u|=0,c|=0,l|=0,_=d=_-32|0,i[d+24>>2]=u,i[d+16>>2]=n,i[d+8>>2]=t,i[d+20>>2]=(0|o)>-1?p(o,20)+3616|0:0,i[d+12>>2]=(0|r)>-1?p(r,20)+3616|0:0,e=function(e,t,r,n){var o,u=0;_=o=_-32|0,function(e,t,r){var n,o=0,u=0,c=0,l=0,d=0,f=0,h=0,v=0,m=0,g=0,S=0,y=0;if(_=n=_-96|0,i[n+64>>2]=a[t>>1],i[n+68>>2]=a[t+2>>1],i[n+72>>2]=i[t+4>>2],i[n+76>>2]=a[t+8>>1],i[n+80>>2]=a[t+10>>1],i[n+84>>2]=a[t+12>>1],i[n+92>>2]=a[t+14>>1]+-1,(o=a[t+18>>1])>>>0<=3){e:{t:switch(o-1|0){case 0:o=p(a[t+16>>1],100);break e;case 1:o=p(a[t+16>>1],10);break e;case 2:break t;default:break e}o=a[t+16>>1]}i[n+88>>2]=o}t=0;e:if(G(n- -64|0,n+40|0)){if(c=Ne(c=p(i[e>>2],60),c>>31,1e7,0),d=L,(u=i[e+4>>2])&&(l=i[e+12>>2])){if(i[n+64>>2]=a[u>>1],i[n+68>>2]=a[u+2>>1],i[n+72>>2]=i[u+4>>2],i[n+76>>2]=a[u+8>>1],i[n+80>>2]=a[u+10>>1],i[n+84>>2]=a[u+12>>1],i[n+92>>2]=a[u+14>>1]+-1,(o=a[u+18>>1])>>>0<=3){t:{r:switch(o-1|0){case 0:o=p(a[u+16>>1],100);break t;case 1:o=p(a[u+16>>1],10);break t;case 2:break r;default:break t}o=a[u+16>>1]}i[n+88>>2]=o}if(i[n+8>>2]=a[l>>1],i[n+12>>2]=a[l+2>>1],i[n+16>>2]=i[l+4>>2],i[n+20>>2]=a[l+8>>1],i[n+24>>2]=a[l+10>>1],i[n+28>>2]=a[l+12>>1],i[n+36>>2]=a[l+14>>1]+-1,(o=a[l+18>>1])>>>0<=3){t:{r:switch(o-1|0){case 0:o=p(a[l+16>>1],100);break t;case 1:o=p(a[l+16>>1],10);break t;case 2:break r;default:break t}o=a[l+16>>1]}i[n+32>>2]=o}if(u=i[n+44>>2],l=u,o=i[n+40>>2],!H(n- -64|0,n+56|0,o,u))break e;if(!H(n+8|0,n+48|0,o,l))break e;m=i[n+40>>2],h=i[n+44>>2],g=c,S=e+16|0,y=e+8|0,v=(l=d)+i[n+52>>2]|0,(f=(o=c)+i[n+48>>2]|0)>>>0<o>>>0&&(v=v+1|0),u=f,o=p(i[e+8>>2],60),f=Ne(o,o>>31,1e7,0),o=L+v|0,v=u=u+f|0,f=o=u>>>0<f>>>0?o+1|0:o,u=d+i[n+60>>2]|0,(d=c+i[n+56>>2]|0)>>>0<c>>>0&&(u=u+1|0),e=p(i[e+16>>2],60),c=Ne(e,e>>31,1e7,0),e=L+u|0,e=(d=c+d|0)>>>0<c>>>0?e+1|0:e,c=d,e=Ne(e=p(i[((e=(0|o)<(0|e)||(0|o)<=(0|e)&&!(v>>>0>=c>>>0)?((0|h)<(0|e)?1:(0|h)<=(0|e)?m>>>0>=c>>>0?0:1:0)&((0|h)>(0|f)?1:(0|h)>=(0|f)?m>>>0<v>>>0?0:1:0):((0|h)<(0|e)?1:(0|h)<=(0|e)?m>>>0>=c>>>0?0:1:0)|((0|h)>(0|f)?1:(0|h)>=(0|f)?m>>>0<v>>>0?0:1:0))?S:y)>>2],60),e>>31,1e7,0),o=L+l|0,d=o=(c=g+e|0)>>>0<e>>>0?o+1|0:o}e=i[n+40>>2],o=i[n+44>>2]-(d+(e>>>0<c>>>0)|0)|0,c=e-c|0,(0|(e=o))<0||(0|e)<=0&&!(c>>>0>=0)||(V(c,e,n- -64|0),a[r>>1]=i[n+64>>2],a[r+2>>1]=i[n+68>>2],i[r+4>>2]=i[n+72>>2],t=1,a[r+14>>1]=s[n+92>>1]+1,a[r+8>>1]=i[n+76>>2],a[r+10>>1]=i[n+80>>2],a[r+12>>1]=i[n+84>>2],e=i[n+88>>2],a[r+18>>1]=3,a[r+16>>1]=e)}return _=n+96|0,t}(n,e,o+8|0)&&(n=i[o+12>>2],i[e>>2]=i[o+8>>2],i[e+4>>2]=n,i[e+16>>2]=i[o+24>>2],n=i[o+20>>2],i[e+8>>2]=i[o+16>>2],i[e+12>>2]=n,n=e,(0|P(e,t,r,o+28|0))>=0?e=1+((i[o+28>>2]+6|0)%7|0)|0:(i[o+28>>2]=-1,e=6),a[n+14>>1]=e,u=1);return _=o+32|0,u}(p(e,20)+3616|0,0!=(0|c),0!=(0|l),d+8|0),_=d+32|0,0|e},Mathpack_Zero:function(){return+v[375]},Mathpack_One:function(){return+v[374]},Mathpack_Pi:function(){return+v[370]},Mathpack_Div:function(e,t){return+oe(e=+e,t=+t)},Mathpack_Mul:function(e,t){return+ae(e=+e,t=+t)},Mathpack_Sub:function(e,t){return+re(e=+e,t=+t)},Mathpack_Add:function(e,t){return+ee(e=+e,t=+t)},Mathpack_Power:function(e,t){return+function(e,t){var r=0,n=0,o=0,u=0;v[460]=t,f(+t),r=0|c(1),c(0),o=r,i[921]=2147483647&r,t=v[460];e:{if(f(+be(v[371])),r=0|c(1),n=0|c(0),65535==(0|r)&n>>>0<=4294967295|r>>>0<65535)v[460]=e,ve();else if(me(),f(+be(t)),r=0|c(1),n=0|c(0),65535==(0|r)&n>>>0>4294967295|r>>>0>65535||-1==(0|(r=le()))){if(v[460]=e,f(+e),n=0|c(1),c(0),(0|(n=(r=n)>>>16<<16))>=1)ce(),ne(t),ge();else if(!((0|n)>-1)){if(Ce(v[374],t),u=Y(v[460]),v[460]=u,me(),f(+be(u)),65535==(0|(n=0|c(1)))&c(0)>>>0>4294967295|n>>>0>65535)break e;if(2147483647==(0|(n=fe()))|!(1&n))break e;v[460]=e,i[921]=2147483647&r,ce(),ne(t),ge(),(r=i[921])>>>0<65536||(i[921]=-2147483648^r)}}else v[460]=e,function(e){var t,r=0;if(!((t=a[1843])|e))return void(i[922]=4&i[922]?4:64);if(!((0|t)<1)&&10==(0|le())){if(r=v[460],me(),te(r),!s[1843])return void Q(e);v[460]=r}r=1;for(;1&e&&(r=ae(v[460],r)),e>>>=1;)ne(v[460]);v[460]=r}(r);if(o>>>16<<16>>16<=-1){if(1&(o=i[922]))return i[920]=0,i[921]=0,i[922]=-2&o,v[460];Fe(v[374])}return v[460]}return i[922]=8,v[460]}(e=+e,t=+t)},Mathpack_Cond:function(e){var t,r;return f(+(e=+e)),t=0|c(1),c(0),(r=-65536&t)?2146435072==(2146435072&t)?(i[922]=1,0):0|((0|r)<1?-1:1):0},Mathpack_Cond2:function(e,t){t=+t;var r,n,a,i,o=0,u=0,s=0;f(+(e=+e)),o=0|c(1),r=0|c(0),n=o,i=o,f(+t),a=0|c(1),o=0|c(0),s=-1;e:{if(!((0|n)<(0|(u=a))||(s=1,(0|i)>(0|u)))){if(u=0,(0|o)==(0|r))break e;s=r>>>0<o>>>0?-1:1}o=s,u=(a&n)>-1?o:0-o|0}return 0|u},Mathpack_TakeMathError:function(){var e;return e=i[922],i[922]=0,0|e},Mathpack_Trunc:function(e){return+J(e=+e)},Mathpack_Ceil:function(e){return e=+e,v[460]=e,function(){var e=0,t=0,r=0;e:{if(r=i[920],e=i[921],t=-65536&e){if(2146435072==(2146435072&e))return i[922]=1,void me();if((0|t)>0)break e}return void me()}me(),(0|r)==i[920]&&i[921]==(0|e)||$(1)}(),+v[460]},Mathpack_Floor:function(e){return e=+e,v[460]=e,Z(),+v[460]},Mathpack_Abs:function(e){var t=0;return f(+(e=+e)),t=0|c(1),t&=2147483647,l(0,0|(0|c(0))),l(1,0|t),+d()},Mathpack_Neg:function(e){var t,r,n,a;return f(+(e=+e)),n=-2147483648^(t=0|c(1)),l(0,0|(r=0|c(0))),l(1,0|n),a=+d(),+(65535==(0|t)&r>>>0>4294967295|t>>>0>65535?a:e)},Mathpack_Float:function(e){return+((e|=0)>>>0)},Mathpack_SFloat:function(e){return+(0|(e|=0))},Mathpack_Fix:function(e){return 0|de(e=+e)},Mathpack_LFix:function(e){return 0|he(e=+e)},Mathpack_SFix:function(e){return e=+e,v[460]=e,0|z()},Mathpack_Round:function(e,t){return+function(e,t){var r,o=0,u=0,l=0,d=0;_=r=_+-64|0,i[r+56>>2]=0,a[r+46>>1]=0,a[r+48>>1]=0,v[460]=e,f(+e),o=0|c(1),c(0);e:if(u=-65536&o)if(2146435072!=(2146435072&o)){(0|u)>0||(d=32768,o>>>0<65536||(i[921]=-2147483648^o,e=v[460])),ye(e,r+56|0,r+16|0,15),s[r+58>>1]||(a[r+56>>1]=1),v[460]=t,o=(0|(o=z()))<0?100:o;t:{if(u=i[921],l=-65536&u)if(2146435072!=(2146435072&u)){if(!((0|l)>0)){if((o=i[921])>>>0>=65536&&(i[921]=-2147483648^o),(0|(o=z()))<=-1)break t;o=0-o|0}}else i[922]=1;u=a[r+56>>1],l=o+u|0,o=a[r+58>>1],(0|l)<(0|o)&&(i[r+12>>2]=o,i[r+8>>2]=u,X(r+16|0,r+8|0,r+12|0,l),o=i[r+12>>2],a[r+58>>1]=o,u=i[r+8>>2],a[r+56>>1]=u),n[r+46|0]=o,a[r+48>>1]=u+16384&32767|d,Se(3100,3680,r+16|0),e=v[460];break e}e=v[375]}else i[922]=1;return _=r- -64|0,e}(e=+e,t=+t)},Mathpack_RoundUp:function(e,t){return+function(e,t){var r=0,n=0,a=0,o=0,u=0;f(+e),r=0|c(1),c(0);(n=-65536&r)&&(2146435072!=(2146435072&r)?u=(0|n)<1?-1:1:i[922]=1);if(a=B(e,t),v[460]=e,v[460]=Y(e),te(a),(r=i[921])>>>0>=65536){if(2146435072==(2146435072&r))return i[922]=1,a;if(r=(0|(r=de(t)<<16))<0?309:r>>16,f(+t),n=0|c(1),c(0),(o=-65536&n)&&(2146435072!=(2146435072&n)?r=(0|o)<1?0-r|0:r:i[922]=1),(0|r)<=-309)return q(8),0;Q(0-r|0),(0|u)>-1||(r=i[921])>>>0<65536||(i[921]=-2147483648^r),$(a),a=v[460]}return a}(e=+e,t=+t)},Mathpack_RoundDown:function(e,t){var r;return f(+(e=B(e=+e,t=+t))),r=0|c(1),c(0),2146435072==(2146435072&r)&&(i[922]=1,e=-1),+e},Mathpack_TenTo:function(e){return Q(e|=0),+v[460]},Mathpack_Compare:function(e,t){return+(0|function(e,t){var r,n=0,a=0,o=0,u=0,s=0;_=r=_-16|0,v[r+8>>3]=e,v[r>>3]=t,f(+e),n=0|c(1),a=0|c(0),o=n,f(+t),n=0|c(1),u=0|c(0),s=n;e:{if((0|a)!=(0|u)||(0|o)!=(0|n)){if((s+2097152&2146435072)-(2146435072&o)>>>0<=5242879&&(e=Y(e),v[r+8>>3]=e,f(+e),n=0|c(1),c(0),o=n,e=Y(t),v[r>>3]=e,f(+e),n=0|c(1),c(0),s=n),n=1,o=i[(u=(a=(s&o)>-1)?r+8|0:r)+4>>2],s=i[(a=a?r:r+8|0)+4>>2],(0|o)>(0|s))break e;if((0|o)<(0|s)){n=-1;break e}if(u=i[u>>2],a=i[a>>2],u>>>0>a>>>0)break e;if(n=-1,u>>>0<a>>>0)break e}n=0}return _=r+16|0,n}(e=+e,t=+t))},Mathpack_GetExp32:function(e){var t;return f(+(e=+e)),t=0|c(1),c(0),2146435072&t},Mathpack_Equal:function(e,t){t=+t;var r,n,a=0;return f(+(e=+e)),a=0|c(1),r=0|c(0),f(+t),n=0|c(1),0|(a=(0|r)==(0|c(0))?(0|a)==(0|n):0)},Mathpack_ViewRound:function(e){var t;return f(+(e=+e)),t=0|c(1),c(0),2146435072==(2146435072&t)?(i[922]=1,-1):+Y(e)},Mathpack_Sqrt:function(e){return e=+e,v[460]=e,ve(),+v[460]},Mathpack_Exp:function(e){return e=+e,v[460]=e,ge(),+v[460]},Mathpack_Ln:function(e){return e=+e,v[460]=e,ce(),+v[460]},Mathpack_Log:function(e){return e=+e,v[460]=e,function(){var e,t;e=+N(+v[460]),v[460]=e,f(+e),t=0|c(1),c(0),2146435072==(2146435072&t)&&(i[922]=8)}(),+v[460]},Mathpack_Sin:function(e){return e=+e,v[460]=e,function(){var e=0,t=0;f(+(t=v[460])),e=0|c(1),c(0),1101004799==(0|(e&=2145386496))&!0|e>>>0<1101004799&&(t=+T(+t),v[460]=t,f(+t),e=0|c(1),c(0),2146435072!=(2146435072&e))||(i[922]=8)}(),+v[460]},Mathpack_Cos:function(e){return e=+e,v[460]=e,function(){var e=0,t=0;f(+(t=v[460])),e=0|c(1),c(0),1101004799==(0|(e&=2145386496))&!0|e>>>0<1101004799&&(t=+I(+t),v[460]=t,f(+t),e=0|c(1),c(0),2146435072!=(2146435072&e))||(i[922]=8)}(),+v[460]},Mathpack_Tan:function(e){return e=+e,v[460]=e,function(){var e=0,t=0,r=0;r=8,f(+(t=v[460])),e=0|c(1),c(0);1101004799==(0|(e&=2145386496))&!0|e>>>0<1101004799&&(t=+O(+t),v[460]=t,r=4,f(+t),e=0|c(1),c(0),2146435072!=(2146435072&e))||(i[922]=r)}(),+v[460]},Mathpack_Asin:function(e){return+W(e=+e,0)},Mathpack_Acos:function(e){return+W(e=+e,1)},Mathpack_Atan:function(e){return e=+e,v[460]=e,pe(),+v[460]},Mathpack_Atan2:function(e,t){return+function(e,t){var r=0,n=0,a=0,o=0,u=0,s=0;v[460]=e;e:{if(f(+e),r=0|c(1),c(0),r>>>0>=65536){if(2146435072!=(2146435072&r))break e;i[922]=1}v[460]=t;t:{if(f(+t),r=0|c(1),c(0),n=-65536&r){if(2146435072!=(2146435072&r))break t;i[922]=1}return q(4),0}return se((0|n)<1?-1:1),ne(v[370]),ie(v[372]),v[460]}e:if((0|r)<=-1){f(+t),r=0|c(1),c(0);t:{if(n=-65536&r)if(2146435072!=(2146435072&r)){if((0|n)<1)break t}else i[922]=1;a=v[370];break e}f(+(a=v[370])),r=0|c(1),n=0|c(0),o=-2147483648^r,l(0,0|n),l(1,0|o),u=+d(),s=a,a=65535==(0|r)&n>>>0>4294967295|r>>>0>65535?u:s}else a=v[375];return Ce(t,e),pe(),$(a),v[460]}(e=+e,t=+t)},Mathpack_FormatGeneral:function(e,t){t|=0;var r,n,o,u=0,l=0;return f(+(e=+e)),r=0|c(1),o=0|c(0),2146435072==(2146435072&r)?(i[922]=1,-1):(v[460]=e,u=3104,(n=-65536&(l=r))&&(2146435072!=(2146435072&l)?(u=3104,(0|n)>0||(l>>>0>=65536&&(i[921]=-2147483648^l),u=3104,!o&-2147483648==(0|r)||(a[1552]=45,u=3106))):(i[922]=1,u=3104)),l=u,t=(0|t)<255?t:255,t=function(e,t,r,n){var o;_=o=_-16|0,e=0|Ie[i[i[e>>2]+8>>2]](e),i[o+8>>2]=0;e:if(r<<1>>>0<=33){if((0|r)<1)break e;a[t>>1]=0}else ye(v[460],o+8|0,t,15),t=function(e,t,r,n,o,u){var c,l,d,f=0,h=0,v=0,m=0,g=0;_=l=_-16|0,c=(t<<1)+e|0,d=l+12|0;t:{r:{n:{a:if(!(v=(0|r)<5&(h=o?n:1)+3>>>0<8)){i:if(!((0|h)>(0|r))){if((0|(n=r+h|0))>=3){if((0|r)<5|(0|h)>-4)break a;if((n+-2|0)<(0|o))break i;break a}if((0|r)<5)break a}if(m=1,n=1,(0|r)<7)break n;n=r-(h+97>>>0>196?6:5)|0;break n}(1!=(0|r)||(n=0,h))&&(n=r-((0|h)<(0|r)?(0|h)<1?2-h|0:1:0)|0)}n:{if((0|n)<(0|o)){f=1,o=0;a:if(!((0|t)<1)){i:{o:{if(!n){if(s[e>>1]>52)break o;break a}if((0|n)<1|(0|n)>=(0|t))break a;if(s[(n<<1)+e>>1]<=52)break i;for(;;){if(g=s[(f=((o=n+-1|0)<<1)+e|0)>>1]+1|0,a[f>>1]=g,58!=(65535&g))break i;if(n=o,!o)break}}a[e>>1]=49,o=1,f=h+1|0;break a}for(;(0|(o=n))>=2&&48==s[((n=o+-1|0)<<1)+e>>1];);f=h}if((-1^v)&(0|f)>(0|r)|m)break n;break r}if(f=h,!m)break r}if(i[d>>2]=32768,r=e+2|0,(0|o)<2||(n=r+(o<<1)|0)>>>0>=c>>>0?n=r:(o=o+-1|0,i[d>>2]=32768|o,e=e+4|0,(t<<1)-4>>1>>>0<o>>>0&&F(),x(e,r,o<<1),a[r>>1]=u),n>>>0<c>>>0&&(a[n>>1]=69,n=n+2|0),n>>>0>=c>>>0?o=n:(o=n+2|0,(0|f)<=0?(a[n>>1]=45,f=1-f|0):(a[n>>1]=43,f=f+-1|0)),(0|f)<100|o>>>0>=c>>>0||(e=(f>>>0)/100|0,a[o>>1]=e+48,f=f-p(e,100)|0,o=o+2|0),o>>>0<c>>>0&&(a[o>>1]=48+((0|f)/10|0),o=o+2|0),o>>>0>=c>>>0)break t;a[o>>1]=48+((0|f)%10|0),o=o+2|0;break t}if((0|o)<0|(0|o)>(0|f))if(r=o-f|0,i[d>>2]=r,(0|f)>=1){if(!((r=(n=((v=(r=(h=(0|f)>(0|t)?t:f)<<1)+e|0)+(o<<1)|0)-r|0)+-2|0)>>>0<e>>>0|n>>>0>=c>>>0))for(;a[n>>1]=s[r>>1],n=n+-2|0,(r=r+-2|0)>>>0>=v>>>0;);(0|f)<(0|t)&&(a[v>>1]=u),o=v+(((0|(e=c-v>>1))>(0|(t=o-h|0))?t+1|0:e)<<1)|0}else{if(!((n=2+((e-(f<<1)|0)+(o<<1)|0)|0)>>>0>=c>>>0||(o=((o<<1)+e|0)-2|0)>>>0<e>>>0))for(;a[n>>1]=s[o>>1],n=n+-2|0,(o=o+-2|0)>>>0>=e>>>0;);if((0|t)>=1&&(a[e>>1]=48,e=e+2|0),e>>>0<c>>>0&&(a[e>>1]=u,e=e+2|0),n=c-e>>1,f&&(t=(0|n)<(0|(t=0-f|0))?n:t))for(o=0;a[(o<<1)+e>>1]=48,(0|t)!=(0|(o=o+1|0)););o=(((0|n)<(0|r)?n:r)<<1)+e|0}else{if(r=(n=(0|f)>(0|t)?t:f)-o|0)for(t=(o<<1)+e|0,o=0;a[t+(o<<1)>>1]=48,(0|r)!=(0|(o=o+1|0)););o=(n<<1)+e|0}}return _=l+16|0,o}(t,r,n,a[o+8>>1],a[o+10>>1],e);return _=o+16|0,t}(i[256],l,3614-l>>1,(0|t)>0?t:0),i[920]=0,i[921]=0,t-3104>>1)},Mathpack_FormatGetExponent:function(){return i[924]},Mathpack_FormatGetSign:function(){return i[925]},Mathpack_FormatFixed:function(e,t,r){t|=0,r|=0;var n,o=0,u=0;return _=n=_+-64|0,f(+(e=+e)),o=0|c(1),c(0),2146435072!=(2146435072&o)?(i[n+56>>2]=0,a[n+46>>1]=0,a[n+48>>1]=0,ye(e,n+56|0,n+16|0,(o=t+r|0)>>>0<15?o:15),u=a[n+56>>1],o=a[n+58>>1],i[n+8>>2]=o,t=t+u|0,i[n+12>>2]=t,(0|(t=t+r|0))<(0|o)&&(X(n+16|0,n+12|0,n+8|0,t),o=i[n+8>>2]),o?((0|(r=r+(t=i[n+12>>2])|0))<(0|o)&&(i[n+8>>2]=r,o=r),(0|o)>-1||(i[922]=1)):(o=0,i[n+12>>2]=0,t=0),i[924]=t,i[925]=s[n+48>>1]>>>15^1,r=o,o>>>0>=256&&(F(),r=i[n+8>>2]),x(3104,n+16|0,o<<1)):(i[922]=1,r=-1),_=n- -64|0,0|r},Mathpack_FormatScientific:function(e,t,r){t|=0,r|=0;var n,o=0,u=0,l=0;if(_=n=_+-64|0,f(+(e=+e)),u=0|c(1),c(0),2146435072!=(2146435072&u)){if(i[n+56>>2]=0,a[n+46>>1]=0,a[n+48>>1]=0,ye(e,n+56|0,n+16|0,15),l=a[n+56>>1],i[n+12>>2]=l,u=a[n+58>>1],i[n+8>>2]=u,(0|(o=t))>=2&&(o=(0|l)%(0|t)|0,o=((0|l)<1?t:o?0:t)+o|0),!((0|(o=r+o|0))>=(0|u))){for(X(n+16|0,n+12|0,n+8|0,o),o=(0|o)<(0|(u=i[n+8>>2]))?o:u;u=o,(0|o)>=1&&48==s[(n+16|0)+((o=u+-1|0)<<1)>>1];);i[n+8>>2]=u,(0|t)<2||(0|(o=i[n+12>>2]))!=(0|l)&&((((l=r)+(r=(0|o)%(0|t)|0)|0)+((0|o)<1?t:r?0:t)|0)>=(0|u)||(F(),u=i[n+8>>2]))}(0|u)<=-1&&(i[922]=1),i[924]=i[n+12>>2],i[925]=s[n+48>>1]>>>15^1,(o=u)>>>0>=256&&(F(),o=i[n+8>>2]),x(3104,n+16|0,u<<1)}else i[922]=1,o=-1;return _=n- -64|0,0|o},Mathpack_Pack:function(e,t,r){var o;return e|=0,t|=0,r|=0,_=o=_-48|0,n[o+39|0]=0,x(o+8|0,3104,(r=(0|r)<15?r:15)<<1),a[o+40>>1]=t+16384&32767|!e<<15,n[o+38|0]=r,i[o>>2]=0,i[o+4>>2]=0,Se(i[256],o,o+8|0)&&(i[922]=1),_=o+48|0,+v[o>>3]},_start:U,__errno_location:function(){return 3712},setThrew:function(e,t){e|=0,t|=0,i[926]||(i[927]=t,i[926]=e)},stackSave:function(){return 0|_},stackAlloc:function(e){return _=e=_-(e|=0)&-16,0|e},stackRestore:function(e){_=e|=0},__growWasmMemory:function(e){return 0,0|F()}}}({Math:n.Math,Int8Array:Int8Array,Uint8Array:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array,NaN:NaN,Infinity:1/0},{abort:function(){throw new Error("abort")},Base_LocaleIsNumeral:a.Base_LocaleIsNumeral,Base_LocaleGetOrdinal:a.Base_LocaleGetOrdinal,Base_LocaleDecimalSeparator:a.Base_LocaleDecimalSeparator,Math_log10:a.Math_log10,Math_log:a.Math_log,Math_sqrt:a.Math_sqrt,Math_sin:a.Math_sin,Math_cos:a.Math_cos,Math_tan:a.Math_tan,Math_atan:a.Math_atan,Math_exp:a.Math_exp,proc_exit:i.proc_exit},v),g=m.memory;t.memory=g;var S=m.Base_StrBuf;t.Base_StrBuf=S;var y=m.Base_StrBufSize;t.Base_StrBufSize=y;var b=m.Dtr_DaysPerMonth;t.Dtr_DaysPerMonth=b;var E=m.Dtr_FromNum;t.Dtr_FromNum=E;var F=m.Dtr_Yr;t.Dtr_Yr=F;var C=m.Dtr_Mon;t.Dtr_Mon=C;var R=m.Dtr_DOM;t.Dtr_DOM=R;var k=m.Dtr_Hour;t.Dtr_Hour=k;var N=m.Dtr_Min;t.Dtr_Min=N;var A=m.Dtr_Sec;t.Dtr_Sec=A;var T=m.Dtr_Wdy;t.Dtr_Wdy=T;var I=m.Dtr_FracSec;t.Dtr_FracSec=I;var O=m.Dtr_Rounding;t.Dtr_Rounding=O;var M=m.Dtr_Write;t.Dtr_Write=M;var w=m.Dtr_ToNum;t.Dtr_ToNum=w;var D=m.Dtr_ToNumWithDuration;t.Dtr_ToNumWithDuration=D;var _=m.Dtr_Days;t.Dtr_Days=_;var L=m.Dtr_ToDays;t.Dtr_ToDays=L;var U=m.Dtr_ToTime;t.Dtr_ToTime=U;var x=m.Dtr_UtcToLocal;t.Dtr_UtcToLocal=x;var B=m.Mathpack_Zero;t.Mathpack_Zero=B;var W=m.Mathpack_One;t.Mathpack_One=W;var P=m.Mathpack_Pi;t.Mathpack_Pi=P;var V=m.Mathpack_Div;t.Mathpack_Div=V;var G=m.Mathpack_Mul;t.Mathpack_Mul=G;var H=m.Mathpack_Sub;t.Mathpack_Sub=H;var j=m.Mathpack_Add;t.Mathpack_Add=j;var K=m.Mathpack_Power;t.Mathpack_Power=K;var Y=m.Mathpack_Cond;t.Mathpack_Cond=Y;var q=m.Mathpack_Cond2;t.Mathpack_Cond2=q;var z=m.Mathpack_TakeMathError;t.Mathpack_TakeMathError=z;var J=m.Mathpack_Trunc;t.Mathpack_Trunc=J;var Q=m.Mathpack_Ceil;t.Mathpack_Ceil=Q;var X=m.Mathpack_Floor;t.Mathpack_Floor=X;var Z=m.Mathpack_Abs;t.Mathpack_Abs=Z;var $=m.Mathpack_Neg;t.Mathpack_Neg=$;var ee=m.Mathpack_Float;t.Mathpack_Float=ee;var te=m.Mathpack_SFloat;t.Mathpack_SFloat=te;var re=m.Mathpack_Fix;t.Mathpack_Fix=re;var ne=m.Mathpack_LFix;t.Mathpack_LFix=ne;var ae=m.Mathpack_SFix;t.Mathpack_SFix=ae;var ie=m.Mathpack_Round;t.Mathpack_Round=ie;var oe=m.Mathpack_RoundUp;t.Mathpack_RoundUp=oe;var ue=m.Mathpack_RoundDown;t.Mathpack_RoundDown=ue;var se=m.Mathpack_TenTo;t.Mathpack_TenTo=se;var ce=m.Mathpack_Compare;t.Mathpack_Compare=ce;var le=m.Mathpack_GetExp32;t.Mathpack_GetExp32=le;var de=m.Mathpack_Equal;t.Mathpack_Equal=de;var fe=m.Mathpack_ViewRound;t.Mathpack_ViewRound=fe;var he=m.Mathpack_Sqrt;t.Mathpack_Sqrt=he;var ve=m.Mathpack_Exp;t.Mathpack_Exp=ve;var pe=m.Mathpack_Ln;t.Mathpack_Ln=pe;var me=m.Mathpack_Log;t.Mathpack_Log=me;var ge=m.Mathpack_Sin;t.Mathpack_Sin=ge;var Se=m.Mathpack_Cos;t.Mathpack_Cos=Se;var ye=m.Mathpack_Tan;t.Mathpack_Tan=ye;var be=m.Mathpack_Asin;t.Mathpack_Asin=be;var Ee=m.Mathpack_Acos;t.Mathpack_Acos=Ee;var Fe=m.Mathpack_Atan;t.Mathpack_Atan=Fe;var Ce=m.Mathpack_Atan2;t.Mathpack_Atan2=Ce;var Re=m.Mathpack_FormatGeneral;t.Mathpack_FormatGeneral=Re;var ke=m.Mathpack_FormatGetExponent;t.Mathpack_FormatGetExponent=ke;var Ne=m.Mathpack_FormatGetSign;t.Mathpack_FormatGetSign=Ne;var Ae=m.Mathpack_FormatFixed;t.Mathpack_FormatFixed=Ae;var Te=m.Mathpack_FormatScientific;t.Mathpack_FormatScientific=Te;var Ie=m.Mathpack_Pack;t.Mathpack_Pack=Ie;var Oe=m._start;t._start=Oe;var Me=m.__errno_location;t.__errno_location=Me;var we=m.setThrew;t.setThrew=we;var De=m.stackSave;t.stackSave=De;var _e=m.stackAlloc;t.stackAlloc=_e;var Le=m.stackRestore;t.stackRestore=Le;var Ue=m.__growWasmMemory;t.__growWasmMemory=Ue},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,a,i=r(7).createPerf();t.watchdog=(n=1/0,(a=function(e){if(void 0===e&&(e=""),i.now()>n)throw new Error("Time limit exceeded with message: "+e)}).arm=function(e){n=i.now()+e},a)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(4),a=void 0;t.setLocale=function(e){a=e};t.Base_LocaleIsNumeral=function(e){return a.isNumeral(e)?1:0},t.Base_LocaleGetOrdinal=function(e){return a.getOrdinal(e)},t.Base_LocaleDecimalSeparator=function(){var e=a.decimalSeparator;return 0===e.length?46:e.charCodeAt(0)},t.fastMin=function(e,t){return e<t?e:t},t.pxcharToStr=function(e,t){for(var r=new Uint16Array(n.memory.buffer),a="",i=0;i<t;i+=1)a+=String.fromCharCode(r[e+(i<<1)>>1]);return a},t.strToPxchar=function(e,t){for(var r=new Uint16Array(n.memory.buffer),a=0;a<t.length;a+=1)r[e+(a<<1)>>1]=t.charCodeAt(a)},t.isSupported=function(){var e=new ArrayBuffer(2);return new Uint16Array(e)[0]=1,1===new Uint8Array(e)[0]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function n(){return"undefined"!=typeof process?{now:function(){var e=process.hrtime();return(1e9*e[0]+e[1])/1e6}}:"undefined"!=typeof performance?performance:Date}t.createPerf=n;var a=function(){function e(e){this.perf=n(),this.name=e,this.start()}return e.prototype.start=function(){this.startTimeMS=this.perf.now(),this.splitTimeMS=this.startTimeMS},e.prototype.split=function(e){var t=this.perf.now(),r=t-this.splitTimeMS;console.warn("timer: "+this.name+" @ "+e+" : = "+this.roundMe(r)+" (total = "+this.roundMe(t-this.startTimeMS)+")"),this.splitTimeMS=t},e.prototype.elapsedTime=function(){return this.perf.now()-this.startTimeMS},e.prototype.roundMe=function(e){return Math.round(100*e)/100},e}();t.Timer=a},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0});var a,i=r(4),o=r(6);function u(e){return{num:e}}!function(e){e[e.None=0]="None",e[e.Over=1]="Over",e[e.Under=2]="Under",e[e.DivBy0=4]="DivBy0",e[e.Trans=8]="Trans",e[e._NA=16]="_NA",e[e._Val=32]="_Val",e[e._Num=64]="_Num"}(a=t.MathErrorNum||(t.MathErrorNum={}));var s=((n={})[a.Over]=u(a.Over),n[a.Under]=u(a.Under),n[a.DivBy0]=u(a.DivBy0),n[a.Trans]=u(a.Trans),n);function c(e){var t;return null!==(t=s[e])&&void 0!==t?t:u(e)}function l(e){return function(t){var r=e(t),n=i.Mathpack_TakeMathError();return n===a.None?r:c(n)}}function d(e){return function(t,r){var n=e(t,r),o=i.Mathpack_TakeMathError();return o===a.None?n:c(o)}}t.mathError=c,t.zero=i.Mathpack_Zero,t.one=i.Mathpack_One,t.pi=i.Mathpack_Pi,t.exp32=i.Mathpack_GetExp32,t.equal=function(e,t){return 0!==i.Mathpack_Equal(e,t)},t.trunc=i.Mathpack_Trunc,t.ceil=l(i.Mathpack_Ceil),t.floor=l(i.Mathpack_Floor),t.abs=i.Mathpack_Abs,t.neg=i.Mathpack_Neg,t.float=function(e){return e<0?i.Mathpack_SFloat(e):i.Mathpack_Float(e)},t.fix=function(e){return i.Mathpack_Fix(e)>>>0},t.lfix=i.Mathpack_LFix,t.sfix=l(i.Mathpack_SFix),t.round=d(i.Mathpack_Round),t.roundUp=d(i.Mathpack_RoundUp),t.roundDown=d(i.Mathpack_RoundDown),t.tenTo=function(e){if(e<-1e3)return 0;if(e>1e3)return c(a.Over);if(!isFinite(e))return c(a.Over);var t=i.Mathpack_TenTo(e),r=i.Mathpack_TakeMathError();return r===a.None?t:c(r)},t.compare=i.Mathpack_Compare,t.div=d(i.Mathpack_Div),t.mul=d(i.Mathpack_Mul),t.sub=d(i.Mathpack_Sub),t.add=d(i.Mathpack_Add),t.power=d(i.Mathpack_Power),t.cond=function(e){var t=i.Mathpack_Cond(e),r=i.Mathpack_TakeMathError();return r===a.None?t:c(r)},t.cond2=i.Mathpack_Cond2,t.viewRound=l(i.Mathpack_ViewRound),t.sqrt=l(i.Mathpack_Sqrt),t.exp=l(i.Mathpack_Exp),t.ln=l(i.Mathpack_Ln),t.log=l(i.Mathpack_Log),t.sin=l(i.Mathpack_Sin),t.cos=l(i.Mathpack_Cos),t.tan=l(i.Mathpack_Tan),t.asin=l(i.Mathpack_Asin),t.acos=l(i.Mathpack_Acos),t.atan=l(i.Mathpack_Atan),t.atan2=d(i.Mathpack_Atan2),t.formatGeneral=function(e,t,r){try{o.setLocale(e);var n=i.Mathpack_FormatGeneral(t,r);return n<0?c(i.Mathpack_TakeMathError()):o.pxcharToStr(i.Base_StrBuf(),n)}finally{o.setLocale(void 0)}},t.formatFixed=function(e,t,r){var n=i.Mathpack_FormatFixed(e,t,r);if(n<0)return i.Mathpack_TakeMathError();var a=o.pxcharToStr(i.Base_StrBuf(),n),u=i.Mathpack_FormatGetExponent();return{sign:0!==i.Mathpack_FormatGetSign(),mantissa:a,exponent:u}},t.formatScientific=function(e,t,r){var n=i.Mathpack_FormatScientific(e,t,r);if(n<0)return i.Mathpack_TakeMathError();var a=o.pxcharToStr(i.Base_StrBuf(),n),u=i.Mathpack_FormatGetExponent();return{sign:0!==i.Mathpack_FormatGetSign(),mantissa:a,exponent:u}},t.pack=function(e,t,r,n){try{o.setLocale(e);var u=o.fastMin(n.length,i.Base_StrBufSize());o.strToPxchar(i.Base_StrBuf(),n.substring(0,u));var s=i.Mathpack_Pack(!!t,r,u),l=i.Mathpack_TakeMathError();return l!==a.None?c(l):isNaN(s)?c(a.Over):s}finally{o.setLocale(void 0)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5),a=function(){function e(){}return e.column_name_to_index=function(e){if(1===e.length)return e[0].charCodeAt(0)-"A".charCodeAt(0)+1;for(var t=0,r=0,n=e.split("");r<n.length;r++){t*=26,t+=n[r].charCodeAt(0)-"A".charCodeAt(0)+1}return t},e.column_index_to_name=function(e){for(var t="";e>0;)t+=String.fromCharCode((e-1)%26+65),e=Math.floor((e-1)/26);return t.split("").reverse().join("")},e.cell_dependency=function(t,r,a){n.watchdog("wd0x1a9bd3");var i;if(i=e.cell_both_absolute.exec(t)){var o=e.column_name_to_index(i[1]),u=Number(i[2]);return i[2][0]>=""&&(u=Number(i[2].charCodeAt(0)-16384)),[o,u,0]}if(n.watchdog("wd0xa26bda"),i=e.cell_col_absolute.exec(t)){o=e.column_name_to_index(i[1]),u=Number(i[2]);return i[2][0]>=""&&(u=Number(i[2].charCodeAt(0)-16384)),[o,u-a,0]}if(n.watchdog("wd0x2a23e1"),i=e.cell_row_absolute.exec(t)){o=e.column_name_to_index(i[1]),u=Number(i[2]);return i[2][0]>=""&&(u=Number(i[2].charCodeAt(0)-16384)),[o-r,u,0]}if(n.watchdog("wd0x3ebc91"),i=e.cell_both_relative.exec(t)){o=e.column_name_to_index(i[1]),u=Number(i[2]);return i[2][0]>=""&&(u=Number(i[2].charCodeAt(0)-16384)),[o-r,u-a,0]}throw new Error("We should never get here.")},e.toR1C1=function(t,r,n){void 0===n&&(n=!1);var a=e.cell_dependency(t,0,0),i=e.cell_dependency(r,0,0),o="R",u="C";n&&(o="",u="");var s=[];i.forEach((function(e,t,r){s.push(e-a[t])}));var c="";return e.cell_both_absolute.exec(r)?c=o+i[1]+u+i[0]:e.cell_col_absolute.exec(r)?(0===s[1]?c+=o:c+=o+"["+s[1]+"]",c+=u+i[0]):e.cell_row_absolute.exec(r)?(0===s[0]?c+=u:c+=u+"["+s[0]+"]",c=o+i[1]+c):(0===s[1]?c+=o:c+=o+"["+s[1]+"]",0===s[0]?c+=u:c+=u+"["+s[0]+"]"),c},e.formulaToR1C1=function(t,r,n){for(var a,i=t.slice(),o=e.column_index_to_name(r)+n;a=e.range_pair.exec(i);)if(a){var u=a[1];a[2];i=i.replace(a[0],e.toR1C1(o,a[1],!0)+":"+e.toR1C1(o,a[2],!0))}for(var s=null;s=e.single_dep.exec(i);)if(s){u=s[1];i=i.replace(s[0],e.toR1C1(o,u,!0))}return i=(i=i.replace(//g,"R")).replace(//g,"C")},e.extract_sheet_cell=function(t){n.watchdog("wd0x012630");var r=e.sheet_plus_cell.exec(t);return r?[r[1],r[2],r[2]]:["","",""]},e.all_cell_dependencies=function(t,r,a,i){void 0===i&&(i=!0),n.watchdog("wd0x2f82fe");var o=null,u=[];if("string"!=typeof t)return null;for(t=(t=(t=(t=(t=(t=(t=t.replace(this.formulas_with_numbers,"_")).replace(this.formulas_with_quoted_sheetnames_2,"_")).replace(this.formulas_with_quoted_sheetnames_1,"_")).replace(this.formulas_with_unquoted_sheetnames_2,"_")).replace(this.formulas_with_unquoted_sheetnames_1,"_")).replace(this.formulas_with_unquoted_sheetnames_1,"_")).replace(this.formulas_with_structured_references,"_");o=e.range_pair.exec(t);)if(n.watchdog("wd0x784918"),o){for(var s=o[1],c=e.cell_dependency(s,r,a),l=o[2],d=e.cell_dependency(l,r,a),f=d[0]-c[0]+1,h=d[1]-c[1]+1,v=0;v<f;v++)for(var p=0;p<h;p++)u.push([v+c[0],p+c[1],0]);t=t.replace(o[0],"_")}for(var m=null;m=e.single_dep.exec(t);)if(n.watchdog("wd0x0fb232"),m){s=m[1];var g=e.cell_dependency(s,r,a);u.push(g),t=t.replace(m[0],"_")}if(i)for(var S=null;S=e.number_dep.exec(t);)n.watchdog("wd0xd82ed1"),S&&(u.push([0,0,1]),t=t.replace(S[0],"_"));return u},e.numeric_constants=function(t){var r=[];if("string"!=typeof(t=t.slice()))return r;t=(t=(t=(t=(t=(t=(t=t.replace(this.formulas_with_numbers,"_")).replace(this.formulas_with_quoted_sheetnames_2,"_")).replace(this.formulas_with_quoted_sheetnames_1,"_")).replace(this.formulas_with_unquoted_sheetnames_2,"_")).replace(this.formulas_with_unquoted_sheetnames_1,"_")).replace(this.formulas_with_unquoted_sheetnames_1,"_")).replace(this.formulas_with_structured_references,"_");for(var n=null;n=e.range_pair.exec(t);)n&&(t=t.replace(n[0],"_"));for(var a=null;a=e.single_dep.exec(t);)a&&(t=t.replace(a[0],"_"));for(var i=null;i=e.number_dep.exec(t);)i&&(r.push(parseFloat(i)),t=t.replace(i[0],"_"));return r},e.baseVector=function(){return[0,0,0]},e.all_dependencies=function(t,r,a,i,o){n.watchdog("wd0x961028");var u=[];if(t>=o.length||r>=o[0].length||t<0||r<0)return[];var s=o[t][r];return s.length>1&&"="===s[0]&&(u=e.all_cell_dependencies(s,i,a)),u},e.generate_all_references=function(t,r,a){n.watchdog("wd0x6a6002");for(var i={},o=0;o<t.length;o++)for(var u=t[o],s=0;s<u.length;s++){n.watchdog("wd0x93d412");var c=u[s];if("="===c[0])for(var l=0,d=e.all_cell_dependencies(c,0,0);l<d.length;l++){var f=d[l];if(n.watchdog("wd0x8a466e"),0===f[0]&&0===f[1]&&0!==f[2]);else{var h=f[0]-r-1,v=f[1]-a-1,p=!1;if(v>=t.length||h>=t[0].length||h<0||v<0)p=!0;else{var m=t[v][h];void 0!==m&&"="!==m[0]&&(p=!0)}p&&(i[f.join(",")]=!0)}}}return i},e.general_re="\\$?[A-Z][A-Z]?\\$?[\\d\\u2000-\\u6000]+",e.sheet_re="[^\\!]+",e.sheet_plus_cell=new RegExp("("+e.sheet_re+")\\!("+e.general_re+")"),e.sheet_plus_range=new RegExp("("+e.sheet_re+")\\!("+e.general_re+"):("+e.general_re+")"),e.single_dep=new RegExp("("+e.general_re+")"),e.range_pair=new RegExp("("+e.general_re+"):("+e.general_re+")","g"),e.number_dep=new RegExp("([0-9]+\\.?[0-9]*)"),e.cell_both_relative=new RegExp("[^\\$A-Z]?([A-Z][A-Z]?)([\\d\\u2000-\\u6000]+)"),e.cell_col_absolute=new RegExp("\\$([A-Z][A-Z]?)([\\d\\u2000-\\u6000]+)"),e.cell_row_absolute=new RegExp("[^\\$A-Z]?([A-Z][A-Z]?)\\$([\\d\\u2000-\\u6000]+)"),e.cell_both_absolute=new RegExp("\\$([A-Z][A-Z]?)\\$([\\d\\u2000-\\u6000]+)"),e.formulas_with_numbers=new RegExp("/ATAN2|BIN2DEC|BIN2HEX|BIN2OCT|DAYS360|DEC2BIN|DEC2HEX|DEC2OCT|HEX2BIN|HEX2DEC|HEX2OCT|IMLOG2|IMLOG10|LOG10|OCT2BIN|OCT2DEC|OCT2HEX|SUNX2MY2|SUMX2PY2|SUMXMY2|T.DIST.2T|T.INV.2T/","g"),e.formulas_with_quoted_sheetnames_1=new RegExp("'[^']*'!\\$?[A-Z][A-Z]?\\$?\\d+","g"),e.formulas_with_quoted_sheetnames_2=new RegExp("'[^']*'!\\$?[A-Z][A-Z]?\\$?\\d+:\\$?[A-Z][A-Z]?\\$?\\d+","g"),e.formulas_with_unquoted_sheetnames_1=new RegExp("[A-Za-z0-9]+!\\$?[A-Z][A-Z]?\\$?\\d+","g"),e.formulas_with_unquoted_sheetnames_2=new RegExp("[A-Za-z0-9]+!\\$?[A-Z][A-Z]?\\$?\\d+:\\$?[A-Z][A-Z]?\\$?\\d+","g"),e.formulas_with_structured_references=new RegExp("\\[([^\\]])*\\]","g"),e.originalSheetSuffix="_EL",e}();t.ExcelUtils=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(9),a=r(27),i=r(7),o=r(28),u=r(29),s=r(31),c=r(5);function l(e,t){if("number"==typeof e)return e-t;e=e,t=t;for(var r=0;r<e.length;r+=1){var n=l(e[r],t[r]);if(0!==n)return n}return 0}function d(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e}t.tuple=d;var f=function(){function e(){}return e.setReportingThreshold=function(t){e.reportingThreshold=t},e.getReportingThreshold=function(){return e.reportingThreshold},e.setFormattingDiscount=function(t){e.formattingDiscount=t},e.getFormattingDiscount=function(){return e.formattingDiscount},e.process_formulas=function(t,r,a){c.watchdog("wd0xea1170");for(var i=JSON.stringify(n.ExcelUtils.baseVector()),o=function(e,t){return[e[0]+t[0],e[1]+t[1],e[2]+t[2]]},u=[],s=0;s<t.length;s++){c.watchdog("wd0xa1597b");for(var l=t[s],d=0;d<l.length;d++){c.watchdog("wd0x0d7fc8");var f=l[d].toString();if(f.length>0){var h=n.ExcelUtils.all_dependencies(s,d,a+s,r+d,t),v=d+r+1,p=s+a+1;if(0===h.length)"="===f[0]&&u.push([[v,p,0],e.distinguishedZeroHash]);else{var m=h.reduce(o);if(JSON.stringify(m)===i)u.push([[v,p,0],m.toString()]);else{var g=this.hash_vector(m).toString();u.push([[v,p,0],g])}}}}}return u},e.color_all_data=function(t){for(var r=[],n=0,a=Object.keys(t);n<a.length;n++){var i=a[n];c.watchdog("wd0xc22046");var o=i.split(","),u=Number(o[0]),s=Number(o[1]);r.push([[u,s,0],e.distinguishedZeroHash])}return r},e.process_values=function(t,r,n,a){for(var i=[],o=0;o<t.length;o++){c.watchdog("wd0x503d57");for(var u=t[o],s=0;s<u.length;s++){c.watchdog("wd0x366ad1");var l=u[s].toString();if(l.length>0&&"="!==r[o][s][0])if(Number(l).toString()===l){var d=s+n+1,f=o+a+1;i.push([[d,f,1],e.distinguishedZeroHash])}}}return i},e.identify_ranges=function(e,t){for(var r={},n=0,a=e;n<a.length;n++){var i=a[n];c.watchdog("wd0x770d8c"),r[i[1]]=r[i[1]]||[],r[i[1]].push(i[0])}for(var o=0,u=Object.keys(r);o<u.length;o++){var s=u[o];c.watchdog("wd0x84ae4d"),r[s].sort(t)}return r},e.group_ranges=function(e,t){var r={},n=0,a=1;t||(n=1,a=0);for(var i=0,o=Object.keys(e);i<o.length;i++){var u=o[i];c.watchdog("wd0xa372ae"),r[u]=[];for(var s=e[u].shift(),l=s,d=0,f=e[u];d<f.length;d++){var h=f[d];h[n]===l[n]&&h[a]===l[a]+1||(r[u].push([s,l]),s=h),l=h}r[u].push([s,l])}return r},e.identify_groups=function(e){var t=this.identify_ranges(e,(function(e,t){return e[0]===t[0]?e[1]-t[1]:e[0]-t[0]})),r=this.group_ranges(t,!0),n=o.JSONclone.clone(r);return this.merge_groups(n)},e.processed_to_matrix=function(t,r,n,a,i){for(var o=new Array(t),u=0;u<t;u++)o[u]=new Array(r).fill(0);for(var s=0,c=i;s<c.length;s++){var l=c[s],d=l[0],f=d[0],h=d[1],v=d[2],p=l[1],m=h-a-1,g=f-n-1,S=Number(e.distinguishedZeroHash);1===v||(S=Number(p)),o[m][g]=S}return o},e.stencilize=function(e){return s.Stencil.stencil_computation(e,(function(e,t){return e*t}),1)},e.compute_stencil_probabilities=function(e,t,r){for(var n=new Array(e),a=0;a<e;a++)n[a]=new Array(t).fill(0);var i=0,o={};for(a=0;a<e;a++)for(var u=0;u<t;u++)o[r[a][u]]=o[r[a][u]]+1||1,0!==r[a][u]&&(i+=1);for(a=0;a<e;a++)for(u=0;u<t;u++)n[a][u]=o[r[a][u]]/i;var s=0,c=0;for(a=0;a<e;a++)for(u=0;u<t;u++)r[a][u]>0&&(c+=o[r[a][u]]);for(a=0;a<e;a++)for(u=0;u<t;u++)o[r[a][u]]>0&&(s+=this.entropy(o[r[a][u]]/c));Math.log2(i);return n},e.generate_suspicious_cells=function(e,t,r,n,a,i,o){void 0===o&&(o=.01);for(var u=[],s=0,c=0,l=0;l<e;l++)for(var d=0;d<t;d++){var f=d+r+1,h=l+n+1;i[l][d]>0&&(s+=a[l][d],c+=1,i[l][d]<=o&&0!==a[l][d]&&u.push([f,h,i[l][d]]))}var v=s/c;return u.sort((function(e,t){return Math.abs(t[2]-v)-Math.abs(e[2]-v)})),u},e.process_suspicious=function(t,r,a){c.watchdog("wd0x72fd38");new i.Timer("process_suspicious");var o=n.ExcelUtils.extract_sheet_cell(t),u=(o[0],o[1]),s=n.ExcelUtils.cell_dependency(u,0,0),l=[];r.length>this.formulasThreshold?console.warn("Too many formulas to perform formula analysis."):l=e.process_formulas(r,s[0]-1,s[1]-1);var f=[],h=[],v=a.length,p=a[0].length;if(a.length>this.valuesThreshold)console.warn("Too many values to perform reference analysis.");else{var m=n.ExcelUtils.generate_all_references(r,s[0]-1,s[1]-1);f=e.color_all_data(m),h=e.process_values(a,r,s[0]-1,s[1]-1)}var g=e.identify_groups(f),S=e.identify_groups(l),y=[];return a.length<1e4&&(y=e.find_suspicious_cells(v,p,s,r,l,h,1)),d(y,S,g,e.generate_proposed_fixes(S))},e.entropy=function(e){return-e*Math.log2(e)},e.entropydiff=function(e,t){var r=e+t;return-((this.entropy(e/r)+this.entropy(t/r))/Math.log2(r))},e.fix_metric=function(e,t,r,n){var i=t[0],o=t[1],u=n[0],s=n[1],c=a.RectangleUtils.area([[i[0],i[1],0],[o[0],o[1],0]]),l=a.RectangleUtils.area([[u[0],u[1],0],[s[0],s[1],0]]),d=Math.min(c,l),f=Math.max(c,l),h=Math.min(r,e),v=Math.max(r,e),p=Math.abs(v-h)/this.Multiplier;p<1&&(p=1);var m=(1+this.entropydiff(d,f))/(p*d);return m=-m},e.count_proposed_fixes=function(e){var t=0;for(var r in e){var n=e[r][1],i=n[0],o=n[1],u=e[r][2],s=u[0],c=u[1];t+=a.RectangleUtils.diagonal([[i[0],i[1],0],[o[0],o[1],0]]),t+=a.RectangleUtils.diagonal([[s[0],s[1],0],[c[0],c[1],0]])}return t},e.fix_proposed_fixes=function(t){var r={},n={};for(var a in t){if(t[a][1]>t[a][2]){var i=t[a][1];t[a][1]=t[a][2],t[a][2]=i}r[JSON.stringify(t[a][1])]=t[a],n[JSON.stringify(t[a][2])]=t[a]}var o=[],u={};for(var a in t){var s=t[a][0];if(!(-s<e.reportingThreshold/100)){var c=JSON.stringify(t[a][1]),l=JSON.stringify(t[a][2]);if(c in n||l in r){if(!u[c]&&c in n){var d=[-s*JSON.parse(n[c][0]),t[a][1],n[c][1]];o.push(d),u[c]=!0,u[l]=!0;continue}if(!u[l]&&l in r){d=[-s*JSON.parse(r[l][0]),t[a][1],r[l][2]];o.push(d),u[l]=!0,u[c]=!0}}else o.push(t[a])}}return o},e.generate_proposed_fixes=function(e){var t=u.find_all_proposed_fixes(e);return t.sort(l),t},e.merge_groups=function(e){for(var t=0,r=Object.keys(e);t<r.length;t++){var n=r[t];c.watchdog("wd0x781a33");var a=e[n].slice();e[n]=this.merge_individual_groups(a)}return e},e.merge_individual_groups=function(e){var t=new i.Timer("merge_individual_groups"),r=0;for(e=e.sort();;){c.watchdog("wd0x0a3668");for(var n=!1,o={},u=[],s=e.slice();s.length>0;)for(var l=s.shift(),d=0;d<s.length;d++)if(c.watchdog("wd0x9cf1d5"),a.RectangleUtils.is_mergeable(l,s[d])){var f=JSON.stringify(l),h=JSON.stringify(s[d]);if(!(f in o)&&!(h in o)){u.push(a.RectangleUtils.bounding_box(l,s[d])),o[f]=!0,o[h]=!0,n=!0;break}}for(d=0;d<e.length;d++)c.watchdog("wd0x1bc2bb"),JSON.stringify(e[d])in o||u.push(e[d]);if(u.sort(),!n)return u;if(e=u.slice(),++r>2e3)return console.warn("Too many iterations; abandoning this group."),t.split("done, "+r+" iterations."),[[[-1,-1,0],[-1,-1,0]]]}},e.hash_vector=function(e){var t=0,r=0,n=Math.abs(e[0]-t),a=Math.abs(e[1]-r),i=e[2];return this.Multiplier*(n+a+i)},e.adjust_proposed_fixes=function(e,t,r,n){return e.map((function(e){var a=e[0];if(100*-a<1)return null;for(var i=e[1].map((function(e){return e.toString().padStart(10,"0")})),o=e[2].map((function(e){return e.toString().padStart(10,"0")})),u=i<o?e[1]:e[2],s=i<o?e[2]:e[1],c=u[0],l=c[0],f=c[1],h=u[1],v=(h[0],h[1],s[0]),p=(v[0],v[1],s[1]),m=p[0],g=p[1],S=l-r-1,y=f-n-1,b=m-r-1,E=g-n-1,F=!0,C=JSON.stringify(t[y][S]),R=y;R<=E;R++)for(var k=S;k<=b;k++){if(JSON.stringify(t[R][k])!==C){F=!1;break}}return d(a,u,s,F)})).filter((function(e){return null!==e}))},e.find_suspicious_cells=function(e,t,r,n,a,i,o){return c.watchdog("wd0x8cabd6"),[]},e.reportingThreshold=35,e.suspiciousCellsReportingThreshold=85,e.formattingDiscount=50,e.formulasThreshold=1e4,e.valuesThreshold=1e4,e.Multiplier=1,e.distinguishedZeroHash="12345",e}();t.Colorize=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(26);t.detect_errors=n.detect_errors},function(e,t,r){r(13),e.exports=r(33)},function(e,t,r){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */var n;n=function(){"use strict";function e(e){return"function"==typeof e}var t=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},r=0,n=void 0,a=void 0,i=function(e,t){f[r]=e,f[r+1]=t,2===(r+=2)&&(a?a(h):S())},o="undefined"!=typeof window?window:void 0,u=o||{},s=u.MutationObserver||u.WebKitMutationObserver,c="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),l="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function d(){var e=setTimeout;return function(){return e(h,1)}}var f=new Array(1e3);function h(){for(var e=0;e<r;e+=2)(0,f[e])(f[e+1]),f[e]=void 0,f[e+1]=void 0;r=0}var v,p,m,g,S=void 0;function y(e,t){var r=this,n=new this.constructor(F);void 0===n[E]&&w(n);var a=r._state;if(a){var o=arguments[a-1];i((function(){return O(a,n,o,r._result)}))}else T(r,n,e,t);return n}function b(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(F);return R(t,e),t}c?S=function(){return process.nextTick(h)}:s?(p=0,m=new s(h),g=document.createTextNode(""),m.observe(g,{characterData:!0}),S=function(){g.data=p=++p%2}):l?((v=new MessageChannel).port1.onmessage=h,S=function(){return v.port2.postMessage(0)}):S=void 0===o?function(){try{var e=Function("return this")().require("vertx");return void 0!==(n=e.runOnLoop||e.runOnContext)?function(){n(h)}:d()}catch(e){return d()}}():d();var E=Math.random().toString(36).substring(2);function F(){}function C(t,r,n){r.constructor===t.constructor&&n===y&&r.constructor.resolve===b?function(e,t){1===t._state?N(e,t._result):2===t._state?A(e,t._result):T(t,void 0,(function(t){return R(e,t)}),(function(t){return A(e,t)}))}(t,r):void 0===n?N(t,r):e(n)?function(e,t,r){i((function(e){var n=!1,a=function(e,t,r,n){try{e.call(t,r,n)}catch(e){return e}}(r,t,(function(r){n||(n=!0,t!==r?R(e,r):N(e,r))}),(function(t){n||(n=!0,A(e,t))}),e._label);!n&&a&&(n=!0,A(e,a))}),e)}(t,r,n):N(t,r)}function R(e,t){if(e===t)A(e,new TypeError("You cannot resolve a promise with itself"));else if(a=typeof(n=t),null===n||"object"!==a&&"function"!==a)N(e,t);else{var r=void 0;try{r=t.then}catch(t){return void A(e,t)}C(e,t,r)}var n,a}function k(e){e._onerror&&e._onerror(e._result),I(e)}function N(e,t){void 0===e._state&&(e._result=t,e._state=1,0!==e._subscribers.length&&i(I,e))}function A(e,t){void 0===e._state&&(e._state=2,e._result=t,i(k,e))}function T(e,t,r,n){var a=e._subscribers,o=a.length;e._onerror=null,a[o]=t,a[o+1]=r,a[o+2]=n,0===o&&e._state&&i(I,e)}function I(e){var t=e._subscribers,r=e._state;if(0!==t.length){for(var n=void 0,a=void 0,i=e._result,o=0;o<t.length;o+=3)n=t[o],a=t[o+r],n?O(r,n,a,i):a(i);e._subscribers.length=0}}function O(t,r,n,a){var i=e(n),o=void 0,u=void 0,s=!0;if(i){try{o=n(a)}catch(e){s=!1,u=e}if(r===o)return void A(r,new TypeError("A promises callback cannot return that same promise."))}else o=a;void 0!==r._state||(i&&s?R(r,o):!1===s?A(r,u):1===t?N(r,o):2===t&&A(r,o))}var M=0;function w(e){e[E]=M++,e._state=void 0,e._result=void 0,e._subscribers=[]}var D=function(){function e(e,r){this._instanceConstructor=e,this.promise=new e(F),this.promise[E]||w(this.promise),t(r)?(this.length=r.length,this._remaining=r.length,this._result=new Array(this.length),0===this.length?N(this.promise,this._result):(this.length=this.length||0,this._enumerate(r),0===this._remaining&&N(this.promise,this._result))):A(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var t=0;void 0===this._state&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var r=this._instanceConstructor,n=r.resolve;if(n===b){var a=void 0,i=void 0,o=!1;try{a=e.then}catch(e){o=!0,i=e}if(a===y&&void 0!==e._state)this._settledAt(e._state,t,e._result);else if("function"!=typeof a)this._remaining--,this._result[t]=e;else if(r===_){var u=new r(F);o?A(u,i):C(u,e,a),this._willSettleAt(u,t)}else this._willSettleAt(new r((function(t){return t(e)})),t)}else this._willSettleAt(n(e),t)},e.prototype._settledAt=function(e,t,r){var n=this.promise;void 0===n._state&&(this._remaining--,2===e?A(n,r):this._result[t]=r),0===this._remaining&&N(n,this._result)},e.prototype._willSettleAt=function(e,t){var r=this;T(e,void 0,(function(e){return r._settledAt(1,t,e)}),(function(e){return r._settledAt(2,t,e)}))},e}(),_=function(){function t(e){this[E]=M++,this._result=this._state=void 0,this._subscribers=[],F!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof t?function(e,t){try{t((function(t){R(e,t)}),(function(t){A(e,t)}))}catch(t){A(e,t)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return t.prototype.catch=function(e){return this.then(null,e)},t.prototype.finally=function(t){var r=this.constructor;return e(t)?this.then((function(e){return r.resolve(t()).then((function(){return e}))}),(function(e){return r.resolve(t()).then((function(){throw e}))})):this.then(t,t)},t}();return _.prototype.then=y,_.all=function(e){return new D(this,e).promise},_.race=function(e){var r=this;return t(e)?new r((function(t,n){for(var a=e.length,i=0;i<a;i++)r.resolve(e[i]).then(t,n)})):new r((function(e,t){return t(new TypeError("You must pass an array to race."))}))},_.resolve=b,_.reject=function(e){var t=new this(F);return A(t,e),t},_._setScheduler=function(e){a=e},_._setAsap=function(e){i=e},_._asap=i,_.polyfill=function(){var e=void 0;if("undefined"!=typeof global)e=global;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var r=null;try{r=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===r&&!t.cast)return}e.Promise=_},_.Promise=_,_.polyfill(),_},e.exports=n()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.forEachPromise=function(e,t,r){return e.reduce((function(e,n){return e.then((function(){return r&&r.stop?Promise.resolve(void 0):t(n,r)}))}),Promise.resolve(void 0))},t.defaultToJSONResultWhenStringifyFails="...",t.getStringifiedError=function(e){if(0===e)return"0";if(!e)return"";try{return JSON.stringify(function e(t,r){void 0===r&&(r=0);if(r<0||r>5)return t;if(null==t||"object"!=typeof t)return t;var n={};Object.getOwnPropertyNames(t).forEach((function(e){"stack"!==e&&e.toUpperCase()!==e&&(n[e]=t[e])}));var a=Object.getPrototypeOf(t);a&&"object"==typeof a&&Object.keys(a).forEach((function(e){"stack"!==e&&e.toUpperCase()!==e&&(n[e]=t[e])}));var i={};return Object.keys(n).forEach((function(t){i[t]=e(n[t],r+1)})),i}(e))}catch(e){return t.defaultToJSONResultWhenStringifyFails}};var n=new RegExp("\\W+","g");t.getPerfWatchMarkName=function(e){if(!e)return"";var t=e.trim().substring(0,200).trim().replace(n,"_").substring(0,80);return t&&t.length>0&&"_"===t.substr(t.length-1,1)&&(t=t.substr(0,t.length-1)),t&&t.length>0&&"_"===t.substr(0,1)&&(t=t.substr(1)),t},t.retry=function(e,t){if(!e)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(t<1)return Promise.reject(new Error("utils.retry: attempts expected to be greater than 0 but got "+t));for(var r=Promise.reject(),n=function(t){r=r.catch((function(r){return e(t,r)}))},a=1;a<=t;a+=1)n(a);return r},t.chainFallbackPromises=function(e,t){if(!e||0===e.length)return Promise.reject();for(var r=t(e[0]),n=function(n){var a=e[n];r=r.catch((function(){return t(a)}))},a=1;a<e.length;a+=1)n(a);return r},t.getQueryParameterByName=function(e,t){var r=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(e);if(r)return r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):""},t.decodeHtml=function(e){return"string"==typeof e?(new DOMParser).parseFromString(e,"text/html").documentElement.textContent:e},t.calcHashCode=function(e){if(!e)return 0;for(var t=5381,r=t,n=e.length,a=0;a<n&&(t=4294967295&((t<<5)+t^e.charCodeAt(a)),a!==n-1);a+=2)r=4294967295&((r<<5)+r^e.charCodeAt(a+1));var i=t+35685*r+(23896*r<<16)&4294967295;return i<0&&(i+=4294967296),i},t.getCharIndexInTextFromPoint=function(e,t,r){void 0===r&&(r=!1);var n=-1,a=null;if(void 0!==document.caretPositionFromPoint)null!==(i=document.caretPositionFromPoint(e,t))&&(n=i.offset,a=null!=i.offsetNode&&null!=i.offsetNode.parentElement&&"SPAN"===i.offsetNode.parentElement.nodeName?i.offsetNode.parentElement:i.offsetNode);else if(void 0!==document.caretRangeFromPoint){null!==(i=document.caretRangeFromPoint(e,t))&&(n=i.startOffset,a=null!=i.startContainer&&null!=i.startContainer.parentElement&&"SPAN"===i.startContainer.parentElement.nodeName?i.startContainer.parentElement:i.startContainer)}else try{var i;a=document.elementFromPoint(e,t),(i=document.body.createTextRange()).moveToPoint(e,t);var o=document.body.createTextRange();o.moveToElementText(a),o.setEndPoint("EndToStart",i),n=o.text.length}catch(e){return n}if(r)for(var u=!1;null!=a;)null===a.previousSibling&&null!==a.parentNode&&null!==a.parentNode.parentNode&&a.parentNode.parentNode.childNodes.length>1&&!u?(a=a.parentNode,u=!0):null!=(a=a.previousSibling)&&null!=a.textContent&&(n+=a.textContent.length,u&&(n+=1));else for(;null!=a;)null!=(a=a.previousSibling)&&null!=a.textContent&&(n+=a.textContent.length);return n},t.getBoundingRectForText=function(e,t,r,n){function a(e,t,r){if(!e||!e.textContent)return t;if(n&&(t<0||t>e.textContent.length&&(0===e.childNodes.length||"DIV"!==e.childNodes[0].nodeName)))return t-e.textContent.length;if(t<0||t>e.textContent.length)return t-e.textContent.length;if(!e.hasChildNodes())return r(e,t),t-e.textContent.length;for(var i=e.childNodes,o=0;o<i.length&&t>=0;o+=1)t=a(i[o],t,r),n&&"DIV"===i[o].nodeName&&(t-=1);return t}void 0===n&&(n=!1);var i=document.createRange();return a(e,t,(function(e,t){return i.setStart(e,t)})),a(e,r,(function(e,t){return i.setEnd(e,t)})),i.getBoundingClientRect()}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(t.TraceLevel||(t.TraceLevel={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS"}(t.LogCategory||(t.LogCategory={})),t.ULS={getFromExternalLogger:function(e){var t=e;return{ULS:{trace:function(e,r,n){return t.traceTag(0,e,r,n)},traceTag:function(e,r,n,a){return t.traceTag(e,r,n,a)},debugTrace:function(e,r,n){return t.debugTraceTag(0,e,r,n)},debugTraceTag:function(e,r,n,a){return t.debugTraceTag(e,r,n,a)},assert:function(e,r,n){return t.assertTag(0,e,r,n)},assertTag:function(e,r,n,a){return t.assertTag(e,r,n,a)},shipAssert:function(e,r,n){return t.shipAssertTag(0,e,r,n)},shipAssertTag:function(e,r,n,a){return t.shipAssertTag(e,r,n,a)}}}}};var n=function(){function e(){}return e.prototype.shipAssertTag=function(e,t,r,n){console.assert(r,"shipAssertTag:",e,t,n)},e.prototype.assertTag=function(e,t,r,n){console.assert(r,"assertTag",e,t,n)},e.prototype.traceTag=function(e,t,r,n){console.log("traceTag",e,n,t,r)},e.prototype.debugTraceTag=function(e,t,r,n){console.log("debugTraceTag",e,n,t,r)},e}();t.ConsoleLogger=n;var a=function(){function e(){}return e.prototype.shipAssertTag=function(){},e.prototype.assertTag=function(){},e.prototype.traceTag=function(){},e.prototype.debugTraceTag=function(){},e}();t.NulLogger=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={};t.promises=function(){return void 0===n.promises&&(n.promises="undefined"!=typeof Promise&&"function"==typeof Promise.resolve&&Promise.resolve(0)&&"function"==typeof Promise.resolve(0).then),n.promises}},function(e,t,r){"use strict";function n(){return window.performance&&window.performance.now?window.performance.now():Date.now()}function a(e,t,r){e[t]=n()-r}Object.defineProperty(t,"__esModule",{value:!0}),t.start=function(e){var t=n(),r=e,i=t,o={},u=function(e,t,n){return function(e,t,r,n,i,o){a(e,"end",r);var u={sessionName:t,result:n?"success":"failure",message:o,marks:e},s=JSON.stringify(u);i(s)}(o,r,i,e,t,n)};return o.start=0,{mark:function(e){return function(e){return a(o,e,i)}(e)},end:function(e){return u(!0,e)},success:function(e,t){return u(!0,e,t)},failure:function(e,t){return u(!1,e,t)}}},t.mark=function(e,t){void 0!==e&&e.mark(t)},t.end=function(e,t){void 0!==e&&e.end(t)},t.success=function(e,t,r){void 0!==e&&e.success(t,r)},t.failure=function(e,t,r){void 0!==e&&e.failure(t,r)},t.timeStamp=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={isChangeGateEnabled:function(e){return!1}};t.ewaUtils=function(){return n},t.initEwaUtils=function(e){if(!e)throw new Error("the 'ewaUtils' argument is missing");n=e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){return Date.now()};t.initStopwatchFactory=function(e,t){return void 0===t&&(t=1),"undefined"!=typeof self&&self.performance&&self.performance.now&&(n=function(){return self.performance.now()}),function(r){var a=n(),i=r;return{reset:function(e){null!=e&&(i=e),a=n()},stop:function(r){var o=n()-a,u=JSON.stringify({Target:i,Duration:o.toFixed(t),StopInfo:r});e(u)}}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNewGuid=function(){var e=new Uint8Array(31),t=function(e){var t={crypto:!1,perfNow:!1,exceptions:[]},r=window.crypto||window.msCrypto;if(r){t.crypto=!0;try{return r.getRandomValues(e),t}catch(e){t.exceptions.push("crypto: "+JSON.stringify(e))}}var n=!1,a=window.performance;try{a&&a.now&&a.now()!==1/0&&(n=!0)}catch(e){t.exceptions.push("perfNow: "+JSON.stringify(e))}for(var i=0;i<e.length;i+=1){try{if(n){t.perfNow=!0;var o=Math.floor(100*a.now())%10;(o<0||o>9)&&(o=0);for(var u=0;u<o;u+=1)Math.random()}}catch(e){t.exceptions.push("Math.random: "+JSON.stringify(e))}e[i]=Math.floor(16*Math.random())}return t}(e),r=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=15&e[r];return r+=1,("x"===t?n:3&n|8).toString(16)})),t]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Auto="auto",e.Manual="manual"}(t.TextAreaVirtualKeyboardPolicy||(t.TextAreaVirtualKeyboardPolicy={})),function(e){e.None="none",e.Text="text",e.Tel="tel",e.Url="url",e.Email="email",e.Numeric="numeric",e.Decimal="decimal",e.Search="search"}(t.TextAreaInputMode||(t.TextAreaInputMode={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Math=void 0;const n=function(e){if(e.imul&&e.fround&&e.clz32)return e;const t=new Float32Array(1);return Object.create(e,{imul:{value:function(e,t){var r=(4194303&e)*(t|=0);return 4290772992
/*!== 0*/&e&&(r+=(4290772992&e)*t|0),0|r}},fround:{value:function(e){return t[0]=e,t[0]}},clz32:{value:function(t){var r=t>>>0;return 0===r?32:31-(e.log(r)/e.LN2|0)|0}}})}(Math);t.Math=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Base_LocaleIsNumeral",{enumerable:!0,get:function(){return n.Base_LocaleIsNumeral}}),Object.defineProperty(t,"Base_LocaleGetOrdinal",{enumerable:!0,get:function(){return n.Base_LocaleGetOrdinal}}),Object.defineProperty(t,"Base_LocaleDecimalSeparator",{enumerable:!0,get:function(){return n.Base_LocaleDecimalSeparator}}),t.Math_atan=t.Math_tan=t.Math_cos=t.Math_sin=t.Math_exp=t.Math_log=t.Math_log10=t.Math_sqrt=void 0;var n=r(6);const a=Math.sqrt;t.Math_sqrt=a;const i=Math.log10||function(e){return Math.log(e)*Math.LOG10E};t.Math_log10=i;const o=Math.log;t.Math_log=o;const u=Math.exp;t.Math_exp=u;const s=Math.sin;t.Math_sin=s;const c=Math.cos;t.Math_cos=c;const l=Math.tan;t.Math_tan=l;const d=Math.atan;t.Math_atan=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.proc_exit=function(e){throw new Error("unexpected process termination: "+e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(4),a=r(8);function i(e,t,r,n,a,i,o,u,s){return{yr:e,mon:t,dom:r,hour:n,min:a,sec:i,wdy:o,fracSec:u,rounding:s}}function o(e){return i(n.Dtr_Yr(e),n.Dtr_Mon(e),n.Dtr_DOM(e),n.Dtr_Hour(e),n.Dtr_Min(e),n.Dtr_Sec(e),n.Dtr_Wdy(e),n.Dtr_FracSec(e),n.Dtr_Rounding(e))}function u(e,t){n.Dtr_Write(t.yr,t.mon,t.dom,t.hour,t.min,t.sec,t.wdy,t.fracSec,t.rounding,e)}t.daysPerMonth=function(e,t,r){return n.Dtr_DaysPerMonth(e,t,r?1:0)},function(e){e[e.RoundSec=0]="RoundSec",e[e.Round10ths=1]="Round10ths",e[e.Round100ths=2]="Round100ths",e[e.Round1000ths=3]="Round1000ths"}(t.Rounding||(t.Rounding={})),t.dtr=i,t.fromNum=function(e,t,r,a){var i=t;return 0===n.Dtr_FromNum(e,i,0,r?1:0,a?1:0)&&o(0)},t.toNum=function(e,t,r){u(0,e);var i=n.Dtr_ToNum(0,t?1:0,r?1:0),o=n.Mathpack_TakeMathError();return o===a.MathErrorNum.None?i:a.mathError(o)},t.toNumWithDuration=function(e,t,r,i,o){u(0,e);var s=i,c=n.Dtr_ToNumWithDuration(0,t?1:0,r?1:0,s,o),l=n.Mathpack_TakeMathError();return l===a.MathErrorNum.None?c:a.mathError(l)},t.toDays=function(e,t,r){return u(0,e),0===n.Dtr_ToDays(0,t?1:0,r?1:0)&&n.Dtr_Days()},function(e){e[e.Hour=0]="Hour",e[e.Minute=1]="Minute",e[e.Second=2]="Second"}(t.TimeDivision||(t.TimeDivision={})),t.toTime=function(e,t,r){var i=t,o=r,u=n.Dtr_ToTime(e,i,o);return n.Mathpack_TakeMathError()===a.MathErrorNum.None&&u},t.utcToLocal=function(e,t,r,a){return u(0,e),null!=t.standardDate&&u(1,t.standardDate),null!=t.daylightDate&&u(2,t.daylightDate),0!==n.Dtr_UtcToLocal(0,t.bias,null!=t.standardDate?1:-1,t.standardBias,null!=t.daylightDate?2:-1,t.daylightBias,r?1:0,a?1:0)&&o(0)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(9),a=r(10),i=r(7),o=r(5);function u(e,t){for(var r=e[0],n=e[1],a=t[0],i=t[1],o=[],u=r;u<=a;u++)for(var s=n;s<=i;s++)o.push([u,s,0]);return o}t.detect_errors=function(e,t,r,s){void 0===s&&(s=1/0),t=null!=t?t:a.Colorize.getFormattingDiscount(),r=null!=r?r:a.Colorize.getReportingThreshold(),o.watchdog.arm(s);for(var c={},l=0,d=e.worksheets.map((function(e){if(o.watchdog("wd0x8d98cc"),0===e.formulas.length&&0===e.values.length)return{name:"",out:null};var s=e.usedRangeAddress;s=s.replace(/!(!+)/,"!");var c=new i.Timer("excelint"),l=a.Colorize.process_suspicious(s,e.formulas,e.values),d=(l[0],l[1],l[2],l[3]);o.watchdog("wd0x7919b4");var f=c.elapsedTime(),h=a.Colorize.adjust_proposed_fixes(d,e.styles,0,0),v=c.elapsedTime(),p=h.map((function(e){o.watchdog("wd0xfb8f16");var n=e[0],i=e[1],u=e[2],s=e[3],c=-n;return s||(c*=(100-t)/100),100*c>=r?a.tuple(c,i,u,s):null})).filter((function(e){return null!==e})),m=function(e,t){return(t[0]-e[0]+1)*(t[1]-e[1]+1)*(t[2]-e[2]+1)},g=c.elapsedTime(),S=p.map((function(t){o.watchdog("wd0x2375dd");for(var r=t[1][0][0]===t[2][0][0]?"vertical":"horizontal",a=[],i=[],u=[],s=[],c=[],l=[],d=[],f=[],h=[],v=t[3],p=[m.apply(void 0,t[1]),m.apply(void 0,t[2])],g=0;g<2;g++){var S=t[g+1][0],y=S[1]-1,b=S[0]-1,E=e.formulas[y][b],F=n.ExcelUtils.numeric_constants(E);c.push(F),l.push(l.reduce((function(e,t){return e+t}),0));var C=n.ExcelUtils.all_cell_dependencies(E,b+1,y+1,!1);d.push(C.length);var R=n.ExcelUtils.formulaToR1C1(E,b+1,y+1),k=n.ExcelUtils.column_index_to_name(b+1)+(y+1)+":",N=k+R;u.push(R),s.push(N),a.push(E),i.push(k+E),f.push((E.match(/\$/g)||[]).length),h.push(C)}var A=Math.abs(l[0]-l[1]),T=[];for(g=0;g<h.length;g++)if(h[g].length>0){if("vertical"===r&&0===h[g][0][0]&&-1===h[g][0][1]){T.push("recurrent-formula");break}if("horizontal"===r&&-1===h[g][0][0]&&0===h[g][0][1]){T.push("recurrent-formula");break}}d[0]!==d[1]&&T.push("different-referent-count"),c[0].length!==c[1].length&&(1===Math.abs(c[0].length-c[1].length)?T.push("one-extra-constant"):T.push("number-of-constants-mismatch")),c[0].length>0&&c[1].length>0&&(d[0]+d[1]===0?T.push("both-constants"):d[0]*d[1]==0&&T.push("one-is-all-constants")),u[0]!==u[1]&&JSON.stringify(h[0].sort())!==JSON.stringify(h[1].sort())&&T.push("r1c1-mismatch"),f[0]!==f[1]&&T.push("absolute-ref-mismatch");for(g=0;g<h.length;g++)if(h[g].length>0&&h[g][0][0]*h[g][0][1]!=0){T.push("off-axis-reference");break}return T===[]&&T.push("unclassified"),{bin:T,direction:r,sameFormat:v,rangeSizes:p,numbers:l,sameConstants:c[0]===c[1],numeric_difference:A,magnitude_numeric_difference:0===A?0:Math.log10(A),formulas:i,r1c1formulas:s,dependence_vectors:h}})),y=c.elapsedTime(),b=e.formulas.flat().filter((function(e){return e.length>0})).length,E=e.values.flat().filter((function(e){return e.length>0})).length,F=e.values[0].length,C=e.values.length,R=C*F,k=p.map((function(e){return e[0]})).reduce((function(e,t){return e+t}),0),N=p.map((function(e){return o.watchdog("wd0xbcc23c"),e[0]>=r/100?u(e[1][0],e[1][1]).concat(u(e[2][0],e[2][1])):[]})),A=Array.from(new Set(N.flat(1).map((function(e){return JSON.stringify(e)}))));N=A.map((function(e){return JSON.parse(e)}));var T=c.elapsedTime(),I={suspiciousnessThreshold:r,formattingDiscount:t,proposedFixes:p,exampleFixes:S,suspiciousRanges:p.length,weightedSuspiciousRanges:k,suspiciousCells:N.length,elapsedTimeSeconds:T/1e3,proposedFixesTimeSeconds:f/1e3,adjustProposedFixesTimeSeconds:(v-f)/1e3,adjustFormatProposedFixesTimeSeconds:(g-v)/1e3,exampleFixesTimeSeconds:(y-g)/1e3,numCountingTimeSeconds:(T-y)/1e3,columns:F,rows:C,totalCells:R,numFormulaCells:b,numValueCells:E};return{name:e.sheetName,out:I}})).filter((function(e){return null!==e.out}));l<d.length;l++){var f=d[l],h=f.name,v=f.out;c[h]=v}return{workbookName:e.workbookName,worksheets:c}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.is_adjacent=function(e,t){var r=e[0],n=r[0],a=r[1],i=(r[2],e[1]),o=i[0],u=i[1],s=(i[2],t[0]),c=s[0],l=s[1],d=(s[2],t[1]),f=d[0],h=d[1];d[2];return!(n-f>1||c-o>1||a-h>1||l-u>1)},e.bounding_box=function(e,t){var r=e[0],n=r[0],a=r[1],i=(r[2],e[1]),o=i[0],u=i[1],s=(i[2],t[0]),c=s[0],l=s[1],d=(s[2],t[1]),f=d[0],h=d[1];d[2];return[[Math.min(n,c),Math.min(a,l),0],[Math.max(o,f),Math.max(u,h),0]]},e.area=function(e){var t=e[0],r=t[0],n=t[1],a=(t[2],e[1]),i=a[0],o=a[1];a[2];return(i-r+1)*(o-n+1)},e.diagonal=function(e){var t=e[0],r=t[0],n=t[1],a=(t[2],e[1]),i=a[0],o=a[1],u=(a[2],i-r+1),s=o-n+1;return Math.sqrt(u*u+s*s)},e.overlap=function(e,t){var r=e[0],n=r[0],a=r[1],i=(r[2],e[1]),o=i[0],u=i[1],s=(i[2],t[0]),c=s[0],l=s[1],d=(s[2],t[1]),f=d[0],h=d[1];d[2];return(o>f?f-n+1:o-c+1)*(u>h?h-a+1:u-l+1)},e.is_mergeable=function(t,r){return e.is_adjacent(t,r)&&e.area(t)+e.area(r)-e.overlap(t,r)===e.area(e.bounding_box(t,r))},e}();t.RectangleUtils=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.clone=function(t){if(t){if(Array.isArray(t))return t.slice();if(t.constructor===Object){for(var r={},n=0,a=Object.keys(t);n<a.length;n++){var i=a[n];r[i]=e.clone(t[i])}return r}return t}return null},e}();t.JSONclone=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(30),a=r(10),i=r(5);function o(e,t){var r=e[0],n=(e[1],t[0]);t[1];return r[0]!==n[0]?r[0]-n[0]:r[1]-n[1]}function u(e,t){for(var r=0;r<3;r++){if(e[r]<t[r])return-1;if(e[r]>t[r])return 1}return 0}function s(e,t,r,i,o,s,c,l,d,f){var h,v,p,m=t[0],g=t[1],S=[],y=n.binsearch(d,t,(function(e,t){return e[0][0]-t[0][0]})),b=n.binsearch(f,t,(function(e,t){return e[0][1]-t[0][1]}));y>b?(h=i,p=y,v=0):(h=o,p=b,v=1),p>0&&(p-=1);for(var E=function(r){var i=h[r];if(i===e)return"continue";var o=l[i];if(0===v){if(g[0]+1<o[0][0])return"break"}else if(g[1]+1<o[0][1])return"break";if(g[0]+1<o[0][0]||g[1]+1<o[0][1]||o[1][0]+1<m[0]||o[1][1]+1<m[1]);else{var d=function(e,t,r,a){var i=e[0],o=e[1],s=t[0],c=t[1],l=[i-1,c,0],d=[s,o-1,0],f=[s+1,o,0],h=[i,c+1,0],v=[],p=-1;if(-1!==(p=n.strict_binsearch(a,l,u))&&r[p][1]===o){var m=[r[p],a[p]];v.push(m)}if(-1!==(p=n.strict_binsearch(a,d,u))&&r[p][0]===i){m=[r[p],a[p]];v.push(m)}if(-1!==(p=n.strict_binsearch(r,f,u))&&a[p][1]===c){m=[r[p],a[p]];v.push(m)}if(-1!==(p=n.strict_binsearch(r,h,u))&&a[p][0]===s){m=[r[p],a[p]];v.push(m)}return v}(m,g,s[i],c[i]);d.length>0&&(S=S.concat(d.map((function(r,n,o){return[a.Colorize.fix_metric(parseFloat(e),t,parseFloat(i),r),t,r]}))))}},F=p;F<h.length;F++){if("break"===E(F))break}return S}function c(e,t){for(var r=e.map((function(e,t){return{item:e,index:t}})).sort((function(e,r){return t(e.item,r.item)||e.index-r.index})).map((function(e){return e.item})),n=0;n<e.length;n+=1)e[n]=r[n];return e}t.find_all_proposed_fixes=function(e){var t=[],r={};!function(e,t){for(var r=0,n=Object.keys(e);r<n.length;r++){var a=n[r];i.watchdog("wd0xa287cd"),t[a]=e[a].sort(o).map((function(e,t,r){return[e[0].map((function(e,t,r){return Number(e)})),e[1].map((function(e,t,r){return Number(e)}))]}))}}(e,r);for(var n={},a={},l=0,d=Object.keys(e);l<d.length;l++){var f=d[l];i.watchdog("wd0xb02b87"),n[f]=r[f].map((function(e,t,r){var n=e[0];e[1];return n})),a[f]=r[f].map((function(e,t,r){e[0];return e[1]}))}var h=function(e){for(var t={},r=0,n=Object.keys(e);r<n.length;r++){for(var a=n[r],i=1e6,o=1e6,u=-1e6,s=-1e6,c=0;c<e[a].length;c++){var l=e[a][c][0][0],d=e[a][c][1][0],f=e[a][c][0][1],h=e[a][c][1][1];d>u&&(u=d),l<i&&(i=l),h>s&&(s=h),f<o&&(o=f)}t[a]=[[i,o,0],[u,s,0]]}return t}(e),v=Object.keys(e);c(v,(function(e,t){return h[e][0][0]-h[t][0][0]}));var p=v.map((function(e,t,r){return h[e]})),m=Object.keys(e);c(m,(function(e,t){return h[e][0][1]-h[t][0][1]}));for(var g,S=m.map((function(e,t,r){return h[e]})),y=0,b=Object.keys(e);y<b.length;y++){f=b[y];for(var E=0;E<r[f].length;E++){i.watchdog("wd0xe37031");var F=s(f,r[f][E],0,v,m,n,a,h,p,S);t=t.concat(F)}}return t=t.map((function(e,t,r){return u(e[1],e[2])<0?[e[0],e[2],e[1]]:[e[0],e[1],e[2]]})),g={},t=t.filter((function(e){return!(g[e]=e in g)}))}},function(e,t,r){"use strict";function n(e,t,r){for(var n=0,a=e.length;n<a;){var i=Math.floor((n+a)/2);r(e[i],t)<0?n=i+1:a=i}return n}Object.defineProperty(t,"__esModule",{value:!0}),t.binsearch=function(e,t,r){return void 0===r&&(r=void 0),void 0===r&&(r=function(e,t){return e===t?0:e<t?-1:1}),n(e,t,r)},t.strict_binsearch=function(e,t,r){void 0===r&&(r=void 0);var a=n(e,t,r);return a===e.length||0!==r(e[a],t)?-1:a}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.normalized_entropy=function(e){for(var t=e.reduce((function(e,t){return e+t}),0),r=0,n=0;n<e.length;n++){var a=e[n]/t;0!==a&&(r-=a*Math.log2(a))}return r/Math.log2(t)},e}();t.InfoGain=n;var a=function(){function e(){}return e.initialize=function(){if(!e.initialized){if(e.stencil_right=e.stencil.filter((function(e){var t=e[0];e[1];return t<=0})),e.stencil_left=e.stencil.filter((function(e){var t=e[0];e[1];return t>=0})),e.stencil_top=e.stencil.filter((function(e){e[0];return e[1]>=0})),e.stencil_bottom=e.stencil.filter((function(e){e[0];return e[1]<=0})),e.stencil_topleft=e.stencil_top.filter((function(e){var t=e[0];e[1];return t>=0})),e.stencil_topright=e.stencil_top.filter((function(e){var t=e[0];e[1];return t<=0})),e.stencil_bottomleft=e.stencil_bottom.filter((function(e){var t=e[0];e[1];return t>=0})),e.stencil_bottomright=e.stencil_bottom.filter((function(e){var t=e[0];e[1];return t<=0})),e.reflectStencils){var t=void 0;t=e.stencil.filter((function(e){var t=e[0];e[1];return t>0})).map((function(e){return[-e[0],e[1]]})),e.stencil_right=e.stencil_right.concat(t),t=e.stencil.filter((function(e){var t=e[0];e[1];return t<0})).map((function(e){return[-e[0],e[1]]})),e.stencil_left=e.stencil_left.concat(t),t=e.stencil.filter((function(e){e[0];return e[1]<0})).map((function(e){return[e[0],-e[1]]})),e.stencil_top=e.stencil_top.concat(t),t=e.stencil.filter((function(e){e[0];return e[1]>0})).map((function(e){return[e[0],-e[1]]})),e.stencil_bottom=e.stencil_bottom.concat(t),t=e.stencil_top.filter((function(e){var t=e[0];e[1];return t<0})).map((function(e){return[-e[0],e[1]]})),e.stencil_topleft=e.stencil_topleft.concat(t),t=e.stencil_left.filter((function(e){e[0];return e[1]<0})).map((function(e){return[e[0],-e[1]]})),e.stencil_topleft=e.stencil_topleft.concat(t),e.stencil_topleft.splice(e.stencil_topleft.findIndex((function(e){return JSON.stringify(e)===JSON.stringify([1,1])})),1),t=e.stencil_top.filter((function(e){var t=e[0];e[1];return t>0})).map((function(e){return[-e[0],e[1]]})),e.stencil_topright=e.stencil_topright.concat(t),t=e.stencil_right.filter((function(e){e[0];return e[1]<0})).map((function(e){return[e[0],-e[1]]})),e.stencil_topright=e.stencil_topright.concat(t),e.stencil_topright.splice(e.stencil_topright.findIndex((function(e){return JSON.stringify(e)===JSON.stringify([-1,1])})),1),t=e.stencil_bottom.map((function(e){return[-e[0],e[1]]})).filter((function(e){var t=e[0];e[1];return t>0})),e.stencil_bottomleft=e.stencil_bottomleft.concat(t),t=e.stencil_left.map((function(e){return[e[0],-e[1]]})).filter((function(e){e[0];return e[1]<0})),e.stencil_bottomleft=e.stencil_bottomleft.concat(t),e.stencil_bottomleft.splice(e.stencil_bottomleft.findIndex((function(e){return JSON.stringify(e)===JSON.stringify([1,-1])})),1),t=e.stencil_bottom.map((function(e){return[-e[0],e[1]]})).filter((function(e){var t=e[0];e[1];return t<0})),e.stencil_bottomright=e.stencil_bottomright.concat(t),t=e.stencil_right.map((function(e){return[e[0],-e[1]]})).filter((function(e){e[0];return e[1]<0})),e.stencil_bottomright=e.stencil_bottomright.concat(t),e.stencil_bottomright.splice(e.stencil_bottomright.findIndex((function(e){return JSON.stringify(e)===JSON.stringify([-1,-1])})),1)}e.initialized=!0}},e.apply_stencil=function(t,r,n,a,i,o){if(t.length!==e.stencil.length)throw Error("Length mismatched");for(var u=i,s=0;s<t.length;s++){var c=t[s],l=c[0];u=o(u,r[n+c[1]][a+l])}return u},e.stencil_computation=function(t,r,n){e.initialize();for(var a=t.length,i=t[0].length,o=Array(a).fill(0).map((function(){return Array(i).fill(0)})),u=1;u<i-1;u++)for(var s=1;s<a-1;s++)o[s][u]=e.apply_stencil(e.stencil,t,u,s,n,r);for(s=1;s<i-1;s++)o[0][s]=e.apply_stencil(e.stencil_top,t,0,s,n,r),o[a-1][s]=e.apply_stencil(e.stencil_bottom,t,a-1,s,n,r);for(u=1;u<a-1;u++)o[u][0]=e.apply_stencil(e.stencil_left,t,u,0,n,r),o[u][i-1]=e.apply_stencil(e.stencil_right,t,u,i-1,n,r);return o[0][0]=e.apply_stencil(e.stencil_topleft,t,0,0,n,r),o[0][i-1]=e.apply_stencil(e.stencil_topright,t,0,i-1,n,r),o[a-1][0]=e.apply_stencil(e.stencil_bottomleft,t,a-1,0,n,r),o[a-1][i-1]=e.apply_stencil(e.stencil_bottomright,t,a-1,i-1,n,r),o},e.reflectStencils=!0,e.ninePointStencil=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,0],[0,1],[1,-1],[1,0],[1,1]],e.stencil=e.ninePointStencil,e.initialized=!1,e}();t.Stencil=a},function(e){e.exports={evidenceGlobal:{count:1e4,value:[{"%NUMBER%":230,"%WSF:IF%":110,"%WSF:SUM%":44,"%WSF:VLOOKUP%":37,"%WSF:INDEX%":25,"%BOOL:FALSE%":20,"%WSF:MATCH%":15,"%BOOL:TRUE%":15},{"%NUMBER%":200,"%WSF:IF%":87,"%WSF:SUM%":41,"%WSF:VLOOKUP%":28,"%WSF:INDEX%":19},{"%NUMBER%":240,"%WSF:IF%":110,"%WSF:SUM%":45,"%WSF:VLOOKUP%":37,"%WSF:INDEX%":25,"%BOOL:FALSE%":20,"%WSF:MATCH%":16,"%BOOL:TRUE%":15},{"%NUMBER%":200,"%WSF:IF%":91,"%WSF:SUM%":41,"%WSF:VLOOKUP%":27,"%WSF:INDEX%":19},{"%NUMBER%":200,"%WSF:IF%":87,"%WSF:SUM%":44,"%WSF:VLOOKUP%":27,"%WSF:INDEX%":15},{"%NUMBER%":210,"%WSF:IF%":94,"%WSF:SUM%":45,"%WSF:VLOOKUP%":29,"%WSF:INDEX%":19,"%BOOL:TRUE%":14,"%BOOL:FALSE%":14},{"%NUMBER%":210,"%WSF:IF%":99,"%WSF:SUM%":45,"%WSF:VLOOKUP%":28,"%WSF:INDEX%":19,"%BOOL:TRUE%":14},{"%NUMBER%":200,"%WSF:IF%":90,"%WSF:SUM%":45,"%WSF:VLOOKUP%":27,"%WSF:INDEX%":14},{"%NUMBER%":200,"%WSF:IF%":87,"%WSF:SUM%":42,"%WSF:VLOOKUP%":28,"%WSF:INDEX%":19,"%BOOL:TRUE%":14},{"%NUMBER%":240,"%WSF:IF%":110,"%WSF:SUM%":46,"%WSF:VLOOKUP%":37,"%WSF:INDEX%":25,"%BOOL:FALSE%":20,"%WSF:MATCH%":16,"%BOOL:TRUE%":15},{"%NUMBER%":200,"%WSF:IF%":91,"%WSF:SUM%":42,"%WSF:VLOOKUP%":27,"%WSF:INDEX%":19,"%BOOL:TRUE%":14},{"%NUMBER%":230,"%WSF:IF%":110,"%WSF:SUM%":46,"%WSF:VLOOKUP%":37,"%WSF:INDEX%":25,"%BOOL:FALSE%":20,"%WSF:MATCH%":15,"%BOOL:TRUE%":15},{"%NUMBER%":570,"%WSF:IF%":190,"%WSF:SUM%":83,"%WSF:VLOOKUP%":67,"%WSF:INDEX%":49,"%BOOL:TRUE%":37,"%BOOL:FALSE%":25,"%WSF:OFFSET%":22,"%WSF:AND%":21,"%DATE%":20,"%WSF:IFERROR%":17,"%WSF:MATCH%":15,"%WSF:OR%":14,"%WSF:RANK%":14},{"%NUMBER%":350,"%WSF:IF%":120,"%WSF:VLOOKUP%":44,"%BOOL:FALSE%":38,"%WSF:INDEX%":21,"%WSF:LOG%":17,"%WSF:MATCH%":17,"%WSF:SEARCH%":17,"%WSF:SUM%":17,"%WSF:LEFT%":15,"%WSF:CONCATENATE%":15}]},evidenceFuncs:{1:{count:1e4,value:[{"%NUMBER%":240,"%WSF:IF%":160,"%WSF:SUM%":60,"%WSF:INDEX%":21,"%WSF:VLOOKUP%":15,"%WSF:MATCH%":15,"%WSF:AND%":14,"%BOOL:FALSE%":13},{"%NUMBER%":200,"%WSF:IF%":130,"%WSF:SUM%":58,"%WSF:INDEX%":20,"%WSF:MATCH%":14},{"%NUMBER%":250,"%WSF:IF%":160,"%WSF:SUM%":60,"%WSF:INDEX%":21,"%WSF:VLOOKUP%":15,"%WSF:MATCH%":15,"%WSF:AND%":14,"%BOOL:FALSE%":13},{"%NUMBER%":200,"%WSF:IF%":130,"%WSF:SUM%":57,"%WSF:INDEX%":20,"%WSF:MATCH%":13,"%WSF:AND%":13,"%WSF:OFFSET%":13},{"%NUMBER%":200,"%WSF:IF%":130,"%WSF:SUM%":59,"%WSF:INDEX%":19,"%WSF:MATCH%":13},{"%NUMBER%":210,"%WSF:IF%":140,"%WSF:SUM%":59,"%WSF:INDEX%":20,"%WSF:MATCH%":14,"%WSF:AND%":14},{"%NUMBER%":210,"%WSF:IF%":140,"%WSF:SUM%":59,"%WSF:INDEX%":20,"%WSF:AND%":14,"%WSF:MATCH%":14,"%WSF:OFFSET%":13},{"%NUMBER%":200,"%WSF:IF%":130,"%WSF:SUM%":59,"%WSF:INDEX%":19,"%WSF:AND%":14,"%WSF:MATCH%":13,"%WSF:OFFSET%":13},{"%NUMBER%":200,"%WSF:IF%":130,"%WSF:SUM%":59,"%WSF:INDEX%":20,"%WSF:MATCH%":14},{"%NUMBER%":250,"%WSF:IF%":160,"%WSF:SUM%":62,"%WSF:INDEX%":21,"%WSF:VLOOKUP%":15,"%WSF:MATCH%":15,"%WSF:AND%":14,"%BOOL:FALSE%":13},{"%NUMBER%":200,"%WSF:IF%":130,"%WSF:SUM%":59,"%WSF:INDEX%":20,"%WSF:MATCH%":13,"%WSF:AND%":13,"%WSF:OFFSET%":13},{"%NUMBER%":240,"%WSF:IF%":160,"%WSF:SUM%":62,"%WSF:INDEX%":21,"%WSF:VLOOKUP%":15,"%WSF:MATCH%":15,"%WSF:AND%":14,"%BOOL:FALSE%":13},{"%NUMBER%":530,"%WSF:IF%":260,"%WSF:SUM%":110,"%WSF:INDEX%":66,"%WSF:AND%":32,"%WSF:OFFSET%":30,"%WSF:VLOOKUP%":23,"%WSF:OR%":21,"%BOOL:FALSE%":21,"%WSF:RANK%":21,"%WSF:INT%":20,"%WSF:ROW%":18,"%DATE%":16,"%WSF:SMALL%":15,"%WSF:ISBLANK%":13},{"%NUMBER%":310,"%WSF:IF%":170,"%WSF:VLOOKUP%":20,"%BOOL:FALSE%":18,"%WSF:INDEX%":17,no:13}]},4:{count:1e4,value:[{"%WSF:SUM%":220,"%NUMBER%":130,"%WSF:IF%":41,"%CURRENCY%":11,"%WSF:SUMIF%":5.5},{"%WSF:SUM%":150,"%NUMBER%":140,"%WSF:IF%":34,"%ERROR:#REF!%":18,"%CURRENCY%":8.4},{"%WSF:SUM%":250,"%NUMBER%":120,"%WSF:IF%":38,"%ERROR:#REF!%":19,"%CURRENCY%":10},{"%WSF:SUM%":160,"%NUMBER%":130,"%WSF:IF%":38,"%ERROR:#REF!%":18,"%CURRENCY%":8.1},{"%WSF:SUM%":260,"%NUMBER%":170,"%ERROR:#REF!%":55,"%WSF:IF%":27,"%WSF:MATCH%":14,"%WSF:OFFSET%":9.3,total:6.8,"%CURRENCY%":6.5},{"%WSF:SUM%":290,"%NUMBER%":120,"%ERROR:#REF!%":54,"%WSF:IF%":27,total:9.5,"%CURRENCY%":6.4},{"%WSF:SUM%":310,"%NUMBER%":93,"%ERROR:#REF!%":54,"%WSF:IF%":31},{"%WSF:SUM%":280,"%NUMBER%":89,"%ERROR:#REF!%":54,"%WSF:IF%":25},{"%WSF:SUM%":160,"%NUMBER%":120,"%WSF:IF%":31,"%ERROR:#REF!%":18,"%CURRENCY%":5.4},{"%WSF:SUM%":260,"%NUMBER%":98,"%WSF:IF%":35,"%ERROR:#REF!%":19},{"%WSF:SUM%":160,"%NUMBER%":110,"%WSF:IF%":35,"%ERROR:#REF!%":18},{"%WSF:SUM%":240,"%NUMBER%":98,"%WSF:IF%":35,"%CURRENCY%":5.5},{"%NUMBER%":870,"%WSF:SUM%":450,"%WSF:IF%":77,total:70,"%CURRENCY%":28,"%WSF:VLOOKUP%":27,"%DATE%":25,"%YEAR%":23,current:19,liabilities:18,all:15,time:13,"":13,de:12,"%WSF:MATCH%":11,"%WSF:OFFSET%":8.4,euclidean:7.9,"%WSF:MONTH%":7.5,"%BOOL:FALSE%":7.4,"%WSF:YEAR%":7.1,"%ERROR:#REF!%":6.9,arun:5.6,"%WSF:INDEX%":5.5,sussex:5.4},{"%WSF:SUM%":360,"%NUMBER%":340,"%WSF:IF%":48,sum:32,cum:32,error:31,"%YEAR%":24,total:21,"%WSF:MATCH%":19,squared:15,"%ERROR:#REF!%":14,"%WSF:INDEX%":11,"%WSF:COUNTIF%":11,"%WSF:OFFSET%":8.5,female:7.8,male:7.7,"%DATE%":6.2,year:6,"%WSF:MONTH%":5.4}]},5:{count:1e4,value:[{"%WSF:AVERAGE%":250,"%WSF:ROW%":240,"%WSF:INDEX%":220,"%NUMBER%":140,"%WSF:OFFSET%":21,"%WSF:IF%":12},{"%NUMBER%":160,"%WSF:AVERAGE%":140,"%WSF:ROW%":130,"%WSF:INDEX%":110,"%WSF:OFFSET%":20,"%WSF:IF%":12},{"%WSF:AVERAGE%":250,"%WSF:ROW%":240,"%WSF:INDEX%":220,"%NUMBER%":140,"%WSF:OFFSET%":21,"%WSF:IF%":12},{"%WSF:AVERAGE%":160,"%NUMBER%":140,"%WSF:ROW%":130,"%WSF:INDEX%":110,"%WSF:OFFSET%":20,"%WSF:IF%":13},{"%NUMBER%":160,"%WSF:AVERAGE%":73,"%WSF:OFFSET%":20,"%WSF:ROW%":19,"%WSF:IF%":13},{"%NUMBER%":160,"%WSF:AVERAGE%":150,"%WSF:ROW%":130,"%WSF:INDEX%":110,"%WSF:OFFSET%":20,"%WSF:IF%":12},{"%WSF:AVERAGE%":170,"%NUMBER%":140,"%WSF:ROW%":130,"%WSF:INDEX%":110,"%WSF:OFFSET%":20,"%WSF:IF%":12,"%WSF:LEFT%":9.5},{"%NUMBER%":160,"%WSF:AVERAGE%":74,"%WSF:OFFSET%":19,"%WSF:ROW%":18,"%WSF:IF%":13,"%WSF:LEFT%":9.6},{"%NUMBER%":160,"%WSF:AVERAGE%":140,"%WSF:ROW%":130,"%WSF:INDEX%":110,"%WSF:OFFSET%":20,"%WSF:IF%":12},{"%WSF:AVERAGE%":250,"%WSF:ROW%":240,"%WSF:INDEX%":220,"%NUMBER%":130,"%WSF:OFFSET%":21,"%WSF:IF%":12},{"%WSF:AVERAGE%":160,"%NUMBER%":140,"%WSF:ROW%":130,"%WSF:INDEX%":110,"%WSF:OFFSET%":20,"%WSF:IF%":12,"%WSF:LEFT%":9.5},{"%WSF:AVERAGE%":250,"%WSF:ROW%":240,"%WSF:INDEX%":220,"%NUMBER%":130,"%WSF:OFFSET%":21,"%WSF:IF%":12},{"%NUMBER%":440,"%WSF:AVERAGE%":180,"%DATE%":150,"%TIME%":110,"%WSF:IF%":52,"%WSF:LEFT%":38,"%WSF:IFERROR%":36,"%WSF:VLOOKUP%":31,"%BOOL:TRUE%":30,"%WSF:RAND%":28,"%WSF:WEEKDAY%":19,"%WSF:SQRT%":15},{"%WSF:AVERAGE%":260,"%NUMBER%":89,"%WSF:INDEX%":72,"%WSF:ROW%":71,mean:36,"%WSF:IF%":24,"%WSF:IFERROR%":19,"%WSF:LEFT%":19,smoothed:18,uv:18,bc:18,adult:17,liver:17,brain:17,fetal:17,"":10,"":10}]},22:{count:1e4,value:[{"%WSF:LN%":530,"%NUMBER%":25,"%WSF:EXP%":4.7,"%WSF:SQRT%":4.6},{"%WSF:LN%":420,"%DATE%":66,"%NUMBER%":60,"%WSF:SQRT%":21},{"%WSF:LN%":530,"%NUMBER%":26,"%WSF:EXP%":5.2,"%WSF:SQRT%":4.8},{"%WSF:LN%":440,"%NUMBER%":14},{"%WSF:LN%":350,"%DATE%":72,"%NUMBER%":23,"%WSF:STDEV.S%":21},{"%WSF:LN%":420,"%DATE%":66,"%NUMBER%":59,"%WSF:SQRT%":21},{"%WSF:LN%":440,"%NUMBER%":14,"%WSF:IF%":4.3},{"%WSF:LN%":360,"%NUMBER%":33,"%WSF:SQRT%":6.3},{"%WSF:LN%":420,"%DATE%":66,"%NUMBER%":59,"%WSF:SQRT%":21},{"%WSF:LN%":530,"%NUMBER%":26,"%WSF:EXP%":5.5,"%WSF:SQRT%":5.1},{"%WSF:LN%":440,"%NUMBER%":14,"%WSF:IF%":4.2},{"%WSF:LN%":530,"%NUMBER%":26,"%WSF:EXP%":5.5,"%WSF:SQRT%":5.2},{"%WSF:LN%":830,"%DATE%":490,"%NUMBER%":360,"%WSF:RAND%":86,"%WSF:IF%":8},{"%WSF:LN%":890,"%":66,afkast:66,index:66,daglig:66,iboxx:66,us:66,tri:66,spgsci:66,guld:66,spot:66,spx:66,"%NUMBER%":49,ln:28,date:10,day:7.3,loss:7.3,model:7,universe:7,aaadia:7,op:7,mt:7,"%DATE%":7,return:5.8}]},27:{count:1e4,value:[{"%NUMBER%":310,"%WSF:ROUND%":120,"%WSF:IF%":70,"%WSF:LEFT%":39,"%WSF:WEEKDAY%":20,"%WSF:SUM%":17,"%WSF:AVERAGE%":9.8},{"%NUMBER%":270,"%WSF:ROUND%":120,"%WSF:IF%":56,"%WSF:LEFT%":30,"%WSF:WEEKDAY%":15,"%WSF:SUM%":15,"%WSF:AVERAGE%":7.5},{"%NUMBER%":320,"%WSF:ROUND%":130,"%WSF:IF%":71,"%WSF:LEFT%":39,"%WSF:WEEKDAY%":20,"%WSF:SUM%":18,"%WSF:AVERAGE%":9.9},{"%NUMBER%":270,"%WSF:ROUND%":120,"%WSF:IF%":56,"%WSF:LEFT%":30,"%WSF:WEEKDAY%":15,"%WSF:SUM%":15,"%WSF:AVERAGE%":11},{"%NUMBER%":240,"%WSF:ROUND%":120,"%WSF:IF%":39,"%WSF:LEFT%":20,"%WSF:SUM%":12,"%WSF:WEEKDAY%":10},{"%NUMBER%":280,"%WSF:ROUND%":130,"%WSF:IF%":57,"%WSF:LEFT%":30,"%WSF:SUM%":16,"%WSF:WEEKDAY%":15,"%WSF:AVERAGE%":7.7},{"%NUMBER%":280,"%WSF:ROUND%":130,"%WSF:IF%":58,"%WSF:LEFT%":30,"%WSF:SUM%":16,"%WSF:WEEKDAY%":15,"%WSF:AVERAGE%":11},{"%NUMBER%":240,"%WSF:ROUND%":120,"%WSF:IF%":39,"%WSF:LEFT%":20,"%WSF:SUM%":13,"%WSF:WEEKDAY%":10,"%WSF:AVERAGE%":9.6},{"%NUMBER%":270,"%WSF:ROUND%":120,"%WSF:IF%":55,"%WSF:LEFT%":30,"%WSF:SUM%":15,"%WSF:WEEKDAY%":15,"%WSF:AVERAGE%":7.5},{"%NUMBER%":320,"%WSF:ROUND%":130,"%WSF:IF%":71,"%WSF:LEFT%":39,"%WSF:WEEKDAY%":20,"%WSF:SUM%":18,"%WSF:AVERAGE%":9.8},{"%NUMBER%":270,"%WSF:ROUND%":120,"%WSF:IF%":56,"%WSF:LEFT%":30,"%WSF:WEEKDAY%":15,"%WSF:SUM%":15,"%WSF:AVERAGE%":11},{"%NUMBER%":310,"%WSF:ROUND%":130,"%WSF:IF%":70,"%WSF:LEFT%":39,"%WSF:SUM%":21,"%WSF:WEEKDAY%":20,"%WSF:AVERAGE%":9.7},{"%NUMBER%":1e3,"%WSF:ROUND%":430,"%WSF:IF%":210,"%WSF:LEFT%":120,"%TIME%":110,"%WSF:WEEKDAY%":61,"%WSF:SUM%":35,"%WSF:AVERAGE%":31},{"%NUMBER%":600,"%WSF:ROUND%":240,"%WSF:IF%":130,"%DATE%":82,"%WSF:LEFT%":77,"%WSF:WEEKDAY%":39,"%WSF:SUM%":28,"%":20,th:20,"%WSF:AVERAGE%":19,avg:6.5}]},28:{count:1e4,value:[{"%WSF:LOOKUP%":58,"%NUMBER%":28,"%WSF:INT%":12,"%WSF:RAND%":12},{"%NUMBER%":50,"%WSF:LOOKUP%":15,"%WSF:RAND%":11,"%WSF:INT%":11},{"%WSF:LOOKUP%":63,"%NUMBER%":31,"%WSF:INT%":14,"%WSF:RAND%":14},{"%NUMBER%":51,"%WSF:LOOKUP%":15,"%WSF:RAND%":11,"%WSF:INT%":11},{"%NUMBER%":920,"%WSF:LOOKUP%":190,"%WSF:INT%":18,"%WSF:RAND%":18},{"%NUMBER%":820,"%WSF:LOOKUP%":170,"%WSF:INT%":21,"%WSF:RAND%":21},{"%NUMBER%":920,"%WSF:LOOKUP%":210,"%WSF:RAND%":21,"%WSF:INT%":21},{"%NUMBER%":1e3,"%WSF:LOOKUP%":220,"%WSF:INT%":18,"%WSF:RAND%":18},{"%NUMBER%":61,na:19,area:16,"%WSF:LOOKUP%":15,"%WSF:RAND%":11,"%WSF:INT%":11,system:10,no:9.7,in:9.3},{"%WSF:LOOKUP%":65,"%NUMBER%":43,area:26,no:26,na:14,"%WSF:RAND%":14,"%WSF:INT%":14,in:13,enclosed:12},{"%NUMBER%":67,area:24,na:20,storage:18,"%WSF:LOOKUP%":15,"%WSF:RAND%":11,"%WSF:INT%":11,chemical:11,in:9.8,system:9.4,no:9.1,chemicals:9.1},{"%WSF:LOOKUP%":60,"%NUMBER%":28,"%WSF:INT%":12,"%WSF:RAND%":12},{"%NUMBER%":1200,"%WSF:LOOKUP%":230,"%WSF:RAND%":110,"%WSF:INT%":110,cuatrim:19,lic:12},{"%NUMBER%":240,"%WSF:LOOKUP%":150,"%WSF:RAND%":82,"%WSF:INT%":82,of:60,exposure:43,no:34,de:20,descripcion:20,periodo:20,convenio:20,beca:20,as:17,oc:17,conditions:17,incidents:17,na:17,control:17,measures:17,containment:17,yes:17,vapour:17,ppe:17,substance:17,limit:17,in:8.6,to:8.6,form:8.6,is:8.6,state:8.6}]},29:{count:1e4,value:[{"%WSF:INDEX%":260,"%NUMBER%":220,"%WSF:MATCH%":150,"%BOOL:TRUE%":13,"%WSF:LINEST%":11},{"%NUMBER%":200,"%WSF:INDEX%":160,"%WSF:MATCH%":71,"%WSF:LINEST%":8.1,"%WSF:IF%":7.7,"%BOOL:TRUE%":6.9,"%WSF:ROW%":5.7},{"%WSF:INDEX%":270,"%NUMBER%":220,"%WSF:MATCH%":150,"%BOOL:TRUE%":14,"%WSF:LINEST%":12},{"%WSF:INDEX%":160,"%NUMBER%":140,"%WSF:MATCH%":73,"%BOOL:TRUE%":14,"%WSF:LINEST%":8.1,"%WSF:IF%":7.2},{"%NUMBER%":260,"%WSF:INDEX%":160,"%WSF:MATCH%":73,"%WSF:IF%":25,"%WSF:LINEST%":5.7},{"%NUMBER%":220,"%WSF:INDEX%":180,"%WSF:MATCH%":80,"%WSF:LINEST%":11,"%WSF:IF%":9.1,"%BOOL:TRUE%":7.9,"%BOOL:FALSE%":6.7,"%WSF:ROW%":6,"%WSF:VLOOKUP%":5.6},{"%WSF:INDEX%":170,"%NUMBER%":160,"%WSF:MATCH%":82,"%BOOL:TRUE%":16,"%WSF:LINEST%":11,"%WSF:IF%":7.4,"%BOOL:FALSE%":6.6},{"%NUMBER%":170,"%WSF:INDEX%":140,"%WSF:MATCH%":73,"%BOOL:FALSE%":13,"%WSF:IF%":13,"%WSF:VLOOKUP%":12,"%BOOL:TRUE%":7.9,"%WSF:LINEST%":5.7},{"%NUMBER%":200,"%WSF:INDEX%":160,"%WSF:MATCH%":73,"%WSF:LINEST%":9,"%WSF:IF%":8.7,"%BOOL:TRUE%":7.7,"%WSF:ROW%":5.7,"%WSF:VLOOKUP%":5.6},{"%WSF:INDEX%":270,"%NUMBER%":230,"%WSF:MATCH%":160,"%BOOL:TRUE%":16,"%WSF:LINEST%":13,"%WSF:VLOOKUP%":5.7},{"%WSF:INDEX%":160,"%NUMBER%":150,"%WSF:MATCH%":75,"%BOOL:TRUE%":15,"%WSF:LINEST%":9,"%WSF:IF%":8.2},{"%WSF:INDEX%":270,"%NUMBER%":220,"%WSF:MATCH%":150,"%BOOL:TRUE%":15,"%WSF:LINEST%":13},{"%NUMBER%":840,"%WSF:INDEX%":470,"%WSF:MATCH%":190,"%WSF:IF%":140,"%DATE%":98,"%YEAR%":34,lgr:29,bgr:18,"%WSF:VLOOKUP%":16,"%BOOL:FALSE%":14,bgo:12,lgs:8.7,"%WSF:ROW%":8.3},{"%WSF:INDEX%":320,"%NUMBER%":300,"%WSF:MATCH%":200,name:41,"%CURRENCY%":23,"%WSF:AVERAGE%":15,"%WSF:INDIRECT%":11,"%BOOL:FALSE%":9.4,"%WSF:VLOOKUP%":9.4,"%WSF:IF%":6.9,"%WSF:LINEST%":6.7,tier:6.2}]},33:{count:1e4,value:[{"%WSF:VALUE%":220,"%NUMBER%":220,"%WSF:TEXT%":200,"%WSF:MID%":4.7},{"%NUMBER%":230,"%WSF:VALUE%":210,"%WSF:TEXT%":200,"%WSF:MID%":5},{"%WSF:VALUE%":220,"%NUMBER%":220,"%WSF:TEXT%":200,"%WSF:MID%":4.7},{"%NUMBER%":210,"%WSF:VALUE%":210,"%WSF:TEXT%":200,"%WSF:MID%":4.2},{"%NUMBER%":220,"%WSF:VALUE%":200,"%WSF:TEXT%":190,"%WSF:MID%":5.9},{"%NUMBER%":230,"%WSF:VALUE%":210,"%WSF:TEXT%":200,"%WSF:MID%":5},{"%NUMBER%":210,"%WSF:VALUE%":210,"%WSF:TEXT%":200,"%WSF:MID%":4.2},{"%NUMBER%":210,"%WSF:VALUE%":200,"%WSF:TEXT%":190},{"%NUMBER%":220,"%WSF:VALUE%":210,"%WSF:TEXT%":200,"%WSF:MID%":5},{"%WSF:VALUE%":220,"%NUMBER%":210,"%WSF:TEXT%":200,"%WSF:MID%":4.7},{"%NUMBER%":210,"%WSF:VALUE%":210,"%WSF:TEXT%":200,"%WSF:MID%":4.2},{"%WSF:VALUE%":220,"%NUMBER%":210,"%WSF:TEXT%":200,"%WSF:MID%":4.7},{"%NUMBER%":700,"%WSF:VLOOKUP%":200,"%BOOL:FALSE%":200,na:97,vegetable:81,crop:48,tree:45,field:38,row:36,fruit:33,low:28,medium:24,leafy:23,vine:20,trellis:20,"%WSF:VALUE%":20,deciduous:19,"%WSF:MID%":17,cucurbit:16,root:14,fruiting:14,evergreen:14,stem:13,unassigned:13,tall:12,nut:11,grape:10,and:10,corn:9.4,non:8.4,plants:8.4,ornamentals:8.4,bearing:8.4,head:7.8,brassica:7.8,"%WSF:TRIM%":7.2,sweet:6.6,greenhouse:6.5,bunch:6.2,bundle:6.2,stalk:5.3,cabbage:5.3,green:5.2,berry:4.5,pepper:4.3,nursery:4.3,dry:4.3,tomato:4.3,squash:4.3,blueberry:4.2,grain:4,pea:3.9},{"%WSF:VALUE%":33,"%NUMBER%":12,"%WSF:TRIM%":4.9}]},37:{count:1e4,value:[{"%WSF:OR%":180,all:180},{"%WSF:OR%":280,"%NUMBER%":180,"%WSF:VLOOKUP%":180,"%BOOL:FALSE%":180,"%WSF:AND%":92,all:92},{"%WSF:OR%":180,all:180},{ngst:92,"%WSF:FIND%":92,"%WSF:LEFT%":92,"%WSF:IFERROR%":92},{"%NUMBER%":93,"%BOOL:FALSE%":92,"%WSF:VLOOKUP%":92,"%WSF:LEFT%":92,"%WSF:FIND%":92,"%WSF:IFERROR%":92,ngst:92},{"%WSF:OR%":280,"%NUMBER%":190,"%BOOL:FALSE%":180,"%WSF:VLOOKUP%":180,"%WSF:AND%":92,all:92},{ngst:92,"%WSF:LEFT%":92,"%WSF:IFERROR%":92,"%WSF:FIND%":92},{"%NUMBER%":190,"%WSF:VLOOKUP%":180,"%BOOL:FALSE%":180},{"%WSF:OR%":280,"%NUMBER%":180,"%BOOL:FALSE%":180,"%WSF:VLOOKUP%":180,"%WSF:AND%":92,all:92},{"%WSF:OR%":190,all:180},{ngst:92,"%WSF:LEFT%":92,"%WSF:IFERROR%":92,"%WSF:FIND%":92},{"%WSF:OR%":180,all:180},{"%NUMBER%":350,"%YEAR%":170,fy:170,jpmc:80,citi:69,of:63,department:54,ngst:39,usb:23,commission:21,administration:20,national:18,all:17,federal:13,and:13,agencies:11,office:10,ind:9.6,misc:9.6,corporation:9.4,security:8.6,service:8.4,for:7.6,tribal:7.3,organizations:7.3,services:6.9,development:5.9,agency:5.9,labor:5.4,defense:5.2,social:5.2,trade:5.1,international:5.1,credit:5.1},{"%WSF:OR%":740,all:740,ytdtrend:92,sydbpagency:92}]},78:{count:1e4,value:[{"%NUMBER%":370,"%WSF:OFFSET%":190,"%WSF:MATCH%":34,"%WSF:ROW%":9.7},{"%NUMBER%":270,"%WSF:OFFSET%":130,"%WSF:MATCH%":23,fy:12,"%WSF:ROW%":9},{"%NUMBER%":380,"%WSF:OFFSET%":200,"%WSF:MATCH%":35,"%WSF:ROW%":10},{"%NUMBER%":300,"%WSF:OFFSET%":140,"%WSF:MATCH%":33,fy:12,"%WSF:ROW%":9,"%WSF:IF%":6.4},{"%NUMBER%":320,"%WSF:OFFSET%":150,"%WSF:MATCH%":20,fy:12,"%WSF:INT%":10,"%WSF:DATE%":10,"%WSF:ROW%":9},{"%NUMBER%":380,"%WSF:OFFSET%":180,"%WSF:MATCH%":24,fy:12,"%WSF:ROW%":9.2},{"%NUMBER%":400,"%WSF:OFFSET%":200,"%WSF:MATCH%":34,fy:12,"%WSF:ROW%":9.2,"%WSF:IF%":6.4},{"%NUMBER%":300,"%WSF:OFFSET%":160,"%WSF:MATCH%":32,fy:12,"%WSF:INT%":9.4,"%WSF:ROW%":8.5,"%WSF:SUMIF%":5.3},{"%NUMBER%":260,"%WSF:OFFSET%":130,"%WSF:MATCH%":23,fy:12,"%WSF:ROW%":9},{"%NUMBER%":380,"%WSF:OFFSET%":200,"%WSF:MATCH%":35,"%WSF:ROW%":10},{"%NUMBER%":290,"%WSF:OFFSET%":140,"%WSF:MATCH%":32,fy:12,"%WSF:ROW%":9,"%WSF:IF%":6.2},{"%NUMBER%":370,"%WSF:OFFSET%":200,"%WSF:MATCH%":34,"%WSF:ROW%":9.8},{"%NUMBER%":620,"%WSF:OFFSET%":300,"%WSF:MATCH%":32,"%WSF:ROW%":30,fy:21,"%DATE%":19,fb:9.2,"%WSF:COLUMN%":6.1,total:4.4,"%WSF:IF%":4.3,ahy:4,men:3.8},{"%NUMBER%":1e3,"%WSF:OFFSET%":460,"%WSF:MATCH%":73,taxonomy:33,dod:28,"":21,services:14,goods:14,actions:12,obligations:12,tab:12,workout:12,"":10,st:10,"":10,or:10,category:9.6,group:9.4,portfolio:9.4,"%WSF:ROW%":5.3,and:5.3,agency:5.3,"%WSF:IF%":4.5,no:4.1,id:3.7,contracting:3.5,major:3.5}]},101:{count:1e4,value:[{"%WSF:HLOOKUP%":240,"%BOOL:FALSE%":220,"%NUMBER%":71},{"%WSF:HLOOKUP%":180,"%BOOL:FALSE%":170,"%NUMBER%":77,"%WSF:VLOOKUP%":38,"%BOOL:TRUE%":35,"%WSF:IF%":9.3},{"%WSF:HLOOKUP%":240,"%BOOL:FALSE%":220,"%NUMBER%":75},{"%NUMBER%":280,"%BOOL:FALSE%":210,"%WSF:HLOOKUP%":170,"%WSF:VLOOKUP%":38,"%WSF:IF%":10},{"%WSF:HLOOKUP%":180,"%BOOL:FALSE%":170,"%NUMBER%":49},{"%WSF:HLOOKUP%":190,"%BOOL:FALSE%":180,"%NUMBER%":79,"%WSF:VLOOKUP%":36,"%BOOL:TRUE%":36},{"%NUMBER%":290,"%BOOL:FALSE%":210,"%WSF:HLOOKUP%":180,"%WSF:VLOOKUP%":36,"%WSF:IF%":8.7},{"%BOOL:FALSE%":210,"%WSF:HLOOKUP%":180,"%NUMBER%":59,"%WSF:VLOOKUP%":36},{"%WSF:HLOOKUP%":180,"%BOOL:FALSE%":170,"%NUMBER%":74,"%WSF:VLOOKUP%":35,"%BOOL:TRUE%":35},{"%WSF:HLOOKUP%":240,"%BOOL:FALSE%":230,"%NUMBER%":72},{"%NUMBER%":280,"%BOOL:FALSE%":210,"%WSF:HLOOKUP%":170,"%WSF:VLOOKUP%":35,"%WSF:IF%":9},{"%WSF:HLOOKUP%":240,"%BOOL:FALSE%":220,"%NUMBER%":71},{"%NUMBER%":240,de:180,"%WSF:HLOOKUP%":170,"%BOOL:FALSE%":160,"%WSF:CONCATENATE%":150,obras:69,"%WSF:VLOOKUP%":63,"%BOOL:TRUE%":52,"construo":41,"%DATE%":36,you:34,para:28,"instalaes":27,anteriormente:27,"no":27,"%WSF:SQRT%":26,"%WSF:PERCENTILE%":26,question:21,did:16,br:16,the:16,or:14,ccfp:14,bimc:14,"gua":14,especificadas:14,especificados:14,"preparao":14,"construes":14,esgoto:14,"servios":14,redes:14,in:13,to:13,shqcc:12,"%WSF:IF%":12,"%WSF:ISERROR%":11,and:10,your:9.3,do:8.9,of:8.6,were:8.1,total:8.1},{"%WSF:HLOOKUP%":64,"%NUMBER%":60,"%BOOL:FALSE%":29,trust:26,nhs:25,"%ERROR:#REF!%":17,foundation:14,hospitals:10,"ms":9.8}]},102:{count:1e4,value:[{"%NUMBER%":230,"%WSF:VLOOKUP%":210,"%BOOL:TRUE%":110,"%BOOL:FALSE%":73,"%WSF:MATCH%":6.9},{"%NUMBER%":190,"%WSF:VLOOKUP%":150,"%BOOL:TRUE%":100,"%BOOL:FALSE%":30,"%WSF:DATE%":7.2,"%WSF:MATCH%":6.7,"%WSF:IF%":6.3},{"%NUMBER%":230,"%WSF:VLOOKUP%":210,"%BOOL:TRUE%":110,"%BOOL:FALSE%":74,"%WSF:MATCH%":7.3,"%WSF:DATE%":5.1},{"%NUMBER%":220,"%WSF:VLOOKUP%":150,"%BOOL:TRUE%":100,"%BOOL:FALSE%":34,"%WSF:IF%":30,"%WSF:MATCH%":6.7,"%WSF:AND%":5.6},{"%NUMBER%":190,"%WSF:VLOOKUP%":140,"%BOOL:TRUE%":100,"%BOOL:FALSE%":29,"%WSF:MATCH%":7.3,"%WSF:DATE%":7.2,"%WSF:OR%":6.8,all:6.8,"%WSF:IF%":6.7},{"%NUMBER%":200,"%WSF:VLOOKUP%":150,"%BOOL:TRUE%":100,"%BOOL:FALSE%":31,"%WSF:MATCH%":7.8,"%WSF:DATE%":7.2,"%WSF:IF%":6.3},{"%NUMBER%":230,"%WSF:VLOOKUP%":160,"%BOOL:TRUE%":100,"%BOOL:FALSE%":35,"%WSF:IF%":30,"%WSF:MATCH%":7.8,"%WSF:AND%":5.6},{"%NUMBER%":200,"%WSF:VLOOKUP%":150,"%BOOL:TRUE%":100,"%BOOL:FALSE%":30,"%WSF:IF%":19,"%WSF:MATCH%":7.4,"%WSF:DATE%":5.1},{"%NUMBER%":190,"%WSF:VLOOKUP%":150,"%BOOL:TRUE%":100,"%BOOL:FALSE%":30,"%WSF:DATE%":7.2,"%WSF:MATCH%":6.7,"%WSF:IF%":6.6},{"%NUMBER%":230,"%WSF:VLOOKUP%":210,"%BOOL:TRUE%":110,"%BOOL:FALSE%":74,"%WSF:MATCH%":7.3,"%WSF:DATE%":5.1},{"%NUMBER%":220,"%WSF:VLOOKUP%":150,"%BOOL:TRUE%":100,"%BOOL:FALSE%":34,"%WSF:IF%":30,"%WSF:MATCH%":6.7,"%WSF:AND%":5.6},{"%NUMBER%":220,"%WSF:VLOOKUP%":210,"%BOOL:TRUE%":110,"%BOOL:FALSE%":73,"%WSF:MATCH%":7},{"%NUMBER%":680,"%WSF:VLOOKUP%":380,"%BOOL:TRUE%":290,"%BOOL:FALSE%":51,"%WSF:DATE%":20,"%WSF:MATCH%":15,"%YEAR%":15,"%DATE%":13,"%WSF:IF%":12,"%WSF:AVERAGE%":7.7,fy:6.4},{"%NUMBER%":270,"%WSF:VLOOKUP%":200,"%BOOL:FALSE%":170,"%WSF:MATCH%":14,"%BOOL:TRUE%":11,"%YEAR%":6.3,"%WSF:AVERAGE%":6.3,size:5.5,weighted:5.5,list:5.5,"%WSF:DATE%":5.1}]},109:{count:1e4,value:[{"%WSF:LOG%":260,"%NUMBER%":260},{"%NUMBER%":230,"%WSF:LOG%":230},{"%WSF:LOG%":260,"%NUMBER%":260},{"%NUMBER%":240,"%WSF:LOG%":230},{"%NUMBER%":190,"%WSF:LOG%":190},{"%WSF:LOG%":230,"%NUMBER%":230},{"%NUMBER%":240,"%WSF:LOG%":230},{"%NUMBER%":230,"%WSF:LOG%":190},{"%WSF:LOG%":230,"%NUMBER%":230},{"%WSF:LOG%":260,"%NUMBER%":260},{"%NUMBER%":240,"%WSF:LOG%":230},{"%WSF:LOG%":260,"%NUMBER%":260},{"%NUMBER%":760,"%WSF:LOG%":760},{"%NUMBER%":1200,"%WSF:LOG%":1e3,brain:150,adult:130,fetal:130}]},119:{count:1e4,value:[{"%NUMBER%":380,"%WSF:REPLACE%":130,"%WSF:MATCH%":130,"%WSF:INDEX%":130},{"%NUMBER%":190,"%WSF:MATCH%":48,"%WSF:REPLACE%":48,"%WSF:INDEX%":48,yes:25,no:3.9},{"%NUMBER%":380,"%WSF:REPLACE%":130,"%WSF:INDEX%":130,"%WSF:MATCH%":130},{"%NUMBER%":220,"%WSF:MATCH%":48,"%WSF:INDEX%":48,"%WSF:REPLACE%":48,com:17,http:15,www:11,utm:8.3,https:6.8,electric:6.7,car:6.5,twitter:5.3,news:4.6,"%":3.3},{"%NUMBER%":59,com:30,twitter:30,https:30},{"%NUMBER%":190,"%WSF:MATCH%":48,"%WSF:INDEX%":48,"%WSF:REPLACE%":48,yes:25,no:3.9},{"%NUMBER%":220,"%WSF:MATCH%":48,"%WSF:INDEX%":48,"%WSF:REPLACE%":48,com:17,http:15,www:11,utm:8.3,https:6.8,electric:6.7,car:6.5,twitter:5.3,news:4.6},{"%NUMBER%":120,com:17,http:15,www:11,utm:8.3,https:6.8,electric:6.7,car:6.5,twitter:5.3,news:4.6},{"%NUMBER%":190,"%WSF:MATCH%":48,"%WSF:INDEX%":48,"%WSF:REPLACE%":48,yes:25,no:3.9},{"%NUMBER%":380,"%WSF:REPLACE%":130,"%WSF:INDEX%":130,"%WSF:MATCH%":130},{"%NUMBER%":220,"%WSF:REPLACE%":48,"%WSF:MATCH%":48,"%WSF:INDEX%":48,com:17,http:15,www:11,utm:8.3,https:6.8,electric:6.7,car:6.5,twitter:5.3,news:4.6},{"%NUMBER%":380,"%WSF:REPLACE%":130,"%WSF:INDEX%":130,"%WSF:MATCH%":130},{"%NUMBER%":210,green:71,solid:66,dot:52,image:29,dash:26,who:4.4,onlyinsf:4.3},{"%NUMBER%":1200,"%WSF:REPLACE%":380,"%WSF:INDEX%":380,"%WSF:MATCH%":380,group:130,vertex:130}]},336:{count:1e4,value:[{"%WSF:CONCATENATE%":220,"%NUMBER%":170,"%WSF:LEFT%":170},{"%NUMBER%":80,"%WSF:CONCATENATE%":77},{"%WSF:CONCATENATE%":220,"%NUMBER%":170,"%WSF:LEFT%":170},{"%NUMBER%":200,"%WSF:LEFT%":150,"%WSF:CONCATENATE%":78,"%YEAR%":7},{"%NUMBER%":82,"%CURRENCY%":11},{"%NUMBER%":82,"%WSF:CONCATENATE%":79},{"%NUMBER%":200,"%WSF:LEFT%":150,"%WSF:CONCATENATE%":80,"%YEAR%":7.2},{"%NUMBER%":110,de:11,del:7,regional:6.6,gobierno:6.6,departamento:6.3},{"%NUMBER%":81,"%WSF:CONCATENATE%":78},{"%WSF:CONCATENATE%":220,"%NUMBER%":170,"%WSF:LEFT%":170},{"%NUMBER%":200,"%WSF:LEFT%":150,"%WSF:CONCATENATE%":78,"%YEAR%":7.1},{"%WSF:CONCATENATE%":220,"%NUMBER%":170,"%WSF:LEFT%":170},{"%NUMBER%":640,gobiernos:310,regionales:310,del:170,de:160,"%YEAR%":150,regional:150,gobierno:150,departamento:150,enfermedades:60,programa:38,articulado:38,nutricional:38,no:36,transmisibles:36,prevencion:24,control:24,metaxenicas:24,zoonosis:24,salud:22,cancer:22,materno:19,neonatal:19,la:17,vih:7.2,sida:7.2,tbc:7.2,"%WSF:CONCATENATE%":7,libertad:6.1,cajamarca:6.1,puno:6.1,piura:6.1,dios:6.1,ancash:6.1,huanuco:6.1,apurimac:6.1,ayacucho:6.1,huancavelica:6.1,madre:6.1,arequipa:6.1,pasco:6.1,lima:6.1,amazonas:6.1,cusco:6.1,loreto:6.1,junin:6.1,lambayeque:6.1,ica:6.1,moquegua:6.1,san:6.1,ucayali:6.1,tumbes:6.1,tacna:6.1,martin:6.1,provincia:6,callao:6,constitucional:6},{"%WSF:CONCATENATE%":860,"%NUMBER%":660,"%WSF:LEFT%":640,index:160,nac:77,"":52,"%WSF:IF%":5.5}]},345:{count:1e4,value:[{"%WSF:SUMIF%":400,"%NUMBER%":54,"%WSF:VLOOKUP%":8.5},{"%WSF:SUMIF%":230,"%NUMBER%":110,"%WSF:VLOOKUP%":31,"%BOOL:FALSE%":26,"%WSF:IF%":18,"%WSF:SUM%":12},{"%WSF:SUMIF%":430,"%NUMBER%":58,"%WSF:SUM%":9.1,"%WSF:VLOOKUP%":8.8},{"%WSF:SUMIF%":230,"%NUMBER%":110,"%YEAR%":65,"%WSF:VLOOKUP%":32,"%BOOL:FALSE%":29,"%WSF:IF%":25,"%WSF:SUM%":20,october:6.6,december:6.6},{"%WSF:SUMIF%":290,"%NUMBER%":83,"%WSF:COUNTIF%":69,"%WSF:VLOOKUP%":17,"%BOOL:FALSE%":13,"%WSF:IF%":11},{"%WSF:SUMIF%":270,"%NUMBER%":110,"%WSF:VLOOKUP%":33,"%BOOL:FALSE%":28,"%WSF:IF%":19},{"%WSF:SUMIF%":280,"%NUMBER%":120,"%YEAR%":64,"%WSF:VLOOKUP%":34,"%BOOL:FALSE%":31,"%WSF:IF%":26,"%WSF:SUM%":14,october:6.7,december:6.6},{"%WSF:SUMIF%":290,"%NUMBER%":82,"%WSF:SUM%":22,"%WSF:IF%":14,"%WSF:VLOOKUP%":11},{"%WSF:SUMIF%":240,"%NUMBER%":110,"%WSF:VLOOKUP%":31,"%BOOL:FALSE%":27,"%WSF:IF%":20,"%WSF:SUM%":17},{"%WSF:SUMIF%":440,"%NUMBER%":56,"%WSF:SUM%":15,"%WSF:VLOOKUP%":8.4,"%BOOL:FALSE%":6.8},{"%WSF:SUMIF%":240,"%NUMBER%":110,"%YEAR%":64,"%WSF:VLOOKUP%":32,"%BOOL:FALSE%":30,"%WSF:IF%":26,"%WSF:SUM%":25,december:6.6,october:6.6,november:6.4},{"%WSF:SUMIF%":410,"%NUMBER%":46,"%WSF:SUM%":18,"%WSF:VLOOKUP%":8.1},{"%WSF:SUMIF%":570,"%NUMBER%":560,"%WSF:VLOOKUP%":80,"%BOOL:FALSE%":68,"%WSF:IF%":46,"%YEAR%":45,pwr:24,"%WSF:CONCATENATE%":23,"%WSF:AVERAGEIFS%":19,gl:19,"%DATE%":19,"%WSF:COLUMN%":17,total:13,"%WSF:COUNTIF%":13,"%WSF:SUM%":9.4,"":8.8,"%WSF:ISERROR%":7.9,"%WSF:MATCH%":6.8},{"%WSF:SUMIF%":430,"%NUMBER%":190,ssi:23,age:20,"%WSF:IF%":17,"%WSF:VLOOKUP%":15,tanf:11,afdc:11,"%WSF:SUM%":7.1,"%YEAR%":6.8,"%WSF:TEXT%":6.6,aaa:6.5}]},346:{count:1e4,value:[{"%WSF:COUNTIF%":340,"%NUMBER%":99},{"%WSF:COUNTIF%":130,"%NUMBER%":110,"%WSF:CONCATENATE%":81,"":78,"%DATE%":44,"%WSF:IF%":25,"%WSF:SUM%":13},{"%WSF:COUNTIF%":350,"%NUMBER%":94},{"%WSF:COUNTIF%":130,"%NUMBER%":120,"%WSF:REPT%":78,"%WSF:IF%":29,"%WSF:ROW%":23,"%WSF:OFFSET%":11,"%WSF:INDEX%":10,"%WSF:SMALL%":10,"%WSF:IFERROR%":10,"%WSF:SUM%":9.6},{"%NUMBER%":120,"%WSF:COUNTIF%":110,"%DATE%":55,"%WSF:LARGE%":15,"":15,"":14,"%WSF:IF%":12,"":11},{"%WSF:COUNTIF%":170,"%NUMBER%":120,"%WSF:CONCATENATE%":82,"":79,"%DATE%":45,"%WSF:IF%":24},{"%WSF:COUNTIF%":160,"%NUMBER%":130,"%WSF:REPT%":79,"%WSF:IF%":28,"%WSF:ROW%":23,"%WSF:OFFSET%":11,"%WSF:INDEX%":10,"%WSF:IFERROR%":10,"%WSF:SMALL%":10},{"%WSF:COUNTIF%":110,"%NUMBER%":110,"%WSF:SUMIF%":59,"%WSF:IF%":14,"%WSF:ROW%":9.4},{"%WSF:COUNTIF%":130,"%NUMBER%":110,"%WSF:CONCATENATE%":81,"":78,"%DATE%":45,"%WSF:IF%":27,"%WSF:SUM%":12},{"%WSF:COUNTIF%":360,"%NUMBER%":100,"%WSF:SUM%":12},{"%WSF:COUNTIF%":130,"%NUMBER%":120,"%WSF:REPT%":78,"%WSF:IF%":30,"%WSF:ROW%":23,"%WSF:OFFSET%":11,"%WSF:IFERROR%":10,"%WSF:INDEX%":10,"%WSF:SMALL%":10},{"%WSF:COUNTIF%":350,"%NUMBER%":95,"%WSF:SUM%":12},{"%NUMBER%":570,"%WSF:COUNTIF%":160,"%WSF:CONCATENATE%":110,"":79,"%WSF:IF%":36,"%WSF:VLOOKUP%":28,"%BOOL:FALSE%":28,"%WSF:IFERROR%":28,"%DATE%":26,"%WSF:SUMIF%":23,"":15,"":14,es:14,diferente:14,total:11,"":11,yes:11,"%YEAR%":10},{"%WSF:COUNTIF%":930,"%NUMBER%":280,"":79,"%WSF:IF%":46,"%BOOL:FALSE%":22,"%WSF:VLOOKUP%":20,respuestas:15,cantidad:15,"%WSF:SUM%":14,de:11,respuesta:11,anulada:11,"%WSF:OFFSET%":10}]},480:{count:1e4,value:[{"%NUMBER%":200,"%WSF:IFERROR%":140,"%WSF:VLOOKUP%":58,"%BOOL:FALSE%":56,"%WSF:MATCH%":53,"%WSF:IF%":22,"%WSF:INDEX%":21},{"%NUMBER%":160,"%WSF:IFERROR%":77,"%WSF:MATCH%":46,"%WSF:IF%":30,"%WSF:VLOOKUP%":29,"%BOOL:FALSE%":27},{"%NUMBER%":200,"%WSF:IFERROR%":140,"%WSF:VLOOKUP%":59,"%BOOL:FALSE%":57,"%WSF:MATCH%":53,"%WSF:IF%":22,"%WSF:INDEX%":21},{"%NUMBER%":160,"%WSF:IFERROR%":78,"%WSF:MATCH%":47,"%WSF:VLOOKUP%":42,"%BOOL:FALSE%":41,"%WSF:IF%":36},{"%NUMBER%":160,"%WSF:IFERROR%":75,"%WSF:MATCH%":44,"%WSF:VLOOKUP%":41,"%BOOL:FALSE%":37,"%WSF:OR%":37,"%WSF:IF%":31},{"%NUMBER%":170,"%WSF:IFERROR%":81,"%WSF:MATCH%":48,"%WSF:IF%":30,"%WSF:VLOOKUP%":30,"%BOOL:FALSE%":28,"%WSF:INDEX%":19},{"%NUMBER%":170,"%WSF:IFERROR%":82,"%WSF:MATCH%":49,"%WSF:VLOOKUP%":42,"%BOOL:FALSE%":41,"%WSF:IF%":37,"%WSF:INDEX%":19},{"%NUMBER%":160,"%WSF:IFERROR%":81,"%WSF:MATCH%":46,"%WSF:VLOOKUP%":26,"%WSF:IF%":26,"%BOOL:FALSE%":25},{"%NUMBER%":170,"%WSF:IFERROR%":78,"%WSF:MATCH%":47,"%WSF:IF%":29,"%WSF:VLOOKUP%":29,"%BOOL:FALSE%":27,"%WSF:INDEX%":18},{"%NUMBER%":200,"%WSF:IFERROR%":140,"%WSF:VLOOKUP%":59,"%BOOL:FALSE%":57,"%WSF:MATCH%":54,"%WSF:IF%":22,"%WSF:INDEX%":21},{"%NUMBER%":160,"%WSF:IFERROR%":79,"%WSF:MATCH%":47,"%WSF:VLOOKUP%":42,"%BOOL:FALSE%":41,"%WSF:IF%":36,"%WSF:INDEX%":18},{"%NUMBER%":200,"%WSF:IFERROR%":140,"%WSF:VLOOKUP%":58,"%BOOL:FALSE%":56,"%WSF:MATCH%":53,"%WSF:IF%":22,"%WSF:INDEX%":21},{"%NUMBER%":500,"%WSF:IFERROR%":150,"%WSF:IF%":110,"%WSF:MATCH%":100,"%WSF:VLOOKUP%":91,"%BOOL:FALSE%":85,"%WSF:INDEX%":41,"%WSF:COUNTIFS%":22,"%YEAR%":21,"%WSF:CONCATENATE%":18},{"%NUMBER%":350,"%WSF:IFERROR%":280,"%WSF:VLOOKUP%":150,"%BOOL:FALSE%":140,"%WSF:MATCH%":79,"%WSF:FIND%":50,"%WSF:LEFT%":49,ngst:49,"%WSF:IF%":47,"%WSF:INDEX%":31,"%WSF:CONCATENATE%":25}]},481:{count:1e4,value:[{"%WSF:COUNTIFS%":190,sa:120,primary:120,"%NUMBER%":84,no:63,"%ERROR:#REF!%":43},{"%WSF:COUNTIFS%":120,"%NUMBER%":85,primary:81,sa:81,no:40,"%ERROR:#REF!%":28},{"%WSF:COUNTIFS%":200,sa:120,primary:120,"%NUMBER%":89,no:63,"%ERROR:#REF!%":48},{"%WSF:COUNTIFS%":120,primary:81,sa:81,"%NUMBER%":55,no:40,"%ERROR:#REF!%":28},{"%WSF:COUNTIFS%":130,sa:82,primary:82,"%ERROR:#REF!%":48,"%NUMBER%":44,no:41},{"%WSF:COUNTIFS%":130,"%NUMBER%":85,sa:82,primary:82,no:41,"%ERROR:#REF!%":36},{"%WSF:COUNTIFS%":130,sa:82,primary:82,"%NUMBER%":53,no:41,"%ERROR:#REF!%":36},{"%WSF:COUNTIFS%":130,sa:82,primary:82,"%ERROR:#REF!%":52,no:41,"%NUMBER%":37},{"%WSF:COUNTIFS%":120,"%NUMBER%":86,primary:81,sa:81,no:41,"%ERROR:#REF!%":28},{"%WSF:COUNTIFS%":200,sa:120,primary:120,"%NUMBER%":90,no:63,"%ERROR:#REF!%":48},{"%WSF:COUNTIFS%":120,sa:81,primary:81,"%NUMBER%":56,no:40,"%ERROR:#REF!%":28},{"%WSF:COUNTIFS%":190,sa:120,primary:120,"%NUMBER%":84,no:63,"%ERROR:#REF!%":44},{"%NUMBER%":350,"%WSF:COUNTIFS%":170,"%ERROR:#REF!%":130,sa:100,primary:100,no:56,road:27,"%WSF:IF%":23,"%WSF:COUNTIF%":21,de:19,"excluso":16,"%YEAR%":15,thornton:14,heath:14,selsdon:13,brighton:13,green:13},{"%WSF:COUNTIFS%":400,primary:370,sa:370,"%ERROR:#REF!%":110,"%NUMBER%":61,vacant:44,part:22,occupied:22,mw:18,other:15,service:15,convenience:15,comparison:15}]},482:{count:1e4,value:[{"%WSF:SUMIFS%":250,primary:110,sa:110,"%NUMBER%":78,"%BOOL:TRUE%":33},{"%WSF:SUMIFS%":180,"%NUMBER%":110,sa:72,primary:72,"%BOOL:TRUE%":32,"%WSF:IF%":17},{"%WSF:SUMIFS%":260,primary:110,sa:110,"%NUMBER%":80,"%BOOL:TRUE%":34},{"%WSF:SUMIFS%":190,sa:73,primary:73,"%NUMBER%":55,"%BOOL:TRUE%":32},{"%WSF:SUMIFS%":170,primary:73,sa:73,"%NUMBER%":54,"%BOOL:TRUE%":32,"%WSF:IF%":16},{"%WSF:SUMIFS%":190,"%NUMBER%":100,sa:73,primary:73,"%BOOL:TRUE%":33,"%WSF:IF%":15},{"%WSF:SUMIFS%":200,sa:73,primary:73,"%NUMBER%":52,"%BOOL:TRUE%":33},{"%WSF:SUMIFS%":170,primary:73,sa:73,"%BOOL:TRUE%":31,"%NUMBER%":28},{"%WSF:SUMIFS%":180,"%NUMBER%":110,primary:72,sa:72,"%BOOL:TRUE%":32,"%WSF:IF%":19},{"%WSF:SUMIFS%":260,sa:110,primary:110,"%NUMBER%":78,"%BOOL:TRUE%":34},{"%WSF:SUMIFS%":190,sa:73,primary:73,"%NUMBER%":55,"%BOOL:TRUE%":32},{"%WSF:SUMIFS%":250,primary:110,sa:110,"%NUMBER%":74,"%BOOL:TRUE%":33},{"%NUMBER%":420,"%WSF:SUMIFS%":150,"%WSF:COUNTIFS%":110,sa:110,primary:110,"%WSF:SUMIF%":58,no:56,"%YEAR%":55,"%WSF:IF%":32,"%WSF:VLOOKUP%":31,"%BOOL:FALSE%":29,"%WSF:INDIRECT%":29,"%WSF:ROW%":28,"%WSF:ADDRESS%":28,"%WSF:CONCATENATE%":27,district:27,road:24,"%BOOL:TRUE%":17,green:16,"%WSF:AVERAGE%":15,heath:12},{"%WSF:SUMIFS%":400,sa:320,primary:320,"%ERROR:#REF!%":89,"%NUMBER%":79,vacant:41,"%WSF:YEAR%":27,part:21,occupied:21,"%YEAR%":18,of:17,other:15,comparison:14,convenience:14,service:14,the:13,"%WSF:MONTH%":13}]}},priors:{count:1,value:{1:.493,4:.0648,5:.0533,22:.00366,27:.0209,28:.00366,29:.0181,33:.00673,37:.00522,78:.0115,101:.00456,102:.165,109:.0283,119:.00724,336:.0143,345:.00652,346:.00673,480:.0307,481:.00357,482:.00513}}}},function(e,t,r){"use strict";r.r(t);var n={};r.r(n),r.d(n,"makeNewtypeIso",(function(){return oe})),r.d(n,"staticAssertExtends",(function(){return ue})),r.d(n,"identity",(function(){return se})),r.d(n,"makeStringMap",(function(){return ce})),r.d(n,"cloneStringMap",(function(){return le})),r.d(n,"numEnumArray",(function(){return de})),r.d(n,"numEnumMap",(function(){return fe})),r.d(n,"safePush",(function(){return he})),r.d(n,"safeConcat",(function(){return ve})),r.d(n,"isDefined",(function(){return pe})),r.d(n,"isNone",(function(){return me})),r.d(n,"pair",(function(){return ge})),r.d(n,"fastMin",(function(){return Se})),r.d(n,"fastMax",(function(){return ye})),r.d(n,"fastAbs",(function(){return be})),r.d(n,"makeStringCompareCI",(function(){return Ee})),r.d(n,"typedInstanceCreator",(function(){return Fe})),r.d(n,"now",(function(){return Re})),r.d(n,"singleton",(function(){return ke}));var a={};r.r(a),r.d(a,"SyntaxError",(function(){return ev})),r.d(a,"TypeError",(function(){return tv})),r.d(a,"baseErrors",(function(){return nv})),r.d(a,"formatDiagnostic",(function(){return av}));var i={};r.r(i),r.d(i,"MachineCallKind",(function(){return Am})),r.d(i,"machineCall",(function(){return _m})),r.d(i,"isMachineCall",(function(){return Lm})),r.d(i,"ArrayMachine",(function(){return Um})),r.d(i,"TransitionKind",(function(){return Ce})),r.d(i,"nextTransition",(function(){return Ae})),r.d(i,"callMachineTransition",(function(){return Te})),r.d(i,"nextOnSuccessReceiver",(function(){return Oe})),r.d(i,"MachineCycle",(function(){return Me})),r.d(i,"MachineRuntime",(function(){return we})),r.d(i,"AllMachine",(function(){return De}));var o={};r.r(o),r.d(o,"AutocompleteMessageKind",(function(){return Tw})),r.d(o,"AutocompleteStopReason",(function(){return ww})),r.d(o,"CellType",(function(){return Dw})),r.d(o,"setFormulaAutocompleteSuggester",(function(){return Uw})),r.d(o,"IntelligentSuggester",(function(){return xw})),r.d(o,"AutocompleteExperiment",(function(){return Bw}));var u={};r.r(u),r.d(u,"MessageType",(function(){return XD})),r.d(u,"now",(function(){return Re})),r.d(u,"ulsLogger",(function(){return _})),r.d(u,"CorrelationIdFactory",(function(){return E_})),r.d(u,"ConstantDelayPulseProvider",(function(){return F_})),r.d(u,"SynchronousPulseProvider",(function(){return C_})),r.d(u,"FormulaBarScheduler",(function(){return R_})),r.d(u,"PluginSchedulerSingleton",(function(){return k_})),r.d(u,"LocalGrid2SyncDataSourceAdapter",(function(){return g_})),r.d(u,"NaiveLocalSheetGrid",(function(){return zw})),r.d(u,"MockAsyncGrid",(function(){return b_})),r.d(u,"PluginRequestKind",(function(){return ZD})),r.d(u,"getSheetNamesRequest",(function(){return n_})),r.d(u,"getRangeRequest",(function(){return a_})),r.d(u,"delayRequest",(function(){return o_})),r.d(u,"createSnapshotRequest",(function(){return u_})),r.d(u,"delayResponse",(function(){return s_})),r.d(u,"createSnapshotResponse",(function(){return c_})),r.d(u,"getRangeResponse",(function(){return l_})),r.d(u,"getSheetNamesResponse",(function(){return d_})),r.d(u,"ExcelMessageKind",(function(){return i_})),r.d(u,"functionSuggestionMessage",(function(){return f_})),r.d(u,"formulaHighlightingMessage",(function(){return h_}));var s=r(0);function c(e){return e}function l(e,t){if("string"==typeof t&&null!=f[t])return e;var r=function(e){if("object"==typeof e&&null!==e){var t=e.kind;if("string"==typeof t)return t}}(e),n=void 0!==r?v[r]:void 0;return void 0===n&&(n=h[function(e){var t=typeof e;if("object"===t){if(null===e)return"null";if(Array.isArray(e))return"Array"}return t}(e)]),void 0!==n?n(e,t):"<unexpected>"}function d(e){try{return String(JSON.stringify(l(e,void 0)))}catch(e){if(null==e||"object"!=typeof e)return"<error: "+String(JSON.stringify(e))+">";var t=String(e.name),r=String(e.message);return r.indexOf(t)>=0?"<error "+r+">":"<error "+t+": "+r+">"}}var f={kind:!0,type:!0,index:!0,length:!0,row:!0,col:!0,rows:!0,cols:!0},h={boolean:c,symbol:function(e){return"symbol"!=typeof e?"<unexpected>":"<symbol "+String(e)+">"},undefined:c,null:c,number:function(e){return"number"!=typeof e?"<unexpected>":isFinite(e)?"<number>":e},bigint:function(e){return"bigint"!=typeof e?"<unexpected>":"<bigint>"},string:function(e){return"string"!=typeof e?"<unexpected>":e.length>0?"<string>":e},function:function(e){if("function"!=typeof e)return"<unexpected>";var t=e.name;return"string"==typeof t&&t.length>0?"<function "+t+">":"<function>"},object:function(e){if("object"!=typeof e)return"<unexpected>";var t={};for(var r in e)e.hasOwnProperty(r)&&(t[r]=l(e[r],r));return t},Array:function(e){return"object"==typeof e&&Array.isArray(e)?e.map(l):"<unexpected>"}},v=Object.create(null);function p(e){var t=Math.abs(e);return 0===t?-1e4:Math.floor(k(t))}var m,g=new RegExp("[^=\\[\\]\\.\\\\\\/%@#\\-_\\+,;\\(\\):?\"&<>'!\\{\\}~\\^\\*$\\sd]","g"),S=/[0-9]/g,y=/d/g;function b(e){return e.toLowerCase().replace(y,"w").replace(S,"d").replace(g,"w")}function E(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}function F(e,t,r){return void 0===r&&(r=0),r+t.length<=e.length&&e.substring(r,r+t.length)===t}function C(e,t){return Array(t+1).join(e)}function R(e,t){for(var r=0;r<e.length;r+=1)e[r]=t;return e}var k=null!==(m=Math.log2)&&void 0!==m?m:function(e){return Math.log(e)*Math.LOG2E};function N(e){var t=[];return Object.keys(e).map(Number).forEach((function(r){return t[r]=e[r]})),t}function A(e){if(null==e||"object"!=typeof e)return d(e);var t=e,r=String(t.name),n=String(t.message);if(null!=t.stack){var a=String(t.stack);return a.indexOf(n)>=0&&a.indexOf(r)>=0?a:r+": "+n+"\n"+a}return n.indexOf(r)>=0?n:r+": "+n}function T(e,t){if(null==e||"object"!=typeof e)return e;var r=e;return r.message=t+" "+String(r.message),r}function I(e,t){return function(r,n,a,i){if(e(r,n,a,i),!a)throw new Error(t+" "+r+" "+n+" "+i)}}function O(e){return{shipAssertTag:I(e.shipAssertTag.bind(e),"shipAssertTag"),assertTag:I(e.assertTag.bind(e),"assertTag"),traceTag:e.traceTag.bind(e),debugTraceTag:e.debugTraceTag.bind(e)}}function M(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];try{return e.apply(void 0,t)}catch(e){}}}var w,D=function(){function e(){this.callBufferCapacity=100,this.callBuffer=[],this.shipAssertTag=this.createBufferingCallback("shipAssertTag"),this.assertTag=this.createBufferingCallback("assertTag"),this.traceTag=this.createBufferingCallback("traceTag"),this.debugTraceTag=this.createBufferingCallback("debugTraceTag")}return e.prototype.createBufferingCallback=function(e){var t=this;return function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];t.callBuffer.length<t.callBufferCapacity&&t.callBuffer.push({method:e,args:r})}},e.prototype.invokeBufferedCalls=function(){var e;if(0!==this.callBuffer.length){var t=this.callBuffer;this.callBuffer=[];var r="calc.common.DefaultLogger.invokeBufferedCalls: "+t.length+" calls before initLogger";_.ULS.traceTag(579736781,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Warning,r);for(var n=0,a=t;n<a.length;n++){var i=a[n];(e=_.noThrowLogger)[i.method].apply(e,i.args)}}},e}(),_=new(function(){function e(){this.logger=new D,this.ULS=O(this.logger),this.noThrowLogger=this.logger}return e.prototype.setLogger=function(e){var t=this.logger;this.logger=e,this.ULS=O(e),this.noThrowLogger=function(e){return{shipAssertTag:M(e.shipAssertTag.bind(e)),assertTag:M(e.assertTag.bind(e)),traceTag:M(e.traceTag.bind(e)),debugTraceTag:M(e.debugTraceTag.bind(e))}}(e),t instanceof D&&t.invokeBufferedCalls()},e}());function L(e,t){var r=e+": code should be unreachable because a value has type 'never'; given "+d(t);return _.ULS.assertTag(595980872,s.LogCategory.msoulscat_ES_EWAJS,!1,r)}function U(e){return _.ULS.assertTag(595980873,s.LogCategory.msoulscat_ES_EWAJS,!1,e)}function x(e,t){t||U(e+": expected condition to be true")}function B(e,t){E(t)||U(e+": expected integer; given "+d(t))}function W(e,t){(!E(t)||t<0)&&U(e+": expected natural number; given "+d(t))}function P(e,t){(!E(t)||t<=0)&&U(e+": expected positive integer; given "+d(t))}function V(e,t,r){(!E(t)||t<0||t>=r)&&U(e+": expected natural number less than "+d(r)+"; given "+d(t))}function G(e,t,r){(!E(t)||t<=0||t>r)&&U(e+": expected positive integer at most "+d(r)+"; given "+d(t))}!function(e){e.FeatureCheckingEnabled="FeatureCheckingEnabled",e.CalcPreventSpillingHack="CalcPreventSpillingHack",e.CalcSupportDynamicArrays="CalcSupportDynamicArrays",e.CalcFieldValueFunction="CalcFieldValueFunction",e.CalcRecordFunctions="CalcRecordFunctions",e.CalcNestedRecordFunction="CalcNestedRecordFunction",e.CalcDotOperator="CalcDotOperator",e.CalcStructuredReferences="CalcStructuredReferences",e.CalcLetFunction="CalcLetFunction",e.CalcLetRecFunction="CalcLetRecFunction",e.CalcLambdaFunctions="CalcLambdaFunctions",e.CalcUseTypedWorkersLib="CalcUseTypedWorkersLib",e.CalcWebWorkerTest="CalcWebWorkerTest",e.CalcAutocompleteExperiment="CalcAutocompleteExperiment",e["OfficeVSO:3852168_CalcCGJanFormatTweaks"]="OfficeVSO:3852168_CalcCGJanFormatTweaks",e["OfficeVSO:3852168_CalcCGSimpleCurrCode"]="OfficeVSO:3852168_CalcCGSimpleCurrCode",e["OfficeVSO:4790598_CalcCGMachineCycleDetectionFix"]="OfficeVSO:4790598_CalcCGMachineCycleDetectionFix"}(w||(w={}));var H,j=function(e){var t="calc.common.isFeatureEnabledCallback: called with "+e+" before initCalc";return _.ULS.traceTag(587207117,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Warning,t),!1},K={};function Y(e){return void 0===K[e]&&(K[e]=j(e)),K[e]}function q(e){return{kind:H.Success,value:e}}!function(e){e.Success="Success",e.Failure="Failure",e.Paused="Paused"}(H||(H={}));var z,J=q(void 0);function Q(e){return{kind:H.Failure,reason:e}}function X(e){return e.kind===H.Success}function Z(e){return{kind:z.JavaScriptError,error:e}}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */!function(e){e.JavaScriptError="JavaScriptError"}(z||(z={}));var $=function(e,t){return($=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function ee(e,t){function r(){this.constructor=e}$(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var te=function(){return(te=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function re(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r}function ne(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{s(n.next(e))}catch(e){i(e)}}function u(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,u)}s((n=n.apply(e,t||[])).next())}))}function ae(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}}function ie(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),a=0;for(t=0;t<r;t++)for(var i=arguments[t],o=0,u=i.length;o<u;o++,a++)n[a]=i[o];return n}function oe(e,t){return{wrap:e,unwrap:t}}function ue(){}function se(e){return e}function ce(){var e=Object.create(null);return e.___=void 0,delete e.___,e}function le(e){var t=ce();for(var r in e)t[r]=e[r];return t}function de(e){return Object.keys(e).map((function(e){return Number(e)})).filter((function(e){return!isNaN(e)}))}function fe(e,t){for(var r={},n=0,a=de(e);n<a.length;n++){var i=a[n];r[i]=t(i)}return r}function he(e,t){for(var r=0,n=t;r<n.length;r++){var a=n[r];e.push(a)}return e}function ve(e,t){var r=[];he(r,e);for(var n=0,a=t;n<a.length;n++){he(r,a[n])}return r}function pe(e){return null!=e}function me(e){return null==e}function ge(e,t){return[e,t]}function Se(e,t){return e<t?e:t}function ye(e,t){return e<t?t:e}function be(e){return e<0?-e:e}function Ee(e){try{var t=new Intl.Collator(function(e){var t=[e],r=e.indexOf("-");return r>0&&t.push(e.substring(0,r)),"en"!==t[t.length-1]&&t.push("en"),t}(e),{sensitivity:"accent"});return t.compare.bind(t)}catch(e){return function(e,t){return e===t?0:e.toLocaleUpperCase().localeCompare(t.toLocaleUpperCase())}}}function Fe(){return function(e){return e}}var Ce,Re="undefined"!=typeof self&&null!=self.performance&&null!=self.performance.now?function(){return self.performance.now()}:function(){return Date.now()};function ke(e){return function(){function t(){}return t.instance=function(){return void 0===t.value&&(t.value=e()),t.value},t.prototype.instance=function(){return t.instance()},t.value=void 0,t}()}function Ne(e,t,r){return{kind:e,machine:t,receiver:r}}!function(e){e[e.Next=1]="Next",e[e.CallMachine=2]="CallMachine"}(Ce||(Ce={}));var Ae=Ne(Ce.Next,void 0,void 0);function Te(e,t){return Ne(Ce.CallMachine,e,t)}var Ie={receiveResult:function(e){return X(e)?Ae:e}};function Oe(){return Ie}var Me=function(e){function t(t,r){var n=this.constructor,a=e.call(this,"Cycle detected: tried to call an already-running Machine")||this;a.machine=t,a.stackDepth=r;var i=n.prototype;return Object.getPrototypeOf(a)!==i&&(null!=Object.setPrototypeOf?Object.setPrototypeOf(a,i):a.__proto__=i),a}return ee(t,e),t}(Error),we=function(){function e(e){this.numSteps=0,this.fixCycleDetection=Y(w["OfficeVSO:4790598_CalcCGMachineCycleDetectionFix"]),this.stack=[];try{this.pushFrame(Te(e,{receiveResult:function(e){return e}})),this.transition=Ae}catch(e){this.transition=Q(Z(e))}}return e.resetStats=function(){e.maxStackDepth=0,e.numPauses=0,e.numCycles=0},e.prototype.pushFrame=function(t){var r=this.stack.length,n=t.machine;if(!0===n.runStatus)throw e.numCycles+=1,new Me(n,r);!1===n.runStatus&&(n.runStatus=!0),this.stack.push(t),e.maxStackDepth<r+1&&(e.maxStackDepth=r+1)},e.prototype.advanceTopFrame=function(){var e=this.stack[this.stack.length-1].machine;return"boolean"!=typeof e.runStatus?e.runStatus:e.next()},e.prototype.step=function(){this.numSteps+=1;var e=this.transition;try{switch(e.kind){case Ce.Next:return void(this.transition=this.advanceTopFrame());case Ce.CallMachine:return this.pushFrame(e),void(this.transition=this.advanceTopFrame());default:var t=this.stack.pop();return t?(t.machine.runStatus=!!this.fixCycleDetection&&e,void(this.transition=t.receiver.receiveResult(e))):e}}catch(e){return void(this.transition=Q(Z(e)))}},e.prototype.run=function(t){if(void 0===t&&(t=function(){return!1}),this.result)return this.result;try{for(;;){var r=this.step();if(r)return this.result=r;if(t())return void(e.numPauses+=1)}}catch(e){return this.result=Q(Z(e))}},e.maxStackDepth=0,e.numPauses=0,e.numCycles=0,e}(),De=function(){function e(e){this.machines=e,this.runStatus=!1,this.values=[]}return e.prototype.next=function(){return this.values.length<this.machines.length?Te(this.machines[this.values.length],this):q(this.values)},e.prototype.receiveResult=function(e){return X(e)?(this.values.push(e.value),this.next()):e},e}(),_e=function(){function e(t,r,n){this.transition=t,this.onFulfilled=r,this.onRejected=n,this.runStatus=!(!Y(w["OfficeVSO:4790598_CalcCGMachineCycleDetectionFix"])||t instanceof e||t.kind===Ce.CallMachine)&&t}return e.prototype.setState=function(e,t,r){return this.onFulfilled=t,this.onRejected=r,this.transition=e},e.prototype.next=function(){return this.transition instanceof e?this.transition=Te(this.transition,this):this.transition},e.prototype.receiveResult=function(t){var r;try{if(X(t)){if(!this.onFulfilled)return this.setState(t,void 0,void 0);r=this.onFulfilled(t.value)}else{if(!this.onRejected)return this.setState(t,void 0,void 0);r=this.onRejected(t.reason)}}catch(e){return this.setState(Q(Z(e)),void 0,void 0)}return r instanceof e?(this.setState(r.transition,r.onFulfilled,r.onRejected),r.setState(this,void 0,void 0),this.next()):this.setState(q(r),void 0,void 0)},e.prototype.bind=function(t){return new e(this,t,void 0)},e.prototype.catch=function(t){return new e(this,void 0,t)},e.prototype.finally=function(t){return new e(this,(function(e){return t(),e}),(function(r){return t(),e.reject(r)}))},e.all=function(t){return e.fromMachine(new De(t.map(e.resolve)))},e.prototype.settle=function(){return new we(this).run()},e.settleOrThrow=function(e){var t=e.settle();if(X(t))return t.value;throw t.reason.error},e.resolve=function(t){return t instanceof e?t:new e(q(t),void 0,void 0)},e.reject=function(t){return new e(Q(t),void 0,void 0)},e.undefined=function(){var t=e.resolve(void 0);return e.undefined=function(){return t},t},e.fromMachine=function(t){if(t instanceof e)return t;var r=new e(e.undefined(),void 0,void 0);return r.transition=Te(t,r),r},e.try=function(t){return e.undefined().bind(t)},e.RepeatMachine=function(){function t(e,t){this.onLoop=e,this.accum=t,this.runStatus=!1}return t.prototype.next=function(){var t=this.onLoop(this.accum);return t instanceof e?Te(t,this):this.receiveSuccess(t)},t.prototype.receiveResult=function(e){return X(e)?this.receiveSuccess(e.value):e},t.prototype.receiveSuccess=function(e){return void 0===e?q(this.accum):(this.accum=e,Ae)},t}(),e.repeat=function(t,r){return e.resolve(r).bind((function(r){return e.fromMachine(new e.RepeatMachine(t,r))}))},e}();function Le(e,t){switch(t.kind){case pt.Literal:var r=t.oper,n=t.isClosed,a=t.label;return e.literalNode(r,n,a);case pt.Array:var i=t.nodes;n=t.isClosed,a=t.label;return e.arrayNode(i,n,a);case pt.App:var o=t.head,u=t.args;n=t.isClosed,a=t.label;return e.appNode(o,u,n,a);case pt.Let:o=t.head;var s=t.vars,c=t.body;n=t.isClosed,a=t.label;return e.letNode(o,s,c,n,a);case pt.Lambda:o=t.head;var l=t.params;c=t.body,n=t.isClosed,a=t.label;return e.lambdaNode(o,l,c,n,a);case pt.Paren:var d=t.node;n=t.isClosed,a=t.label;return e.parenNode(d,n,a);case pt.Name:var f=t.parts,h=t.qualifier;a=t.label;return e.nameNode(f,h,a);case pt.CellRef:var v=t.ref;h=t.qualifier,a=t.label;return e.cellRefNode(v,h,a);case pt.FieldRef:var p=t.lhs,m=t.rhs,g=t.shouldBeBracketed;a=t.label;return e.fieldRefNode(p,m,g,a);case pt.StructRef:p=t.lhs,m=t.rhs,a=t.label;return e.structRefNode(p,m,a);case pt.Bad:a=t.label;switch(t.type){case yt.Sequence:case yt.StructRef:case yt.FieldRef:return e.badSequenceNode(t.type,t.contents,a);default:return e.badStringNode(t.type,t.contents,a)}default:return L("calc.lang.visitFormulaNode",t)}}function Ue(e,t){var r=t.id,n=t.label;return e.operatorNode(r,n)}function xe(e,t){var r=t.id,n=t.whole,a=t.label;return e.wsfNode(r,n,a)}function Be(e,t){switch(t.kind){case pt.Operator:return Ue(e,t);case pt.WSF:return xe(e,t);default:return Le(e,t)}}function We(e,t){switch(t.kind){case ot.Error:var r=t.label;return e.errorQualifier(r);case ot.Relative:r=t.label;return e.relativeQualifier(r);case ot.Document:var n=t.document,a=t.path,i=t.isQuoted;r=t.label;return e.documentQualifier(n,a,i,r);case ot.Sheet:var o=t.sheet,u=t.document;i=t.isQuoted,r=t.label;return e.sheetQualifier(o,u,i,r);case ot.Ident:var s=t.name;i=t.isQuoted,r=t.label;return e.identQualifier(s,i,r);case ot.SheetRange:var c=t.sheet1,l=t.sheet2,d=t.document;i=t.isQuoted,r=t.label;return e.sheetRangeQualifier(c,l,d,i,r);default:return L("calc.lang.visitQualifier",t)}}function Pe(e,t){switch(t.kind){case ut.Error:var r=t.label;return e.cellRefError(r);case ut.Single:var n=t.row,a=t.col,i=t.isBracketed;r=t.label;return e.cellRefSingle(n,a,i,r);case ut.Range:var o=t.ref1,u=t.ref2;r=t.label;return e.cellRefRange(o,u,r);case ut.Row:var s=t.row1,c=t.row2;i=t.isBracketed,r=t.label;return e.cellRefRow(s,c,i,r);case ut.Col:var l=t.col1,d=t.col2;i=t.isBracketed,r=t.label;return e.cellRefCol(l,d,i,r);default:return L("calc.lang.visitCellRef",t)}}function Ve(e){return{literalNode:e.literalNode.bind(e),arrayNode:e.arrayNode.bind(e),appNode:e.appNode.bind(e),letNode:e.letNode.bind(e),lambdaNode:e.lambdaNode.bind(e),parenNode:e.parenNode.bind(e),nameNode:e.nameNode.bind(e),cellRefNode:e.cellRefNode.bind(e),fieldRefNode:e.fieldRefNode.bind(e),structRefNode:e.structRefNode.bind(e),badSequenceNode:e.badSequenceNode.bind(e),badStringNode:e.badStringNode.bind(e),operatorNode:e.operatorNode.bind(e),wsfNode:e.wsfNode.bind(e)}}var Ge=function(){function e(){}return e.prototype.literalNode=function(e,t,r){return Vt(e,t,r)},e.prototype.arrayNode=function(e,t,r){return Gt(e,t,r)},e.prototype.appNode=function(e,t,r,n){return Ht(e,t,r,n)},e.prototype.letNode=function(e,t,r,n,a){return jt(e,t,r,n,a)},e.prototype.lambdaNode=function(e,t,r,n,a){return Kt(e,t,r,n,a)},e.prototype.parenNode=function(e,t,r){return zt(e,t,r)},e.prototype.nameNode=function(e,t,r){return Jt(e,t,r)},e.prototype.cellRefNode=function(e,t,r){return tr(e,t,r)},e.prototype.fieldRefNode=function(e,t,r,n){return rr(e,t,r,n)},e.prototype.structRefNode=function(e,t,r){return ar(e,t,r)},e.prototype.badSequenceNode=function(e,t,r){return dr(e,t,r)},e.prototype.badStringNode=function(e,t,r){return dr(e,t,r)},e.prototype.operatorNode=function(e,t){return Yt(e,t)},e.prototype.wsfNode=function(e,t,r){return qt(e,t,r)},e}(),He=Ve(new Ge),je=function(){function e(e){this.value=e}return e.prototype.literalNode=function(e,t,r){return this.value},e.prototype.arrayNode=function(e,t,r){return this.value},e.prototype.appNode=function(e,t,r,n){return this.value},e.prototype.letNode=function(e,t,r,n,a){return this.value},e.prototype.lambdaNode=function(e,t,r,n,a){return this.value},e.prototype.parenNode=function(e,t,r){return this.value},e.prototype.nameNode=function(e,t,r){return this.value},e.prototype.cellRefNode=function(e,t,r){return this.value},e.prototype.fieldRefNode=function(e,t,r,n){return this.value},e.prototype.structRefNode=function(e,t,r){return this.value},e.prototype.badSequenceNode=function(e,t,r){return this.value},e.prototype.badStringNode=function(e,t,r){return this.value},e.prototype.operatorNode=function(e,t){return this.value},e.prototype.wsfNode=function(e,t,r){return this.value},e}();function Ke(e){return Ve(new je(e))}var Ye=Ke(void 0),qe=function(e){function t(t,r){var n=e.call(this,t)||this;return n.reducer=function(e,t){return r(e,t)},n}return ee(t,e),t.prototype.arrayNode=function(e,t,r){var n=this;return x("calc.lang.binaryVisitor: non-empty array",e.length>0&&e[0].length>0),e.map((function(e){return e.reduce(n.reducer)})).reduce(this.reducer)},t.prototype.appNode=function(e,t,r,n){return t.reduce(this.reducer,e)},t.prototype.letNode=function(e,t,r,n,a){return this.reducer(t.map((function(e){return e[1]})).reduce(this.reducer,e),r)},t.prototype.lambdaNode=function(e,t,r,n,a){return this.reducer(e,r)},t.prototype.parenNode=function(e,t,r){return e},t.prototype.fieldRefNode=function(e,t,r,n){return e},t.prototype.badSequenceNode=function(e,t,r){return x("calc.lang.binaryVisitor: non-empty bad-sequence",t.length>0),t.reduce(this.reducer)},t}(function(){function e(e){this.visitor=e}return e.prototype.literalNode=function(e,t,r){return this.visitor.literalNode(e,t,r)},e.prototype.arrayNode=function(e,t,r){return this.visitor.arrayNode(e,t,r)},e.prototype.appNode=function(e,t,r,n){return this.visitor.appNode(e,t,r,n)},e.prototype.letNode=function(e,t,r,n,a){return this.visitor.letNode(e,t,r,n,a)},e.prototype.lambdaNode=function(e,t,r,n,a){return this.visitor.lambdaNode(e,t,r,n,a)},e.prototype.parenNode=function(e,t,r){return this.visitor.parenNode(e,t,r)},e.prototype.nameNode=function(e,t,r){return this.visitor.nameNode(e,t,r)},e.prototype.cellRefNode=function(e,t,r){return this.visitor.cellRefNode(e,t,r)},e.prototype.fieldRefNode=function(e,t,r,n){return this.visitor.fieldRefNode(e,t,r,n)},e.prototype.structRefNode=function(e,t,r){return this.visitor.structRefNode(e,t,r)},e.prototype.badSequenceNode=function(e,t,r){return this.visitor.badSequenceNode(e,t,r)},e.prototype.badStringNode=function(e,t,r){return this.visitor.badStringNode(e,t,r)},e.prototype.operatorNode=function(e,t){return this.visitor.operatorNode(e,t)},e.prototype.wsfNode=function(e,t,r){return this.visitor.wsfNode(e,t,r)},e}());function ze(e,t){return Ve(new qe(e,t))}var Je=function(){function e(e,t){this.a=e,this.b=t}return e.prototype.literalNode=function(e,t,r){return this.b(this.a.literalNode(e,t,r))},e.prototype.arrayNode=function(e,t,r){return this.b(this.a.arrayNode(e,t,r))},e.prototype.appNode=function(e,t,r,n){return this.b(this.a.appNode(e,t,r,n))},e.prototype.letNode=function(e,t,r,n,a){return this.b(this.a.letNode(e,t,r,n,a))},e.prototype.lambdaNode=function(e,t,r,n,a){return this.b(this.a.lambdaNode(e,t,r,n,a))},e.prototype.parenNode=function(e,t,r){return this.b(this.a.parenNode(e,t,r))},e.prototype.nameNode=function(e,t,r){return this.b(this.a.nameNode(e,t,r))},e.prototype.cellRefNode=function(e,t,r){return this.b(this.a.cellRefNode(e,t,r))},e.prototype.fieldRefNode=function(e,t,r,n){return this.b(this.a.fieldRefNode(e,t,r,n))},e.prototype.structRefNode=function(e,t,r){return this.b(this.a.structRefNode(e,t,r))},e.prototype.badSequenceNode=function(e,t,r){return this.b(this.a.badSequenceNode(e,t,r))},e.prototype.badStringNode=function(e,t,r){return this.b(this.a.badStringNode(e,t,r))},e.prototype.operatorNode=function(e,t){return this.b(this.a.operatorNode(e,t))},e.prototype.wsfNode=function(e,t,r){return this.b(this.a.wsfNode(e,t,r))},e}();function Qe(e,t){return Ve(new Je(e,t))}Qe(ze(Ke(0),ye),(function(e){return e+1}));var Xe=function(){function e(e){this.visitors=e,this.keys=Object.keys(e)}return e.prototype.literalNode=function(e,t,r){for(var n={},a=0,i=this.keys;a<i.length;a++){var o=i[a];n[o]=this.visitors[o].literalNode(e,t,r)}return n},e.prototype.arrayNode=function(e,t,r){for(var n={},a=0,i=this.keys;a<i.length;a++){var o=i[a];n[o]=this.visitors[o].arrayNode(e,t,r)}return n},e.prototype.appNode=function(e,t,r,n){for(var a={},i=0,o=this.keys;i<o.length;i++){var u=o[i];a[u]=this.visitors[u].appNode(e,t,r,n)}return a},e.prototype.letNode=function(e,t,r,n,a){for(var i={},o=0,u=this.keys;o<u.length;o++){var s=u[o];i[s]=this.visitors[s].letNode(e,t,r,n,a)}return i},e.prototype.lambdaNode=function(e,t,r,n,a){for(var i={},o=0,u=this.keys;o<u.length;o++){var s=u[o];i[s]=this.visitors[s].lambdaNode(e,t,r,n,a)}return i},e.prototype.parenNode=function(e,t,r){for(var n={},a=0,i=this.keys;a<i.length;a++){var o=i[a];n[o]=this.visitors[o].parenNode(e,t,r)}return n},e.prototype.nameNode=function(e,t,r){for(var n={},a=0,i=this.keys;a<i.length;a++){var o=i[a];n[o]=this.visitors[o].nameNode(e,t,r)}return n},e.prototype.cellRefNode=function(e,t,r){for(var n={},a=0,i=this.keys;a<i.length;a++){var o=i[a];n[o]=this.visitors[o].cellRefNode(e,t,r)}return n},e.prototype.fieldRefNode=function(e,t,r,n){for(var a={},i=0,o=this.keys;i<o.length;i++){var u=o[i];a[u]=this.visitors[u].fieldRefNode(e,t,r,n)}return a},e.prototype.structRefNode=function(e,t,r){for(var n={},a=0,i=this.keys;a<i.length;a++){var o=i[a];n[o]=this.visitors[o].structRefNode(e,t,r)}return n},e.prototype.badSequenceNode=function(e,t,r){for(var n={},a=0,i=this.keys;a<i.length;a++){var o=i[a];n[o]=this.visitors[o].badSequenceNode(e,t,r)}return n},e.prototype.badStringNode=function(e,t,r){for(var n={},a=0,i=this.keys;a<i.length;a++){var o=i[a];n[o]=this.visitors[o].badStringNode(e,t,r)}return n},e.prototype.operatorNode=function(e,t){for(var r={},n=0,a=this.keys;n<a.length;n++){var i=a[n];r[i]=this.visitors[i].operatorNode(e,t)}return r},e.prototype.wsfNode=function(e,t,r){for(var n={},a=0,i=this.keys;a<i.length;a++){var o=i[a];n[o]=this.visitors[o].wsfNode(e,t,r)}return n},e}();function Ze(e,t){var r=function(t){switch(t.kind){case pt.Literal:var n=t.oper,a=t.isClosed,i=t.label;return e.literalNode(n,a,i);case pt.Array:var o=t.nodes;a=t.isClosed,i=t.label;return e.arrayNode(o.map((function(e){return e.map(r)})),a,i);case pt.App:var u=t.head,s=t.args;a=t.isClosed,i=t.label;return e.appNode(function(t){switch(t.kind){case pt.Operator:return Ue(e,t);case pt.WSF:return xe(e,t);default:return r(t)}}(u),s.map(r),a,i);case pt.Let:u=t.head;var c=t.vars,l=t.body;a=t.isClosed,i=t.label;return e.letNode(xe(e,u),c.map((function(e){var t=e[0],n=e[1];return[t,r(n)]})),r(l),a,i);case pt.Lambda:u=t.head;var d=t.params;l=t.body,a=t.isClosed,i=t.label;return e.lambdaNode(xe(e,u),d,r(l),a,i);case pt.Paren:var f=t.node;a=t.isClosed,i=t.label;return e.parenNode(r(f),a,i);case pt.Name:var h=t.parts,v=t.qualifier;i=t.label;return e.nameNode(h,v,i);case pt.CellRef:var p=t.ref;v=t.qualifier,i=t.label;return e.cellRefNode(p,v,i);case pt.FieldRef:var m=t.lhs,g=t.rhs,S=t.shouldBeBracketed;i=t.label;return e.fieldRefNode(r(m),g,S,i);case pt.StructRef:m=t.lhs,g=t.rhs,i=t.label;return e.structRefNode(m,g,i);case pt.Bad:i=t.label;switch(t.type){case yt.Sequence:case yt.StructRef:case yt.FieldRef:return e.badSequenceNode(t.type,t.contents.map(r),i);default:return e.badStringNode(t.type,t.contents,i)}default:return L("calc.lang.reduceBottomUp_Recursive",t)}};return r(t)}function $e(e,t,r,n){var a=[],i=function(e){return a.push(e),o},o=function(){return a.length<t.length?r(e,t[a.length],i):n(a)};return o}function et(e,t,r){return $e(e,t,nt,r)}function tt(e,t,r){var n=t.id,a=t.whole,i=t.label;return function(){return r(e.wsfNode(n,a,i))}}function rt(e,t,r){var n=t[0];return nt(e,t[1],(function(e){return r([n,e])}))}function nt(e,t,r){switch(t.kind){case pt.Literal:var n=t.oper,a=t.isClosed,i=t.label;return function(){return r(e.literalNode(n,a,i))};case pt.Array:var o=t.nodes,u=t.isClosed,s=t.label;return $e(e,o,et,(function(t){return r(e.arrayNode(t,u,s))}));case pt.App:var c=t.head,l=t.args,d=t.isClosed,f=t.label;return function(){return function(e,t,r){switch(t.kind){case pt.Operator:var n=t.id,a=t.label;return function(){return r(e.operatorNode(n,a))};case pt.WSF:return tt(e,t,r);default:return nt(e,t,r)}}(e,c,(function(t){return et(e,l,(function(n){return r(e.appNode(t,n,d,f))}))}))};case pt.Let:var h=t.head,v=t.vars,p=t.body,m=t.isClosed,g=t.label;return function(){return tt(e,h,(function(t){return $e(e,v,rt,(function(n){return nt(e,p,(function(a){return function(){return r(e.letNode(t,n,a,m,g))}}))}))}))};case pt.Lambda:var S=t.head,y=t.params,b=t.body,E=t.isClosed,F=t.label;return function(){return tt(e,S,(function(t){return nt(e,b,(function(n){return function(){return r(e.lambdaNode(t,y,n,E,F))}}))}))};case pt.Paren:var C=t.node,R=t.isClosed,k=t.label;return function(){return nt(e,C,(function(t){return function(){return r(e.parenNode(t,R,k))}}))};case pt.Name:var N=t.parts,A=t.qualifier,T=t.label;return function(){return r(e.nameNode(N,A,T))};case pt.CellRef:var I=t.ref,O=t.qualifier,M=t.label;return function(){return r(e.cellRefNode(I,O,M))};case pt.FieldRef:var w=t.lhs,D=t.rhs,_=t.shouldBeBracketed,U=t.label;return function(){return nt(e,w,(function(t){return function(){return r(e.fieldRefNode(t,D,_,U))}}))};case pt.StructRef:var x=t.lhs,B=t.rhs,W=t.label;return function(){return r(e.structRefNode(x,B,W))};case pt.Bad:var P=t.label;switch(t.type){case yt.Sequence:case yt.StructRef:case yt.FieldRef:var V=t.type,G=t.contents;return et(e,G,(function(t){return r(e.badSequenceNode(V,t,P))}));default:var H=t.type,j=t.contents;return function(){return r(e.badStringNode(H,j,P))}}default:return L("calc.lang.reduceBottomUp_CPS",t)}}var at=function(){function e(e){var t=this;this.visitor=e,this.visitFormulaNode=function(e){return Le(t,e)},this.lazyVisitFormulaNode=function(e){return _e.resolve(e).bind(t.visitFormulaNode)},this.visitAppHeadNode=function(e){return Be(t,e)},this.lazyVisitAppHeadNode=function(e){return _e.resolve(e).bind(t.visitAppHeadNode)},this.visitWSFNode=function(e){return xe(t,e)},this.lazyVisitWSFNode=function(e){return _e.resolve(e).bind(t.visitWSFNode)},this.lazyVisitVar=function(e){var r=e[0],n=e[1];return t.lazyVisitFormulaNode(n).bind((function(e){return[r,e]}))}}return e.prototype.literalNode=function(e,t,r){var n=this;return _e.try((function(){return n.visitor.literalNode(e,t,r)}))},e.prototype.arrayNode=function(e,t,r){var n=this;return _e.all(e.map((function(e){return _e.all(e.map(n.lazyVisitFormulaNode))}))).bind((function(e){return n.visitor.arrayNode(e,t,r)}))},e.prototype.appNode=function(e,t,r,n){var a=this;return this.lazyVisitAppHeadNode(e).bind((function(e){return _e.all(t.map(a.lazyVisitFormulaNode)).bind((function(t){return a.visitor.appNode(e,t,r,n)}))}))},e.prototype.letNode=function(e,t,r,n,a){var i=this;return this.lazyVisitWSFNode(e).bind((function(e){return _e.all(t.map(i.lazyVisitVar)).bind((function(t){return i.visitFormulaNode(r).bind((function(r){return i.visitor.letNode(e,t,r,n,a)}))}))}))},e.prototype.lambdaNode=function(e,t,r,n,a){var i=this;return this.lazyVisitWSFNode(e).bind((function(e){return Le(i,r).bind((function(r){return i.visitor.lambdaNode(e,t,r,n,a)}))}))},e.prototype.parenNode=function(e,t,r){var n=this;return this.lazyVisitFormulaNode(e).bind((function(e){return n.visitor.parenNode(e,t,r)}))},e.prototype.nameNode=function(e,t,r){var n=this;return _e.try((function(){return n.visitor.nameNode(e,t,r)}))},e.prototype.cellRefNode=function(e,t,r){var n=this;return _e.try((function(){return n.visitor.cellRefNode(e,t,r)}))},e.prototype.fieldRefNode=function(e,t,r,n){var a=this;return this.lazyVisitFormulaNode(e).bind((function(e){return a.visitor.fieldRefNode(e,t,r,n)}))},e.prototype.structRefNode=function(e,t,r){var n=this;return _e.try((function(){return n.visitor.structRefNode(e,t,r)}))},e.prototype.badSequenceNode=function(e,t,r){var n=this;return _e.all(t.map(this.lazyVisitFormulaNode)).bind((function(t){return n.visitor.badSequenceNode(e,t,r)}))},e.prototype.badStringNode=function(e,t,r){var n=this;return _e.try((function(){return n.visitor.badStringNode(e,t,r)}))},e.prototype.operatorNode=function(e,t){var r=this;return _e.try((function(){return r.visitor.operatorNode(e,t)}))},e.prototype.wsfNode=function(e,t,r){var n=this;return _e.try((function(){return n.visitor.wsfNode(e,t,r)}))},e}();var it,ot,ut,st,ct;function lt(e,t,r){return r<=50?Ze(e,t):function(e,t){var r;return function(e){for(var t=e;null!=t;)t=t()}(nt(e,t,(function(e){r=e}))),r}(e,t)}function dt(e,t){return lt(e,t.node,t.depthUpperBound)}function ft(e,t){return _e.settleOrThrow(_e.resolve(Le(e,t)))}function ht(e,t){return ft(e,t.node)}function vt(e){return function e(t,r){if(r>50)return 1/0;switch(t.kind){case pt.Array:for(var n=0,a=0,i=t.nodes;a<i.length;a++)for(var o=0,u=i[a];o<u.length;o++){n=ye(n,e(u[o],r+1))}return n+1;case pt.Let:case pt.Lambda:case pt.App:n=e(t.head,r+1);for(var s=0,c=t.args;s<c.length;s++){n=ye(n,e(c[s],r+1))}return n+1;case pt.Paren:return e(t.node,r+1)+1;case pt.FieldRef:return e(t.lhs,r+1)+1;case pt.Name:case pt.CellRef:case pt.StructRef:case pt.Literal:case pt.Operator:case pt.WSF:return 1;case pt.Bad:switch(t.type){case yt.Sequence:case yt.StructRef:case yt.FieldRef:n=0;for(var l=0,d=t.contents;l<d.length;l++){n=ye(n,e(d[l],r+1))}return n+1;default:return"string"==typeof t.contents?1:L("calc.lang.getDepthUpperBound",t.contents)}default:return L("calc.lang.getDepthUpperBound",t)}}(e,0)}!function(e){e[e.R1C1=1]="R1C1",e[e.A1=2]="A1"}(it||(it={})),function(e){e.Error="Error",e.Relative="Relative",e.Document="Document",e.Sheet="Sheet",e.Ident="Ident",e.SheetRange="SheetRange"}(ot||(ot={})),function(e){e.Error="Error",e.Single="Single",e.Range="Range",e.Row="Row",e.Col="Col"}(ut||(ut={})),function(e){e.Abs="Abs",e.Rel="Rel"}(st||(st={})),function(e){e.LocalName="LocalName",e.AppHeadName="AppHeadName",e.FormulaRoot="FormulaRoot"}(ct||(ct={}));var pt,mt,gt,St,yt,bt,Et,Ft,Ct,Rt={kind:ct.AppHeadName},kt={kind:ct.FormulaRoot};function Nt(e){return void 0===e&&(e=0),{kind:ot.Error,isQuoted:!1,label:e}}function At(e){return void 0===e&&(e=0),{kind:ot.Relative,isQuoted:!1,label:e}}function Tt(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=0),{kind:ot.Document,isQuoted:r,label:n,document:e,path:t}}function It(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=0),{kind:ot.Sheet,isQuoted:r,label:n,sheet:e,document:t}}function Ot(e,t,r){return void 0===t&&(t=!1),void 0===r&&(r=0),{kind:ot.Ident,isQuoted:t,label:r,name:e}}function Mt(e,t,r,n,a){return void 0===n&&(n=!1),void 0===a&&(a=0),{kind:ot.SheetRange,isQuoted:n,label:a,sheet1:e,sheet2:t,document:r}}function wt(e,t){return{kind:e,index:t}}function Dt(e){void 0===e&&(e=0);return{kind:ut.Error,label:e,isBracketed:!1}}function _t(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=0),{kind:ut.Single,label:n,row:e,col:t,isBracketed:r}}function Lt(e,t,r){void 0===r&&(r=0);var n=e.isBracketed||t.isBracketed;return{kind:ut.Range,label:r,ref1:e,ref2:t,isBracketed:n}}function Ut(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=0),{kind:ut.Row,label:n,row1:e,row2:t,isBracketed:r}}function xt(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=0),{kind:ut.Col,label:n,col1:e,col2:t,isBracketed:r}}function Bt(e,t,r,n){return{node:e,spans:t,annotations:r,depthUpperBound:null!=n?n:vt(e)}}function Wt(e,t,r,n){return W("calc.lang.formulaSpan",e),B("calc.lang.formulaSpan",t),t<e&&U("calc.lang.formulaSpan: expected end >= "+e+"; given "+t),{start:e,end:t,pre:r,post:n}}function Pt(e,t,r){return{kind:ct.LocalName,name:e,whole:t,label:r}}function Vt(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=0),{kind:pt.Literal,label:r,oper:e,isClosed:t}}function Gt(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=0),{kind:pt.Array,label:r,nodes:e,isClosed:t}}function Ht(e,t,r,n){return void 0===r&&(r=!0),void 0===n&&(n=0),{kind:pt.App,label:n,head:e,args:t,isClosed:r}}function jt(e,t,r,n,a){void 0===n&&(n=!0),void 0===a&&(a=0),P("calc.lang.letNode",t.length),x("calc.lang.letNode",t.every((function(e){return Wr(e[0])})));var i=ve([],ie(t,[[r]]));return{kind:pt.Let,label:a,head:e,args:i,isClosed:n,vars:t,body:r}}function Kt(e,t,r,n,a){void 0===n&&(n=!0),void 0===a&&(a=0),x("calc.lang.lambdaNode",t.every(Wr));var i=ie(t,[r]);return{kind:pt.Lambda,label:a,head:e,args:i,isClosed:n,params:t,body:r}}function Yt(e,t){return void 0===t&&(t=0),{kind:pt.Operator,label:t,id:e}}function qt(e,t,r){return void 0===r&&(r=0),{kind:pt.WSF,label:r,id:e,whole:t}}function zt(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=0),{kind:pt.Paren,label:r,node:e,isClosed:t}}function Jt(e,t,r){void 0===r&&(r=0);var n="string"==typeof e?e:e.asWhole,a="string"==typeof e?Qt(e,!0):e;return{kind:pt.Name,label:r,whole:n,parts:a,qualifier:t}}function Qt(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=0),{kind:mt.IdentNamePart,label:r,asWhole:e,canDenoteNamedObject:t}}function Xt(e,t,r){return void 0===r&&(r=0),{kind:mt.CellRefNamePart,label:r,asWhole:t,canDenoteNamedObject:!1,ref:e}}function Zt(e,t,r,n){return void 0===r&&(r=!0),void 0===n&&(n=0),{kind:mt.FieldRefNamePart,label:n,asWhole:e.asWhole+"."+t,canDenoteNamedObject:r,lhs:e,rhs:t}}function $t(e){for(var t=[e],r=t[0];r.kind===mt.FieldRefNamePart;)t.push(r.lhs),r=r.lhs;return t.reverse(),{kind:r.kind,parts:t}}function er(e){for(var t=e;t.kind===mt.FieldRefNamePart;)t=t.lhs;return t}function tr(e,t,r){return void 0===r&&(r=0),{kind:pt.CellRef,label:r,ref:e,qualifier:t}}function rr(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=0),{kind:pt.FieldRef,label:n,lhs:e,rhs:t,shouldBeBracketed:r}}function nr(e,t,r,n){return void 0===t&&(t=!1),void 0===r&&(r=!0),void 0===n&&(n=0),{label:n,field:e,isBracketed:t,isClosed:r}}function ar(e,t,r){return void 0===r&&(r=0),{kind:pt.StructRef,label:r,lhs:e,rhs:t}}function ir(e,t,r,n){return void 0===t&&(t=!1),void 0===r&&(r=!0),void 0===n&&(n=0),{kind:St.SpecialRef,label:n,id:e,isBracketed:t,isClosed:r}}function or(e,t,r,n){return void 0===t&&(t=!1),void 0===r&&(r=!0),void 0===n&&(n=0),{kind:St.ColumnRef,label:n,name:e,isBracketed:t,isClosed:r}}function ur(e,t,r){return void 0===r&&(r=0),{kind:St.RangeOpRef,label:r,lhs:e,rhs:t}}function sr(e,t,r){return void 0===r&&(r=0),{kind:St.IsectOpRef,label:r,lhs:e,rhs:t}}function cr(e,t){return void 0===t&&(t=0),{kind:St.ThisRowOpRef,label:t,ref:e}}function lr(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=0),{label:r,isClosed:t,innerRef:e}}function dr(e,t,r){return void 0===r&&(r=0),{kind:pt.Bad,label:r,type:e,contents:t}}function fr(e,t,r,n,a,i,o){(W("calc.lang.functionType",e),0===r.length?0!==n.length:n.length>=r.length)&&U("calc.lang.functionType: expected tailTypes.length < restTypes.length; given "+JSON.stringify(n));0===r.length&&t.length+n.length<e&&U("calc.lang.functionType: expected headTypes.length + tailTypes.length >= "+e+"; given "+JSON.stringify(t));return{minArgs:e,headTypes:t,restTypes:r,tailTypes:n,returnType:a,staticPrecs:i,flags:o}}function hr(e){return e.index===e.index2}function vr(e){return e.isWellFormed}function pr(e){return 1===e.rows&&1===e.cols}function mr(e){return hr(e.sheet)}function gr(e){return pr(e.range)}function Sr(e,t){if(pr(e))return t(e,0,0);for(var r=e.row,n=e.rows,a=e.col,i=e.cols,o=0;o<n;o+=1)for(var u=0;u<i;u+=1)if(!t(Dn(r+o,a+u),o,u))return!1;return!0}function yr(e,t){var r=e.row,n=e.col,a=e.rows,i=e.cols,o=t.row,u=t.col,s=t.rows,c=t.cols,l=Se(r,o),d=Se(n,u);return Mn(l,d,ye(r+a,o+s)-l,ye(n+i,u+c)-d)}function br(e){return 0===e.length&&U("calc.runtime.gridRangesJoin: expected nonempty range array"),e.reduce(yr)}function Er(e,t){var r=e.row,n=e.col,a=e.rows,i=e.cols,o=t.row,u=t.col,s=t.rows,c=t.cols,l=ye(r,o),d=ye(n,u),f=Se(r+a,o+s)-l,h=Se(n+i,u+c)-d;if(!(f<=0||h<=0))return Mn(l,d,f,h)}function Fr(e,t){var r=e.row,n=e.col,a=e.rows,i=e.cols,o=t.row,u=t.col,s=t.rows,c=t.cols;return ye(r,o)<Se(r+a,o+s)&&ye(n,u)<Se(n+i,u+c)}function Cr(e,t){var r=e.row,n=e.col,a=t.row,i=t.col,o=t.rows,u=t.cols,s=a<=r&&r<a+o,c=i<=n&&n<i+u;return s&&c?Dn(r,n):s&&1===u?Dn(r,i):c&&1===o?Dn(a,n):1===u&&1===o?Dn(a,i):void 0}function Rr(e){return e.rows*e.cols}function kr(e,t){return e===t||e.name===t.name&&e.path===t.path}function Nr(e,t){return kr(e.document,t.document)&&e.index===t.index}function Ar(e,t){return e.row===t.row&&e.col===t.col}function Tr(e,t){return e.row===t.row&&e.col===t.col&&e.rows===t.rows&&e.cols===t.cols}function Ir(e,t){return Nr(e.sheet,t.sheet)&&Ar(e.range,t.range)}function Or(e,t){return Nr(e.sheet,t.sheet)&&Tr(e.range,t.range)}function Mr(e){return pr(e)?e:Mn(e.row,e.col,1,1)}function wr(e){return gr(e)?e:Wn(e.sheet,Mr(e.range))}function Dr(e,t){var r=e.row,n=e.col,a=t.row,i=t.col;return Mn(Se(r,a),Se(n,i),Math.abs(a-r)+1,Math.abs(i-n)+1)}function _r(e,t){function r(r){var n=e.spans[r.label];return void 0!==n&&n.start<=t&&t<n.end}for(var n=e.node,a=!0;a;)switch(a=!1,n.kind){case pt.Array:for(var i=n.nodes,o=i.length-1;!a&&o>=0;o-=1)for(var u=i[o],s=u.length-1;!a&&s>=0;s-=1){r(l=u[s])&&(n=l,a=!0)}break;case pt.App:case pt.Let:case pt.Lambda:var c=n.args;for(s=c.length-1;!a&&s>=0;s-=1){r(l=c[s])&&(n=l,a=!0)}break;case pt.Paren:var l;r(l=n.node)&&(n=l,a=!0);break;case pt.Bad:case pt.Name:case pt.CellRef:case pt.StructRef:case pt.Literal:break;case pt.FieldRef:r(n.lhs)&&(n=n.lhs,a=!0);break;default:L("getSubExpressionFromPosition",n)}return n}!function(e){e.Literal="Literal",e.Array="Array",e.App="App",e.Let="Let",e.Lambda="Lambda",e.Paren="Paren",e.Name="Name",e.CellRef="CellRef",e.FieldRef="FieldRef",e.StructRef="StructRef",e.Bad="Bad",e.Operator="Operator",e.WSF="WSF"}(pt||(pt={})),function(e){e.IdentNamePart="IdentNamePart",e.CellRefNamePart="CellRefNamePart",e.FieldRefNamePart="FieldRefNamePart"}(mt||(mt={})),function(e){e[e.All=1]="All",e[e.Data=2]="Data",e[e.Headers=3]="Headers",e[e.Totals=4]="Totals",e[e.ThisRow=5]="ThisRow"}(gt||(gt={})),function(e){e.SpecialRef="SpecialRef",e.ColumnRef="ColumnRef",e.RangeOpRef="RangeOpRef",e.IsectOpRef="IsectOpRef",e.ThisRowOpRef="ThisRowOpRef"}(St||(St={})),function(e){e.Unexpected="Unexpected",e.CellRef="CellRef",e.Qualifier="Qualifier",e.Operator="Operator",e.Literal="Literal",e.Sequence="Sequence",e.StructRef="StructRef",e.FieldRef="FieldRef"}(yt||(yt={})),function(e){e[e.Number=1]="Number",e[e.String=2]="String",e[e.Boolean=4]="Boolean",e[e.Error=8]="Error",e[e.Range=16]="Range",e[e.Array=32]="Array",e[e.Missing=64]="Missing",e[e.Blank=128]="Blank",e[e.Rich=256]="Rich"}(bt||(bt={})),function(e){e[e.None=0]="None",e[e.Goto=512]="Goto",e[e.Ref3D=1024]="Ref3D",e[e.All=2047]="All"}(Et||(Et={})),function(e){e[e.None=0]="None",e[e.OwnDoc=1]="OwnDoc",e[e.OwnSheet=2]="OwnSheet",e[e.OwnRow=4]="OwnRow",e[e.OwnCol=8]="OwnCol",e[e.OwnRowCopy=16]="OwnRowCopy",e[e.OwnColCopy=32]="OwnColCopy",e[e.OwnDocSheets=64]="OwnDocSheets",e[e.CellProps=128]="CellProps",e[e.AllCells=256]="AllCells",e[e.AllNames=512]="AllNames",e[e.Time=1024]="Time",e[e.Calc=2048]="Calc",e[e.InFilterMode=4096]="InFilterMode",e[e.RefStyle=8192]="RefStyle",e[e.All=16383]="All"}(Ft||(Ft={})),function(e){e[e.None=0]="None",e[e.Dark=1]="Dark",e[e.Macro=2]="Macro",e[e.OnlyParsedDuringLoad=4]="OnlyParsedDuringLoad",e[e.Internal=8]="Internal",e[e.Allow3dRef=16]="Allow3dRef"}(Ct||(Ct={}));var Lr=[];function Ur(e){return 0===function(e){return 1===e.args.length&&Pr(e.args[0])?0:e.args.length}(e)?Lr:e.args}function xr(e){return e.kind===pt.Operator}function Br(e){return e.kind===pt.WSF}function Wr(e){return e.kind===pt.Name&&void 0===e.qualifier}function Pr(e){return e.kind===pt.Literal&&Xr(e.oper)}function Vr(e){return e.kind===pt.Literal&&Kr(e.oper)}function Gr(e,t,r){var n=e.headTypes,a=e.restTypes,i=e.tailTypes;if(P("calc.runtime.getArgType: n",r),V("calc.runtime.getArgType: i",t,r),t<n.length)return n[t];if(0===a.length)return Et.None;var o=(r-n.length)%a.length;return o>i.length?Et.None:t>=r-o?i[t-(r-o)]:a[(t-n.length)%a.length]}function Hr(e,t){var r=e.minArgs,n=e.headTypes,a=e.restTypes,i=e.tailTypes;return!(t<r)&&(t<=n.length||0!==a.length&&(t-n.length)%a.length<=i.length)}function jr(e,t){return t.length>0&&((r=e).kind===pt.Literal&&qr(r.oper)||e.kind===pt.Name||e.kind===pt.CellRef);var r}function Kr(e){return e.kind===bt.Number}function Yr(e){return e.kind===bt.String}function qr(e){return e.kind===bt.Boolean}function zr(e){return e.kind===bt.Error}function Jr(e){return e.kind===bt.Range}function Qr(e){return e.kind===bt.Array}function Xr(e){return e.kind===bt.Missing}function Zr(e){return e.kind===bt.Blank}function $r(e){return e.kind===bt.Rich}var en=bt.Number|bt.String|bt.Boolean;function tn(e){return 0!=(e.kind&en)}var rn,nn=en|bt.Error|bt.Array|bt.Rich;function an(e,t,r,n){if(r.kind!==t.kind)return!1;switch(r.kind){case bt.Boolean:case bt.String:return r.value===t.value;case bt.Number:return 0===e.cond2(r,t);case bt.Error:return r.type===t.type;case bt.Rich:return n;case bt.Array:var a=t;if(r.cols!==a.cols||r.rows!==a.rows)return!1;for(var i=0;i<r.rows;i+=1)for(var o=r.opers[i],u=a.opers[i],s=0;s<r.cols;s+=1)if(!an(e,u[s],o[s],n))return!1;return!0;case bt.Blank:return!0;default:return L("calc.lang.readOperEq",r)}}!function(e){e.NotImplemented="NotImplemented",e.Unavailable="Unavailable",e.Internal="Internal"}(rn||(rn={}));var on=te(te({},z),rn);function un(e){return{kind:on.NotImplemented,features:e}}function sn(e){return 0===e.length&&U("calc.lang.unavailable: expected nonempty array"),{kind:on.Unavailable,objects:e}}function cn(e){return{kind:on.Internal,message:e}}function ln(e){var t=function(t){this.reason=t,this.name=e,this.stack=e,this.message=t.kind};return(t.prototype=Object.create(Error.prototype)).constructor=t,t}var dn="_xlfn.",fn="_xlws.";function hn(e,t){var r=t;return r.length>dn.length&&0===e.stringCompareCI(r.substring(0,dn.length),dn)&&(r=r.substring(dn.length)).length>fn.length&&0===e.stringCompareCI(r.substring(0,fn.length),fn)&&(r=r.substring(fn.length)),e.getWorksheetFuncId(r)}var vn,pn,mn="_xlpm.";function gn(e,t){var r=t;return r.length>mn.length&&0===e.stringCompareCI(r.substring(0,mn.length),mn)&&(r=r.substring(mn.length)),r}function Sn(e,t){return e.id===gt.Data&&(t.id===gt.Headers||t.id===gt.Totals)||t.id===gt.Data&&(e.id===gt.Headers||e.id===gt.Totals)||e.id===t.id}function yn(e){return(e.lhs.kind===St.ColumnRef||e.lhs.kind===St.RangeOpRef)&&e.rhs.kind===St.SpecialRef&&e.rhs.isBracketed||(e.rhs.kind===St.ColumnRef||e.rhs.kind===St.RangeOpRef)&&e.lhs.kind===St.SpecialRef&&e.lhs.isBracketed||e.lhs.kind===St.SpecialRef&&e.rhs.kind===St.SpecialRef&&Sn(e.lhs,e.rhs)&&e.lhs.isBracketed&&e.rhs.isBracketed}function bn(e){switch(e.kind){case St.SpecialRef:case St.ColumnRef:return e.isClosed;case St.RangeOpRef:return e.lhs.isClosed&&e.rhs.isClosed}}function En(e){return{kind:vn.Cell,range:e}}function Fn(e){return{kind:vn.Range,range:e}}function Cn(e,t){switch(e){case vn.Cell:return gr(t)?En(t):U("calc.lang.lexicalSourceGrid: expected cell");case vn.Range:return Fn(t)}}function Rn(e){return{kind:vn.NameManager,name:e}}!function(e){e[e.Cell=1]="Cell",e[e.Range=2]="Range",e[e.NameManager=3]="NameManager",e[e.CondFormatting=4]="CondFormatting",e[e.DataValidation=5]="DataValidation",e[e.Indirect=6]="Indirect",e[e.Other=7]="Other"}(vn||(vn={})),function(e){e.AppHead="AppHead",e.Plain="Plain",e.StructRef="StructRef",e.Indirect="Indirect"}(pn||(pn={}));function kn(e,t){return{path:e,name:t}}function Nn(e,t,r,n){return{name:e,range:t,hasHeadersRow:r,hasTotalsRow:n}}function An(e,t,r){return{document:e,index:t,index2:r}}function Tn(e,t){return An(e,t,t)}function In(e){return{document:e,index:void 0,index2:void 0}}function On(e,t){return{sheets:e,position:t}}function Mn(e,t,r,n){return{row:e,col:t,rows:r,cols:n}}function wn(e,t,r,n){return V("calc.lang.gridRange",e,1<<20),V("calc.lang.gridRange",t,16384),G("calc.lang.gridRange",r,(1<<20)-e),G("calc.lang.gridRange",n,16384-t),Mn(e,t,r,n)}function Dn(e,t){return V("calc.lang.gridCell",e,1<<20),V("calc.lang.gridCell",t,16384),Mn(e,t,1,1)}function _n(e,t){return{sheet:e,range:t}}var Ln,Un,xn=_n,Bn=_n,Wn=_n,Pn=_n;function Vn(e){return{document:e,index:void 0}}function Gn(e,t){return void 0===t?Vn(e):Tn(e,t)}function Hn(e,t){return{scope:e,name:t}}function jn(e,t){return{document:e,id:t}}!function(e){e[e.Lower=-1]="Lower",e[e.Exact=0]="Exact",e[e.Upper=1]="Upper"}(Un||(Un={}));var Kn;function Yn(e,t,r,n){return{cells:e,names:t,special:r,bound:n}}function qn(e){return e?ha:va}function zn(e){return{kind:bt.String,value:e}}function Jn(e){var t=oa[e];return void 0!==t?t:ia(e)}!function(e){e[e.NULL=1]="NULL",e[e.DIV0=2]="DIV0",e[e.VALUE=3]="VALUE",e[e.REF=4]="REF",e[e.NAME=5]="NAME",e[e.NUM=6]="NUM",e[e.NA=7]="NA",e[e.GETTING_DATA=8]="GETTING_DATA",e[e.FIELD=13]="FIELD"}(Kn||(Kn={}));var Qn=ia(Kn.NULL),Xn=ia(Kn.DIV0),Zn=ia(Kn.VALUE),$n=ia(Kn.REF),ea=ia(Kn.NAME),ta=ia(Kn.NUM),ra=ia(Kn.NA),na=ia(Kn.GETTING_DATA),aa=ia(Kn.FIELD);function ia(e){return{kind:bt.Error,type:e}}var oa=N(((Ln={})[Kn.NULL]=Qn,Ln[Kn.DIV0]=Xn,Ln[Kn.VALUE]=Zn,Ln[Kn.REF]=$n,Ln[Kn.NAME]=ea,Ln[Kn.NUM]=ta,Ln[Kn.NA]=ra,Ln[Kn.GETTING_DATA]=na,Ln[Kn.FIELD]=aa,Ln));function ua(e,t,r){return W("calc.lang.arrayOper",e),W("calc.lang.arrayOper",t),r.length!==e?U("calc.lang.arrayOper: Inconsistent row number"):{kind:bt.Array,rows:e,cols:t,opers:r}}function sa(e,t){return P("calc.lang.rangeSeqOper",t.length),{kind:bt.Range,sheets:e,ranges:t}}function ca(e,t){return{kind:bt.Range,sheets:e,ranges:[t]}}var la,da={kind:bt.Missing},fa={kind:bt.Blank},ha={kind:bt.Boolean,value:!0},va={kind:bt.Boolean,value:!1};!function(e){e[e.COUNT=0]="COUNT",e[e.IF=1]="IF",e[e.ISNA=2]="ISNA",e[e.ISERROR=3]="ISERROR",e[e.SUM=4]="SUM",e[e.AVERAGE=5]="AVERAGE",e[e.MIN=6]="MIN",e[e.MAX=7]="MAX",e[e.ROW=8]="ROW",e[e.COLUMN=9]="COLUMN",e[e.NA=10]="NA",e[e.NPV=11]="NPV",e[e.STDEV=12]="STDEV",e[e.DOLLAR=13]="DOLLAR",e[e.FIXED=14]="FIXED",e[e.SIN=15]="SIN",e[e.COS=16]="COS",e[e.TAN=17]="TAN",e[e.ATAN=18]="ATAN",e[e.PI=19]="PI",e[e.SQRT=20]="SQRT",e[e.EXP=21]="EXP",e[e.LN=22]="LN",e[e.LOG10=23]="LOG10",e[e.ABS=24]="ABS",e[e.INT=25]="INT",e[e.SIGN=26]="SIGN",e[e.ROUND=27]="ROUND",e[e.LOOKUP=28]="LOOKUP",e[e.INDEX=29]="INDEX",e[e.REPT=30]="REPT",e[e.MID=31]="MID",e[e.LEN=32]="LEN",e[e.VALUE=33]="VALUE",e[e.TRUE=34]="TRUE",e[e.FALSE=35]="FALSE",e[e.AND=36]="AND",e[e.OR=37]="OR",e[e.NOT=38]="NOT",e[e.MOD=39]="MOD",e[e.DCOUNT=40]="DCOUNT",e[e.DSUM=41]="DSUM",e[e.DAVERAGE=42]="DAVERAGE",e[e.DMIN=43]="DMIN",e[e.DMAX=44]="DMAX",e[e.DSTDEV=45]="DSTDEV",e[e.VAR=46]="VAR",e[e.DVAR=47]="DVAR",e[e.TEXT=48]="TEXT",e[e.LINEST=49]="LINEST",e[e.TREND=50]="TREND",e[e.LOGEST=51]="LOGEST",e[e.GROWTH=52]="GROWTH",e[e.GOTO=53]="GOTO",e[e.HALT=54]="HALT",e[e.RETURN=55]="RETURN",e[e.PV=56]="PV",e[e.FV=57]="FV",e[e.NPER=58]="NPER",e[e.PMT=59]="PMT",e[e.RATE=60]="RATE",e[e.MIRR=61]="MIRR",e[e.IRR=62]="IRR",e[e.RAND=63]="RAND",e[e.MATCH=64]="MATCH",e[e.DATE=65]="DATE",e[e.TIME=66]="TIME",e[e.DAY=67]="DAY",e[e.MONTH=68]="MONTH",e[e.YEAR=69]="YEAR",e[e.WEEKDAY=70]="WEEKDAY",e[e.HOUR=71]="HOUR",e[e.MINUTE=72]="MINUTE",e[e.SECOND=73]="SECOND",e[e.NOW=74]="NOW",e[e.AREAS=75]="AREAS",e[e.ROWS=76]="ROWS",e[e.COLUMNS=77]="COLUMNS",e[e.OFFSET=78]="OFFSET",e[e.ABSREF=79]="ABSREF",e[e.RELREF=80]="RELREF",e[e.ARGUMENT=81]="ARGUMENT",e[e.SEARCH=82]="SEARCH",e[e.TRANSPOSE=83]="TRANSPOSE",e[e.ERROR=84]="ERROR",e[e.STEP=85]="STEP",e[e.TYPE=86]="TYPE",e[e.ECHO=87]="ECHO",e[e.SET_NAME=88]="SET_NAME",e[e.CALLER=89]="CALLER",e[e.DEREF=90]="DEREF",e[e.WINDOWS=91]="WINDOWS",e[e.SERIES=92]="SERIES",e[e.DOCUMENTS=93]="DOCUMENTS",e[e.ACTIVE_CELL=94]="ACTIVE_CELL",e[e.SELECTION=95]="SELECTION",e[e.RESULT=96]="RESULT",e[e.ATAN2=97]="ATAN2",e[e.ASIN=98]="ASIN",e[e.ACOS=99]="ACOS",e[e.CHOOSE=100]="CHOOSE",e[e.HLOOKUP=101]="HLOOKUP",e[e.VLOOKUP=102]="VLOOKUP",e[e.LINKS=103]="LINKS",e[e.INPUT=104]="INPUT",e[e.ISREF=105]="ISREF",e[e.GET_FORMULA=106]="GET_FORMULA",e[e.GET_NAME=107]="GET_NAME",e[e.SET_VALUE=108]="SET_VALUE",e[e.LOG=109]="LOG",e[e.EXEC=110]="EXEC",e[e.CHAR=111]="CHAR",e[e.LOWER=112]="LOWER",e[e.UPPER=113]="UPPER",e[e.PROPER=114]="PROPER",e[e.LEFT=115]="LEFT",e[e.RIGHT=116]="RIGHT",e[e.EXACT=117]="EXACT",e[e.TRIM=118]="TRIM",e[e.REPLACE=119]="REPLACE",e[e.SUBSTITUTE=120]="SUBSTITUTE",e[e.CODE=121]="CODE",e[e.NAMES=122]="NAMES",e[e.DIRECTORY=123]="DIRECTORY",e[e.FIND=124]="FIND",e[e.CELL=125]="CELL",e[e.ISERR=126]="ISERR",e[e.ISTEXT=127]="ISTEXT",e[e.ISNUMBER=128]="ISNUMBER",e[e.ISBLANK=129]="ISBLANK",e[e.T=130]="T",e[e.N=131]="N",e[e.FOPEN=132]="FOPEN",e[e.FCLOSE=133]="FCLOSE",e[e.FSIZE=134]="FSIZE",e[e.FREADLN=135]="FREADLN",e[e.FREAD=136]="FREAD",e[e.FWRITELN=137]="FWRITELN",e[e.FWRITE=138]="FWRITE",e[e.FPOS=139]="FPOS",e[e.DATEVALUE=140]="DATEVALUE",e[e.TIMEVALUE=141]="TIMEVALUE",e[e.SLN=142]="SLN",e[e.SYD=143]="SYD",e[e.DDB=144]="DDB",e[e.GET_DEF=145]="GET_DEF",e[e.REFTEXT=146]="REFTEXT",e[e.TEXTREF=147]="TEXTREF",e[e.INDIRECT=148]="INDIRECT",e[e.REGISTER=149]="REGISTER",e[e.CALL=150]="CALL",e[e.ADD_BAR=151]="ADD_BAR",e[e.ADD_MENU=152]="ADD_MENU",e[e.ADD_COMMAND=153]="ADD_COMMAND",e[e.ENABLE_COMMAND=154]="ENABLE_COMMAND",e[e.CHECK_COMMAND=155]="CHECK_COMMAND",e[e.RENAME_COMMAND=156]="RENAME_COMMAND",e[e.SHOW_BAR=157]="SHOW_BAR",e[e.DELETE_MENU=158]="DELETE_MENU",e[e.DELETE_COMMAND=159]="DELETE_COMMAND",e[e.GET_CHART_ITEM=160]="GET_CHART_ITEM",e[e.DIALOG_BOX=161]="DIALOG_BOX",e[e.CLEAN=162]="CLEAN",e[e.MDETERM=163]="MDETERM",e[e.MINVERSE=164]="MINVERSE",e[e.MMULT=165]="MMULT",e[e.FILES=166]="FILES",e[e.IPMT=167]="IPMT",e[e.PPMT=168]="PPMT",e[e.COUNTA=169]="COUNTA",e[e.CANCEL_KEY=170]="CANCEL_KEY",e[e.FOR=171]="FOR",e[e.WHILE=172]="WHILE",e[e.BREAK=173]="BREAK",e[e.NEXT=174]="NEXT",e[e.INITIATE=175]="INITIATE",e[e.REQUEST=176]="REQUEST",e[e.POKE=177]="POKE",e[e.EXECUTE=178]="EXECUTE",e[e.TERMINATE=179]="TERMINATE",e[e.RESTART=180]="RESTART",e[e.HELP=181]="HELP",e[e.GET_BAR=182]="GET_BAR",e[e.PRODUCT=183]="PRODUCT",e[e.FACT=184]="FACT",e[e.GET_CELL=185]="GET_CELL",e[e.GET_WORKSPACE=186]="GET_WORKSPACE",e[e.GET_WINDOW=187]="GET_WINDOW",e[e.GET_DOCUMENT=188]="GET_DOCUMENT",e[e.DPRODUCT=189]="DPRODUCT",e[e.ISNONTEXT=190]="ISNONTEXT",e[e.GET_NOTE=191]="GET_NOTE",e[e.NOTE=192]="NOTE",e[e.STDEVP=193]="STDEVP",e[e.VARP=194]="VARP",e[e.DSTDEVP=195]="DSTDEVP",e[e.DVARP=196]="DVARP",e[e.TRUNC=197]="TRUNC",e[e.ISLOGICAL=198]="ISLOGICAL",e[e.DCOUNTA=199]="DCOUNTA",e[e.DELETE_BAR=200]="DELETE_BAR",e[e.UNREGISTER=201]="UNREGISTER",e[e.USDOLLAR=204]="USDOLLAR",e[e.FINDB=205]="FINDB",e[e.SEARCHB=206]="SEARCHB",e[e.REPLACEB=207]="REPLACEB",e[e.LEFTB=208]="LEFTB",e[e.RIGHTB=209]="RIGHTB",e[e.MIDB=210]="MIDB",e[e.LENB=211]="LENB",e[e.ROUNDUP=212]="ROUNDUP",e[e.ROUNDDOWN=213]="ROUNDDOWN",e[e.ASC=214]="ASC",e[e.DBCS=215]="DBCS",e[e.RANK=216]="RANK",e[e.ADDRESS=219]="ADDRESS",e[e.DAYS360=220]="DAYS360",e[e.TODAY=221]="TODAY",e[e.VDB=222]="VDB",e[e.ELSE=223]="ELSE",e[e.ELSE_IF=224]="ELSE_IF",e[e.END_IF=225]="END_IF",e[e.FOR_CELL=226]="FOR_CELL",e[e.MEDIAN=227]="MEDIAN",e[e.SUMPRODUCT=228]="SUMPRODUCT",e[e.SINH=229]="SINH",e[e.COSH=230]="COSH",e[e.TANH=231]="TANH",e[e.ASINH=232]="ASINH",e[e.ACOSH=233]="ACOSH",e[e.ATANH=234]="ATANH",e[e.DGET=235]="DGET",e[e.CREATE_OBJECT=236]="CREATE_OBJECT",e[e.VOLATILE=237]="VOLATILE",e[e.LAST_ERROR=238]="LAST_ERROR",e[e.CUSTOM_UNDO=239]="CUSTOM_UNDO",e[e.CUSTOM_REPEAT=240]="CUSTOM_REPEAT",e[e.FORMULA_CONVERT=241]="FORMULA_CONVERT",e[e.GET_LINK_INFO=242]="GET_LINK_INFO",e[e.TEXT_BOX=243]="TEXT_BOX",e[e.INFO=244]="INFO",e[e.GROUP=245]="GROUP",e[e.GET_OBJECT=246]="GET_OBJECT",e[e.DB=247]="DB",e[e.PAUSE=248]="PAUSE",e[e.RESUME=251]="RESUME",e[e.FREQUENCY=252]="FREQUENCY",e[e.ADD_TOOLBAR=253]="ADD_TOOLBAR",e[e.DELETE_TOOLBAR=254]="DELETE_TOOLBAR",e[e._UDF=255]="_UDF",e[e.RESET_TOOLBAR=256]="RESET_TOOLBAR",e[e.EVALUATE=257]="EVALUATE",e[e.GET_TOOLBAR=258]="GET_TOOLBAR",e[e.GET_TOOL=259]="GET_TOOL",e[e.SPELLING_CHECK=260]="SPELLING_CHECK",e[e.ERROR_TYPE=261]="ERROR_TYPE",e[e.APP_TITLE=262]="APP_TITLE",e[e.WINDOW_TITLE=263]="WINDOW_TITLE",e[e.SAVE_TOOLBAR=264]="SAVE_TOOLBAR",e[e.ENABLE_TOOL=265]="ENABLE_TOOL",e[e.PRESS_TOOL=266]="PRESS_TOOL",e[e.REGISTER_ID=267]="REGISTER_ID",e[e.GET_PROJECT=268]="GET_PROJECT",e[e.AVEDEV=269]="AVEDEV",e[e.BETADIST=270]="BETADIST",e[e.GAMMALN=271]="GAMMALN",e[e.BETAINV=272]="BETAINV",e[e.BINOMDIST=273]="BINOMDIST",e[e.CHIDIST=274]="CHIDIST",e[e.CHIINV=275]="CHIINV",e[e.COMBIN=276]="COMBIN",e[e.CONFIDENCE=277]="CONFIDENCE",e[e.CRITBINOM=278]="CRITBINOM",e[e.EVEN=279]="EVEN",e[e.EXPONDIST=280]="EXPONDIST",e[e.FDIST=281]="FDIST",e[e.FINV=282]="FINV",e[e.FISHER=283]="FISHER",e[e.FISHERINV=284]="FISHERINV",e[e.FLOOR=285]="FLOOR",e[e.GAMMADIST=286]="GAMMADIST",e[e.GAMMAINV=287]="GAMMAINV",e[e.CEILING=288]="CEILING",e[e.HYPGEOMDIST=289]="HYPGEOMDIST",e[e.LOGNORMDIST=290]="LOGNORMDIST",e[e.LOGINV=291]="LOGINV",e[e.NEGBINOMDIST=292]="NEGBINOMDIST",e[e.NORMDIST=293]="NORMDIST",e[e.NORMSDIST=294]="NORMSDIST",e[e.NORMINV=295]="NORMINV",e[e.NORMSINV=296]="NORMSINV",e[e.STANDARDIZE=297]="STANDARDIZE",e[e.ODD=298]="ODD",e[e.PERMUT=299]="PERMUT",e[e.POISSON=300]="POISSON",e[e.TDIST=301]="TDIST",e[e.WEIBULL=302]="WEIBULL",e[e.SUMXMY2=303]="SUMXMY2",e[e.SUMX2MY2=304]="SUMX2MY2",e[e.SUMX2PY2=305]="SUMX2PY2",e[e.CHITEST=306]="CHITEST",e[e.CORREL=307]="CORREL",e[e.COVAR=308]="COVAR",e[e.FORECAST=309]="FORECAST",e[e.FTEST=310]="FTEST",e[e.INTERCEPT=311]="INTERCEPT",e[e.PEARSON=312]="PEARSON",e[e.RSQ=313]="RSQ",e[e.STEYX=314]="STEYX",e[e.SLOPE=315]="SLOPE",e[e.TTEST=316]="TTEST",e[e.PROB=317]="PROB",e[e.DEVSQ=318]="DEVSQ",e[e.GEOMEAN=319]="GEOMEAN",e[e.HARMEAN=320]="HARMEAN",e[e.SUMSQ=321]="SUMSQ",e[e.KURT=322]="KURT",e[e.SKEW=323]="SKEW",e[e.ZTEST=324]="ZTEST",e[e.LARGE=325]="LARGE",e[e.SMALL=326]="SMALL",e[e.QUARTILE=327]="QUARTILE",e[e.PERCENTILE=328]="PERCENTILE",e[e.PERCENTRANK=329]="PERCENTRANK",e[e.MODE=330]="MODE",e[e.TRIMMEAN=331]="TRIMMEAN",e[e.TINV=332]="TINV",e[e.MOVIE_COMMAND=334]="MOVIE_COMMAND",e[e.GET_MOVIE=335]="GET_MOVIE",e[e.CONCATENATE=336]="CONCATENATE",e[e.POWER=337]="POWER",e[e.SPREADBASE_DATA_FIELD=338]="SPREADBASE_DATA_FIELD",e[e.GET_VIEW=339]="GET_VIEW",e[e.GET_FIELD=340]="GET_FIELD",e[e.GET_ITEM=341]="GET_ITEM",e[e.RADIANS=342]="RADIANS",e[e.DEGREES=343]="DEGREES",e[e.SUBTOTAL=344]="SUBTOTAL",e[e.SUMIF=345]="SUMIF",e[e.COUNTIF=346]="COUNTIF",e[e.COUNTBLANK=347]="COUNTBLANK",e[e.SCENARIO_GET=348]="SCENARIO_GET",e[e.OPTIONS_LISTS=349]="OPTIONS_LISTS",e[e.ISPMT=350]="ISPMT",e[e.DATEDIF=351]="DATEDIF",e[e.DATESTRING=352]="DATESTRING",e[e.NUMBERSTRING=353]="NUMBERSTRING",e[e.ROMAN=354]="ROMAN",e[e.OPENDIALOG=355]="OPENDIALOG",e[e.SAVEDIALOG=356]="SAVEDIALOG",e[e.VIEW_GET=357]="VIEW_GET",e[e.GETPIVOTDATA=358]="GETPIVOTDATA",e[e.HYPERLINK=359]="HYPERLINK",e[e.FURIGANA=360]="FURIGANA",e[e.AVERAGEA=361]="AVERAGEA",e[e.MAXA=362]="MAXA",e[e.MINA=363]="MINA",e[e.STDEVPA=364]="STDEVPA",e[e.VARPA=365]="VARPA",e[e.STDEVA=366]="STDEVA",e[e.VARA=367]="VARA",e[e.BAHTTEXT=368]="BAHTTEXT",e[e.THAIDOW=369]="THAIDOW",e[e.THAIDIGIT=370]="THAIDIGIT",e[e.THAIMOY=371]="THAIMOY",e[e.THAINUMSOUND=372]="THAINUMSOUND",e[e.THAINUMSTRING=373]="THAINUMSTRING",e[e.THAISTRINGLENGTH=374]="THAISTRINGLENGTH",e[e.ISTHAIDIGIT=375]="ISTHAIDIGIT",e[e.ROUNDBAHTDOWN=376]="ROUNDBAHTDOWN",e[e.ROUNDBAHTUP=377]="ROUNDBAHTUP",e[e.THAIYEAR=378]="THAIYEAR",e[e.RTD=379]="RTD",e[e.CUBEVALUE=380]="CUBEVALUE",e[e.CUBEMEMBER=381]="CUBEMEMBER",e[e.CUBEMEMBERPROPERTY=382]="CUBEMEMBERPROPERTY",e[e.CUBERANKEDMEMBER=383]="CUBERANKEDMEMBER",e[e.HEX2BIN=384]="HEX2BIN",e[e.HEX2DEC=385]="HEX2DEC",e[e.HEX2OCT=386]="HEX2OCT",e[e.DEC2BIN=387]="DEC2BIN",e[e.DEC2HEX=388]="DEC2HEX",e[e.DEC2OCT=389]="DEC2OCT",e[e.OCT2BIN=390]="OCT2BIN",e[e.OCT2HEX=391]="OCT2HEX",e[e.OCT2DEC=392]="OCT2DEC",e[e.BIN2DEC=393]="BIN2DEC",e[e.BIN2OCT=394]="BIN2OCT",e[e.BIN2HEX=395]="BIN2HEX",e[e.IMSUB=396]="IMSUB",e[e.IMDIV=397]="IMDIV",e[e.IMPOWER=398]="IMPOWER",e[e.IMABS=399]="IMABS",e[e.IMSQRT=400]="IMSQRT",e[e.IMLN=401]="IMLN",e[e.IMLOG2=402]="IMLOG2",e[e.IMLOG10=403]="IMLOG10",e[e.IMSIN=404]="IMSIN",e[e.IMCOS=405]="IMCOS",e[e.IMEXP=406]="IMEXP",e[e.IMARGUMENT=407]="IMARGUMENT",e[e.IMCONJUGATE=408]="IMCONJUGATE",e[e.IMAGINARY=409]="IMAGINARY",e[e.IMREAL=410]="IMREAL",e[e.COMPLEX=411]="COMPLEX",e[e.IMSUM=412]="IMSUM",e[e.IMPRODUCT=413]="IMPRODUCT",e[e.SERIESSUM=414]="SERIESSUM",e[e.FACTDOUBLE=415]="FACTDOUBLE",e[e.SQRTPI=416]="SQRTPI",e[e.QUOTIENT=417]="QUOTIENT",e[e.DELTA=418]="DELTA",e[e.GESTEP=419]="GESTEP",e[e.ISEVEN=420]="ISEVEN",e[e.ISODD=421]="ISODD",e[e.MROUND=422]="MROUND",e[e.ERF=423]="ERF",e[e.ERFC=424]="ERFC",e[e.BESSELJ=425]="BESSELJ",e[e.BESSELK=426]="BESSELK",e[e.BESSELY=427]="BESSELY",e[e.BESSELI=428]="BESSELI",e[e.XIRR=429]="XIRR",e[e.XNPV=430]="XNPV",e[e.PRICEMAT=431]="PRICEMAT",e[e.YIELDMAT=432]="YIELDMAT",e[e.INTRATE=433]="INTRATE",e[e.RECEIVED=434]="RECEIVED",e[e.DISC=435]="DISC",e[e.PRICEDISC=436]="PRICEDISC",e[e.YIELDDISC=437]="YIELDDISC",e[e.TBILLEQ=438]="TBILLEQ",e[e.TBILLPRICE=439]="TBILLPRICE",e[e.TBILLYIELD=440]="TBILLYIELD",e[e.PRICE=441]="PRICE",e[e.YIELD=442]="YIELD",e[e.DOLLARDE=443]="DOLLARDE",e[e.DOLLARFR=444]="DOLLARFR",e[e.NOMINAL=445]="NOMINAL",e[e.EFFECT=446]="EFFECT",e[e.CUMPRINC=447]="CUMPRINC",e[e.CUMIPMT=448]="CUMIPMT",e[e.EDATE=449]="EDATE",e[e.EOMONTH=450]="EOMONTH",e[e.YEARFRAC=451]="YEARFRAC",e[e.COUPDAYBS=452]="COUPDAYBS",e[e.COUPDAYS=453]="COUPDAYS",e[e.COUPDAYSNC=454]="COUPDAYSNC",e[e.COUPNCD=455]="COUPNCD",e[e.COUPNUM=456]="COUPNUM",e[e.COUPPCD=457]="COUPPCD",e[e.DURATION=458]="DURATION",e[e.MDURATION=459]="MDURATION",e[e.ODDLPRICE=460]="ODDLPRICE",e[e.ODDLYIELD=461]="ODDLYIELD",e[e.ODDFPRICE=462]="ODDFPRICE",e[e.ODDFYIELD=463]="ODDFYIELD",e[e.RANDBETWEEN=464]="RANDBETWEEN",e[e.WEEKNUM=465]="WEEKNUM",e[e.AMORDEGRC=466]="AMORDEGRC",e[e.AMORLINC=467]="AMORLINC",e[e.CONVERT=468]="CONVERT",e[e.ACCRINT=469]="ACCRINT",e[e.ACCRINTM=470]="ACCRINTM",e[e.WORKDAY=471]="WORKDAY",e[e.NETWORKDAYS=472]="NETWORKDAYS",e[e.GCD=473]="GCD",e[e.MULTINOMIAL=474]="MULTINOMIAL",e[e.LCM=475]="LCM",e[e.FVSCHEDULE=476]="FVSCHEDULE",e[e.CUBEKPIMEMBER=477]="CUBEKPIMEMBER",e[e.CUBESET=478]="CUBESET",e[e.CUBESETCOUNT=479]="CUBESETCOUNT",e[e.IFERROR=480]="IFERROR",e[e.COUNTIFS=481]="COUNTIFS",e[e.SUMIFS=482]="SUMIFS",e[e.AVERAGEIF=483]="AVERAGEIF",e[e.AVERAGEIFS=484]="AVERAGEIFS",e[e.AGGREGATE=485]="AGGREGATE",e[e.BINOM_DIST=486]="BINOM_DIST",e[e.BINOM_INV=487]="BINOM_INV",e[e.CONFIDENCE_NORM=488]="CONFIDENCE_NORM",e[e.CONFIDENCE_T=489]="CONFIDENCE_T",e[e.CHISQ_TEST=490]="CHISQ_TEST",e[e.F_TEST=491]="F_TEST",e[e.COVARIANCE_P=492]="COVARIANCE_P",e[e.COVARIANCE_S=493]="COVARIANCE_S",e[e.EXPON_DIST=494]="EXPON_DIST",e[e.GAMMA_DIST=495]="GAMMA_DIST",e[e.GAMMA_INV=496]="GAMMA_INV",e[e.MODE_MULT=497]="MODE_MULT",e[e.MODE_SNGL=498]="MODE_SNGL",e[e.NORM_DIST=499]="NORM_DIST",e[e.NORM_INV=500]="NORM_INV",e[e.PERCENTILE_EXC=501]="PERCENTILE_EXC",e[e.PERCENTILE_INC=502]="PERCENTILE_INC",e[e.PERCENTRANK_EXC=503]="PERCENTRANK_EXC",e[e.PERCENTRANK_INC=504]="PERCENTRANK_INC",e[e.POISSON_DIST=505]="POISSON_DIST",e[e.QUARTILE_EXC=506]="QUARTILE_EXC",e[e.QUARTILE_INC=507]="QUARTILE_INC",e[e.RANK_AVG=508]="RANK_AVG",e[e.RANK_EQ=509]="RANK_EQ",e[e.STDEV_S=510]="STDEV_S",e[e.STDEV_P=511]="STDEV_P",e[e.T_DIST=512]="T_DIST",e[e.T_DIST_2T=513]="T_DIST_2T",e[e.T_DIST_RT=514]="T_DIST_RT",e[e.T_INV=515]="T_INV",e[e.T_INV_2T=516]="T_INV_2T",e[e.VAR_S=517]="VAR_S",e[e.VAR_P=518]="VAR_P",e[e.WEIBULL_DIST=519]="WEIBULL_DIST",e[e.NETWORKDAYS_INTL=520]="NETWORKDAYS_INTL",e[e.WORKDAY_INTL=521]="WORKDAY_INTL",e[e.ECMA_CEILING=522]="ECMA_CEILING",e[e.ISO_CEILING=523]="ISO_CEILING",e[e.BETA_DIST=525]="BETA_DIST",e[e.BETA_INV=526]="BETA_INV",e[e.CHISQ_DIST=527]="CHISQ_DIST",e[e.CHISQ_DIST_RT=528]="CHISQ_DIST_RT",e[e.CHISQ_INV=529]="CHISQ_INV",e[e.CHISQ_INV_RT=530]="CHISQ_INV_RT",e[e.F_DIST=531]="F_DIST",e[e.F_DIST_RT=532]="F_DIST_RT",e[e.F_INV=533]="F_INV",e[e.F_INV_RT=534]="F_INV_RT",e[e.HYPGEOM_DIST=535]="HYPGEOM_DIST",e[e.LOGNORM_DIST=536]="LOGNORM_DIST",e[e.LOGNORM_INV=537]="LOGNORM_INV",e[e.NEGBINOM_DIST=538]="NEGBINOM_DIST",e[e.NORM_S_DIST=539]="NORM_S_DIST",e[e.NORM_S_INV=540]="NORM_S_INV",e[e.T_TEST=541]="T_TEST",e[e.Z_TEST=542]="Z_TEST",e[e.ERF_PRECISE=543]="ERF_PRECISE",e[e.ERFC_PRECISE=544]="ERFC_PRECISE",e[e.GAMMALN_PRECISE=545]="GAMMALN_PRECISE",e[e.CEILING_PRECISE=546]="CEILING_PRECISE",e[e.FLOOR_PRECISE=547]="FLOOR_PRECISE",e[e.ACOT=548]="ACOT",e[e.ACOTH=549]="ACOTH",e[e.COT=550]="COT",e[e.COTH=551]="COTH",e[e.CSC=552]="CSC",e[e.CSCH=553]="CSCH",e[e.SEC=554]="SEC",e[e.SECH=555]="SECH",e[e.IMTAN=556]="IMTAN",e[e.IMCOT=557]="IMCOT",e[e.IMCSC=558]="IMCSC",e[e.IMCSCH=559]="IMCSCH",e[e.IMSEC=560]="IMSEC",e[e.IMSECH=561]="IMSECH",e[e.BITAND=562]="BITAND",e[e.BITOR=563]="BITOR",e[e.BITXOR=564]="BITXOR",e[e.BITLSHIFT=565]="BITLSHIFT",e[e.BITRSHIFT=566]="BITRSHIFT",e[e.PERMUTATIONA=567]="PERMUTATIONA",e[e.COMBINA=568]="COMBINA",e[e.XOR=569]="XOR",e[e.PDURATION=570]="PDURATION",e[e.BASE=571]="BASE",e[e.DECIMAL=572]="DECIMAL",e[e.DAYS=573]="DAYS",e[e.BINOM_DIST_RANGE=574]="BINOM_DIST_RANGE",e[e.GAMMA=575]="GAMMA",e[e.SKEW_P=576]="SKEW_P",e[e.GAUSS=577]="GAUSS",e[e.PHI=578]="PHI",e[e.RRI=579]="RRI",e[e.UNICHAR=580]="UNICHAR",e[e.UNICODE=581]="UNICODE",e[e.MUNIT=582]="MUNIT",e[e.ARABIC=583]="ARABIC",e[e.ISOWEEKNUM=584]="ISOWEEKNUM",e[e.NUMBERVALUE=585]="NUMBERVALUE",e[e.SHEET=586]="SHEET",e[e.SHEETS=587]="SHEETS",e[e.FORMULATEXT=588]="FORMULATEXT",e[e.ISFORMULA=589]="ISFORMULA",e[e.IFNA=590]="IFNA",e[e.CEILING_MATH=591]="CEILING_MATH",e[e.FLOOR_MATH=592]="FLOOR_MATH",e[e.IMSINH=593]="IMSINH",e[e.IMCOSH=594]="IMCOSH",e[e.FILTERXML=595]="FILTERXML",e[e.WEBSERVICE=596]="WEBSERVICE",e[e.ENCODEURL=597]="ENCODEURL",e[e.FORECAST_ETS=598]="FORECAST_ETS",e[e.FORECAST_ETS_CONFINT=599]="FORECAST_ETS_CONFINT",e[e.FORECAST_ETS_SEASONALITY=600]="FORECAST_ETS_SEASONALITY",e[e.FORECAST_LINEAR=601]="FORECAST_LINEAR",e[e.FORECAST_ETS_STAT=602]="FORECAST_ETS_STAT",e[e.MAXIFS=603]="MAXIFS",e[e.MINIFS=604]="MINIFS",e[e.TEXTJOIN=605]="TEXTJOIN",e[e.CONCAT=606]="CONCAT",e[e.IFS=607]="IFS",e[e.SWITCH=608]="SWITCH",e[e.SINGLE=609]="SINGLE",e[e.AVERAGE_WEIGHTED=610]="AVERAGE_WEIGHTED",e[e.ANCHORARRAY=611]="ANCHORARRAY",e[e._FV=612]="_FV",e[e.FIELDVALUE=613]="FIELDVALUE",e[e.FILTER=614]="FILTER",e[e.SORT=615]="SORT",e[e.UNIQUE=616]="UNIQUE",e[e.RICHSEARCH=617]="RICHSEARCH",e[e.LARGEPROPERTY=618]="LARGEPROPERTY",e[e.SMALLPROPERTY=619]="SMALLPROPERTY",e[e.AVERAGEPROPERTY=620]="AVERAGEPROPERTY",e[e.FINDN=621]="FINDN",e[e.TEXTSLICE=622]="TEXTSLICE",e[e.TEXTBEFORE=623]="TEXTBEFORE",e[e.TEXTAFTER=624]="TEXTAFTER",e[e.TEXTSPLIT=625]="TEXTSPLIT",e[e._SORT=626]="_SORT",e[e._ONEDARRAY=627]="_ONEDARRAY",e[e.XMATCH=628]="XMATCH",e[e.XLOOKUP=629]="XLOOKUP",e[e.SORTBY=630]="SORTBY",e[e.RANDARRAY=631]="RANDARRAY",e[e.SEQUENCE=632]="SEQUENCE",e[e.STOCKHISTORY=633]="STOCKHISTORY",e[e.SUBARRAY=634]="SUBARRAY",e[e.APPENDROWS=635]="APPENDROWS",e[e.APPENDCOLUMNS=636]="APPENDCOLUMNS",e[e.SELECTROW=637]="SELECTROW",e[e.SELECTCOLUMN=638]="SELECTCOLUMN",e[e.LET=639]="LET",e[e.LAMBDA=640]="LAMBDA",e[e.ARRAYMAKE=641]="ARRAYMAKE",e[e.APPLY=642]="APPLY",e[e.ISLAMBDA=643]="ISLAMBDA",e[e.ARITY=644]="ARITY",e[e.RECURSE=645]="RECURSE",e[e.RECORD=646]="RECORD",e[e.VALUETOTEXT=647]="VALUETOTEXT",e[e.ARRAYTOTEXT=648]="ARRAYTOTEXT",e[e.FORMATTEDNUMBER=649]="FORMATTEDNUMBER",e[e.TESTFUNCTIONBEGIN=650]="TESTFUNCTIONBEGIN",e[e.IMAGE=651]="IMAGE",e[e.GRF=652]="GRF",e[e.UNIT=653]="UNIT",e[e.RICHERROR=654]="RICHERROR",e[e.COUNTER=655]="COUNTER",e[e.BROKENRECORD=656]="BROKENRECORD",e[e.FORMULABYTES=657]="FORMULABYTES",e[e.FORMULACODE=658]="FORMULACODE",e[e.FORMULAHTML=659]="FORMULAHTML",e[e.STREAM=660]="STREAM",e[e.GETRICHERRORS=661]="GETRICHERRORS",e[e.DBGSTAT=662]="DBGSTAT",e[e.RICHNUMBER=663]="RICHNUMBER",e[e.RICHERNUMBER=664]="RICHERNUMBER",e[e.DBGWRITE=665]="DBGWRITE",e[e.LETREC=680]="LETREC",e[e.NESTEDRECORD=681]="NESTEDRECORD"}(la||(la={}));var pa,ma=[[255,"255"],[268,"GET.WORKBOOK"],[349,"OPTIONS.LISTS.GET"],[355,"OPEN.DIALOG"],[356,"SAVE.DIALOG"],[360,"PHONETIC"],[369,"THAIDAYOFWEEK"],[371,"THAIMONTHOFYEAR"],[612,"_FV"],[626,"_SORT"],[627,"_ONEDARRAY"],[637,"SelectRow"],[638,"SelectColumn"],[641,"ARRAY.MAKE"]].reduce((function(e,t){return e[t[0]]=t[1],e}),[]),ga=[],Sa=[[1,ga,[57],ga,1,0,16],[1,[36,831,831],ga,ga,823,0,0],[1,[15],ga,ga,4,0,0],[1,[15],ga,ga,4,0,0],[1,ga,[305],ga,1,0,16],[1,ga,[49],ga,1,0,16],[1,ga,[49],ga,1,0,16],[1,ga,[49],ga,1,0,16],[0,[16],ga,ga,33,0,0],[0,[16],ga,ga,33,0,0],[0,ga,ga,ga,3,0,16],[2,[1],[49],ga,1,0,16],[1,ga,[49],ga,1,0,16],[1,[1,1],ga,ga,2,0,0],[1,[1,65,4],ga,ga,2,0,0],[1,[1],ga,ga,1,0,0],[1,[1],ga,ga,1,0,0],[1,[1],ga,ga,1,0,0],[1,[1],ga,ga,1,0,0],[0,ga,ga,ga,1,0,0],[1,[1],ga,ga,1,0,0],[1,[1],ga,ga,1,0,0],[1,[1],ga,ga,1,0,0],[1,[1],ga,ga,1,0,0],[1,[1],ga,ga,1,0,0],[1,[1],ga,ga,1,0,0],[1,[1],ga,ga,1,0,0],[2,[1,1],ga,ga,1,0,0],[2,[263,48,48],ga,ga,263,0,0],[2,[48,1,1,1],ga,ga,311,0,0],[2,[2,1],ga,ga,2,0,0],[3,[2,1,1],ga,ga,2,0,0],[1,[2],ga,ga,1,0,0],[1,[7],ga,ga,1,0,0],[0,ga,ga,ga,4,0,16],[0,ga,ga,ga,4,0,16],[1,ga,[52],ga,4,0,16],[1,ga,[52],ga,4,0,16],[1,[4],ga,ga,4,0,16],[2,[1,1],ga,ga,1,0,0],[3,[16,83,18],ga,ga,1,0,0],[3,[16,19,18],ga,ga,1,0,0],[3,[16,19,18],ga,ga,1,0,0],[3,[16,19,18],ga,ga,1,0,0],[3,[16,19,18],ga,ga,1,0,0],[3,[16,19,18],ga,ga,1,0,0],[1,ga,[49],ga,1,0,16],[3,[16,19,18],ga,ga,1,0,0],[2,[263,2],ga,ga,2,0,0],[1,[48,112,84,84],ga,ga,32,0,0],[1,[48,112,112,84],ga,ga,32,0,0],[1,[48,112,84,84],ga,ga,32,0,0],[1,[48,112,112,84],ga,ga,32,0,0],[1,[16],ga,ga,512,0,2],[0,[4],ga,ga,512,0,2],[0,[575],ga,ga,512,0,2],[3,[1,1,1,1,1],ga,ga,1,0,0],[3,[1,1,1,1,1],ga,ga,1,0,0],[3,[1,1,1,1,1],ga,ga,1,0,0],[3,[1,1,1,1,1],ga,ga,1,0,0],[3,[1,1,1,1,1,1],ga,ga,1,0,0],[3,[48,1,1],ga,ga,1,0,16],[1,[48,1],ga,ga,1,0,0],[0,ga,ga,ga,1,16383,0],[2,[263,305,17],ga,ga,1,0,0],[3,[1,1,1],ga,ga,1,0,0],[3,[1,1,1],ga,ga,1,0,0],[1,[1],ga,ga,1,0,0],[1,[1],ga,ga,1,0,0],[1,[1],ga,ga,1,0,0],[1,[1,1],ga,ga,1,0,0],[1,[1],ga,ga,1,0,0],[1,[1],ga,ga,1,0,0],[1,[1],ga,ga,1,0,0],[0,ga,ga,ga,1,16383,0],[1,[16],ga,ga,1,0,0],[1,[48],ga,ga,1,0,0],[1,[48],ga,ga,1,0,0],[3,[16,65,65,65,65],ga,ga,16,16383,0],[2,[2,16],ga,ga,16,0,2],[2,[16,16],ga,ga,2,0,2],[0,[66,81,16],ga,ga,4,0,2],[2,[2,2,1],ga,ga,1,0,0],[1,[39],ga,ga,32,0,0],[0,[1,24],ga,ga,4,0,2],[0,ga,ga,ga,4,0,2],[1,[303],ga,ga,1,0,0],[0,[4],ga,ga,4,0,2],[1,[2,63],ga,ga,4,0,2],[0,ga,ga,ga,50,0,2],[1,[16],ga,ga,47,0,2],[0,[65,66],ga,ga,32,0,2],[4,[87,117,117,1,117],ga,ga,4,0,0],[0,[1,66],ga,ga,32,0,2],[0,ga,ga,ga,16,0,2],[0,ga,ga,ga,16,0,2],[0,[1],ga,ga,4,0,2],[2,[1,1],ga,ga,1,0,0],[1,[1],ga,ga,1,0,0],[1,[1],ga,ga,1,0,0],[2,[33],[831],ga,823,0,0],[3,[263,49,49,4],ga,ga,295,0,0],[3,[263,49,49,4],ga,ga,295,0,0],[0,[66,65],ga,ga,32,0,2],[1,[2,65,66,67,65,65,2],ga,ga,575,0,2],[1,[63],ga,ga,4,0,0],[1,[18],ga,ga,2,0,2],[1,[2,4],ga,ga,6,0,2],[2,[16,47],ga,ga,4,0,2],[1,[1,1],ga,ga,1,0,0],[1,[2,1,4,4],ga,ga,7,0,2],[1,[1],ga,ga,2,0,0],[1,[2],ga,ga,2,0,0],[1,[2],ga,ga,2,0,0],[1,[2],ga,ga,2,0,0],[1,[2,9],ga,ga,2,0,0],[1,[2,9],ga,ga,2,0,0],[2,[258,258],ga,ga,4,0,0],[1,[2],ga,ga,2,0,0],[4,[2,1,1,2],ga,ga,2,0,0],[3,[2,2,2,2],ga,ga,2,0,0],[1,[2],ga,ga,1,0,0],[0,[66,65,66],ga,ga,32,0,2],[0,[2],ga,ga,2,0,2],[2,[2,2,1],ga,ga,1,0,0],[1,[2,16],ga,ga,303,16383,0],[1,[15],ga,ga,4,0,0],[1,[143],ga,ga,4,0,0],[1,[143],ga,ga,4,0,0],[1,[143],ga,ga,4,0,0],[1,[23],ga,ga,2,0,0],[1,[23],ga,ga,1,0,0],[1,[2,1],ga,ga,1,0,2],[1,[1],ga,ga,1,0,2],[1,[1],ga,ga,1,0,2],[1,[1],ga,ga,2,0,2],[2,[1,1],ga,ga,2,0,2],[2,[1,2],ga,ga,1,0,2],[2,[1,2],ga,ga,1,0,2],[1,[1,1],ga,ga,1,0,2],[1,[3],ga,ga,1,0,0],[1,[3],ga,ga,1,0,0],[3,[1,1,1],ga,ga,1,0,0],[4,[1,1,1,1],ga,ga,1,0,0],[4,[1,1,1,1,1],ga,ga,1,0,0],[1,[2,66,65],ga,ga,2,0,2],[1,[16,4],ga,ga,2,0,2],[1,[2,4],ga,ga,16,0,2],[1,[2,4],ga,ga,16,16383,0],[1,[2,3,66,66,66,65,67,66,67],[66],ga,3,0,2],[1,[3],[127],ga,575,0,2],[0,[3],ga,ga,1,0,2],[2,[3,115,83,3],ga,ga,1,0,2],[3,[3,83,115,83,3],ga,ga,1,0,2],[4,[3,3,3,4,3],ga,ga,4,0,2],[4,[3,3,3,4,3],ga,ga,4,0,2],[4,[3,3,3,3,3],ga,ga,4,0,2],[0,[3],ga,ga,4,0,2],[2,[3,3,3],ga,ga,4,0,2],[3,[3,3,3,3],ga,ga,4,0,2],[1,[1,67,66],ga,ga,1,0,2],[1,[52],ga,ga,36,0,2],[1,[2],ga,ga,2,0,0],[1,[32],ga,ga,1,0,0],[1,[32],ga,ga,32,0,0],[2,[32,32],ga,ga,32,0,0],[0,[2,2],ga,ga,32,0,2],[4,[1,1,1,1,1,1],ga,ga,1,0,0],[4,[1,1,1,1,1,1],ga,ga,1,0,0],[1,ga,[121],ga,1,0,16],[0,[1,16],ga,ga,4,0,2],[3,[2,1,1,1],ga,ga,512,0,2],[1,[4],ga,ga,512,0,2],[0,ga,ga,ga,512,0,2],[0,ga,ga,ga,512,0,2],[2,[2,2],ga,ga,1,0,2],[2,[1,2],ga,ga,32,0,2],[3,[1,18,18],ga,ga,4,0,2],[2,[1,2],ga,ga,4,0,2],[1,[1],ga,ga,4,0,2],[0,[1],ga,ga,512,0,2],[0,[2],ga,ga,4,0,2],[0,[3,3,3,3],ga,ga,3,0,2],[1,ga,[113],ga,1,0,16],[1,[1],ga,ga,1,0,0],[1,[1,16],ga,ga,47,0,2],[1,[1],ga,ga,47,0,2],[1,[1,2],ga,ga,47,0,2],[1,[1,2],ga,ga,63,0,2],[3,[16,19,18],ga,ga,1,0,0],[1,[143],ga,ga,4,0,0],[0,[82,65,65],ga,ga,2,0,2],[0,[66,82,17,17],ga,ga,1,0,2],[1,ga,[49],ga,1,0,16],[1,ga,[49],ga,1,0,16],[3,[16,19,18],ga,ga,1,0,0],[3,[16,19,18],ga,ga,1,0,0],[1,[1,1],ga,ga,1,0,0],[1,[143],ga,ga,4,0,0],[3,[16,83,18],ga,ga,1,0,0],[1,[3],ga,ga,4,0,2],[1,[3],ga,ga,4,0,2],void 0,void 0,[1,[1,1],ga,ga,2,0,0],[2,[2,2,1],ga,ga,1,0,0],[2,[2,2,1],ga,ga,1,0,0],[4,[2,1,1,2],ga,ga,2,0,0],[1,[2,9],ga,ga,2,0,0],[1,[2,9],ga,ga,2,0,0],[3,[2,1,1],ga,ga,2,0,0],[1,[2],ga,ga,1,0,0],[2,[1,1],ga,ga,1,0,0],[2,[1,1],ga,ga,1,0,0],[1,[2],ga,ga,2,0,0],[1,[2],ga,ga,2,0,0],[2,[1,16,4],ga,ga,1,0,16],void 0,void 0,[2,[1,65,65,68,66],ga,ga,2,0,0],[2,[1,1,4],ga,ga,1,0,0],[0,ga,ga,ga,1,16383,0],[5,[1,1,1,1,1,1,4],ga,ga,1,0,0],[0,ga,ga,ga,512,0,2],[1,[12],ga,ga,512,0,2],[0,ga,ga,ga,512,0,2],[1,[2,82,84],ga,ga,512,0,2],[1,ga,[49],ga,1,0,16],[1,ga,[32],ga,1,0,0],[1,[1],ga,ga,1,0,0],[1,[1],ga,ga,1,0,0],[1,[1],ga,ga,1,0,0],[1,[1],ga,ga,1,0,0],[1,[1],ga,ga,1,0,0],[1,[1],ga,ga,1,0,0],[3,[16,19,18],ga,ga,263,0,0],[2,[1,18,17,17,18,17,17,115,84,21,17],ga,ga,2,0,2],[0,[4],ga,ga,4,0,2],[0,ga,ga,ga,16,0,2],[0,[2,2],ga,ga,4,0,2],[0,[2,2,2],ga,ga,4,0,2],[2,[2,23,23,23,23],ga,ga,2,0,2],[2,[2,1,1,2],ga,ga,1,0,2],[1,[2,66,65,65],ga,ga,1,0,2],[1,[2],ga,ga,3,16383,0],[0,ga,ga,ga,2,0,2],[1,[1,2,1,1,1],ga,ga,47,0,2],[4,[1,1,1,1,1],ga,ga,1,0,0],[0,[4],ga,ga,512,0,2],void 0,void 0,[0,[1],ga,ga,512,0,2],[2,[48,48],ga,ga,32,0,16],[0,[66,96],ga,ga,2,0,2],[1,[2],ga,ga,4,0,2],[1,[17],[127],ga,575,0,0],[1,[3],ga,ga,4,0,2],[1,[2],ga,ga,63,0,2],[1,[1,3],ga,ga,47,0,2],[1,[1,3,1],ga,ga,47,0,2],[1,[2,66,4],ga,ga,4,0,2],[1,[15],ga,ga,1,0,0],[0,[2],ga,ga,4,0,2],[0,[2],ga,ga,4,0,2],[0,[99,66],ga,ga,4,0,2],[3,[3,1,4],ga,ga,4,0,2],[3,[3,1,4],ga,ga,4,0,2],[2,[2,3,66],ga,ga,1,0,2],[1,[1,2],ga,ga,35,0,2],[1,ga,[49],ga,1,0,16],[3,[1,1,1,65,65],ga,ga,1,0,0],[1,[1],ga,ga,1,0,0],[3,[1,1,1,65,65],ga,ga,1,0,0],[4,[1,1,1,4],ga,ga,1,0,0],[2,[1,1],ga,ga,1,0,0],[2,[1,1],ga,ga,1,0,0],[2,[1,1],ga,ga,1,0,0],[3,[1,1,1],ga,ga,1,0,0],[3,[1,1,1],ga,ga,1,0,0],[1,[1],ga,ga,1,0,0],[3,[1,1,4],ga,ga,1,0,0],[3,[1,1,1],ga,ga,1,0,0],[3,[1,1,1],ga,ga,1,0,0],[1,[1],ga,ga,1,0,0],[1,[1],ga,ga,1,0,0],[2,[1,1],ga,ga,1,0,0],[4,[1,1,1,4],ga,ga,1,0,0],[3,[1,1,1],ga,ga,1,0,0],[2,[1,1],ga,ga,1,0,0],[4,[1,1,1,1],ga,ga,1,0,0],[3,[1,1,1],ga,ga,1,0,0],[3,[1,1,1],ga,ga,1,0,0],[3,[1,1,1],ga,ga,1,0,0],[4,[1,1,1,4],ga,ga,1,0,0],[1,[1],ga,ga,1,0,0],[3,[1,1,1],ga,ga,1,0,0],[1,[1],ga,ga,1,0,0],[3,[1,1,1],ga,ga,1,0,0],[1,[1],ga,ga,1,0,0],[2,[1,1],ga,ga,1,0,0],[3,[1,1,4],ga,ga,1,0,0],[3,[1,1,1],ga,ga,1,0,0],[4,[1,1,1,4],ga,ga,1,0,0],[2,[32,32],ga,ga,1,0,0],[2,[32,32],ga,ga,1,0,0],[2,[32,32],ga,ga,1,0,0],[2,[32,32],ga,ga,1,0,0],[2,[32,32],ga,ga,1,0,0],[2,[32,32],ga,ga,1,0,0],[3,[1,32,32],ga,ga,1,0,0],[2,[32,32],ga,ga,1,0,0],[2,[32,32],ga,ga,1,0,0],[2,[32,32],ga,ga,1,0,0],[2,[32,32],ga,ga,1,0,0],[2,[32,32],ga,ga,1,0,0],[2,[32,32],ga,ga,1,0,0],[4,[32,32,1,1],ga,ga,1,0,0],[3,[32,32,1,65],ga,ga,1,0,0],[1,ga,[49],ga,1,0,16],[1,ga,[49],ga,1,0,16],[1,ga,[49],ga,1,0,16],[1,ga,[49],ga,1,0,16],[1,ga,[49],ga,1,0,16],[1,ga,[49],ga,1,0,16],[2,[49,1,1],ga,ga,1,0,16],[2,[49,1],ga,ga,1,0,16],[2,[49,1],ga,ga,1,0,16],[2,[49,1],ga,ga,1,0,16],[2,[49,1],ga,ga,1,0,16],[2,[49,1,65],ga,ga,1,0,16],[1,ga,[32],ga,1,0,16],[2,[49,1],ga,ga,1,0,16],[2,[1,1],ga,ga,1,0,0],void 0,[3,[2,1,1,1],ga,ga,1,0,2],[2,[2,1,1],ga,ga,1,0,2],[1,ga,[2],ga,2,0,0],[2,[1,1],ga,ga,1,0,0],[2,[66,2,66,65,65,65,66,66,66],ga,ga,2,0,2],[1,[1,2],ga,ga,35,0,2],[1,[1,66,2],ga,ga,35,0,2],[1,[1,66,66,2],ga,ga,7,0,2],[1,[1],ga,ga,1,0,0],[1,[1],ga,ga,1,0,0],[2,[1],[16],ga,1,0,0],[2,[16,15,16],ga,ga,1,0,0],[2,[16,15],ga,ga,1,0,0],[1,[16],ga,ga,1,0,0],[1,[1,2],ga,ga,19,0,2],[1,[33],ga,ga,33,0,2],[4,[1,1,1,1],ga,ga,1,0,0],[3,[1,1,2],ga,ga,1,0,0],[1,[1],ga,ga,2,0,0],[2,[1,1],ga,ga,2,0,0],[1,[1,5],ga,ga,2,0,0],[0,[66,66,66,65],ga,ga,6,0,2],[0,[66,66,66,66,65],ga,ga,6,0,2],[1,[1,2],ga,ga,19,0,2],[2,[18,18],[2,79],ga,15,0,0],[1,[2,39],ga,ga,39,0,0],[1,[16],ga,ga,2,0,0],[1,ga,[49],ga,1,0,16],[1,ga,[49],ga,1,0,16],[1,ga,[49],ga,1,0,16],[1,ga,[49],ga,1,0,16],[1,ga,[49],ga,1,0,16],[1,ga,[49],ga,1,0,16],[1,ga,[49],ga,1,0,16],[1,[1],ga,ga,2,0,0],[1,[1],ga,ga,2,0,0],[1,[3],ga,ga,2,0,0],[1,[1],ga,ga,2,0,0],[1,[1],ga,ga,2,0,0],[1,[1],ga,ga,2,0,0],[1,[2],ga,ga,1,0,0],[1,[2],ga,ga,4,0,0],[1,[1],ga,ga,1,0,0],[1,[1],ga,ga,1,0,0],[1,[1],ga,ga,1,0,0],[3,ga,[2],ga,2,0,0],[1,[2],[50],ga,15,0,0],[2,[2,50,2],ga,ga,10,0,0],[3,[2,2,2],ga,ga,15,0,0],[3,[2,2,1,2],ga,ga,10,0,0],[1,[95,95],ga,ga,9,0,0],[1,[95],ga,ga,9,0,0],[1,[95,95],ga,ga,9,0,0],[1,[95,95],ga,ga,9,0,0],[1,[95,95],ga,ga,9,0,0],[1,[95,95],ga,ga,9,0,0],[1,[95,95],ga,ga,9,0,0],[1,[95,95],ga,ga,9,0,0],[1,[95],ga,ga,9,0,0],[1,[95],ga,ga,9,0,0],[1,[95,95],ga,ga,9,0,0],[1,[95,95],ga,ga,9,0,0],[2,[95,95],ga,ga,9,0,0],[2,[95,95],ga,ga,9,0,0],[2,[95,95],ga,ga,9,0,0],[1,[95],ga,ga,9,0,0],[1,[95],ga,ga,9,0,0],[1,[95],ga,ga,9,0,0],[1,[95],ga,ga,9,0,0],[1,[95],ga,ga,9,0,0],[1,[95],ga,ga,9,0,0],[1,[95],ga,ga,9,0,0],[1,[95],ga,ga,9,0,0],[1,[95],ga,ga,9,0,0],[1,[95],ga,ga,9,0,0],[1,[95],ga,ga,9,0,0],[1,[95],ga,ga,9,0,0],[2,[95,95,95],ga,ga,9,0,0],[1,ga,[127],ga,9,0,0],[1,ga,[127],ga,9,0,0],[4,[95,95,95,127],ga,ga,9,0,0],[1,[95],ga,ga,9,0,0],[1,[95],ga,ga,9,0,0],[2,[95,95],ga,ga,9,0,0],[1,[95,95],ga,ga,9,0,0],[1,[95,95],ga,ga,9,0,0],[1,[95],ga,ga,9,0,0],[1,[95],ga,ga,9,0,0],[2,[95,95],ga,ga,9,0,0],[1,[95,95],ga,ga,9,0,0],[1,[95],ga,ga,9,0,0],[2,[95,95],ga,ga,9,0,0],[2,[95,95],ga,ga,9,0,0],[2,[95,95],ga,ga,9,0,0],[2,[95,95],ga,ga,9,0,0],[2,[127,127,95],ga,ga,9,0,0],[3,[95,127,127],ga,ga,9,0,0],[5,[95,95,95,95,95,95],ga,ga,9,0,0],[5,[95,95,95,95,95,95],ga,ga,9,0,0],[4,[95,95,95,95,95],ga,ga,9,0,0],[4,[95,95,95,95,95],ga,ga,9,0,0],[4,[95,95,95,95,95],ga,ga,9,0,0],[4,[95,95,95,95,95],ga,ga,9,0,0],[4,[95,95,95,95,95],ga,ga,9,0,0],[3,[95,95,95],ga,ga,9,0,0],[3,[95,95,95],ga,ga,9,0,0],[3,[95,95,95],ga,ga,9,0,0],[6,[95,95,95,95,95,95,95],ga,ga,9,0,0],[6,[95,95,95,95,95,95,95],ga,ga,9,0,0],[2,[95,95],ga,ga,9,0,0],[2,[95,95],ga,ga,9,0,0],[2,[95,95],ga,ga,9,0,0],[2,[95,95],ga,ga,9,0,0],[6,[95,95,95,95,95,95],ga,ga,9,0,0],[6,[95,95,95,95,95,95],ga,ga,9,0,0],[2,[95,95],ga,ga,9,0,0],[2,[95,95],ga,ga,9,0,0],[2,[95,95,95],ga,ga,9,0,0],[3,[95,95,95,95],ga,ga,9,0,0],[3,[95,95,95,95],ga,ga,9,0,0],[3,[95,95,95,95],ga,ga,9,0,0],[3,[95,95,95,95],ga,ga,9,0,0],[3,[95,95,95,95],ga,ga,9,0,0],[3,[95,95,95,95],ga,ga,9,0,0],[5,[95,95,95,95,95,95],ga,ga,9,0,0],[5,[95,95,95,95,95,95],ga,ga,9,0,0],[7,[95,95,95,95,95,95,95,95],ga,ga,9,0,0],[7,[95,95,95,95,95,95,95,95],ga,ga,9,0,0],[8,[95,95,95,95,95,95,95,95,95],ga,ga,9,0,0],[8,[95,95,95,95,95,95,95,95,95],ga,ga,9,0,0],[2,[95,95],ga,ga,9,16383,0],[1,[95,95],ga,ga,9,0,0],[6,[95,95,95,95,95,95,95],ga,ga,9,0,0],[6,[95,95,95,95,95,95,95],ga,ga,9,0,0],[3,[95,95,95],ga,ga,9,0,0],[6,[95,95,95,95,95,95,95,95],ga,ga,9,0,0],[4,[95,95,95,95,95],ga,ga,9,0,0],[2,[95,95,127],ga,ga,9,0,0],[2,[95,95,127],ga,ga,9,0,0],[1,ga,[127],ga,9,0,0],[1,ga,[127],ga,9,0,0],[1,ga,[127],ga,9,0,0],[2,[95,127],ga,ga,9,0,0],[3,[2,2,1,2],ga,ga,10,0,0],[2,[2,50,2,1,2],ga,ga,10,0,0],[1,[2],ga,ga,9,0,0],[2,[47,575],ga,ga,303,0,0],[2,ga,[16,15],ga,1,0,0],[3,[16],[16,15],ga,1,0,0],[2,[16,15,16],ga,ga,1,0,0],[3,[16],[16,15],ga,1,0,0],[3,[1,1,48,17],[16],ga,1,0,0],[4,[1,1,1,4],ga,ga,1,0,0],[3,[1,1,1],ga,ga,1,0,0],[3,[1,1,1],ga,ga,1,0,0],[3,[1,1,1],ga,ga,1,0,0],[2,[32,32],ga,ga,1,0,0],[2,[32,32],ga,ga,1,0,0],[2,[32,32],ga,ga,1,0,0],[2,[32,32],ga,ga,1,0,0],[3,[1,1,4],ga,ga,1,0,0],[4,[1,1,1,4],ga,ga,1,0,0],[3,[1,1,1],ga,ga,1,0,0],[1,ga,[32],ga,32,0,16],[1,ga,[32],ga,1,0,16],[4,[1,1,1,4],ga,ga,1,0,0],[3,[1,1,1],ga,ga,1,0,0],[2,[49,1],ga,ga,1,0,16],[2,[49,1],ga,ga,1,0,16],[2,[49,1,65],ga,ga,1,0,16],[2,[49,1,65],ga,ga,1,0,16],[3,[1,1,4],ga,ga,1,0,0],[2,[49,1],ga,ga,1,0,16],[2,[49,1],ga,ga,1,0,16],[2,[1,16,4],ga,ga,1,0,16],[2,[1,16,4],ga,ga,1,0,16],[1,ga,[49],ga,1,0,16],[1,ga,[49],ga,1,0,16],[3,[1,1,4],ga,ga,1,0,0],[2,[1,1],ga,ga,1,0,0],[2,[1,1],ga,ga,1,0,0],[2,[1,1],ga,ga,1,0,0],[2,[1,1],ga,ga,1,0,0],[1,ga,[49],ga,1,0,16],[1,ga,[49],ga,1,0,16],[4,[1,1,1,4],ga,ga,1,0,0],[2,[95,95,75,127],ga,ga,9,0,0],[2,[95,95,75,127],ga,ga,9,0,0],[2,[1,1],ga,ga,1,0,0],[1,[1,65],ga,ga,1,0,0],void 0,[4,[1,1,1,4,65,65],ga,ga,1,0,0],[3,[1,1,1,65,65],ga,ga,1,0,0],[3,[1,1,4],ga,ga,1,0,0],[2,[1,1],ga,ga,1,0,0],[2,[1,1],ga,ga,1,0,0],[2,[1,1],ga,ga,1,0,0],[4,[1,1,1,4],ga,ga,1,0,0],[3,[1,1,1],ga,ga,1,0,0],[3,[1,1,1],ga,ga,1,0,0],[3,[1,1,1],ga,ga,1,0,0],[5,[1,1,1,1,4],ga,ga,1,0,0],[4,[1,1,1,4],ga,ga,1,0,0],[3,[1,1,1],ga,ga,1,0,0],[4,[1,1,1,4],ga,ga,1,0,0],[2,[1,4],ga,ga,1,0,0],[1,[1],ga,ga,1,0,0],[4,[32,32,1,1],ga,ga,1,0,0],[2,[49,1,1],ga,ga,1,0,16],[1,[95],ga,ga,9,0,0],[1,[95],ga,ga,9,0,0],[1,[1],ga,ga,1,0,0],[1,[1,65],ga,ga,1,0,0],[1,[1,65],ga,ga,1,0,0],[1,[1],ga,ga,1,0,0],[1,[1],ga,ga,1,0,0],[1,[1],ga,ga,1,0,0],[1,[1],ga,ga,1,0,0],[1,[1],ga,ga,1,0,0],[1,[1],ga,ga,1,0,0],[1,[1],ga,ga,1,0,0],[1,[1],ga,ga,1,0,0],[1,[95],ga,ga,9,0,0],[1,[95],ga,ga,9,0,0],[1,[95],ga,ga,9,0,0],[1,[95],ga,ga,9,0,0],[1,[95],ga,ga,9,0,0],[1,[95],ga,ga,9,0,0],[2,[1,1],ga,ga,1,0,0],[2,[1,1],ga,ga,1,0,0],[2,[1,1],ga,ga,1,0,0],[2,[1,1],ga,ga,1,0,0],[2,[1,1],ga,ga,1,0,0],[2,[1,1],ga,ga,1,0,0],[2,[1,1],ga,ga,1,0,0],[1,ga,[52],ga,4,0,16],[3,[1,1,1],ga,ga,1,0,0],[2,[1,1,65],ga,ga,2,0,0],[2,[2,1],ga,ga,1,0,0],[2,[3,3],ga,ga,1,0,0],[3,[1,1,1,65],ga,ga,1,0,0],[1,[1],ga,ga,1,0,0],[1,ga,[49],ga,1,0,16],[1,[1],ga,ga,1,0,0],[1,[1],ga,ga,1,0,0],[3,[1,1,1],ga,ga,1,0,0],[1,[1],ga,ga,2,0,0],[1,[2],ga,ga,1,0,0],[1,[1],ga,ga,32,0,0],[1,[2],ga,ga,1,0,0],[1,[1],ga,ga,1,0,0],[1,[2,66,66],ga,ga,1,0,0],[0,[50],ga,ga,1,16383,16],[0,[48],ga,ga,1,16383,16],[1,[16],ga,ga,2,16383,0],[1,[16],ga,ga,4,0,0],[2,[47,575],ga,ga,303,0,0],[1,[1,65,65],ga,ga,1,0,0],[1,[1,65,65],ga,ga,1,0,0],[1,[95],ga,ga,9,0,0],[1,[95],ga,ga,9,0,0],[2,[2,2],ga,ga,47,0,0],[1,[2],ga,ga,10,0,0],[1,[2],ga,ga,10,0,0],[3,[1,48,48,65,65,65],ga,ga,1,0,0],[3,[1,48,48,65,65,65,65],ga,ga,1,0,0],[2,[48,48,65,65],ga,ga,1,0,0],[3,[1,32,32],ga,ga,1,0,0],[3,[48,48,1,65,65,65],ga,ga,1,0,0],[3,[16],[16,15],ga,1,0,0],[3,[16],[16,15],ga,1,0,0],[3,[114,68],[114],ga,2,0,16],[1,ga,[114],ga,2,0,16],[2,ga,[44,575],ga,831,0,0],[3,[47],[575,575],[575],831,0,0],[1,[1399],ga,ga,1375,0,21],[2,ga,[113,113],ga,1,0,17],[1,[16],ga,ga,48,0,21],[2,[271,2,4],ga,ga,303,0,21],[2,[271,2],ga,ga,303,0,17],[2,[48,48,111],ga,ga,303,0,1],[1,[160,96,96,4],ga,ga,32,0,1],[1,[160,4,4],ga,ga,32,0,1],[2,[2,256],ga,ga,1,0,8],[3,[2,49,1],ga,ga,1,0,25],[3,[2,49,1],ga,ga,1,0,25],[2,[2],[49],ga,1,0,25],[2,[2,2,65,68,68],ga,ga,1,0,1],[1,[2,65,65],ga,ga,2,0,1],[2,[2,2,65,68],ga,ga,2,0,1],[2,[2,2,65,68],ga,ga,2,0,1],[2,[2,98,98,68],ga,ga,32,0,1],[1,[32,96,96,4],ga,ga,32,0,9],[2,[4,16],ga,ga,32,0,25],[2,[391,48,65,65],ga,ga,1,0,1],[3,[391,48,48,511,65,65],ga,ga,319,0,1],[2,[160],[160,65],ga,32,0,1],[0,[65,65,65,65,68],ga,ga,32,16383,1],[1,[65,65,65,65],ga,ga,32,0,1],[2,[258,1,65,65,65],[65],ga,32,0,17],[1,[48,65,65,65,65],ga,ga,48,0,1],[1,[48],[48],ga,32,0,1],[1,[48],[48],ga,32,0,1],[1,[48,33],[33],ga,32,0,1],[1,[48,33],[33],ga,32,0,1],[3,ga,[319,319],[319],319,0,1],[1,ga,[319],ga,319,0,1],[3,[1,1,319],ga,ga,32,0,1],[1,ga,[319],ga,319,0,1],[1,[319],ga,ga,4,0,1],[1,[319],ga,ga,9,0,1],[0,ga,ga,ga,319,0,1],[3,[15],[2,47],ga,303,0,17],[1,[399,1],ga,ga,2,0,1],[1,[32,1],ga,ga,2,0,1],[2,[15,2],ga,ga,256,0,17],[0,ga,ga,ga,1,0,1],[1,[2],ga,ga,258,0,1],[1,[287,2],ga,ga,288,0,17],[2,[15,2],ga,ga,271,0,17],[1,[1,1],ga,ga,10,0,17],[0,ga,ga,ga,1,0,1],[3,[47],[2,47],ga,47,0,17],[1,[16],ga,ga,2,16383,1],[1,[16],ga,ga,2,16383,1],[1,[16],ga,ga,2,16383,1],[0,[1],ga,ga,1,0,1],[0,[1],ga,ga,32,0,1],[1,[2,1],ga,ga,47,0,1],[1,[1],ga,ga,264,0,17],[1,[1],ga,ga,264,0,17],[2,[2,47],ga,ga,47,0,1],void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,[3,ga,[319,319],[319],319,0,1],[3,[15],[2,303],ga,303,0,17]].map((function(e){return void 0===e?void 0:fr.apply(void 0,e)})),ya=fr(0,[],[Et.All],[],Et.All,Ft.All,Ct.None);!function(e){e[e.Add=1]="Add",e[e.Sub=2]="Sub",e[e.Mul=3]="Mul",e[e.Div=4]="Div",e[e.Pow=5]="Pow",e[e.Percent=6]="Percent",e[e.Neg=7]="Neg",e[e.Pos=8]="Pos",e[e.Concat=9]="Concat",e[e.Eq=10]="Eq",e[e.Ne=11]="Ne",e[e.Lt=12]="Lt",e[e.Le=13]="Le",e[e.Gt=14]="Gt",e[e.Ge=15]="Ge",e[e.Range=16]="Range",e[e.Isect=17]="Isect",e[e.Union=18]="Union",e[e.And=19]="And",e[e.Or=20]="Or",e[e.Xor=21]="Xor",e[e.Min=22]="Min",e[e.Max=23]="Max",e[e.At=24]="At",e[e.Pound=25]="Pound"}(pa||(pa={}));var ba=[void 0,"+","-","*","/","^","%","-","+","&","=","<>","<","<=",">",">=",":",void 0,void 0,"&&","||","^^",void 0,void 0,"@","#"],Ea=bt.Number|bt.String|bt.Boolean|bt.Blank,Fa=bt.Number|bt.String|bt.Boolean|bt.Blank,Ca=fr(2,[bt.Number,bt.Number],[],[],bt.Number,Ft.None,Ct.None),Ra=fr(1,[bt.Number],[],[],bt.Number,Ft.None,Ct.None),ka=fr(1,[Ea],[],[],Ea,Ft.None,Ct.None),Na=fr(2,[bt.String,bt.String],[],[],bt.String,Ft.None,Ct.None),Aa=fr(2,[Fa,Fa],[],[],bt.Boolean,Ft.None,Ct.None),Ta=fr(2,[bt.Range,bt.Range],[],[],bt.Range,Ft.AllCells,Ct.None),Ia=fr(2,[bt.Range,bt.Range],[],[],bt.Range,Ft.None,Ct.None),Oa=fr(2,[bt.Boolean,bt.Boolean],[],[],bt.Boolean,Ft.None,Ct.None),Ma=[];function wa(e){var t=Ma[e];return null!=t?t:ya}function Da(e){var t=Sa[e];return null!=t?t:ya}function _a(e,t){var r=Sa[e];null!=r&&(r.staticPrecs=t)}Ma[pa.Add]=Ca,Ma[pa.Sub]=Ca,Ma[pa.Mul]=Ca,Ma[pa.Div]=Ca,Ma[pa.Pow]=Ca,Ma[pa.Percent]=Ra,Ma[pa.Neg]=Ra,Ma[pa.At]=Sa[la.SINGLE],Ma[pa.Pound]=Sa[la.ANCHORARRAY],Ma[pa.Pos]=ka,Ma[pa.Concat]=Na,Ma[pa.Eq]=Aa,Ma[pa.Ne]=Aa,Ma[pa.Lt]=Aa,Ma[pa.Le]=Aa,Ma[pa.Gt]=Aa,Ma[pa.Ge]=Aa,Ma[pa.Range]=Ta,Ma[pa.Isect]=Ia,Ma[pa.Union]=Ia,Ma[pa.And]=Oa,Ma[pa.Or]=Oa,Ma[pa.Xor]=Oa,Ma[pa.Min]=Ca,Ma[pa.Max]=Ca,_a(la.ROW,Ft.OwnRow),_a(la.COLUMN,Ft.OwnCol),_a(la.SHEET,Ft.OwnDocSheets),_a(la.SHEETS,Ft.OwnDocSheets),_a(la.OFFSET,Ft.AllCells),_a(la.INDIRECT,Ft.AllCells),_a(la.SUMIF,Ft.AllCells),_a(la.AVERAGEIF,Ft.AllCells),_a(la.LOOKUP,Ft.AllCells),_a(la.ADDRESS,Ft.RefStyle),_a(la.FORMULATEXT,Ft.RefStyle),_a(la.NOW,Ft.Time),_a(la.TODAY,Ft.Time),_a(la.RAND,Ft.Calc),_a(la.RANDBETWEEN,Ft.Calc),_a(la.RANDARRAY,Ft.Calc),_a(la.SUBTOTAL,Ft.CellProps),_a(la.CELL,Ft.CellProps|Ft.AllCells),_a(la.INFO,Ft.None);var La,Ua,xa,Ba,Wa;function Pa(e){return 55296==(64512&e)}function Va(e){return 56320==(64512&e)}function Ga(e){return 55296==(63488&e)}function Ha(e,t){if(Pa(e)&&Va(t))return 65536+((1023&e)<<10|1023&t)}function ja(e){if(e<=65535)return String.fromCharCode(e);var t=e-65536;return String.fromCharCode(t>>10|55296,1023&t|56320)}function Ka(e,t,r){for(var n=t,a=0;a<r;a+=1){if(n>=e.length)return;Pa(e.charCodeAt(n))&&n+1<e.length&&Va(e.charCodeAt(n+1))?n+=2:n+=1}return n}function Ya(e,t,r){for(var n=0,a=t;a<r;n+=1){Pa(e.charCodeAt(a))&&a+1<r&&Va(e.charCodeAt(a+1))?a+=2:a+=1}return n}function qa(e,t){var r=e.charCodeAt(t);if(!Ga(r))return r;if(t+1>=e.length)return 65533;var n=Ha(r,e.charCodeAt(t+1));return null!=n?n:65533}function za(e){return e>=65536?2:1}function Ja(e,t){void 0===t&&(t=0);for(var r=[],n=t;n<e.length;){var a=qa(e,n);r.push(a),n+=za(a)}return r}!function(e){e.Paren="Paren",e.Lead="Lead",e.Intern="Intern",e.Trail="Trail"}(La||(La={})),function(e){e.MDY="MDY",e.DMY="DMY",e.YMD="YMD",e.MYD="MYD",e.DYM="DYM",e.YDM="YDM"}(Ua||(Ua={})),function(e){e.ASCII="ASCII",e.ArabicIndic="ArabicIndic",e.ExtendedArabicIndic="ExtendedArabicIndic",e.Devanagari="Devanagari",e.Bengali="Bengali",e.Gurmukhi="Gurmukhi",e.Gujarati="Gujarati",e.Oriya="Oriya",e.Tamil="Tamil",e.Telugu="Telugu",e.Kannada="Kannada",e.Malayalam="Malayalam",e.Thai="Thai",e.Lao="Lao",e.Tibetan="Tibetan",e.Myanmar="Myanmar",e.Ethiopic="Ethiopic",e.Khmer="Khmer",e.Mongolian="Mongolian",e.Unknown="Unknown",e.ChineseTrad1="ChineseTrad1",e.ChineseTrad2="ChineseTrad2",e.ChineseTrad3="ChineseTrad3",e.ChineseSimp1="ChineseSimp1",e.ChineseSimp2="ChineseSimp2",e.ChineseSimp3="ChineseSimp3",e.Japanese1="Japanese1",e.Japanese2="Japanese2",e.Japanese3="Japanese3",e.Korean1="Korean1",e.Korean2="Korean2",e.Korean3="Korean3",e.Korean4="Korean4"}(xa||(xa={})),function(e){e.Gregorian="Gregorian",e.GregorianUS="GregorianUS",e.Japan="Japan",e.Taiwan="Taiwan",e.Korea="Korea",e.Hijri="Hijri",e.Thai="Thai",e.Hebrew="Hebrew"}(Ba||(Ba={})),function(e){e[e.General=0]="General",e[e.NoComFixed0=-1]="NoComFixed0",e[e.NoComFixed=-2]="NoComFixed",e[e.Fixed0=-3]="Fixed0",e[e.Fixed=-4]="Fixed",e[e.Currency=-9]="Currency",e[e.CoCurrency=-10]="CoCurrency",e[e.CurrencyDec=-11]="CurrencyDec",e[e.CoCurrencyDec=-12]="CoCurrencyDec",e[e.Pct0=-13]="Pct0",e[e.Pct=-14]="Pct",e[e.Exp=-15]="Exp",e[e.Fract=-17]="Fract",e[e.FractBond=-18]="FractBond",e[e.MMDDYY=-19]="MMDDYY",e[e.DDMMMYY=-20]="DDMMMYY",e[e.DDMMM=-21]="DDMMM",e[e.MMMYY=-22]="MMMYY",e[e.HHMMAP=-23]="HHMMAP",e[e.HHMMSSAP=-24]="HHMMSSAP",e[e.HHMM=-25]="HHMM",e[e.HHMMSS=-26]="HHMMSS",e[e.MDYHMS=-27]="MDYHMS",e[e.USCoCurrency=-37]="USCoCurrency",e[e.USCoCurrencyDec=-39]="USCoCurrencyDec",e[e.Currency2=-5]="Currency2",e[e.CoCurrency2=-6]="CoCurrency2",e[e.CurrencyDec2=-7]="CurrencyDec2",e[e.CoCurrencyDec2=-8]="CoCurrencyDec2",e[e.Acct=-33]="Acct",e[e.AcctCur=-32]="AcctCur",e[e.AcctDec=-35]="AcctDec",e[e.AcctDecCur=-34]="AcctDecCur",e[e.MMSS=-28]="MMSS",e[e.AbsHMMSS=-31]="AbsHMMSS",e[e.SS0=-29]="SS0",e[e.Eng=-16]="Eng",e[e.Text=-30]="Text"}(Wa||(Wa={}));function Qa(e){return 32===e||10===e}function Xa(e,t,r,n){V("calc.parse.parseUint",t,16);for(var a=0,i=n,o=r.length;i<o;){var u=qa(r,i);if(!e.isNumeral(u))break;var s=e.getOrdinal(u);0===a&&0!==s&&(o=Se(o,i+t)),a=10*a+s,i+=za(u)}return i===o&&i<r.length&&e.isNumeral(qa(r,i))?[0,n]:[a,i]}function Za(e,t,r,n){var a=n,i=Xa(e,5,r,a),o=i[0],u=i[1];if(u===a)return!1;if(o>32767)return!1;if(!((a=u)<r.length&&47===r.charCodeAt(a)))return!1;var s=Xa(e,5,r,a+=1),c=s[0],l=s[1];if(l===a)return!1;if(c>32767)return!1;if(a=l,0===c)return[!1,0,a];var d=t.div(t.fromNumber(o),t.fromNumber(c));return x("calc.lang.tryTokenizeFrac",Kr(d)),[d,c,a]}function $a(e,t,r,n,a,i,o){var u,s,c,l=n,d=0,f="",h=!1,v=!1,p=xa.ASCII;if(F(r,e.decimalSeparator,n)||n<r.length&&e.isNumeral(qa(r,n))){for(var m=function(){if((i||a&&r.indexOf("%",l)>=0)&&(d-=2,void 0!==u)){var n=t.div(u,t.fromNumber(100));x("calc.lang.parseNumberLiteral",Kr(n)),u=n,c=Wa.Pct}if(be(d)>=309)return{value:void 0,i:l,consumedThousands:h,consumedDecimal:v,numShape:p,format:c};var o=t.parse(e,!0,d,f);if(void 0!==u){var s=t.add(o,u);x("calc.lang.parseNumberLiteral",Kr(s)),o=s}return{value:o,i:l,consumedThousands:h,consumedDecimal:v,numShape:p,format:c}};l<r.length;){var g=qa(r,l);if(!e.isNumeral(g))break;if(0!==e.getOrdinal(g))break;(s=e.getNumberShape(g))!==xa.ASCII&&(p=s),l+=za(g)}if(o)if(!1!==(E=Za(e,t,r,l))){var S=E[0],y=E[1],b=E[2];return l=b,!1===S?{value:void 0,i:l,consumedThousands:h,consumedDecimal:v,numShape:p,format:c}:(c=y>=10?Wa.FractBond:Wa.Fract,u=S,m())}for(var E,C=l;l<r.length;){g=qa(r,l);if(e.isNumeral(g))d+=1,(s=e.getNumberShape(g))!==xa.ASCII&&(p=s),l+=za(g);else{if(!(a&&d>0&&F(r,e.thousandsSeparator,l)))break;h=!0,l+=e.thousandsSeparator.length}}if(f+=r.substring(C,l),h){var R=function(e,t,r){for(var n=r,a="",i=0;i<t.length;){var o=qa(t,i);if(e.isNumeral(o)){var u=za(o);a+=t.substring(i,i+u),i+=u,n-=1}else{if(0===n||!e.isThousandsPosition(n))return;i+=e.thousandsSeparator.length}}return a}(e,f,d);if(void 0===R)return;f=R}if(n<l&&l<r.length&&Qa(r.charCodeAt(l)))if(!1!==(E=Za(e,t,r,l+1))){S=E[0],y=E[1],b=E[2];return l=b,!1===S?{value:void 0,i:l,consumedThousands:h,consumedDecimal:v,numShape:p,format:c}:(c=y>=10?Wa.FractBond:Wa.Fract,u=S,m())}var k=!1;if(F(r,e.decimalSeparator,l)&&(k=l===n,v=!0,l+=e.decimalSeparator.length),0===d)for(;l<r.length;){g=qa(r,l);if(!e.isNumeral(g))break;if(0!==e.getOrdinal(g))break;d-=1,(s=e.getNumberShape(g))!==xa.ASCII&&(p=s),l+=za(g)}for(C=l;l<r.length;){g=qa(r,l);if(!e.isNumeral(g))break;(s=e.getNumberShape(g))!==xa.ASCII&&(p=s),l+=za(g)}if(f+=r.substring(C,l),!(k&&l<=n+e.decimalSeparator.length)){var N=function(e,t,r){var n=r;if(n<t.length&&0===e.stringCompareCI("E",t.substring(n,n+1)))n+=1;else{if(!F(t,"**",n))return[0,r];n+=2}var a=!1;if(n<t.length){var i=qa(t,n);((a=45===i)||43===i)&&(n+=za(i))}if(n>=t.length||!e.isNumeral(qa(t,n)))return!1;var o=Xa(e,10,t,n),u=o[0],s=o[1];return s!==n&&(!(u>2147483647)&&[a?-u:u,s])}(e,r,l);if(!1!==N){var A=N[0];b=N[1];d+=A,b!==l&&(c=Wa.Exp),l=b}return!1===N?{value:void 0,i:l,consumedThousands:h,consumedDecimal:v,numShape:p,format:c}:m()}}}var ei=1<<20,ti=ei.toString(10).length,ri=16384,ni=ri.toString(26).length,ai=ri.toString(10).length;function ii(e){return e>=97&&e<=122||e>=65&&e<=90}function oi(e){return 1+(e>=97?e-97:e-65)}function ui(e,t,r){return function(n,a,i,o){var u=function(e,t){return F(e,"$",t)?[st.Abs,t+1]:[st.Rel,t]}(i,o),s=u[0],c=u[1],l=e(n,r,i,c),d=l[0],f=l[1];if(f>c){if(d<1||d>t)return;return[wt(s,(s===st.Rel?d-a:d)-1),!1,f]}return[void 0,!1,o]}}function si(e,t,r){return Ri(e,t,r)-e}function ci(e,t,r,n){return function(a,i,o,u){var s=t?e?"R":a.rowLetter:e?"C":a.columnLetter;if(u>=o.length||0!==a.stringCompareCI(s,o[u]))return[void 0,!1,u];var c=u+s.length,l=Xa(a,n,o,c),d=l[0],f=l[1];if(f>c){if(d<1||d>r)return;return[wt(st.Abs,d-1),!1,f]}if(F(o,a.leftBracket,c)){if(c+=a.leftBracket.length,F(o,a.rightBracket,c))return[wt(st.Rel,si(i,0,r)),!0,c+a.rightBracket.length];var h=1,v=o.charCodeAt(c);43===v?c+=1:45===v&&(h=-1,c+=1);var p=Xa(a,n,o,c),m=p[0],g=p[1];if(g>c&&m<r&&F(o,a.rightBracket,g))return[wt(st.Rel,si(i,m*h,r)),!0,g+a.rightBracket.length]}return[!1,!1,f]}}function li(e,t,r,n,a,i,o){var u=n(e,t,i,o);if(null==u)return[void 0,void 0,o];var s=u[0],c=u[1],l=u[2];if(l>o){var d=a(e,r,i,l);if(null==d)return c?[s,void 0,l]:[void 0,void 0,o];var f=d[0],h=d[2];return h>l?[s,f,h]:[s,void 0,l]}var v=a(e,r,i,o);if(null==v)return[void 0,void 0,o];var p=v[0],m=v[2];return m>o?[void 0,p,m]:[void 0,void 0,o]}var di=ui(Xa,ei,ti),fi=ui((function(e,t,r,n){return function(e,t,r){for(var n=0,a=r,i=Se(t.length,r+e);a<i;a+=1){var o=t.charCodeAt(a);if(!ii(o))break;n=26*n+oi(o)}return a===i&&a<t.length&&ii(t.charCodeAt(a))?[0,r]:[n,a]}(t,r,n)}),ri,ni),hi=ci(!1,!0,ei,ti),vi=ci(!1,!1,ri,ai),pi=ci(!0,!0,ei,ti),mi=ci(!0,!1,ri,ai);function gi(e,t){return"object"!=typeof e&&"object"!=typeof t}function Si(e,t,r,n,a){var i,o=r.col,u=r.row;if(t===it.A1){var s=li(e,o,u,fi,di,n,a),c=s[0],l=s[1],d=s[2];if((null!=l&&null!=c||null!=l&&l.kind===st.Abs||null!=c&&c.kind===st.Abs||(null!=l||null!=c)&&(a-1>=0&&58===n.charCodeAt(a-1)||d<n.length&&58===n.charCodeAt(d)))&&(d>=n.length||!e.isIdentContinue(qa(n,d))))return{refStyle:it.A1,row:l,col:c,i:d}}var f=!1,h=li(e,u,o,hi,vi,n,a),v=h[0],p=h[1],m=h[2];if(null!=v||null!=p||"R"===e.rowLetter&&"C"===e.columnLetter||(f=!0,v=(i=li(e,u,o,pi,mi,n,a))[0],p=i[1],m=i[2]),(null!=v||null!=p)&&(m>=n.length||!gi(v,p)||!e.isIdentContinue(qa(n,m))))return{refStyle:it.R1C1,row:v,col:p,i:m,enLocale:f}}function yi(e,t){var r=li(e,0,0,fi,di,t,0),n=r[0],a=r[1],i=r[2];return void 0!==n&&void 0!==a&&i===t.length?Dn(a.index,n.index):void 0}function bi(e,t){var r=li(e,0,0,fi,di,t,0),n=r[0],a=r[1],i=r[2];if(void 0!==n&&void 0!==a){if(i===t.length)return Dn(a.index,n.index);if(58===t.charCodeAt(i)){var o=li(e,0,0,fi,di,t,i+1),u=o[0],s=o[1],c=o[2];if(void 0!==u&&void 0!==s&&c===t.length){var l=Se(a.index,s.index),d=Se(n.index,u.index);return wn(l,d,ye(a.index,s.index)+1-l,ye(n.index,u.index)+1-d)}}}}var Ei=wt(st.Abs,0),Fi=wt(st.Abs,1048575);function Ci(e){for(var t=e+1,r="";t>0;){var n=(t-1)%26;r=String.fromCharCode(65+n)+r,t=Math.floor((t-n)/26)}return r}function Ri(e,t,r){return e+t&r-1}function ki(e,t){return e===it.R1C1&&t.kind===st.Rel&&0!==t.index}function Ni(e,t,r,n){if(t.kind===st.Abs)return t.index;if(n)return Ri(e,t.index,r);var a=e+t.index;return 0<=a&&a<r?a:void 0}function Ai(e,t,r,n,a,i){var o=Ni(r,n,a,i);if(void 0!==o){if(n.kind===st.Abs)return t+(o+1).toFixed();var u=o-r;return 0===u?t:t+e.leftBracket+u.toFixed()+e.rightBracket}}function Ti(e,t,r,n,a){return t===it.A1?function(e,t,r){var n=Ni(e,t,1<<20,r);if(void 0!==n){var a=(n+1).toFixed();return t.kind===st.Abs?"$"+a:a}}(r,n,a):Ai(e,e.rowLetter,r,n,1<<20,a)}function Ii(e,t,r,n,a){return t===it.A1?function(e,t,r){var n=Ni(e,t,16384,r);if(void 0!==n){var a=Ci(n);return t.kind===st.Abs?"$"+a:a}}(r,n,a):Ai(e,e.columnLetter,r,n,16384,a)}function Oi(e,t,r,n){if(r.kind===st.Abs)return r;var a=Ni(t,r,e,n);if(void 0!==a){var i=a-t;return i===r.index?r:wt(st.Rel,i)}}Oi.bind(void 0,1<<20),Oi.bind(void 0,16384);function Mi(e,t,r,n,a){var i=Ni(e,t,n,a),o=Ni(e,r,n,a);if(void 0!==i&&void 0!==o)return i<=o?[t,r,i,o]:[r,t,o,i]}function wi(e,t,r,n,a,i,o,u,s){var c=Mi(i,o,u,r,s);if(void 0!==c){var l=c[0],d=c[1],f=c[2],h=c[3];if(void 0!==t&&0===f&&h===r-1&&o.kind===u.kind)return t(n,a,s);var v=e(n,a,i,l,s);if(void 0!==v){if(a===it.R1C1&&l.kind===d.kind&&l.index===d.index)return v;var p=e(n,a,i,d,s);if(void 0!==p)return v+":"+p}}}var Di=wi.bind(void 0,Ti,void 0,1<<20),_i=wi.bind(void 0,Ii,(function(e,t,r){return Di(e,t,0,Ei,Fi,r)}),16384);function Li(e,t,r,n,a,i){var o=Mi(r,n,a,t,i);if(void 0!==o){var u=o[0],s=o[1],c=o[2],l=o[3];if(void 0!==e&&0===c&&l===t-1&&n.kind===a.kind)return e;var d=Oi(t,r,u,i),f=Oi(t,r,s,i);if(void 0!==d&&void 0!==f)return[!1,d,f]}}Li.bind(void 0,void 0,1<<20),Li.bind(void 0,[!0,Ei,Fi],16384);function Ui(e,t,r,n,a,i){var o=Ti(e,t,r.row,n,i),u=Ii(e,t,r.col,a,i);if(void 0!==o&&void 0!==u)return t===it.A1?u+o:o+u}function xi(e,t,r,n,a,i,o,u){var s=Mi(r.row,n,i,1<<20,u),c=Mi(r.col,a,o,16384,u);if(void 0!==s&&void 0!==c){var l=s[0],d=s[1],f=s[2],h=s[3],v=c[0],p=c[1],m=c[2],g=c[3];if(0===m&&16383===g&&a.kind===o.kind)return Di(e,t,r.row,l,d,u);if(0===f&&1048575===h&&n.kind===i.kind)return _i(e,t,r.col,v,p,u);var S=Ui(e,t,r,l,v,u),y=Ui(e,t,r,d,p,u);if(void 0!==S&&void 0!==y)return S+":"+y}}function Bi(e,t){return 46===t||e.isIdentContinue(t)}var Wi=/'/g;function Pi(e,t){if(0===t.length)return!1;var r=0,n=qa(t,r);if(!e.isIdentStart(n))return!1;for(var a=0,i=Ja(t,r+=za(n));a<i.length;a++){if(!Bi(e,i[a]))return!1}return!0}var Vi=Dn(0,0);function Gi(e,t,r){if(0===e.stringCompareCI(r,e.trueName))return!0;if(0===e.stringCompareCI(r,e.falseName))return!0;var n=Si(e,t,Vi,r,0);if(void 0!==n)if(n.refStyle===it.A1){var a=n.i;if(a>=r.length&&void 0===e.getWorksheetFuncId(r.substring(0,a)))return!0}else if(!gi(n.row,n.col))return!0;return!Pi(e,r)&&(!function(e,t){var r=0;if(!F(t,e.leftBracket,r))return!1;if((r+=e.leftBracket.length)===t.length)return!1;var n=qa(t,r);if(!Bi(e,n))return!1;for(r+=za(n);;){if(F(t,e.rightBracket,r)){r+=e.rightBracket.length;break}if(r===t.length)return!1;var a=qa(t,r);if(!Bi(e,a))return!1;r+=za(a)}var i=t.indexOf(":",r);return i<0?Pi(e,t.substring(r)):Pi(e,t.substring(r,i))&&Pi(e,t.substring(i+1))}(e,r)&&!function(e,t){var r=e.leftBracket.length,n=e.rightBracket.length;return!(t.length<r+n)&&(t.substring(0,r)===e.leftBracket&&(t.substring(t.length-n)===e.rightBracket&&Pi(e,t.substring(r,t.length-n))))}(e,r))}function Hi(e,t,r){return Gi(e,t,r)?"'"+r.replace(Wi,"''")+"'":r}function ji(e,t,r){var n=1===t.cols&&1===t.rows?Ui(e,it.A1,Dn(0,0),wt(st.Rel,t.row),wt(st.Rel,t.col),!1):xi(e,it.A1,Dn(0,0),wt(st.Rel,t.row),wt(st.Rel,t.col),wt(st.Rel,t.row+t.rows-1),wt(st.Rel,t.col+t.cols-1),!1);return x("calc.lang.formatGridRangeA1",void 0!==n),void 0===r?n:Hi(e,it.A1,r)+"!"+n}var Ki,Yi=r(3),qi={ULS:new s.NulLogger},zi=Object(s.initStopwatchFactory)((function(e){return qi.ULS.traceTag(595948114,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,e)}));function Ji(e,t){return ne(this,void 0,void 0,(function(){var r;return ae(this,(function(n){switch(n.label){case 0:r=zi(e),n.label=1;case 1:return n.trys.push([1,,3,4]),[4,t()];case 2:return[2,n.sent()];case 3:return r.stop(),[7];case 4:return[2]}}))}))}function Qi(e,t){if(1==(1&e.length))throw new Error("Invalid class length");for(var r=0;r<e.length;r+=2)for(var n=e[r],a=e[r+1],i=n;i<a;i+=1)t(i,n,a)}!function(e){e[e.Ordinal=15]="Ordinal",e[e.DigitClass=16]="DigitClass",e[e.IdentStartClass=32]="IdentStartClass",e[e.IdentContinueClass=64]="IdentContinueClass"}(Ki||(Ki={}));var Xi=function(e,t,r){var n;function a(e){n[e]|=Ki.IdentStartClass}function i(e){n[e]|=Ki.IdentContinueClass}function o(e,t){n[e]|=Ki.DigitClass,n[e]|=e-t}return function(u){if(void 0===n){var s=ye(e[e.length-1],ye(t[t.length-1],r[r.length-1]));n=new Uint8Array(s),Qi(e,a),Qi(t,i),Qi(r,o);for(var c=4969;c<4978;c+=1)o(c,4968)}var l=n[u];return void 0!==l?l:0}}([65,91,92,93,95,96,97,123,170,171,181,182,186,187,192,215,216,247,248,706,710,722,736,741,748,749,750,751,880,885,886,888,890,894,895,896,902,903,904,907,908,909,910,930,931,1014,1015,1154,1162,1328,1329,1367,1369,1370,1376,1417,1488,1515,1519,1523,1568,1611,1646,1648,1649,1748,1749,1750,1765,1767,1774,1776,1786,1789,1791,1792,1808,1809,1810,1840,1869,1958,1969,1970,1994,2027,2036,2038,2042,2043,2048,2070,2074,2075,2084,2085,2088,2089,2112,2137,2144,2155,2208,2229,2230,2238,2308,2362,2365,2366,2384,2385,2392,2402,2417,2433,2437,2445,2447,2449,2451,2473,2474,2481,2482,2483,2486,2490,2493,2494,2510,2511,2524,2526,2527,2530,2544,2546,2556,2557,2565,2571,2575,2577,2579,2601,2602,2609,2610,2612,2613,2615,2616,2618,2649,2653,2654,2655,2674,2677,2693,2702,2703,2706,2707,2729,2730,2737,2738,2740,2741,2746,2749,2750,2768,2769,2784,2786,2809,2810,2821,2829,2831,2833,2835,2857,2858,2865,2866,2868,2869,2874,2877,2878,2908,2910,2911,2914,2929,2930,2947,2948,2949,2955,2958,2961,2962,2966,2969,2971,2972,2973,2974,2976,2979,2981,2984,2987,2990,3002,3024,3025,3077,3085,3086,3089,3090,3113,3114,3130,3133,3134,3160,3163,3168,3170,3200,3201,3205,3213,3214,3217,3218,3241,3242,3252,3253,3258,3261,3262,3294,3295,3296,3298,3313,3315,3333,3341,3342,3345,3346,3387,3389,3390,3406,3407,3412,3415,3423,3426,3450,3456,3461,3479,3482,3506,3507,3516,3517,3518,3520,3527,3585,3643,3648,3663,3713,3715,3716,3717,3718,3723,3724,3748,3749,3750,3751,3761,3762,3764,3773,3774,3776,3781,3782,3783,3804,3808,3840,3841,3904,3912,3913,3949,3976,3981,4096,4139,4159,4160,4176,4182,4186,4190,4193,4194,4197,4199,4206,4209,4213,4226,4238,4239,4256,4294,4295,4296,4301,4302,4304,4347,4348,4681,4682,4686,4688,4695,4696,4697,4698,4702,4704,4745,4746,4750,4752,4785,4786,4790,4792,4799,4800,4801,4802,4806,4808,4823,4824,4881,4882,4886,4888,4955,4992,5008,5024,5110,5112,5118,5121,5741,5743,5760,5761,5787,5792,5867,5870,5881,5888,5901,5902,5906,5920,5938,5952,5970,5984,5997,5998,6001,6016,6068,6103,6104,6108,6109,6176,6265,6272,6313,6314,6315,6320,6390,6400,6431,6480,6510,6512,6517,6528,6572,6576,6602,6656,6679,6688,6741,6823,6824,6917,6964,6981,6988,7043,7073,7086,7088,7098,7142,7168,7204,7245,7248,7258,7294,7296,7305,7312,7355,7357,7360,7401,7405,7406,7412,7413,7415,7418,7419,7424,7616,7680,7958,7960,7966,7968,8006,8008,8014,8016,8024,8025,8026,8027,8028,8029,8030,8031,8062,8064,8117,8118,8125,8126,8127,8130,8133,8134,8141,8144,8148,8150,8156,8160,8173,8178,8181,8182,8189,8305,8306,8319,8320,8336,8349,8450,8451,8455,8456,8458,8468,8469,8470,8472,8478,8484,8485,8486,8487,8488,8489,8490,8506,8508,8512,8517,8522,8526,8527,8544,8585,11264,11311,11312,11359,11360,11493,11499,11503,11506,11508,11520,11558,11559,11560,11565,11566,11568,11624,11631,11632,11648,11671,11680,11687,11688,11695,11696,11703,11704,11711,11712,11719,11720,11727,11728,11735,11736,11743,12293,12296,12321,12330,12337,12342,12344,12349,12353,12439,12443,12448,12449,12539,12540,12544,12549,12592,12593,12687,12704,12731,12784,12800,13312,19894,19968,40944,40960,42125,42192,42238,42240,42509,42512,42528,42538,42540,42560,42607,42623,42654,42656,42736,42775,42784,42786,42889,42891,42944,42946,42951,42999,43010,43011,43014,43015,43019,43020,43043,43072,43124,43138,43188,43250,43256,43259,43260,43261,43263,43274,43302,43312,43335,43360,43389,43396,43443,43471,43472,43488,43493,43494,43504,43514,43519,43520,43561,43584,43587,43588,43596,43616,43639,43642,43643,43646,43696,43697,43698,43701,43703,43705,43710,43712,43713,43714,43715,43739,43742,43744,43755,43762,43765,43777,43783,43785,43791,43793,43799,43808,43815,43816,43823,43824,43867,43868,43880,43888,44003,44032,55204,55216,55239,55243,55292,63744,64110,64112,64218,64256,64263,64275,64280,64285,64286,64287,64297,64298,64311,64312,64317,64318,64319,64320,64322,64323,64325,64326,64434,64467,64830,64848,64912,64914,64968,65008,65020,65136,65141,65142,65277,65313,65339,65345,65371,65382,65471,65474,65480,65482,65488,65490,65496,65498,65501],[48,58,63,64,65,91,92,93,95,96,97,123,162,167,168,171,174,177,178,182,183,187,188,191,192,215,216,247,248,888,890,894,895,896,900,907,908,909,910,930,931,1328,1329,1367,1369,1370,1376,1417,1421,1424,1425,1470,1471,1472,1473,1475,1476,1478,1479,1480,1488,1515,1519,1523,1536,1545,1547,1548,1550,1563,1564,1565,1567,1642,1646,1748,1749,1792,1807,1867,1869,1970,1984,2039,2042,2043,2045,2094,2112,2140,2144,2155,2208,2229,2230,2238,2259,2404,2406,2416,2417,2436,2437,2445,2447,2449,2451,2473,2474,2481,2482,2483,2486,2490,2492,2501,2503,2505,2507,2511,2519,2520,2524,2526,2527,2532,2534,2557,2558,2559,2561,2564,2565,2571,2575,2577,2579,2601,2602,2609,2610,2612,2613,2615,2616,2618,2620,2621,2622,2627,2631,2633,2635,2638,2641,2642,2649,2653,2654,2655,2662,2678,2689,2692,2693,2702,2703,2706,2707,2729,2730,2737,2738,2740,2741,2746,2748,2758,2759,2762,2763,2766,2768,2769,2784,2788,2790,2800,2801,2802,2809,2816,2817,2820,2821,2829,2831,2833,2835,2857,2858,2865,2866,2868,2869,2874,2876,2885,2887,2889,2891,2894,2902,2904,2908,2910,2911,2916,2918,2936,2946,2948,2949,2955,2958,2961,2962,2966,2969,2971,2972,2973,2974,2976,2979,2981,2984,2987,2990,3002,3006,3011,3014,3017,3018,3022,3024,3025,3031,3032,3046,3067,3072,3085,3086,3089,3090,3113,3114,3130,3133,3141,3142,3145,3146,3150,3157,3159,3160,3163,3168,3172,3174,3184,3192,3204,3205,3213,3214,3217,3218,3241,3242,3252,3253,3258,3260,3269,3270,3273,3274,3278,3285,3287,3294,3295,3296,3300,3302,3312,3313,3315,3328,3332,3333,3341,3342,3345,3346,3397,3398,3401,3402,3408,3412,3428,3430,3456,3458,3460,3461,3479,3482,3506,3507,3516,3517,3518,3520,3527,3530,3531,3535,3541,3542,3543,3544,3552,3558,3568,3570,3572,3585,3643,3647,3663,3664,3674,3713,3715,3716,3717,3718,3723,3724,3748,3749,3750,3751,3774,3776,3781,3782,3783,3784,3790,3792,3802,3804,3808,3840,3844,3859,3860,3861,3898,3902,3912,3913,3949,3953,3973,3974,3992,3993,4029,4030,4045,4046,4048,4053,4057,4096,4170,4176,4294,4295,4296,4301,4302,4304,4347,4348,4681,4682,4686,4688,4695,4696,4697,4698,4702,4704,4745,4746,4750,4752,4785,4786,4790,4792,4799,4800,4801,4802,4806,4808,4823,4824,4881,4882,4886,4888,4955,4957,4960,4969,4989,4992,5018,5024,5110,5112,5118,5121,5742,5743,5760,5761,5787,5792,5867,5870,5881,5888,5901,5902,5909,5920,5941,5952,5972,5984,5997,5998,6001,6002,6004,6016,6100,6103,6104,6107,6110,6112,6122,6128,6138,6155,6159,6160,6170,6176,6265,6272,6315,6320,6390,6400,6431,6432,6444,6448,6460,6464,6465,6470,6510,6512,6517,6528,6572,6576,6602,6608,6619,6622,6684,6688,6751,6752,6781,6783,6794,6800,6810,6823,6824,6832,6847,6912,6988,6992,7002,7009,7037,7040,7156,7168,7224,7232,7242,7245,7294,7296,7305,7312,7355,7357,7360,7376,7379,7380,7419,7424,7674,7675,7958,7960,7966,7968,8006,8008,8014,8016,8024,8025,8026,8027,8028,8029,8030,8031,8062,8064,8117,8118,8133,8134,8148,8150,8156,8157,8176,8178,8181,8182,8191,8203,8208,8234,8239,8255,8257,8260,8261,8274,8275,8276,8277,8288,8293,8294,8306,8308,8317,8319,8333,8336,8349,8352,8384,8400,8433,8448,8588,8592,9001,9003,9255,9280,9291,9312,10088,10102,10181,10183,10214,10224,10627,10649,10712,10716,10748,10750,11124,11126,11158,11160,11311,11312,11359,11360,11508,11517,11518,11520,11558,11559,11560,11565,11566,11568,11624,11631,11632,11647,11671,11680,11687,11688,11695,11696,11703,11704,11711,11712,11719,11720,11727,11728,11735,11736,11743,11744,11776,11823,11824,11904,11930,11931,12020,12032,12246,12272,12284,12292,12296,12306,12308,12320,12336,12337,12349,12350,12352,12353,12439,12441,12448,12449,12539,12540,12544,12549,12592,12593,12687,12688,12731,12736,12772,12784,12831,12832,19894,19904,40944,40960,42125,42128,42183,42192,42238,42240,42509,42512,42540,42560,42611,42612,42622,42623,42738,42752,42944,42946,42951,42999,43052,43056,43066,43072,43124,43136,43206,43216,43226,43232,43256,43259,43260,43261,43310,43312,43348,43360,43389,43392,43457,43471,43482,43488,43519,43520,43575,43584,43598,43600,43610,43616,43715,43739,43742,43744,43760,43762,43767,43777,43783,43785,43791,43793,43799,43808,43815,43816,43823,43824,43880,43888,44011,44012,44014,44016,44026,44032,55204,55216,55239,55243,55292,63744,64110,64112,64218,64256,64263,64275,64280,64285,64311,64312,64317,64318,64319,64320,64322,64323,64325,64326,64450,64467,64830,64848,64912,64914,64968,65008,65022,65024,65040,65056,65072,65075,65077,65101,65104,65122,65123,65124,65127,65129,65130,65136,65141,65142,65277,65279,65280,65284,65285,65291,65292,65296,65306,65308,65311,65313,65339,65342,65371,65372,65373,65374,65375,65382,65471,65474,65480,65482,65488,65490,65496,65498,65501,65504,65511,65512,65519,65529,65534],[48,58,1632,1642,1776,1786,1984,1994,2406,2416,2534,2544,2662,2672,2790,2800,2918,2928,3046,3056,3174,3184,3302,3312,3430,3440,3558,3568,3664,3674,3792,3802,3872,3882,4160,4170,4240,4250,6112,6122,6160,6170,6470,6480,6608,6618,6784,6794,6800,6810,6992,7002,7088,7098,7232,7242,7248,7258,42528,42538,43216,43226,43264,43274,43472,43482,43504,43514,43600,43610,44016,44026,65296,65306]);function Zi(e,t){return{key:e,value:t}}var $i=function(){function e(e,t,r){this.keyCompare=e,this.keys=t,this.values=r}return e.create=function(t){return new e(t,[],[])},e.prototype.setValue=function(e,t){return this.setValues([[e,t]])},e.prototype.remove=function(e){return void 0===this.getKeyIndex(e)?this:this.filter((function(t){return t!==e}))},e.prototype.getOrSetValue=function(e,t){var r=this.getKeyIndex(e);if(void 0===r){var n=t();return[this.setValue(e,n),n]}return[this,this.values[r]]},e.prototype.filter=function(e){for(var t=[],r=0;r<this.keys.length;r+=1){var n=this.keys[r],a=this.values[r];e(n,a)&&t.push([n,a])}return t.length===this.getCount()?this:this.ofSequence(t)},e.prototype.getCount=function(){return this.keys.length},e.prototype.getValue=function(e){var t=this.getKeyIndex(e);if(void 0!==t)return this.values[t]},e.prototype.getEntry=function(e){var t=this.getKeyIndex(e);if(void 0!==t)return Zi(this.keys[t],this.values[t])},e.prototype.contains=function(e){return void 0!==this.getKeyIndex(e)},e.prototype.forEach=function(e){for(var t=0;t<this.keys.length;t+=1)if(!e(this.keys[t],this.values[t]))return!1;return!0},e.prototype.setValues=function(e){var t=this,r=this.keys.map((function(e,r){return[e,t.values[r],r]})),n=r.length;e.forEach((function(e,t){var a=e[0],i=e[1];return r.push([a,i,t+n])})),r.sort((function(e,r){var n=e[0],a=e[2],i=r[0],o=r[2],u=t.keyCompare(n,i);return 0!==u?u:a-o}));for(var a=[],i=void 0,o=0;o<r.length;o+=1){var u=r[o],s=u[0],c=u[1];void 0===i||0!==this.keyCompare(s,i)?(a.push([s,c]),i=s):a[a.length-1]=[s,c]}return this.ofSequence(a)},e.prototype.getKeyIndex=function(e){for(var t=eo;t>=0&&t<this.keys.length;){var r=this.keyCompare(e,this.keys[t]);if(0===r)return t;r<0?t=to(t):r>0&&(t=ro(t))}},e.prototype.ofSequence=function(t){var r=this,n=t.slice();n.sort((function(e,t){var n=e[0],a=t[0];return r.keyCompare(n,a)}));for(var a=new Array(n.length),i=new Array(n.length),o=function(e){var t=new Array(e);return function e(t,r,n,a){if(t>=r.length)return;var i=function(e){var t=function(e){if(0===e)return 0;var t=e;return t=((t=((t=((t=((t=(t|t>>>1)>>>0)|t>>>2)>>>0)|t>>>4)>>>0)|t>>>8)>>>0)|t>>>16)>>>0,(t+=1)/2}(e);if(t/2-1<=e-t)return t-1;return e-t/2}(a);r[t]=n+i,e(to(t),r,n,i),e(ro(t),r,n+i+1,a-i-1)}(eo,t,0,e),t}(n.length),u=0;u<n.length;u+=1){var s=n[o[u]],c=s[0],l=s[1];a[u]=c,i[u]=l}return new e(this.keyCompare,a,i)},e}(),eo=0;function to(e){return 2*e+1}function ro(e){return 2*e+2}var no,ao=r(1),io=function(e,t,r,n,a){return{bias:e,standardDate:t,standardBias:r,daylightDate:n,daylightBias:a}},oo=io(0,void 0,0,void 0,0),uo=ao.dtr.Rounding,so=ao.dtr.dtr,co=ao.dtr.TimeDivision;!function(e){e[e.Year=0]="Year",e[e.Day=1]="Day",e[e.Instant=2]="Instant"}(no||(no={}));var lo={fromNum:function(e,t,r){return ao.dtr.fromNum(e.mathpack.toNumber(t),r,e.date1904,e.dateCompatibility)},toNum:function(e,t){var r=ao.dtr.toNum(t,e.date1904,e.dateCompatibility);return"number"==typeof r?e.mathpack.fromNumber(r):ta},toNumWithDuration:function(e,t,r,n){var a=ao.dtr.toNumWithDuration(t,e.date1904,e.dateCompatibility,r,n);return"number"==typeof a?e.mathpack.fromNumber(a):ta},daysPerMonth:ao.dtr.daysPerMonth,toDays:function(e,t){return ao.dtr.toDays(t,e.date1904,e.dateCompatibility)},toTime:function(e,t,r,n){return ao.dtr.toTime(e.mathpack.toNumber(t),r,n)},utcToLocal:function(e,t,r){return ao.dtr.utcToLocal(t,r,e.date1904,e.dateCompatibility)}};function fo(e){return{kind:bt.Number,_valueXL:e}}var ho=fo(ao.mathpack.zero()),vo=fo(ao.mathpack.one()),po=fo(ao.mathpack.pi());function mo(e){return 0!=(e.num&ao.mathpack.MathErrorNum.DivBy0)?Xn:ta}function go(e){return function(t){return U("calc.lang."+e+": error "+JSON.stringify(t))}}function So(e,t,r){return function(n){var a=e(n._valueXL);return"number"==typeof a?t(a):r(a)}}function yo(e,t,r){return function(n,a){var i=e(n._valueXL,a._valueXL);return"number"==typeof i?t(i):r(i)}}var bo=yo((function(e,t){return ao.mathpack.equal(t,2)?ao.mathpack.mul(e,e):ao.mathpack.power(e,t)}),fo,mo),Eo=So((function(e){return ao.mathpack.div(e,100)}),fo,go("xlPercent"));var Fo=So(ao.mathpack.ceil,fo,go("xlCeil")),Co=So(ao.mathpack.floor,fo,go("xlFloor")),Ro=So(ao.mathpack.cond,se,go("xlCond, isSupported = "+Object(ao.isSupported)())),ko=yo(ao.mathpack.cond2,se,go("xlCond2"));var No=So(ao.mathpack.sfix,se,go("xlSfix")),Ao=So(ao.mathpack.viewRound,fo,go("xlViewRound"));var To,Io,Oo,Mo,wo,Do,_o={zero:ho,one:vo,pi:po,add:yo(ao.mathpack.add,fo,mo),sub:yo(ao.mathpack.sub,fo,mo),mul:yo(ao.mathpack.mul,fo,mo),div:yo(ao.mathpack.div,fo,mo),power:bo,percent:Eo,neg:function(e){return 0!==Ro(e)?fo(ao.mathpack.neg(e._valueXL)):e},compare:function(e,t){return ao.mathpack.compare(e._valueXL,t._valueXL)},formatGeneral:function(e,t,r){var n=t._valueXL,a=ao.mathpack.formatGeneral(e,n,r);return"string"!=typeof a?U("calc.lang.xlFormatGeneral: error "+JSON.stringify(a)):a},formatFixed:function(e,t,r){var n=e._valueXL,a=ao.mathpack.formatFixed(n,t,r);return"object"!=typeof a?U("calc.lang.xlFormatFixed: error "+JSON.stringify(a)):a},formatScientific:function(e,t,r){var n=e._valueXL,a=ao.mathpack.formatScientific(n,t,r);return"object"!=typeof a?U("calc.lang.xlFormatScientific: error "+JSON.stringify(a)):a},parse:function(e,t,r,n){var a=ao.mathpack.pack(e,t,r,n);return"number"!=typeof a?U("calc.lang.xlParse: error "+JSON.stringify(a)):fo(a)},trunc:function(e){return fo(ao.mathpack.trunc(e._valueXL))},ceil:Fo,floor:Co,abs:function(e){return fo(ao.mathpack.abs(e._valueXL))},cond:Ro,cond2:ko,fromNumber:function(e){return x("calc.lang.xlFromNumber",isFinite(e)),fo(e)},toNumber:function(e){var t=e._valueXL;return x("calc.lang.xlToNumber",isFinite(t)),t},sqrt:So(ao.mathpack.sqrt,fo,mo),exp:So(ao.mathpack.exp,fo,mo),ln:So(ao.mathpack.ln,fo,mo),log:So(ao.mathpack.log,fo,mo),sin:So(ao.mathpack.sin,fo,mo),cos:So(ao.mathpack.cos,fo,mo),tan:So(ao.mathpack.tan,fo,mo),asin:So(ao.mathpack.asin,fo,mo),acos:So(ao.mathpack.acos,fo,mo),atan:So(ao.mathpack.atan,fo,mo),atan2:yo(ao.mathpack.atan2,fo,mo),round:yo(ao.mathpack.round,fo,mo),roundUp:yo(ao.mathpack.roundUp,fo,mo),roundDown:yo(ao.mathpack.roundDown,fo,mo),tenTo:function(e){B("calc.lang.xlTenTo",e);var t=ao.mathpack.tenTo(e);return"number"==typeof t?fo(t):mo(t)},checkAlmostCancellation:function(e,t){var r=e._valueXL,n=t._valueXL;return ao.mathpack.exp32(r)-ao.mathpack.exp32(n)>=52428800?ho:t},fix:function(e){return ao.mathpack.fix(e._valueXL)},lfix:function(e){return ao.mathpack.lfix(e._valueXL)},sfix:No,viewRound:Ao};function Lo(e,t,r,n,a,i,o){return void 0===t&&(t=it.A1),void 0===r&&(r=_o),void 0===n&&(n=!1),void 0===a&&(a=!0),void 0===i&&(i=oo),void 0===o&&(o=lo),{localeInfo:e,refStyle:t,mathpack:r,date1904:n,dateCompatibility:a,timezone:i,datepack:o}}var Uo,xo,Bo,Wo,Po,Vo,Go=!1,Ho=void 0,jo=/^(https)|(http)|(file):\/\//;function Ko(e,t,r){if(Go){_.ULS.traceTag(595910878,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"calc.config.initCalc: Calc is already initialized")}else{var n;if(_.setLogger(e),function(e){qi.ULS=e}(e),"function"==typeof(n=t)&&(j=n),null!=r){if(!jo.test(r)){var a="calc.config.initCalc: calcAbsUrl is not absolute: "+r;_.ULS.traceTag(595910879,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Warning,a)}Yi.setConfig({onWorkerError:function(e){var t={error:A(e),innerError:e.info.error?A(e.info.error):void 0},r="calc.onWorkerError: "+JSON.stringify(t);_.ULS.traceTag(593335298,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Warning,r)},onCreateWorker:function(e){var t="calc.onCreateWorker: "+JSON.stringify(e);_.ULS.traceTag(593335299,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,t)}})}Ho=r,Go=!0;_.ULS.traceTag(594642132,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"calc.config.initCalc: Calc version 23.7.1 (production) initialized")}}function Yo(){return Go}function qo(){return Ho}function zo(e,t,r,n,a,i,o,u,s,c,l,d,f,h,v,p,m,g,S,y,b,E){return Jo(r,n,Qo,Xo,Zo,(function(e){return e>0&&e%3==0}),$o,eu,s,c,ru,l,d,f,h,v,p,m,g,S,y,b,E,",",xo.USA,Uo.USA,!1,!1,!1,!1,!1,!1,!1,2,!1," ",!1,La.Paren,!0,!1,"$",2,Ua.MDY,"/","-",!0,!1,!1,!0,":",void 0,!1,!1,!0,["AM","PM"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"],nu,au,iu,ou)}function Jo(e,t,r,n,a,i,o,u,s,c,l,d,f,h,v,p,m,g,S,y,b,E,F,C,R,k,N,A,T,I,O,M,w,D,_,L,U,x,B,W,P,V,G,H,j,K,Y,q,z,J,Q,X,Z,$,ee,te,re,ne,ae,ie,oe,ue,se){return{getWorksheetFuncId:function(t){return e(t.toLocaleUpperCase())},getWorksheetFuncName:t,isNumeral:r,getOrdinal:n,getNumberShape:a,isThousandsPosition:i,isIdentStart:o,isIdentContinue:u,stringCompareCI:s,errorNames:c,specialRefNames:l,trueName:d,falseName:f,rowLetter:h,columnLetter:v,leftBrace:p,rightBrace:m,leftBracket:g,rightBracket:S,decimalSeparator:y,listSeparator:b,columnSeparator:E,rowSeparator:F,thousandsSeparator:C,lcid:R,country:k,isThai:N,isEastAsia:A,isKorea:T,isJapan:I,isChinaT:O,isChinaS:M,isComplexScript:w,numberDecimals:D,isExpSepBySpace:_,fractionSeparator:L,isPercentSepBySpace:U,currencyFormat:x,isCurrencySymbolLead:B,isCurrencySepBySpace:W,currencySymbol:P,currencyDecimals:V,dateOrder:G,dateSeparator:H,dateAltSeparator:j,year4Digits:K,month2Digits:Y,day2Digits:q,longDateFormat:z,timeSeparator:J,timeAltSeparator:Q,hour2Digits:X,clock24Hour:Z,isAMPMSepBySpace:$,ampmSymbols:ee,dayNameShort:te,dayNameLong:re,monthNameShort:ne,monthNameLong:ae,pictureSpecial:ie,pictureSingle:oe,pictureColor:ue,pictureDbnum:se}}function Qo(e){return 0!=(Xi(e)&Ki.DigitClass)}function Xo(e){var t=Xi(e);return 0==(t&Ki.DigitClass)?U("calc.config.getOrdinal: expected numeral; given "+d(e)):t&Ki.Ordinal}function Zo(e){switch(x("calc.config.getNumberShape",Qo(e)),2147483392&e){case 0:return xa.ASCII;case 1536:return e<1648?xa.ArabicIndic:xa.ExtendedArabicIndic;case 1792:return xa.Unknown;case 2304:return e<2416?xa.Devanagari:xa.Bengali;case 2560:return e<2672?xa.Gurmukhi:xa.Gujarati;case 2816:return e<2928?xa.Oriya:xa.Tamil;case 3072:return e<3184?xa.Telugu:xa.Kannada;case 3328:return e<3440?xa.Malayalam:xa.Unknown;case 3584:return e<3680?xa.Thai:xa.Lao;case 3840:return xa.Tibetan;case 4096:return e<4176?xa.Myanmar:xa.Unknown;case 4864:return xa.Ethiopic;case 5888:return xa.Khmer;case 6144:return xa.Mongolian;default:return xa.Unknown}}function $o(e){return 0!=(Xi(e)&Ki.IdentStartClass)}function eu(e){return 0!=(Xi(e)&Ki.IdentContinueClass)}!function(e){e[e.USA=1]="USA",e[e.UK=44]="UK",e[e.AUS=61]="AUS",e[e.NZ=64]="NZ",e[e.UNK=1]="UNK",e[e.CAN=2]="CAN",e[e.DUT=31]="DUT",e[e.FRN=33]="FRN",e[e.SPA=34]="SPA",e[e.ITN=39]="ITN",e[e.SWE=46]="SWE",e[e.GER=49]="GER",e[e.JPN=81]="JPN",e[e.MEX=52]="MEX",e[e.BRA=55]="BRA",e[e.LAM=3]="LAM",e[e.BEL=32]="BEL",e[e.SWZ=41]="SWZ",e[e.SWG=41]="SWG",e[e.SWF=41]="SWF",e[e.AUT=43]="AUT",e[e.DAN=45]="DAN",e[e.NOR=47]="NOR",e[e.POR=351]="POR",e[e.FIN=358]="FIN",e[e.ICE=354]="ICE",e[e.GRK=30]="GRK",e[e.TUR=90]="TUR",e[e.CZE=420]="CZE",e[e.HUN=36]="HUN",e[e.POL=48]="POL",e[e.RUS=7]="RUS",e[e.HEB=972]="HEB",e[e.ARB=966]="ARB",e[e.PER=981]="PER",e[e.ARB_Algeria=213]="ARB_Algeria",e[e.ARB_Bahrain=966]="ARB_Bahrain",e[e.ARB_Djibouti=253]="ARB_Djibouti",e[e.ARB_Egypt=20]="ARB_Egypt",e[e.ARB_Iraq=964]="ARB_Iraq",e[e.ARB_Jordan=962]="ARB_Jordan",e[e.ARB_Kuwait=965]="ARB_Kuwait",e[e.ARB_Lebanon=961]="ARB_Lebanon",e[e.ARB_Libya=218]="ARB_Libya",e[e.ARB_Mauritania=222]="ARB_Mauritania",e[e.ARB_Morocco=216]="ARB_Morocco",e[e.ARB_Oman=968]="ARB_Oman",e[e.ARB_Qatar=974]="ARB_Qatar",e[e.ARB_SaudiArabia=966]="ARB_SaudiArabia",e[e.ARB_Somalia=1]="ARB_Somalia",e[e.ARB_Sudan=249]="ARB_Sudan",e[e.ARB_Syria=963]="ARB_Syria",e[e.ARB_Tunisia=216]="ARB_Tunisia",e[e.ARB_UAE=971]="ARB_UAE",e[e.ARB_Yemen=969]="ARB_Yemen",e[e.KOR=82]="KOR",e[e.TW=886]="TW",e[e.PRC=86]="PRC",e[e.THA=66]="THA",e[e.VIET=84]="VIET"}(Uo||(Uo={})),function(e){e[e.None=0]="None",e[e.USA=1033]="USA",e[e.Greek=1032]="Greek",e[e.Hungarian=1038]="Hungarian",e[e.Turkish=1055]="Turkish",e[e.Thailand=1054]="Thailand",e[e.Vietnam=1066]="Vietnam",e[e.Arabic=1025]="Arabic",e[e.Hebrew=1037]="Hebrew",e[e.Tamil=1097]="Tamil",e[e.Syriac=1114]="Syriac",e[e.Iraq=2049]="Iraq",e[e.Algerian=5121]="Algerian",e[e.Basque=1069]="Basque",e[e.PortBrazil=1046]="PortBrazil",e[e.Croatian=1050]="Croatian",e[e.Czech=1029]="Czech",e[e.Danish=1030]="Danish",e[e.Dutch=1043]="Dutch",e[e.Australian=3081]="Australian",e[e.CanadianEnglish=4105]="CanadianEnglish",e[e.British=2057]="British",e[e.Finnish=1035]="Finnish",e[e.French=1036]="French",e[e.FrenchCanadian=3084]="FrenchCanadian",e[e.Italian=1040]="Italian",e[e.NorskBokmal=1044]="NorskBokmal",e[e.NorskNynorsk=2068]="NorskNynorsk",e[e.Polish=1045]="Polish",e[e.PortIberian=2070]="PortIberian",e[e.Romanian=1048]="Romanian",e[e.Russian=1049]="Russian",e[e.Ukrainian=1058]="Ukrainian",e[e.Belarusian=1059]="Belarusian",e[e.SerbianCyrillic=3098]="SerbianCyrillic",e[e.SerbianLatin=2074]="SerbianLatin",e[e.Slovak=1051]="Slovak",e[e.Slovenian=1060]="Slovenian",e[e.SpanishModern=3082]="SpanishModern",e[e.Swedish=1053]="Swedish",e[e.HongKong=3076]="HongKong",e[e.ChinaT=1028]="ChinaT",e[e.Korea=1042]="Korea",e[e.Japan=1041]="Japan",e[e.China=2052]="China",e[e.ChinaStroke=133124]="ChinaStroke",e[e.Devihi=1125]="Devihi",e[e.Hindi=1081]="Hindi",e[e.German=1031]="German",e[e.Swiss=4108]="Swiss",e[e.SystemTime=62464]="SystemTime",e[e.SystemLongDate=63488]="SystemLongDate",e[e.EuroTrailing=1]="EuroTrailing",e[e.EuroLeading=2]="EuroLeading",e[e.LANG=1023]="LANG",e[e.COUNTRY=64512]="COUNTRY",e[e.OPTIONS=16711680]="OPTIONS"}(xo||(xo={})),function(e){e[e.AP1=0]="AP1",e[e.AP2=1]="AP2",e[e.AP3=2]="AP3",e[e.GeneralOldMAC=3]="GeneralOldMAC",e[e.General=4]="General",e[e.Currency=5]="Currency"}(Bo||(Bo={})),function(e){e[e.Sep=1]="Sep",e[e.Hash=2]="Hash",e[e.Zero=3]="Zero",e[e.Decimal=4]="Decimal",e[e.Percent=5]="Percent",e[e.Comma=6]="Comma",e[e.Colon=7]="Colon",e[e.DateSep=8]="DateSep",e[e.Slash=9]="Slash",e[e.Space=10]="Space",e[e.Minus=11]="Minus",e[e.Plus=12]="Plus",e[e.OpenParen=13]="OpenParen",e[e.CloseParen=14]="CloseParen",e[e.Extra=15]="Extra",e[e.Backslash=16]="Backslash",e[e.Star=17]="Star",e[e.Year=18]="Year",e[e.Month=19]="Month",e[e.Day=20]="Day",e[e.Hour=21]="Hour",e[e.Minute=22]="Minute",e[e.Second=23]="Second",e[e.E=24]="E",e[e.APDelim=25]="APDelim",e[e.Quote=26]="Quote",e[e.ColorStart=27]="ColorStart",e[e.ColorEnd=28]="ColorEnd",e[e.Text=29]="Text",e[e.Question=30]="Question",e[e.Underscore=31]="Underscore",e[e.Reign=32]="Reign",e[e.LocDay=33]="LocDay",e[e.Era=34]="Era",e[e.EraYear=35]="EraYear",e[e.Nen1=36]="Nen1",e[e.Gatsu1=37]="Gatsu1",e[e.Nichi1=38]="Nichi1",e[e.Nen2=39]="Nen2",e[e.Gatsu2=40]="Gatsu2",e[e.Nichi2=41]="Nichi2",e[e.BidiDate=42]="BidiDate",e[e.BidiNum=43]="BidiNum",e[e.DayTh=44]="DayTh",e[e.MonthTh=45]="MonthTh",e[e.YearTh=46]="YearTh",e[e.EngYearTh=47]="EngYearTh",e[e.ThYear=48]="ThYear",e[e.HourTh=49]="HourTh",e[e.MinuteTh=50]="MinuteTh",e[e.SecondTh=51]="SecondTh",e[e.ZeroTh=52]="ZeroTh"}(Wo||(Wo={})),function(e){e[e.Black=0]="Black",e[e.White=1]="White",e[e.Red=2]="Red",e[e.Green=3]="Green",e[e.Blue=4]="Blue",e[e.Yellow=5]="Yellow",e[e.Magenta=6]="Magenta",e[e.Cyan=7]="Cyan",e[e.Color=8]="Color"}(Po||(Po={})),function(e){e[e.DBNUM1=0]="DBNUM1",e[e.DBNUM2=1]="DBNUM2",e[e.DBNUM3=2]="DBNUM3",e[e.DBNUM4=3]="DBNUM4"}(Vo||(Vo={}));var tu=N(((To={})[Kn.NULL]="#NULL!",To[Kn.DIV0]="#DIV/0!",To[Kn.VALUE]="#VALUE!",To[Kn.REF]="#REF!",To[Kn.NAME]="#NAME?",To[Kn.NUM]="#NUM!",To[Kn.NA]="#N/A",To[Kn.GETTING_DATA]="#GETTING_DATA",To[Kn.FIELD]="#FIELD!",To)),ru=N(((Io={})[gt.All]="#All",Io[gt.Data]="#Data",Io[gt.Headers]="#Headers",Io[gt.Totals]="#Totals",Io[gt.ThisRow]="#This Row",Io)),nu=N(((Oo={})[Bo.AP1]="AM/PM",Oo[Bo.AP2]="A/P",Oo[Bo.AP3]="/",Oo[Bo.General]="General",Oo[Bo.Currency]="$",Oo)),au=N(((Mo={})[Wo.Sep]=";",Mo[Wo.Hash]="#",Mo[Wo.Zero]="0",Mo[Wo.Decimal]=".",Mo[Wo.Percent]="%",Mo[Wo.Comma]=",",Mo[Wo.Colon]=":",Mo[Wo.DateSep]="/",Mo[Wo.Slash]="/",Mo[Wo.Space]=" ",Mo[Wo.Minus]="-",Mo[Wo.Plus]="+",Mo[Wo.OpenParen]="(",Mo[Wo.CloseParen]=")",Mo[Wo.Backslash]="\\",Mo[Wo.Star]="*",Mo[Wo.Year]="y",Mo[Wo.Month]="m",Mo[Wo.Day]="d",Mo[Wo.Hour]="h",Mo[Wo.Minute]="m",Mo[Wo.Second]="s",Mo[Wo.E]="E",Mo[Wo.APDelim]="/",Mo[Wo.Quote]='"',Mo[Wo.ColorStart]="[",Mo[Wo.ColorEnd]="]",Mo[Wo.Text]="@",Mo[Wo.Question]="?",Mo[Wo.Underscore]="_",Mo[Wo.Reign]="r",Mo[Wo.LocDay]="a",Mo[Wo.Era]="g",Mo[Wo.EraYear]="e",Mo[Wo.BidiDate]="B",Mo[Wo.BidiNum]="N",Mo[Wo.DayTh]="",Mo[Wo.MonthTh]="",Mo[Wo.YearTh]="",Mo[Wo.EngYearTh]="b",Mo[Wo.ThYear]="",Mo[Wo.HourTh]="",Mo[Wo.MinuteTh]="",Mo[Wo.SecondTh]="",Mo[Wo.ZeroTh]="",Mo)),iu=N(((wo={})[Po.Black]="Black",wo[Po.White]="White",wo[Po.Red]="Red",wo[Po.Green]="Green",wo[Po.Blue]="Blue",wo[Po.Yellow]="Yellow",wo[Po.Magenta]="Magenta",wo[Po.Cyan]="Cyan",wo[Po.Color]="Color",wo)),ou=N(((Do={})[Vo.DBNUM1]="DBNum1",Do[Vo.DBNUM2]="DBNum2",Do[Vo.DBNUM3]="DBNum3",Do[Vo.DBNUM4]="DBNum4",Do)),uu=void 0;function su(e){var t=fu()[e];return void 0===t?"wsf:"+e:t}function cu(e){if(e===pa.Isect)return" ";if(e===pa.Union)return",";var t=ba[e];return void 0===t?"op:"+e:t}function lu(e,t,r){return t===pa.Isect?r:t===pa.Union?e.listSeparator:ba[t]}var du=/_/g;function fu(){if(null==uu){uu=[];for(var e=0,t=de(la);e<t.length;e++){var r=t[e],n=ma[r],a=null!=n?n:la[r].replace(du,".");uu[r]=a}}return uu}function hu(e,t){var r=function(e,t){var r=[];return t.forEach((function(e,t){null!=e&&r.push([e,t])})),$i.create(e).setValues(r)}(e,t);return{getWorksheetFuncId:function(e){return r.getValue(e)},getWorksheetFuncName:function(e){var r=t[e];return null==r?U("calc.config.getWorksheetFuncName: unknown function ID "+e):r}}}var vu,pu,mu=void 0;function gu(){var e,t,r,n,a;return null==mu&&(e=fu(),t=Ee("en-US"),r=hu(t,e),n=r.getWorksheetFuncId,a=r.getWorksheetFuncName,mu=Jo(n,a,Qo,Xo,Zo,(function(e){return e>0&&e%3==0}),$o,eu,t,tu,ru,"TRUE","FALSE","R","C","{","}","[","]",".",",",",",";",",",xo.USA,Uo.USA,!1,!1,!1,!1,!1,!1,!1,2,!1," ",!1,La.Paren,!0,!1,"$",2,Ua.MDY,"/","-",!0,!1,!1,!0,":",void 0,!1,!1,!0,["AM","PM"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"],nu,au,iu,ou)),mu}function Su(e){return{kind:vu.NoOriginSheet,origin:e}}function yu(e){return{kind:vu.InvalidStructRef,reason:e}}!function(e){e.NoOriginSheet="NoOriginSheet",e.InvalidStructRef="InvalidStructRef",e.EmptyIntersection="EmptyIntersection"}(vu||(vu={})),function(e){e.UndefinedColumnName="UndefinedColumnName",e.UndefinedTableName="UndefinedTableName",e.InvalidOriginSheet="InvalidOriginSheet",e.InvalidISectOp="InvalidISectOp",e.MissingTableName="MissingTableName",e.NamedObjectNotTable="NamedObjectNotTable"}(pu||(pu={}));var bu,Eu={kind:vu.EmptyIntersection};function Fu(e,t){return e?t?yr(e,t):e:t}function Cu(e){return X(e)&&me(e.value)?J:e}function Ru(e){return!X(e)||void 0===e.value}!function(e){e.ResolvedName="ResolvedName",e.ResolvedCellRef="ResolvedCellRef",e.ResolvedUserDefinedFunc="ResolvedUserDefinedFunc",e.ResolvedLocalName="ResolvedLocalName",e.ResolvedStructRef="ResolvedStructRef",e.ResolvedNever="ResolvedNever",e.ResolvedDottedName="ResolvedDottedName"}(bu||(bu={}));var ku=function(e,t){return{kind:bu.ResolvedName,node:e,resolution:t}},Nu=function(e,t){return{kind:bu.ResolvedCellRef,node:e,resolution:t}},Au=function(e,t,r){return{kind:bu.ResolvedUserDefinedFunc,node:e,resolution:t,name:r}},Tu=function(e,t){return{kind:bu.ResolvedLocalName,node:e,resolution:t}},Iu=function(e,t){return{kind:bu.ResolvedStructRef,node:e,resolution:t}},Ou=function(e){return{kind:bu.ResolvedNever,node:e,resolution:J}},Mu=function(e,t){return{kind:bu.ResolvedDottedName,resolved:e,fields:t}};function wu(e,t,r){var n=Ni(e.row,t.row,1<<20,r),a=Ni(e.col,t.col,16384,r);return void 0!==n&&void 0!==a?Dn(n,a):void 0}function Du(e,t){if(t.kind===ut.Error)return J;var r=e.originGridCell;if(!X(r))return r;var n=r.value,a=e.wrapCellReferences;switch(t.kind){case ut.Single:return q(wu(n,t,a));case ut.Range:var i=wu(n,t.ref1,a),o=wu(n,t.ref2,a);return void 0!==i&&void 0!==o?q(Dr(i,o)):J;case ut.Row:var u=Ni(n.row,t.row1,1<<20,a),s=Ni(n.row,t.row2,1<<20,a);return void 0!==u&&void 0!==s?q(Dr(Dn(u,0),Dn(s,16383))):J;case ut.Col:var c=Ni(n.col,t.col1,16384,a),l=Ni(n.col,t.col2,16384,a);return void 0!==c&&void 0!==l?q(Dr(Dn(0,c),Dn(1048575,l))):J;default:return L("calc.runtime.resolverService.resolveGridRef",t)}}function _u(e){function t(t,r){if(void 0===r){var n=t.originSheet;return X(n)?[r,q(n.value.document)]:[r,n]}var a=e.getDocumentLoc(r.path,r.document);if(!X(a))return[r,a];var i=null==r.path?void 0:me(a.value)?r.path:a.value.path;return[Tt(me(a.value)?r.document:a.value.name,i,r.isQuoted,r.label),pe(a.value)?q(a.value):J]}function r(t,r){if(Ru(r))return[t,r];var n=Cu(e.getSheetIndex(r.value,t));if(Ru(n))return[t,n];var a=e.getSheetName(r.value,n.value);return X(a)?[a.value,q(Tn(r.value,n.value))]:[t,a]}function n(e,n){var a=t(e,n.document),i=a[0],o=a[1],u=r(n.sheet,o),s=u[0],c=u[1];return[It(s,i,n.isQuoted,n.label),c]}function a(a,i){switch(i.kind){case ot.Error:return[i,J];case ot.Sheet:return n(a,i);case ot.SheetRange:return function(n,a){var i,o=t(n,a.document),u=o[0],s=o[1],c=r(a.sheet1,s),l=c[0],d=c[1],f=r(a.sheet2,s),h=f[0],v=f[1],p=l,m=h;if(Ru(s))i=s;else if(Ru(d))i=d;else if(Ru(v))i=v;else{if(Nr(d.value,v.value))return[It(p,u,a.isQuoted,a.label),q(Tn(s.value,d.value.index))];var g=e.getSheetRangeIndexes(d.value),S=e.getSheetRangeIndexes(v.value);X(g)?X(S)?S.value.position<g.value.position&&(p=h,m=l):i=S:i=g,i=q(An(s.value,d.value.index,v.value.index))}return[Mt(p,m,u,a.isQuoted,a.label),i]}(a,i);default:return L("calc.runtime.resolverService.resolveCellRefQualifier",i)}}function i(e,t){var r,n,i,o,u=t.qualifier,s=t.ref,c=Du(e,s);if(void 0===u||u.kind===ot.Relative){n=u;var l=e.originSheet;if(X(l)){var d=l.value;i=void 0===d.index?Q(Su(d)):q(d)}else i=l}else n=(r=a(e,u))[0],i=r[1];return o=Ru(c)?c:Ru(i)?i:q(xn(i.value,c.value)),Nu(tr(s,n,t.label),o)}function o(r,a,i){var o,u,s,c=a.qualifier,l=a.parts;if(void 0===c||c.kind===ot.Relative){var d=r.originSheet;if(!X(d))return ku(a,d);var f=d.value;if(void 0===f.index)return ku(a,Q(Su(f)));var h=Cu(e.getNameLoc(f,l.asWhole,i));if(!X(h))return ku(a,h);if(h.value)return ku(Jt(Qt(h.value.name,l.canDenoteNamedObject,l.label),c,a.label),h);u=c,s=q(Vn(f.document))}else u=(o=function(e,r){switch(r.kind){case ot.Document:var a=t(e,r);return[c=a[0],Ru(l=a[1])?l:q(Vn(l.value))];case ot.Sheet:return n(e,r);case ot.Ident:var i=n(e,It(r.name,void 0)),o=i[0],u=i[1];if(!X(u))return[r,u];if(u.value)return[Ot(o.sheet,r.isQuoted,r.label),u];var s=t(e,Tt(r.name)),c=s[0],l=s[1];return[Ot(c.document,r.isQuoted,r.label),Ru(l)?l:q(Vn(l.value))];default:return L("calc.runtime.resolverService.resolveNameQualifier",r)}}(r,c))[0],s=o[1];var v,p=l;return Ru(s)?v=s:Ru(v=Cu(e.getNameLoc(s.value,l.asWhole,i)))||(p=Qt(v.value.name,l.canDenoteNamedObject,l.label)),ku(Jt(p,u,a.label),v)}function u(t,r,n){void 0===n&&(n=!1);var a=e.getStructRefColumn(t,r.name);if(!X(a))return{innerRef:r,resolution:a};var i=a.value;if(me(i))return{innerRef:r,resolution:Q(yu(pu.UndefinedColumnName))};var o=i.range.range;return n&&(o=wn(o.row-(i.hasHeadersRow?1:0),o.col,o.rows+(i.hasHeadersRow?1:0)+(i.hasTotalsRow?1:0),o.cols)),{innerRef:or(i.name,r.isBracketed,r.isClosed,r.label),resolution:q(Bn(i.range.sheet,o))}}function s(t,r,n){if(n===gt.ThisRow){if(!X(t.originGridCell))return t.originGridCell;var a=s(t,r,gt.Data);if(Ru(a))return a;var i=a.value.range,o=t.originGridCell.value.row;return o<i.row||o>=i.row+i.rows?Q(Eu):q(Bn(a.value.sheet,wn(o,i.col,1,i.cols)))}return Cu(e.getStructRefSpecialRef(r,n))}function c(e,t,r){void 0===r&&(r=!1);var n=u(e,t.lhs,r),a=n.innerRef,i=n.resolution,o=u(e,t.rhs,r),s=o.innerRef,c=o.resolution;return X(i)||i.reason.kind===vu.InvalidStructRef?X(c)||c.reason.kind===vu.InvalidStructRef?X(i)?X(c)?{innerRef:ur(a,s,t.label),resolution:q(Bn(i.value.sheet,yr(i.value.range,c.value.range)))}:{innerRef:t,resolution:c}:{innerRef:t,resolution:i}:{innerRef:t,resolution:c}:{innerRef:t,resolution:i}}function l(e,t,r){switch(r.kind){case St.ColumnRef:return u(t,r,!0);case St.SpecialRef:return{innerRef:r,resolution:s(e,t,r.id)};case St.RangeOpRef:return c(t,r,!0)}}function d(e,t,r){switch(r.innerRef.kind){case St.ColumnRef:var n=u(t,r.innerRef),a=n.innerRef;return{structRef:Ru(o=n.resolution)?r:lr(a,r.isClosed,r.label),resolution:o};case St.RangeOpRef:var i=c(t,r.innerRef);a=i.innerRef;return{structRef:Ru(o=i.resolution)?r:lr(a,r.isClosed,r.label),resolution:o};case St.SpecialRef:return{structRef:r,resolution:o=s(e,t,r.innerRef.id)};case St.IsectOpRef:var o,d=function(e,t,r){var n,a,i,o,u,s=l(e,t,r.lhs),c=s.innerRef,d=s.resolution,f=l(e,t,r.rhs),h=f.innerRef,v=f.resolution;if(!X(d)&&d.reason.kind!==vu.InvalidStructRef)return{isectOpRef:r,resolution:d};if(!X(v)&&v.reason.kind!==vu.InvalidStructRef)return{isectOpRef:r,resolution:v};if(!X(d))return{isectOpRef:r,resolution:d};if(!X(v))return{isectOpRef:r,resolution:v};if(c.kind===St.SpecialRef&&h.kind===St.SpecialRef){if(Sn(c,h)){var p=Fu(null===(n=d.value)||void 0===n?void 0:n.range,null===(a=v.value)||void 0===a?void 0:a.range),m=null!==(o=null===(i=d.value)||void 0===i?void 0:i.sheet)&&void 0!==o?o:null===(u=v.value)||void 0===u?void 0:u.sheet;return{isectOpRef:r,resolution:me(p)||me(m)?J:q(Bn(m,p))}}return{isectOpRef:r,resolution:Q(yu(pu.InvalidISectOp))}}if(me(d.value)||me(v.value))return{isectOpRef:r,resolution:J};var g=Er(d.value.range,v.value.range);return g?{isectOpRef:sr(c,h,r.label),resolution:q(Bn(d.value.sheet,g))}:{isectOpRef:r,resolution:Q(yu(pu.InvalidISectOp))}}(e,t,r.innerRef);a=d.isectOpRef;return{structRef:Ru(o=d.resolution)?r:lr(a,r.isClosed,r.label),resolution:o};case St.ThisRowOpRef:var f=s(e,t,gt.ThisRow);if(Ru(f)||void 0===r.innerRef.ref)return{structRef:r,resolution:f};var h=r.innerRef.ref.kind===St.ColumnRef?u(t,r.innerRef.ref):c(t,r.innerRef.ref),v=(a=h.innerRef,h.resolution);if(Ru(v))return{structRef:r,resolution:v};var p=Er(f.value.range,v.value.range);return p?{structRef:lr(cr(a,a.label),r.isClosed,r.label),resolution:q(Bn(f.value.sheet,p))}:{structRef:r,resolution:Q(yu(pu.InvalidISectOp))}}}function f(r,n){var a,i,o,u,s,c,l=n.qualifier,d=n.parts,f=null!==(o=null===(i=r.config)||void 0===i?void 0:i.localeInfo)&&void 0!==o?o:e.config.localeInfo;if(void 0===l){var h=r.originSheet;if(!X(h))return Au(n,h,d.asWhole);u=l,s=q(h.value.document)}else u=(a=function(e,r){switch(r.kind){case ot.Document:return t(e,r);case ot.Ident:var n=t(e,Tt(r.name)),a=n[0],i=n[1];return[Ot(a.document,r.isQuoted,r.label),i];default:return L("calc.runtime.resolverService.resolveUserDefinedFuncQualifier",r)}}(r,l))[0],s=a[1];var v=d.asWhole;if(Ru(s))c=s;else{var p=function(e,t,r,n){var a=n;return a.length>"_xludf.".length&&0===t.stringCompareCI(a.substring(0,"_xludf.".length),"_xludf.")&&(a=a.substring("_xludf.".length)),[e.getUserDefinedFuncLoc(r,a),a]}(e,f,s.value,d.asWhole),m=p[0],g=p[1];v=g,X(m)?0!==m.value.length?(c=m,v=g):(c=J,v=g):c=m}return Au(Jt(Qt(d.asWhole,d.canDenoteNamedObject,d.label),u,n.label),c,v)}return{resolveName:o,resolveGridRef:Du,resolveCellRef:i,resolveUserDefinedFunc:f,resolveDottedName:function(e,t,r){var n,a=t.qualifier,u=t.parts,s=[],c=r[t.label],l=(null==c?void 0:c.kind)===ct.AppHeadName;if(!a){var d=er(u);if(d.kind===mt.IdentNamePart){var h=$t(u).parts.slice(1),v=function(e,t){var r=t[e.label];return(null==r?void 0:r.kind)===ct.LocalName?Tu(Jt(Qt(r.whole,e.canDenoteNamedObject,e.label),void 0,-1),q(r)):Tu(Jt(Qt(e.asWhole,e.canDenoteNamedObject,e.label),void 0,-1),J)}(d,r);if(n=Mu(v,h.map((function(e){return e.rhs}))),!X(v.resolution)||v.resolution.value)return n}}for(;;){if(u.canDenoteNamedObject){var p=Jt(Qt(u.asWhole,u.canDenoteNamedObject,u.label),a,-1),m=o(e,p,l?pn.AppHead:pn.Plain);if(n=Mu(m,ie(s).reverse()),!X(m.resolution)||m.resolution.value)return n;if(l&&(void 0===a||a.kind===ot.Document||a.kind===ot.Ident)){var g=f(e,p);if(n=Mu(g,ie(s).reverse()),!X(g.resolution)||g.resolution.value)return n}}if(u.kind===mt.CellRefNamePart&&(null==a&&e.allowUnqualifiedCell||null!=a&&a.kind!==ot.Document)){var S=i(e,tr(u.ref,null!=a&&a.kind===ot.Ident?It(a.name):a,u.label));return Mu(S,s.reverse())}if(u.kind!==mt.FieldRefNamePart)return void 0!==n?n:Mu(Ou(Jt(Qt(u.asWhole,u.canDenoteNamedObject,u.label),a,-1)),ie(s).reverse());s.push(u.rhs),u=u.lhs,l=!1}},resolveStructRef:function(t,r){var n=r.lhs,a=r.rhs;if(void 0!==n){var i=o(t,n,pn.StructRef),u=i.node,s=i.resolution;if(!X(s))return Iu(r,s);if(me(s.value))return Iu(r,Q(yu(pu.UndefinedTableName)));var c=d(t,s.value,a),l=c.structRef,f=c.resolution,h=f;return Ru(h)?Iu(r,h):Iu(ar(u,l,r.label),f)}var v=t.originGridCell,p=t.originSheet;if(!X(v))return Iu(r,v);if(!X(p))return Iu(r,p);if(void 0===p.value.index)return Iu(r,Q(yu(pu.InvalidOriginSheet)));var m=e.getContainingTable(Bn(p.value,v.value));if(!X(m))return Iu(r,m);if(me(m.value))return Iu(r,Q(yu(pu.MissingTableName)));var g=d(t,m.value,a),S=g.structRef,y=g.resolution;return Iu(Ru(y)?r:ar(n,S,r.label),y)}}}var Lu=function(e,t,r){return{sign:e,mantissa:t,exponent:r}};function Uu(e,t){if(t<=1)return t;var r=e%t;return 0===r?t:r<0?r+t:r}function xu(e){return{kind:bt.Number,_valueIEEE:e}}var Bu=xu(0),Wu=xu(1),Pu=xu(Math.PI);function Vu(e){return isFinite(e)?xu(e):ta}function Gu(e,t){var r=e._valueIEEE,n=t._valueIEEE;return r<n?-1:r>n?1:0}function Hu(e,t){var r=void 0===t?e.toExponential():e.toExponential(t),n=r.indexOf("e"),a=!F(r,"-"),i=r.substring(a?0:1,n).replace(".",""),o=parseInt(r.substring(n+1),10)+1;return function(e){for(var t=0;t<e.length;t+=1)if(48!==e.charCodeAt(t))return!1;return!0}(i)?{sign:a,mantissa:"",exponent:0}:{sign:a,mantissa:i,exponent:o}}var ju=["0","1","2","3","4","5","6","7","8","9"];function Ku(e){var t=e._valueIEEE;return xu(t<0?Math.ceil(t):Math.floor(t))}function Yu(e){var t=e._valueIEEE;return xu(Math.floor(t))}function qu(e){return e.substring(0,1)+"."+e.substring(1)}var zu,Ju,Qu={zero:Bu,one:Wu,pi:Pu,add:function(e,t){return Vu(e._valueIEEE+t._valueIEEE)},sub:function(e,t){return Vu(e._valueIEEE-t._valueIEEE)},mul:function(e,t){return Vu(e._valueIEEE*t._valueIEEE)},div:function(e,t){var r=e._valueIEEE,n=t._valueIEEE;return 0===n?Xn:Vu(r/n)},power:function(e,t){var r=e._valueIEEE,n=t._valueIEEE,a=Math.pow(r,n);return isFinite(a)?xu(a):isNaN(a)?Xn:ta},percent:function(e){return xu(e._valueIEEE/100)},neg:function(e){return xu(-e._valueIEEE)},compare:Gu,formatGeneral:function(e,t,r){var n=e.decimalSeparator,a=t._valueIEEE,i=String(a).replace("e","E");return"."!==n&&(i=i.replace(".",n)),i},formatFixed:function(e,t,r){var n,a=e._valueIEEE,i=Hu(a),o=i.sign,u=i.mantissa,s=i.exponent,c=r+(s+t);if(0===c){var l=parseFloat("5e"+String(s-1));if(Math.abs(a)>=l)return Lu(o,"1",s+t+1)}if(c<1)return Lu(!0,"",0);c<=21&&(o=(n=Hu(a,c-1)).sign,u=n.mantissa,c=r+((s=n.exponent)+t));var d=u.substring(0,c);return Lu(o,d,0===d.length?0:s+t)},formatScientific:function(e,t,r){var n,a=e._valueIEEE,i=Hu(a),o=i.sign,u=i.mantissa,s=i.exponent,c=Uu(s,t),l=c+r;if(x("calc.lang.ieeeFormatScientific",l>0),0===l){var d=parseFloat("5e"+String(s-1));if(Math.abs(a)>=d)return Lu(o,"",s+1)}if(l<1)return Lu(!0,"",0);l<=21&&(o=(n=Hu(a,l-1)).sign,u=n.mantissa,l=(c=Uu(s=n.exponent,t))+r);var f=u.substring(0,l);return Lu(o,f,0===f.length?0:s)},parse:function(e,t,r,n){return xu(Number((t?"":"-")+"0."+function(e,t){for(var r=e.getOrdinal,n="",a=0,i=Ja(t);a<i.length;a++){var o=i[a];n+=ju[r(o)]}return n}(e,n)+"E"+String(r)))},trunc:Ku,ceil:function(e){var t=e._valueIEEE;return xu(Math.ceil(t))},floor:Yu,abs:function(e){return xu(Math.abs(e._valueIEEE))},cond:function(e){return Gu(e,Bu)},cond2:Gu,fromNumber:xu,toNumber:function(e){return e._valueIEEE},sqrt:function(e){return Vu(Math.sqrt(e._valueIEEE))},exp:function(e){return Vu(Math.exp(e._valueIEEE))},ln:function(e){return Vu(Math.log(e._valueIEEE))},log:function(e){return Vu(Math.log(e._valueIEEE)/Math.LN10)},sin:function(e){return xu(Math.sin(e._valueIEEE))},cos:function(e){return xu(Math.cos(e._valueIEEE))},tan:function(e){return xu(Math.tan(e._valueIEEE))},asin:function(e){return Vu(Math.asin(e._valueIEEE))},acos:function(e){return Vu(Math.acos(e._valueIEEE))},atan:function(e){return Vu(Math.atan(e._valueIEEE))},atan2:function(e,t){return xu(Math.atan2(t._valueIEEE,e._valueIEEE))},round:function(e,t){var r=e._valueIEEE;if(0===r)return Bu;var n=Hu(r).exponent,a=Ku(t)._valueIEEE+n;if(0===a){var i=parseFloat("5e"+String(n-1));if(Math.abs(r)>=i)return Vu((r<0?-1:1)*parseFloat("10e"+String(n-1)))}return a<1?Bu:a>21?e:Vu(parseFloat(r.toExponential(a-1)))},roundUp:function(e,t){var r=e._valueIEEE;if(0===r)return Bu;var n=Hu(r),a=n.sign,i=n.mantissa,o=n.exponent,u=Ku(t)._valueIEEE+o;return u<1?Vu(parseFloat((a?"":"-")+"10e"+String(o-1-u))):u>21?e:Vu(parseFloat((a?"":"-")+function(e,t){if(e.length<=t)return qu(e);for(var r=e.substring(0,t),n=0,a=r.length-1;a>=0&&r.charCodeAt(a)-48==9;a-=1)n+=1;return n===r.length?"10":qu(r.substring(0,r.length-n-1)+String.fromCharCode(r.charCodeAt(r.length-n-1)+1))}(i,u)+"e"+String(o-1)))},roundDown:function(e,t){var r=e._valueIEEE;if(0===r)return Bu;var n=Hu(r),a=n.sign,i=n.mantissa,o=n.exponent,u=Ku(t)._valueIEEE+o;if(u<1)return Bu;if(u>21)return e;var s=i.substring(0,u);return Vu(parseFloat((a?"":"-")+qu(s)+"e"+String(o-1)))},tenTo:function(e){return B("calc.lang.ieeeTenTo",e),Vu(Math.pow(10,e))},checkAlmostCancellation:function(e,t){return t},fix:function(e){var t=e._valueIEEE,r=Math.abs(t);return r>=4294967296?4294967295:Math.floor(r)},lfix:function(e){var t=Ku(e)._valueIEEE;return t<-2147483648||t>2147483647?-2147483648:t},sfix:function(e){var t=Yu(e)._valueIEEE;return t<-2147483648?-2147483648:t>2147483647?2147483647:t},viewRound:se};!function(e){e[e.Red=0]="Red",e[e.Black=1]="Black"}(zu||(zu={})),function(e){e[e.DoubleBlack=2]="DoubleBlack"}(Ju||(Ju={}));var Xu=zu.Red,Zu=zu.Black,$u=Ju.DoubleBlack,es={c:Zu,l:void 0,r:void 0},ts={c:$u,l:void 0,r:void 0};function rs(e){return void 0===e.l}function ns(e){return e.c===Xu}function as(e){return e.c===Zu&&void 0!==e.l}function is(e){return e.c===Zu&&void 0===e.l}var os=es;function us(e,t,r,n,a){return{c:e,l:t,key:r,value:n,r:a}}function ss(e,t){return us(e,t.l,t.key,t.value,t.r)}function cs(e){return rs(e)?es:ss(Zu,e)}function ls(e,t,r){if(!rs(r)){var n=e.keyCompare(t,r.key);return n<0?ls(e,t,r.l):n>0?ls(e,t,r.r):r}}function ds(e,t){return!!rs(t)||!!ds(e,t.l)&&(!!e(t.key,t.value)&&ds(e,t.r))}function fs(e,t,r,n,a){if(e===Zu){if(ns(t)&&ns(t.l))return us(Xu,ss(Zu,t.l),t.key,t.value,us(Zu,t.r,r,n,a));if(ns(a)&&ns(a.r))return us(Xu,us(Zu,t,r,n,a.l),a.key,a.value,ss(Zu,a.r));if(ns(t)&&ns(t.r))return us(Xu,us(Zu,t.l,t.key,t.value,t.r.l),t.r.key,t.r.value,us(Zu,t.r.r,r,n,a));if(ns(a)&&ns(a.l))return us(Xu,us(Zu,t,r,n,a.l.l),a.l.key,a.l.value,us(Zu,a.l.r,a.key,a.value,a.r))}if(e===$u){if(ns(a)&&ns(a.l))return us(Zu,us(Zu,t,r,n,a.l.l),a.l.key,a.l.value,us(Zu,a.l.r,a.key,a.value,a.r));if(ns(t)&&ns(t.r))return us(Zu,us(Zu,t.l,t.key,t.value,t.r.l),t.r.key,t.r.value,us(Zu,t.r.r,r,n,a))}return us(e,t,r,n,a)}function hs(e,t,r,n,a){return e===Xu&&t.c===$u&&as(a)?fs(Zu,us(Xu,cs(t),r,n,a.l),a.key,a.value,a.r):e===Xu&&as(t)&&a.c===$u?fs(Zu,t.l,t.key,t.value,us(Xu,t.r,r,n,cs(a))):e===Zu&&t.c===$u&&as(a)?fs($u,us(Xu,cs(t),r,n,a.l),a.key,a.value,a.r):e===Zu&&as(t)&&a.c===$u?fs($u,t.l,t.key,t.value,us(Xu,t.r,r,n,cs(a))):e===Zu&&t.c===$u&&ns(a)&&as(a.l)?us(Zu,fs(Zu,us(Xu,cs(t),r,n,a.l.l),a.l.key,a.l.value,a.l.r),a.key,a.value,a.r):e===Zu&&ns(t)&&as(t.r)&&a.c===$u?us(Zu,t.l,t.key,t.value,fs(Zu,t.r.l,t.r.key,t.r.value,us(Xu,t.r.r,r,n,cs(a)))):(x("calc.common.rbTree.rotate: expected R|B",t.c!==$u&&a.c!==$u),us(e,t,r,n,a))}function vs(e,t,r,n){return function(e){return!ns(e)||e.l.c!==Xu&&e.r.c!==Xu?e:ss(Zu,e)}(function e(t,r,n,a){if(rs(a))return us(Xu,es,r,n,es);var i=t.keyCompare(r,a.key);return i<0?fs(a.c,e(t,r,n,a.l),a.key,a.value,a.r):i>0?fs(a.c,a.l,a.key,a.value,e(t,r,n,a.r)):us(a.c,a.l,r,n,a.r)}(e,t,r,n))}function ps(e,t,r){if(rs(r))return r;if(r.c===Xu&&is(r.l)&&is(r.r))return 0===e.keyCompare(t,r.key)?es:r;if(r.c===Zu&&is(r.l)&&is(r.r))return 0===e.keyCompare(t,r.key)?ts:r;if(r.c===Zu&&ns(r.l)&&is(r.l.l)&&is(r.l.r)&&is(r.r)){var n=e.keyCompare(t,r.key);return n<0?us(Zu,ps(e,t,r.l),r.key,r.value,es):n>0?r:us(Zu,es,r.l.key,r.l.value,es)}var a=e.keyCompare(t,r.key);if(a<0)return hs(r.c,ps(e,t,r.l),r.key,r.value,r.r);if(a>0)return hs(r.c,r.l,r.key,r.value,ps(e,t,r.r));x("calc.common.rbTree.rem: expected node",!rs(r.r));var i=function e(t){if(t.c===Xu&&is(t.l)&&is(t.r))return[t.key,t.value,es];if(t.c===Zu&&is(t.l)&&is(t.r))return[t.key,t.value,ts];if(t.c===Zu&&is(t.l)&&ns(t.r))return[t.key,t.value,ss(Zu,t.r)];x("calc.common.rbTree.remMin: expected node",!rs(t.l));var r=e(t.l),n=r[0],a=r[1],i=r[2];return[n,a,hs(t.c,i,t.key,t.value,t.r)]}(r.r),o=i[0],u=i[1],s=i[2];return hs(r.c,r.l,o,u,s)}function ms(e,t,r){var n=ps(e,t,function(e){return as(e)&&e.l.c===Zu&&e.r.c===Zu?ss(Xu,e):e}(r));return x("calc.common.rbTree.remove: expected R|B",n.c===Xu||n.c===Zu),n}var gs,Ss,ys,bs,Es,Fs,Cs,Rs,ks,Ns,As,Ts,Is,Os,Ms,ws,Ds=function(){function e(e,t,r){this.root=e,this.count=t,this.keyCompare=r}return e.create=function(t){return new e(os,0,t)},e.prototype.getCount=function(){return this.count},e.prototype.getValue=function(e){var t=ls(this,e,this.root);return null==t?void 0:t.value},e.prototype.getEntry=function(e){return ls(this,e,this.root)},e.prototype.contains=function(e){return void 0!==this.getValue(e)},e.prototype.forEach=function(e){return ds(e,this.root)},e.prototype.setValue=function(t,r){return new e(vs(this,t,r,this.root),this.contains(t)?this.count:this.count+1,this.keyCompare)},e.prototype.remove=function(t){return this.contains(t)?new e(ms(this,t,this.root),this.count-1,this.keyCompare):this},e.prototype.getOrSetValue=function(t,r){var n=this.getValue(t);if(void 0!==n)return[this,n];var a=r();return[new e(vs(this,t,a,this.root),this.count+1,this.keyCompare),a]},e.prototype.filter=function(t){var r=this,n=os,a=0;return this.forEach((function(e,i){return t(e,i)&&(n=vs(r,e,i,n),a+=1),!1})),new e(n,a,this.keyCompare)},e}(),_s=function(e){function t(t,r,n){var a=e.call(this,Ye)||this;return a.localeInfo=t,a.annotations=r,a.names=n,a}return ee(t,e),t.prototype.appNode=function(t,r,n,a){var i=this;return _e.try((function(){return t.kind===pt.Name&&(i.annotations[t.label]=Rt),e.prototype.appNode.call(i,t,r,n,a)}))},t.prototype.letNode=function(e,r,n){var a=this,i=e.id===la.LETREC||e.id!==la.LET&&U("calc.lang.buildAnnotations"),o=[this.names];r.reduce((function(e,t){var r=t[0],n=e.setValue(gn(a.localeInfo,r.whole),r);return o.push(n),n}),this.names);var u=new t(this.localeInfo,this.annotations,o[r.length]);return this.lazyVisitAppHeadNode(e).bind((function(e){return(i?_e.all(r.map((function(e){var t=e[1];return _e.try((function(){return Le(u,t)}))}))):_e.all(r.map((function(e,r){var n=e[1],i=new t(a.localeInfo,a.annotations,o[r]);return _e.try((function(){return Le(i,n)}))})))).bind((function(e){return Le(u,n)}))}))},t.prototype.lambdaNode=function(e,r,n){var a=this,i=r.reduce((function(e,t){return e.setValue(gn(a.localeInfo,t.whole),t)}),this.names),o=new t(this.localeInfo,this.annotations,i);return this.lazyVisitAppHeadNode(e).bind((function(e){return Le(o,n)}))},t.prototype.nameNode=function(t,r,n){var a=this;return _e.try((function(){if(void 0===r){var i=er(t),o=a.names.getEntry(gn(a.localeInfo,i.asWhole));void 0!==o&&(a.annotations[i.label]=Pt(o.key,o.value.whole,o.value.label))}return e.prototype.nameNode.call(a,t,r,n)}))},t}(at);function Ls(e,t){var r=[];return ft(new _s(e,r,Ds.create(e.stringCompareCI)),t),r[t.label]=kt,r}(Ss=gs||(gs={})).LexicalKind=vn,Ss.NameSource=pn,Ss.sheetRows=1<<20,Ss.sheetCols=16384,Ss.lexicalSourceCell=En,Ss.lexicalSourceRange=Fn,Ss.lexicalSourceName=Rn,Ss.documentLoc=kn,Ss.structRefColumnLoc=Nn,Ss.sheetIndex=Tn,Ss.sheetRange=An,Ss.gridCell=Dn,Ss.gridRange=wn,Ss.allSheetsRange=In,Ss.sheetRangeIndexes=On,Ss.sheetGridCell=Wn,Ss.sheetGridRange=Bn,Ss.sheetGridCube=xn,Ss.originCell=Pn,Ss.documentScope=Vn,Ss.nameLoc=Hn,Ss.nameScope=Gn,Ss.userDefinedFuncLoc=jn,(bs=ys||(ys={})).SpecialPrecs=Ft,bs.PrecsBound=Un,bs.OperKind=bt,bs.trueOper=ha,bs.falseOper=va,bs.ErrorType=Kn,bs.precedents=Yn,bs.stringOper=zn,bs.booleanOper=qn,bs.errorOper=Jn,bs.nullErrorOper=Qn,bs.div0ErrorOper=Xn,bs.valueErrorOper=Zn,bs.refErrorOper=$n,bs.nameErrorOper=ea,bs.numErrorOper=ta,bs.naErrorOper=ra,bs.gettingDataErrorOper=na,bs.fieldErrorOper=aa,bs.arrayOper=ua,bs.rangeSeqOper=sa,bs.range3DOper=ca,bs.missingOper=da,bs.blankOper=fa,(Fs=Es||(Es={})).RefStyle=it,Fs.QualifierKind=ot,Fs.CellRefKind=ut,Fs.PosKind=st,Fs.NodeKind=pt,Fs.NamePartKind=mt,Fs.SpecialRefId=gt,Fs.StructRefKind=St,Fs.BadType=yt,Fs.errorQualifier=Nt,Fs.relativeQualifier=At,Fs.documentQualifier=Tt,Fs.sheetQualifier=It,Fs.identQualifier=Ot,Fs.sheetRangeQualifier=Mt,Fs.pos=wt,Fs.cellRefError=Dt,Fs.cellRefSingle=_t,Fs.cellRefRange=Lt,Fs.cellRefRow=Ut,Fs.cellRefCol=xt,Fs.formula=Bt,Fs.formulaSpan=Wt,Fs.literalNode=Vt,Fs.arrayNode=Gt,Fs.appNode=Ht,Fs.letNode=jt,Fs.lambdaNode=Kt,Fs.operatorNode=Yt,Fs.wsfNode=qt,Fs.parenNode=zt,Fs.nameNode=Jt,Fs.identNamePart=Qt,Fs.cellRefNamePart=Xt,Fs.fieldRefNamePart=Zt,Fs.cellRefNode=tr,Fs.fieldRefNode=rr,Fs.fieldRef=nr,Fs.structRefNode=ar,Fs.structRef=lr,Fs.specialRef=ir,Fs.columnRef=or,Fs.rangeOpRef=ur,Fs.isectOpRef=sr,Fs.thisRowOpRef=cr,Fs.badNode=dr,Fs.AnnotationKind=ct,Fs.appHeadNameAnnotation=Rt,Fs.formulaRootAnnotation=kt,Fs.localNameAnnotation=Pt,(Rs=Cs||(Cs={})).SignatureType=Et,Rs.FunctionFlags=Ct,Rs.OperatorId=pa,Rs.WorksheetFuncId=la,Rs.SpecialPrecs=Ft,Rs.functionType=fr,Rs.unknownFunctionType=ya,Rs.getOperatorType=wa,Rs.getWorksheetFuncType=Da,(Ns=ks||(ks={})).isSheetIndex=hr,Ns.isSheetGridRange=mr,Ns.isGridCell=pr,Ns.isSheetGridCell=gr,Ns.isDocumentLocEqual=kr,Ns.isSheetIndexEqual=Nr,Ns.isGridCellEqual=Ar,Ns.isGridRangeEqual=Tr,Ns.isSheetGridCellEqual=Ir,Ns.isSheetGridRangeEqual=Or,Ns.isWellFormed=vr,Ns.isUnqualifiedNameNode=Wr,Ns.isOperatorNode=xr,Ns.isWSFNode=Br,Ns.gridRangeAnchor=Mr,Ns.sheetGridRangeAnchor=wr,Ns.gridCellRange=Dr,Ns.getArguments=Ur,Ns.getArgType=Gr,Ns.isValidArgsLength=Hr,Ns.isNumberOper=Kr,Ns.isStringOper=Yr,Ns.isBooleanOper=qr,Ns.isErrorOper=zr,Ns.isRangeOper=Jr,Ns.isArrayOper=Qr,Ns.isMissingOper=Xr,Ns.isBlankOper=Zr,Ns.isRichOper=$r,Ns.ResultKind=H,Ns.success=q,Ns.failure=Q,Ns.isSuccess=X,Ns.ReasonKind=on,Ns.notImplemented=un,Ns.unavailable=sn,Ns.internal=cn,Ns.javaScriptError=Z,Ns.columnName=Ci,Ns.formatRow=Ti,Ns.formatCol=Ii,Ns.formatRowRange=Di,Ns.formatColRange=_i,Ns.formatCellPos=Ui,Ns.formatGridRangeA1=ji,Ns.parseGridCellA1=yi,Ns.parseGridRangeA1=bi,Ns.getSubExpressionFromPosition=_r,Ns.ResolveReasonKind=vu,Ns.noOriginSheet=Su,Ns.emptyIntersection=Eu,Ns.createResolver=_u,Ns.ResolvedKind=bu,Ns.resolvedName=ku,Ns.resolvedCellRef=Nu,Ns.resolvedUserDefinedFunc=Au,Ns.resolvedLocalName=Tu,Ns.resolvedStructRef=Iu,Ns.resolvedNever=Ou,Ns.resolvedDottedName=Mu,Ns.visitFormulaNode=Le,Ns.visitOperatorNode=Ue,Ns.visitWSFNode=xe,Ns.visitAppHeadNode=Be,Ns.visitQualifier=We,Ns.visitCellRef=Pe,Ns.identityVisitor=He,Ns.constVisitor=Ke,Ns.voidVisitor=Ye,Ns.binaryVisitor=ze,Ns.composeVisitor=Qe,Ns.reduceBottomUp=dt,Ns.reducePledge=ht,Ns.buildAnnotations=Ls,Ns.assertNever=L,(Ts=As||(As={})).LogCategory=s.LogCategory,Ts.TraceLevel=s.TraceLevel,Ts.localeInfo=zo,Ts.localeInfo2=Jo,Ts.LCID=xo,Ts.Country=Uo,Ts.PictureSpecial=Bo,Ts.PictureSingle=Wo,Ts.PictureColor=Po,Ts.PictureDbnum=Vo,Ts.calcConfig=Lo,Ts.initCalc=Ko,Ts.getEnglishLocaleInfo=gu,Ts.createWorksheetFuncNameCallbacks=hu,Ts.isCalcInit=Yo,Ts.getCalcAbsUrl=qo,Ts.FeatureName=w,(Os=Is||(Is={})).numberComponents=Lu,Os.ieeeMathpack=Qu,Os.xlMathpack=_o,Os.formatScientificLeft=Uu,(ws=Ms||(Ms={})).TimeDivision=co,ws.Rounding=uo,ws.tzData=io,ws.tzUTC=oo,ws.dateTime=so,ws.TimeGranularity=no,ws.xlDatepack=lo;var Us,xs=/"/g,Bs=/'/g,Ws=Wn(Tn(kn(void 0,"Book1"),0),Dn(0,0));function Ps(e){if(!X(e)&&e.reason.kind!==vu.NoOriginSheet&&e.reason.kind!==vu.InvalidStructRef&&e.reason.kind!==vu.EmptyIntersection)throw new Ys(e.reason)}function Vs(e,t){for(var r="",n=0;n<e.length;n+=1){var a=e[n];t.indexOf(a)>=0&&(r+="'"),r+=a}return r}!function(e){e[e.Original=0]="Original",e[e.Bracketed=1]="Bracketed",e[e.Unbracketed=2]="Unbracketed"}(Us||(Us={}));var Gs,Hs={literalNode:function(e,t,r){return r},arrayNode:function(e,t,r){return r},appNode:function(e,t,r,n){return n},letNode:function(e,t,r,n,a){return a},lambdaNode:function(e,t,r,n,a){return a},parenNode:function(e,t,r){return r},nameNode:function(e,t,r){return r},cellRefNode:function(e,t,r){return r},fieldRefNode:function(e,t,r,n){return n},structRefNode:function(e,t,r){return r},badSequenceNode:function(e,t,r){return r},badStringNode:function(e,t,r){return r},operatorNode:function(e,t){return t},wsfNode:function(e,t,r){return r}},js=te(te({},Ke(void 0)),{operatorNode:function(e){return e}}),Ks=function(){function e(e,t,r,n){var a,i,o,u,s=this;this.root=r,this.anonymize=n,this.anon=function(e){return s.anonymize?b(e):e},this.locals=t,this.localeInfo=null!==(i=null===(a=null==t?void 0:t.config)||void 0===a?void 0:a.localeInfo)&&void 0!==i?i:e.config.localeInfo,this.mathpack=e.config.mathpack,this.refStyle=null!==(u=null===(o=null==t?void 0:t.config)||void 0===o?void 0:o.refStyle)&&void 0!==u?u:e.config.refStyle,this.resolver=_u(e),this.spans=r.spans,this.annotations=r.annotations,this.structRefEscapableChars=["'",this.localeInfo.leftBracket,this.localeInfo.rightBracket,"#","@"],this.structRefBracketedChars=ie(this.structRefEscapableChars,[",",":"," ","\t","\n"])}return e.prototype.print=function(){var e=new Xe({str:this,label:Hs,op:js});return"="+this.pre(this.root.node.label,"")+dt(e,this.root).str},e.prototype.pre=function(e,t){var r,n;return this.anonymize?t:null!==(n=null===(r=this.spans[e])||void 0===r?void 0:r.pre)&&void 0!==n?n:t},e.prototype.post=function(e,t){var r,n;return this.anonymize?t:null!==(n=null===(r=this.spans[e])||void 0===r?void 0:r.post)&&void 0!==n?n:t},e.prototype.printRef=function(e,t){var r="";switch(e.kind){case St.SpecialRef:(t===Us.Original&&e.isBracketed||t===Us.Bracketed)&&(r+=this.localeInfo.leftBracket);var n=this.localeInfo.specialRefNames[e.id];if(null==n)throw new Ys(cn("No locale data for specialRefName"));r+=n,(t===Us.Original&&e.isBracketed&&e.isClosed||t===Us.Bracketed)&&(r+=this.localeInfo.rightBracket);break;case St.ColumnRef:(t===Us.Original&&e.isBracketed||t===Us.Bracketed)&&(r+=this.localeInfo.leftBracket);var a=Vs(e.name,this.structRefEscapableChars);r+=this.anon(a),(t===Us.Original&&e.isBracketed&&e.isClosed||t===Us.Bracketed)&&(r+=this.localeInfo.rightBracket);break;case St.RangeOpRef:r+=this.printRef(e.lhs,t===Us.Original?t:Us.Bracketed)+":"+this.printRef(e.rhs,t===Us.Original?t:Us.Bracketed)}return r},e.prototype.printApplication=function(e,t,r){var n=this,a=t.map((function(e,t){return n.pre(e.label,0===t||""===e.str?"":" ")+e.str}));return e.str+"("+a.join(this.localeInfo.listSeparator)+(0===t.length?"":this.post(t[t.length-1].label,""))+(r?")":"")},e.prototype.printCellRef=function(e){var t=e.ref,r=e.qualifier;return(void 0!==r?We(this,r)+"!":"")+Pe(this,t)},e.prototype.printName=function(e){var t=e.whole,r=e.qualifier;return(void 0!==r?We(this,r)+"!":"")+this.anon(t)},e.prototype.literalNode=function(e,t,r){switch(e.kind){case bt.String:return'"'+this.anon(e.value).replace(xs,'""')+'"';case bt.Boolean:return e.value?this.localeInfo.trueName:this.localeInfo.falseName;case bt.Number:return this.anon(this.mathpack.formatGeneral(this.localeInfo,e,21));case bt.Missing:return"";case bt.Error:var n=this.localeInfo.errorNames[e.type];if(null==n)throw new Ys(cn("No locale data for error oper"));return n;default:return L("calc.lang.printFormula",e)}},e.prototype.arrayNode=function(e,t,r){var n=this;return this.localeInfo.leftBrace+e.map((function(e){return e.map((function(e){return e.str})).join(n.localeInfo.columnSeparator)})).join(this.localeInfo.rowSeparator)+(t?this.localeInfo.rightBrace:"")},e.prototype.appNode=function(e,t,r,n){if(void 0!==e.op){if(1===t.length){var a=t[0];switch(e.op){case pa.Percent:return a.str+this.pre(e.label,"")+e.str;case pa.Pound:return a.str+e.str;default:return e.str+this.post(e.label,"")+a.str}}if(2===t.length){var i=t[0],o=t[1];return i.str+this.pre(e.label," ")+e.str+this.post(e.label,e.op===pa.Isect?"":" ")+o.str}return U("calc.lang.printFormula: invalid number of operator args")}return this.printApplication(e,t,r)},e.prototype.letNode=function(e,t,r,n,a){var i=this,o=ve([],ie(t.map((function(e){var t=e[0],r=e[1];return[{str:i.anon(gn(i.localeInfo,t.whole)),label:t.label,op:void 0},r]})),[[r]]));return this.printApplication(e,o,n)},e.prototype.lambdaNode=function(e,t,r,n,a){var i=this,o=ie(t.map((function(e){return{str:i.anon(gn(i.localeInfo,e.whole)),label:e.label,op:void 0}})),[r]);return this.printApplication(e,o,n)},e.prototype.parenNode=function(e,t,r){return"("+this.pre(e.label,"")+e.str+this.post(e.label,"")+(t?")":"")},e.prototype.nameNode=function(e,t,r){var n=this.resolver.resolveDottedName(this.locals,Jt(e,t,r),this.annotations),a=n.resolved,i=n.fields;return Ps(a.resolution),a.kind===bu.ResolvedCellRef?ie([this.printCellRef(a.node)],i.map(this.anon)).join("."):a.kind===bu.ResolvedLocalName&&void 0!==a.resolution.value?ie([this.anon(a.resolution.value.name)],i.map(this.anon)).join("."):a.kind===bu.ResolvedUserDefinedFunc?ie([this.anon(a.name)],i.map(this.anon)).join("."):ie([this.printName(a.node)],i.map(this.anon)).join(".")},e.prototype.cellRefNode=function(e,t,r){var n=this.resolver.resolveCellRef(this.locals,tr(e,t,r)),a=n.node;return Ps(n.resolution),this.printCellRef(a)},e.prototype.fieldRefNode=function(e,t,r,n){var a=e.str,i=r,o=t.isBracketed||i?this.localeInfo.leftBracket:"",u=t.isBracketed&&t.isClosed||i?this.localeInfo.rightBracket:"",s=Vs(t.field,["'",this.localeInfo.leftBracket,this.localeInfo.rightBracket]);return a+="."+o+this.anon(s)+u+this.post(t.label,"")},e.prototype.structRefNode=function(e,t,r){var n=this.resolver.resolveStructRef(this.locals,ar(e,t,r)),a=n.node;Ps(n.resolution);var i=void 0!==a.lhs?this.printName(a.lhs):"";i+=this.localeInfo.leftBracket;var o,u=a.rhs.innerRef;switch(u.kind){case St.ColumnRef:case St.SpecialRef:i+=this.printRef(u,u.isClosed?Us.Unbracketed:Us.Original);break;case St.RangeOpRef:i+=this.printRef(u,u.lhs.isClosed&&u.rhs.isClosed?Us.Unbracketed:Us.Original);break;case St.IsectOpRef:var s=yn(u)&&(bn((o=u).lhs)&&bn(o.rhs))?Us.Bracketed:Us.Original;i+=this.printRef(u.lhs,s)+","+this.printRef(u.rhs,s);break;case St.ThisRowOpRef:i+="@",u.ref&&(u.ref.kind===St.ColumnRef?i+=this.printRef(u.ref,function(e,t){for(var r=0,n=t;r<n.length;r++){var a=n[r];if(e.indexOf(a)>=0)return!0}return!1}(u.ref.name,this.structRefBracketedChars)?Us.Bracketed:Us.Unbracketed):i+=this.printRef(u.ref,u.ref.lhs.isClosed&&u.ref.rhs.isClosed?Us.Unbracketed:Us.Original))}return a.rhs.isClosed&&(i+=this.localeInfo.rightBracket),i},e.prototype.badSequenceNode=function(e,t,r){var n=this;return t.map((function(e){return n.pre(e.label,"")+e.str+n.post(e.label,"")})).join("")},e.prototype.badStringNode=function(e,t,r){return this.pre(r,"")+this.anon(t)+this.post(r,"")},e.prototype.operatorNode=function(e,t){var r=lu(this.localeInfo,e,"");if(void 0===r)throw new Ys(cn("Invalid operator"));return r},e.prototype.wsfNode=function(e,t,r){return this.localeInfo.getWorksheetFuncName(e)},e.prototype.cellRefError=function(){var e=this.localeInfo.errorNames[Kn.REF];if(null==e)throw new Ys(cn("No locale data for #REF"));return e},e.prototype.cellRefSingle=function(e,t,r){var n=Ui(this.localeInfo,this.refStyle,this.locals.originGridCell.value,e,t,this.locals.wrapCellReferences);return void 0!==n?this.anon(n):this.cellRefError()},e.prototype.cellRefRange=function(e,t){var r=xi(this.localeInfo,this.refStyle,this.locals.originGridCell.value,e.row,e.col,t.row,t.col,this.locals.wrapCellReferences);return void 0!==r?this.anon(r):this.cellRefError()},e.prototype.cellRefRow=function(e,t,r){var n=Di(this.localeInfo,this.refStyle,this.locals.originGridCell.value.row,e,t,this.locals.wrapCellReferences);return void 0!==n?this.anon(n):this.cellRefError()},e.prototype.cellRefCol=function(e,t,r){var n=_i(this.localeInfo,this.refStyle,this.locals.originGridCell.value.col,e,t,this.locals.wrapCellReferences);return void 0!==n?this.anon(n):this.cellRefError()},e.prototype.errorQualifier=function(){var e=this.localeInfo.errorNames[Kn.REF];if(null==e)throw new Ys(cn("No locale data for #REF"));return e.replace("!","")},e.prototype.relativeQualifier=function(){return""},e.prototype.documentQualifier=function(e,t,r){return Hi(this.localeInfo,this.refStyle,this.anon(void 0!==t?t+"/"+e:e))},e.prototype.sheetQualifier=function(e,t,r){return Hi(this.localeInfo,this.refStyle,this.anon(this.documentQualifierBeforeSheet(t)+e))},e.prototype.identQualifier=function(e,t){return Hi(this.localeInfo,this.refStyle,this.anon(e))},e.prototype.sheetRangeQualifier=function(e,t,r,n){var a=this.anon(this.documentQualifierBeforeSheet(r)+e),i=this.anon(t),o=a+":"+i;return Gi(this.localeInfo,this.refStyle,a)||Gi(this.localeInfo,this.refStyle,i)?"'"+o.replace(Bs,"''")+"'":o},e.prototype.documentQualifierBeforeSheet=function(e){if(void 0===e)return"";var t=e.path,r=e.document;return(null!=t?t:"")+this.localeInfo.leftBracket+r+this.localeInfo.rightBracket},e}(),Ys=ln("PrintError"),qs=function(){function e(e){this.config=e}return e.prototype.getDocumentLoc=function(e,t){return q(kn(e,t))},e.prototype.getSheetIndex=function(e,t){return q(t)},e.prototype.getSheetName=function(e,t){return q(t)},e.prototype.getNameLoc=function(e,t){return q(t.indexOf(".")>=0?void 0:Hn(e,t))},e.prototype.getUserDefinedFuncLoc=function(e,t){return q([jn(e,t)])},e.prototype.getSheetRangeIndexes=function(e){return q(On([e.index],0))},e.prototype.getContainingTable=function(e){return J},e.prototype.getStructRefColumn=function(e,t){return J},e.prototype.getStructRefSpecialRef=function(e,t){return J},e}();function zs(e){return new qs(e)}function Js(e,t,r){return{config:null!=r?r:void 0,lexicalSource:e,originGridCell:q(t.range),originSheet:q(t.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1}}function Qs(e,t,r){return{config:null!=r?r:void 0,lexicalSource:e,originGridCell:q(t.range),originSheet:q(t.sheet),allowUnqualifiedCell:!1,wrapCellReferences:!0}}function Xs(e,t,r,n){void 0===n&&(n=!1);try{return q(new Ks(e,t,r,n).print())}catch(e){if(e instanceof Ys)return Q(e.reason);throw e}}function Zs(e,t,r){try{var n=r.kind===vn.Cell||r.kind===vn.Range?Js(r,wr(r.range)):r.kind===vn.NameManager?Qs(r,Ws):L("calc.lang.anonymizeFormula",r),a=Xs(zs(Lo(gu(),it.A1,e.mathpack)),n,t,!0);if(a.kind===H.Success)return a.value}catch(e){var i="calc.lang.anonymizeFormula: Format failed: "+A(e);_.ULS.traceTag(595964180,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Warning,i)}return d(t)}function $s(e){return{config:e}}function ec(e,t,r){return{config:null!=r?r:void 0,lexicalKind:e,originGridCell:q(t)}}!function(e){e.NotFormulaString="NotFormulaString"}(Gs||(Gs={}));var tc=te(te({},on),Gs),rc=Js,nc=Qs;function ac(e){return{kind:tc.NotFormulaString,message:e}}var ic,oc,uc,sc;function cc(e){return e.kind===sc.BadNumber||e.kind===bt.Number}!function(e){e[e.End=1]="End",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.Sep=4]="Sep",e[e.Operator=5]="Operator",e[e.Spaces=6]="Spaces",e[e.Ident=7]="Ident",e[e.CellRef=8]="CellRef",e[e.Literal=9]="Literal",e[e.SpecialRef=10]="SpecialRef",e[e.Unexpected=11]="Unexpected",e[e.Escape=12]="Escape"}(ic||(ic={})),function(e){e[e.Paren=1]="Paren",e[e.Bracket=2]="Bracket",e[e.Brace=3]="Brace",e[e.SQuote=4]="SQuote"}(oc||(oc={})),function(e){e[e.List=1]="List",e[e.Row=2]="Row",e[e.Col=3]="Col",e[e.Qual=4]="Qual",e[e.Dot=5]="Dot"}(uc||(uc={})),function(e){e.BadNumber="BadNumber"}(sc||(sc={}));var lc={kind:sc.BadNumber};function dc(e,t,r,n){return{kind:e,start:t,chars:r,isIdentContinue:n}}var fc=function(e){return dc(ic.End,e,"",!1)},hc=function(e,t){return dc(ic.Spaces,e,t,!1)},vc=function(e,t){return dc(ic.Unexpected,e,t,!1)},pc=function(e,t){return dc(ic.Escape,e,t,!1)},mc=function(e,t){return dc(ic.Ident,e,t,!0)};function gc(e,t,r,n){return{kind:e,start:t,chars:r,isIdentContinue:!1,value:n}}var Sc=function(e,t){return gc(ic.Left,e,t,oc.Bracket)},yc=function(e,t){return gc(ic.Left,e,t,oc.Brace)},bc=function(e){return gc(ic.Right,e,")",oc.Paren)},Ec=function(e,t){return gc(ic.Right,e,t,oc.Bracket)},Fc=function(e,t){return gc(ic.Right,e,t,oc.Brace)},Cc=function(e){return gc(ic.Right,e,"'",oc.SQuote)},Rc=function(e,t){return gc(ic.Sep,e,t,uc.List)},kc=function(e,t){return gc(ic.Sep,e,t,uc.Col)},Nc=function(e,t){return gc(ic.Sep,e,t,uc.Row)},Ac=function(e){return gc(ic.Sep,e,"!",uc.Qual)};function Tc(e,t,r,n,a,i,o){return{kind:ic.CellRef,start:e,chars:t,isIdentContinue:r,row:n,col:a,refStyle:i,isBadLocale:o}}function Ic(e,t,r,n){void 0===n&&(n=!0);var a=r.kind===bt.Boolean||cc(r)&&function(e){for(var t=0,r=Ja(e);t<r.length;t++){var n=r[t];if(43===n||45===n||42===n||32===n||47===n)return!1}return!0}(t);return{kind:ic.Literal,start:e,chars:t,isIdentContinue:a,oper:r,hasRight:n}}function Oc(e,t,r){return 0===e.stringCompareCI(e.falseName,r)?Ic(t,r,va):0===e.stringCompareCI(e.trueName,r)?Ic(t,r,ha):mc(t,r)}function Mc(e,t,r){return{kind:ic.Operator,start:e,chars:t,isIdentContinue:!1,value:r}}function wc(e){var t=ba[e];if(null==t)throw new Error("operatorTokenMaker: invalid operator "+e);return function(r){return Mc(r,t,e)}}var Dc=wc(pa.Add),_c=wc(pa.Sub),Lc=wc(pa.Mul),Uc=wc(pa.Div),xc=wc(pa.Pow),Bc=wc(pa.Percent),Wc=wc(pa.Concat),Pc=wc(pa.Eq),Vc=wc(pa.Lt),Gc=wc(pa.Gt),Hc=wc(pa.Ne),jc=wc(pa.Le),Kc=wc(pa.Ge),Yc=wc(pa.Range),qc=wc(pa.At),zc=wc(pa.Pound);function Jc(e,t,r){return r.push(t),t.start+e}function Qc(e,t){var r=t-1;return function(t){if(t<=r){var n=e+": internal error: no progress made at index "+t;return _.ULS.assertTag(595980821,s.LogCategory.msoulscat_ES_EWAJS,!1,n)}r=t}}function Xc(e,t,r){for(var n=t;n<e.length&&r(e,n);)n+=za(qa(e,n));return[e.substring(t,n),n]}function Zc(e,t,r,n,a){return r(e,t)?1:F(e,n,t)&&t+n.length<e.length&&a(e,t+n.length)?2:0}function $c(e,t,r,n,a){for(var i=[],o=t,u=t;u<e.length;){var s=Zc(e,u,r,n,a);if(0===s)break;2===s&&(o!==u&&i.push(e.substring(o,u)),o=u+n.length,u+=n.length),u+=za(qa(e,u))}return o!==u&&i.push(e.substring(o,u)),[i.join(""),u]}var el;function tl(e){if(!el){el=ce();for(var t=0,r=Object.getOwnPropertyNames(rl);t<r.length;t++){var n=r[t];el[n.charCodeAt(0)]=!0}for(var a=0,i=Object.getOwnPropertyNames(nl);a<i.length;a++){var o=i[a];el[o.charCodeAt(0)]=!0}}return!0===el[e]}var rl={"+":Dc,"-":_c,"*":Lc,"/":Uc,"^":xc,"%":Bc,"&":Wc,"=":Pc,"<":Vc,">":Gc,":":Yc,".":function(e){return gc(ic.Sep,e,".",uc.Dot)},"@":qc,"#":zc},nl={"<>":Hc,"<=":jc,">=":Kc};function al(e,t,r){if(t<e.length-1){var n=nl[e.substring(t,t+2)];if(null!=n)return Jc(2,n(t),r)}var a=rl[e.charAt(t)];if(null!=a)return Jc(1,a(t),r);return _.ULS.assertTag(595980822,s.LogCategory.msoulscat_ES_EWAJS,!1,"calc.parse.tokenizeOperator: internal error: expected operator")}function il(e,t,r,n,a){var i=$a(e,t,r,n,!1,!1,!1);if(void 0!==i){var o=i.value,u=i.i;return Jc(u-n,Ic(n,r.substring(n,u),null!=o?o:lc,!0),a),u}}var ol=function(e,t){return 34!==e.charCodeAt(t)},ul=function(e,t){return 34===e.charCodeAt(t)};function sl(e,t,r){var n=$c(e,t+1,ol,'"',ul),a=n[0],i=n[1],o=e.substring(t,i+1);return i<e.length?Jc(i+1-t,Ic(t,o,zn(a),!0),r):Jc(i-t,Ic(t,o,zn(a),!1),r)}function cl(e,t,r,n){for(var a=1;a<e.errorNames.length;a+=1){var i=e.errorNames[a];if(null!=i){var o=t.substring(r,r+i.length);if(0===e.stringCompareCI(i,o))return Jc(i.length,Ic(r,o,Jn(a)),n)}}}function ll(e,t,r,n){for(var a=1;a<e.specialRefNames.length;a+=1){var i=e.specialRefNames[a];if(null!=i){var o=t.substring(r,r+i.length);if(0===e.stringCompareCI(i,o))return Jc(i.length,(u=r,s=o,c=a,gc(ic.SpecialRef,u,s,c)),n)}}var u,s,c}function dl(e,t,r){var n=t.charCodeAt(r);return!(Qa(n)||39===n||35===n||58===n||64===n||F(t,e.listSeparator,r)||F(t,e.leftBracket,r)||F(t,e.rightBracket,r))}var fl=function(e,t){return Qa(qa(e,t))};function hl(e,t,r,n){for(var a=r,i=0,o=function(t,r){return dl(e,t,r)},u=function(t,r){return!dl(e,t,r)},s=Qc("calc.parse.tokenizeBracketedRef",a);a<t.length;){s(a);var c=qa(t,a);if(n.length>0&&n[n.length-1].kind===ic.Escape&&u(t,a))a=Jc(za(c),mc(a,ja(c)),n);else if(64!==c){if(35===c)if(null!=(f=ll(e,t,a,n))){a=f;continue}if(39!==c)if(F(t,e.rightBracket,a)){if(a=Jc(e.rightBracket.length,Ec(a,e.rightBracket),n),0===(i-=1))return a}else if(o(t,a)){var l=Xc(t,a,o),d=l[0];a=Jc((f=l[1])-a,mc(a,d),n)}else if(Qa(c)){var f,h=Xc(t,a,fl);d=h[0];a=Jc((f=h[1])-a,hc(a,d),n)}else 58!==c?F(t,e.listSeparator,a)?a=Jc(e.listSeparator.length,Rc(a,e.listSeparator),n):F(t,e.leftBracket,a)&&i<2?(a=Jc(e.leftBracket.length,Sc(a,e.leftBracket),n),i+=1):a=Jc(za(c),vc(a,ja(c)),n):a=Jc(1,Yc(a),n);else a=Jc(1,pc(a,"'"),n)}else a=Jc(1,qc(a),n)}return a}function vl(e,t,r,n){for(var a,i=Jc(1,(a=r,gc(ic.Left,a,"'",oc.SQuote)),n),o=function(t,r){return function(e,t,r){var n=t.charCodeAt(r);return 39!==n&&58!==n&&42!==n&&63!==n&&!F(t,e.leftBracket,r)&&!F(t,e.rightBracket,r)}(e,t,r)},u=function(e,t){return 39===e.charCodeAt(t)},s=Qc("calc.parse.tokenizeQuotedQualifier",i);i<t.length;){s(i);var c=qa(t,i);if(39===c&&!(i+1<t.length&&39===t.charCodeAt(i+1)))return Jc(1,Cc(i),n);if(58!==c)if(F(t,e.leftBracket,i))i=hl(e,t,i,n);else if(Zc(t,i,o,"'",u)>0){var l=$c(t,i,o,"'",u),d=l[0];i=Jc(l[1]-i,mc(i,d),n)}else i=Jc(za(c),vc(i,ja(c)),n);else i=Jc(1,Yc(i),n)}return i}function pl(e,t,r,n,a,i){var o,u,s,c,l=Si(e,t,r,n,a);if(null!=l){var d=l.i,f=n.substring(d,a);return Jc(d-a,l.refStyle===it.A1?(o=a,u=f,s=l.row,c=l.col,Tc(o,u,!(null!=s&&s.kind!==st.Rel||null!=c&&c.kind!==st.Rel),s,c,it.A1,!1)):function(e,t,r,n,a){return void 0===a&&(a=!1),Tc(e,t,!(!1!==r&&null!=r&&r.kind!==st.Abs||!1!==n&&null!=n&&n.kind!==st.Abs),r,n,it.R1C1,a)}(a,f,l.row,l.col,l.enLocale),i)}}function ml(e,t,r,n){var a=n[n.length-1];return null==a||(a.kind!==ic.Sep||a.value!==uc.Dot)&&(F(t,e.decimalSeparator,r)?a.kind===ic.Spaces&&null==(a=n[n.length-2])||a.kind!==ic.Ident&&a.kind!==ic.CellRef&&a.kind!==ic.Right&&(a.kind!==ic.Literal||cc(a.oper)):e.isNumeral(qa(t,r)))}function gl(e,t,r,n){for(var a=e[t],i=t+1;i<e.length;i+=1){var o=e[i];if(o.kind!==r)break;a=n(a,o)}return[a,i]}function Sl(e,t,r,n,a,i){for(var o=function(e,t,r,n,a,i){for(var o,u=[],s=[],c=i,l=Qc("calc.parse.tokenize",c);c<a.length;){l(c);var d=pl(e,r,n,a,c,u);if(null==d){var f=qa(a,c);if(ml(e,a,c,u)){var h=il(e,t,a,c,u);if(null!=h){c=h;continue}}if(34!==f)if(e.isIdentContinue(f)){var v=Xc(a,c,(function(t,r){return e.isIdentContinue(qa(t,r))})),p=v[0];c=Jc(v[1]-c,Oc(e,c,p),u)}else if(35!==f)if(tl(f))c=al(a,c,u);else if(Qa(f)){var m=Xc(a,c,fl);p=m[0];c=Jc(m[1]-c,hc(c,p),u)}else if(40!==f)if(41!==f)if(F(a,e.leftBrace,c))s.push(oc.Brace),c=Jc(e.leftBrace.length,yc(c,e.leftBrace),u);else if(F(a,e.rightBrace,c))s.length>0&&s[s.length-1]===oc.Brace&&s.pop(),c=Jc(e.rightBrace.length,Fc(c,e.rightBrace),u);else if(F(a,e.leftBracket,c))c=hl(e,a,c,u);else if(F(a,e.rightBracket,c))c=Jc(e.rightBracket.length,Ec(c,e.rightBracket),u);else{if(s.length>0&&s[s.length-1]===oc.Brace){if(F(a,e.columnSeparator,c)){c=Jc(e.columnSeparator.length,kc(c,e.columnSeparator),u);continue}if(F(a,e.rowSeparator,c)){c=Jc(e.rowSeparator.length,Nc(c,e.rowSeparator),u);continue}}c=F(a,e.listSeparator,c)?Jc(e.listSeparator.length,Rc(c,e.listSeparator),u):33!==f?39!==f?Jc(za(f),vc(c,ja(f)),u):vl(e,a,c,u):Jc(1,Ac(c),u)}else s.length>0&&s[s.length-1]===oc.Paren&&s.pop(),c=Jc(1,bc(c),u);else s.push(oc.Paren),c=Jc(1,(o=c,gc(ic.Left,o,"(",oc.Paren)),u);else{var g=cl(e,a,c,u);if(null!=g){c=g;continue}c=al(a,c,u)}else c=sl(a,c,u)}else c=d}return u}(e,t,r,n,a,i),u=[],s=0;s<o.length;){var c=o[s];if(c.kind!==ic.Unexpected)u.push(c),s+=1;else{var l=gl(o,s,ic.Unexpected,(function(e,t){var r=e,n=t;return vc(r.start,r.chars+n.chars)})),d=l[0],f=l[1];u.push(d),s=f}}return u.push(fc(a.length)),u}function yl(e,t,r,n){var a;if(function(e){for(var t=e;null!=t;)t=t()}(e(t,r,n,(function(e,t){a=q({output:e,index:t})}),(function(){a=Q(void 0)}))),null==a){var i="calc.parse.runParser: internal error: parser did not call resolve or reject on "+d(t);return _.ULS.assertTag(595980827,s.LogCategory.msoulscat_ES_EWAJS,!1,i)}return a}function bl(e){var t;return function(r,n,a,i,o){var u=null!=t?t:t=e();return function(){return u(r,n,a,i,o)}}}function El(e){return function(t,r,n,a,i){return a(e,r)}}var Fl,Cl=function(e,t,r,n,a){return a};function Rl(){return Cl}function kl(e,t){return function(r,n,a,i,o){return e(r,n,a,(function(e,n){return t(a,e)(r,n,a,i,o)}),o)}}function Nl(e,t){return function(r,n,a,i,o){return e(r,n,a,(function(e,r){return i(t(a,e),r)}),o)}}function Al(e,t){return function(r,n,a,i,o){return e(r,n,a,i,(function(){return t(r,n,a,i,o)}))}}function Tl(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0===e.length?Rl():e.reduce(Al)}function Il(e,t){return function(r,n,a,i,o){return e(r,n,a,i,(function(){return i(t,n)}))}}function Ol(e){return function(t,r,n,a,i){return e(t,r,n,(function(){return a(!0,r)}),i)}}function Ml(e){return function(t,r,n,a,i){return e(t,r,n,i,(function(){return a(!0,r)}))}}function wl(e,t){return function(r,n,a,i,o){var u=r[n];if(null==u)return o;var s=e(a,u);return null==s?o:i(s,n+t)}}function Dl(e){return wl(e,1)}function _l(e){return wl(e,0)}function Ll(e){return function(t,r,n,a,i){var o=t[r],u=t[r+1];if(null==o||null==u)return i;var s=e(n,o,u);return null==s?i:a(s,r+1)}}function Ul(e,t){return function(r,n,a,i,o){return e(r,n,a,(function(e,r){var n=t(a,e);return null==n?o:i(n,r)}),o)}}function xl(e,t){return r=e,n=function(e,t,r){return r.push(t),r},a=t,function(e,t,i,o,u){var c=a,l=t;function f(){return r(e,l,i,h,v)}function h(t,r){if(r<=l){var a=d(e),o="calc.parse.reduce: internal error: no progress made at index "+l+" on "+a;return _.ULS.assertTag(595980829,s.LogCategory.msoulscat_ES_EWAJS,!1,o)}return c=n(i,t,c),l=r,f}function v(){return o(c,l)}return f};var r,n,a}function Bl(e){return function(t,r,n,a,i){return xl(e,[])(t,r,n,a,i)}}function Wl(e,t){return void 0===t&&(t=e),kl(e,(function(e,r){return xl(t,[r])}))}function Pl(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(0===e.length)return El([]);if(1===e.length)return Nl(e[0],(function(e,t){return[t]}));var r=e.length;return function(t,n,a,i,o){var u=n,s=[];function c(){return e[s.length](t,u,a,l,o)}function l(e,t){return u=t,s.push(e),s.length<r?c:i(s,u)}return c}}function Vl(e,t){return Nl(Pl(e,t),(function(e,t){return t[0]}))}function Gl(e,t){return Nl(Pl(e,t),(function(e,t){return t[1]}))}function Hl(e){return Nl(e,(function(e,t){return ve([],t)}))}function jl(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Hl(Pl.apply(void 0,e))}function Kl(e,t){var r=e.spans[t.label];if(null==r){var n="calc.parse.getNodeSpan: internal error: expected node to have a span; given "+d(t);return _.ULS.assertTag(595980824,s.LogCategory.msoulscat_ES_EWAJS,!1,n)}return r}function Yl(e,t,r,n,a){var i=e.label;return e.label+=1,e.spans[i]=Wt(t,r,n,a),i}function ql(e,t,r){return function(n,a,i,o,u){var s=e(i);return r(n,a,i,(function(e,r){return t(i,s),o(e,r)}),(function(){return t(i,s),u}))}}function zl(e,t){return ql((function(t){var r=t.delim;return t.delim=e,r}),(function(e,t){return e.delim=t}),t)}function Jl(e){return ql((function(e){var t=e.cellRefMustBeCellRefNode;return e.cellRefMustBeCellRefNode=!0,t}),(function(e,t){return e.cellRefMustBeCellRefNode=t}),e)}function Ql(e){return e.kind===ic.Sep&&e.value===uc.Dot}function Xl(e){return e.kind===ic.Operator&&e.value===pa.Range}function Zl(e){return e.kind===ic.Literal&&e.oper.kind===bt.Error&&e.oper.type===Kn.REF}function $l(e){return e.kind===ic.Left&&e.value===oc.Bracket}function ed(e){return(e.kind===ic.Left||e.kind===ic.Right)&&e.value===oc.Bracket}!function(e){e[e.Union=1]="Union",e[e.Arg=2]="Arg"}(Fl||(Fl={}));var td=Il(Dl((function(e,t){return t.kind===ic.Spaces?t.chars:void 0})),""),rd=function(e,t,r,n,a){var i=e[t];if(null==i){var o="calc.parse.pStart: internal error: expected token at "+t+" in "+d(e);return _.ULS.assertTag(589825166,s.LogCategory.msoulscat_ES_EWAJS,!1,o)}return n(i.start,t)};function nd(e){return Dl((function(t,r){return r.kind===ic.Sep&&r.value===e?r:void 0}))}function ad(e){return Dl((function(t,r){return r.kind===ic.Left&&r.value===e?r:void 0}))}function id(e){return Dl((function(t,r){return r.kind===ic.Right&&r.value===e?r:void 0}))}var od,ud,sd=nd(uc.List),cd=nd(uc.Row),ld=nd(uc.Col),dd=nd(uc.Qual),fd=nd(uc.Dot),hd=ad(oc.Paren),vd=id(oc.Paren),pd=ad(oc.Brace),md=id(oc.Brace),gd=ad(oc.SQuote),Sd=id(oc.SQuote),yd=ad(oc.Bracket),bd=id(oc.Bracket),Ed=Ll((function(e,t,r){return Ql(t)&&!$l(r)?t:void 0})),Fd=Dl((function(e,t){return Xl(t)?t:void 0})),Cd=Dl((function(e,t){return function(e){return e.kind===ic.Operator&&e.value===pa.At}(t)?t:void 0})),Rd=Dl((function(e,t){return t.kind===ic.Escape?t:void 0})),kd=Dl((function(e,t){return t.kind===ic.End?t:void 0})),Nd=Nl(Wl(Dl((function(e,t){return t.isIdentContinue?t:void 0}))),(function(e,t){var r=t[0];return 1===t.length?r:mc(r.start,t.map((function(e){return e.chars})).join(""))})),Ad=Ul(Nd,(function(e,t){return e.localeInfo.isIdentStart(qa(t.chars,0))?t:void 0})),Td=Dl((function(e,t){return ed(t)||t.kind===ic.End?void 0:t})),Id=bl((function(){return Hl(Bl(Tl(Wl(Td),jl(Pl(yd),Id,Il(Pl(bd),[])))))})),Od=Nl(Pl(yd,Id,rd,Il(bd,void 0)),(function(e,t){t[0];var r=t[1],n=t[2],a=t[3];return r.push(fc(n)),[r,void 0!==a]}));function Md(e,t){return{kind:ud.MaybeWSFTerm,node:e,whole:t}}function wd(e){return e.kind!==ic.Operator&&e.kind!==ic.Sep&&e.kind!==ic.End&&e.kind!==ic.Spaces&&!(e.kind in ud)}function Dd(e,t){return wd(t=t.kind===ud.MaybeWSFTerm?t.node:t)?Kl(e,t).start:t.start}!function(e){e.ArgsTerm="ArgsTerm",e.FieldRefTerm="FieldRefTerm",e.StructRefTerm="StructRefTerm",e.MaybeWSFTerm="MaybeWSFTerm"}(ud||(ud={}));var _d=Il(Dl((function(e,t){return t.kind===ic.Spaces?t.chars:void 0})),""),Ld=function(e,t,r,n,a){var i=e[t];if(null==i){var o="calc.parse.pStart: internal error: expected term at "+t+" in "+d(e);return _.ULS.assertTag(589825160,s.LogCategory.msoulscat_ES_EWAJS,!1,o)}return n(Dd(r,i),t)};function Ud(e){return Nl(Pl(_d,Ld,Dl(e),Ld,_d),(function(e,t){var r=t[0],n=t[1];return Yt(t[2],Yl(e,n,t[3],r,t[4]))}))}function xd(e){return Nl(Pl(_d,Ld,Dl(e),Ld),(function(e,t){var r=t[0],n=t[1];return Yt(t[2],Yl(e,n,t[3],r,""))}))}function Bd(e){return Nl(Pl(Ld,Dl(e),Ld,_d),(function(e,t){var r=t[0];return Yt(t[1],Yl(e,r,t[2],"",t[3]))}))}var Wd=Ud((function(e,t){return t.kind!==ic.Operator||t.value!==pa.Add&&t.value!==pa.Sub?void 0:t.value})),Pd=Bd((function(e,t){if(t.kind===ic.Operator){if(t.value===pa.Add)return pa.Pos;if(t.value===pa.Sub)return pa.Neg}})),Vd=Bd((function(e,t){return t.kind===ic.Operator&&t.value===pa.At?t.value:void 0})),Gd=xd((function(e,t){return t.kind===ic.Operator&&t.value===pa.Pound?t.value:void 0})),Hd=Dl((function(e,t){return t.kind===ud.StructRefTerm?t:void 0})),jd=Ud((function(e,t){return t.kind!==ic.Operator||t.value!==pa.Mul&&t.value!==pa.Div?void 0:t.value})),Kd=Ud((function(e,t){return t.kind===ic.Operator&&t.value===pa.Pow?t.value:void 0})),Yd=xd((function(e,t){return t.kind===ic.Operator&&t.value===pa.Percent?t.value:void 0})),qd=Ud((function(e,t){return t.kind===ic.Operator&&t.value===pa.Concat?t.value:void 0})),zd=Ud((function(e,t){return t.kind===ic.Operator&&t.value>=pa.Eq&&t.value<=pa.Ge?t.value:void 0})),Jd=Ud((function(e,t){return t.kind===ic.Operator&&t.value===pa.Range?t.value:void 0})),Qd=Ud((function(e,t){return t.kind===ic.Operator&&t.value===pa.Union?t.value:void 0})),Xd=Ll((function(e,t,r){if(t.kind===ic.Spaces&&r.kind!==ic.End&&(r.kind!==ic.Operator||r.value===pa.At)&&!Ql(r)){var n=Yl(e,t.start,Dd(e,r),t.chars,"");return Yt(pa.Isect,n)}})),Zd=Dl((function(e,t){return Ql(t)?t:void 0})),$d=Dl((function(e,t){return t.kind===ud.ArgsTerm?t:void 0})),ef=Dl((function(e,t){return t.kind===ud.ArgsTerm||t.kind===ud.FieldRefTerm?t:void 0})),tf=((od={})[la.LET]=w.CalcLetFunction,od[la.LETREC]=w.CalcLetRecFunction,od[la.LAMBDA]=w.CalcLambdaFunctions,od),rf=Dl((function(e,t){if(t.kind===ud.MaybeWSFTerm&&void 0!==t.whole){var r=hn(e.localeInfo,t.whole);if(void 0===r)return;x("calc.parse.parseWSFName: unexpected UDF",r!==la._UDF);var n=tf[r];if(void 0!==n&&!Y(n))return;return qt(r,t.whole,t.node.label)}})),nf=function(e,t,r){return t===r.length-1||t%2==1||Wr(e)},af=function(e,t,r){return t===r.length-1||Wr(e)},of=Nl(Pl(rf,$d),(function(e,t){var r=t[0],n=t[1],a=n.nodes;switch(r.id){case la.LET:case la.LETREC:if(a.length>=3&&a.length%2==1&&a.every(nf)){r.id;for(var i=[],o=0;o+1<a.length;o+=2)i.push([a[o],a[o+1]]);var u=a[a.length-1],s=Yl(e,Kl(e,r).start,n.end,"","");return jt(r,i,u,n.isClosed,s)}break;case la.LAMBDA:if(a.length>=1&&a.every(af)){r.id;var c=a.slice(0,a.length-1);u=a[a.length-1],s=Yl(e,Kl(e,r).start,n.end,"","");return Kt(r,c,u,n.isClosed,s)}}return lf(e,r,a,n.isClosed,n.end)}));function uf(e,t,r){return Nl(Pl(Bl(e),t),(function(e,t){var n=t[0],a=t[1];return n.reduceRight(r(e),a)}))}function sf(e,t,r){return Nl(Pl(e,Bl(t)),(function(e,t){var n=t[0];return t[1].reduce(r(e),n)}))}function cf(e){return function(t,r){var n=r[0],a=r[1],i=Kl(e,t).start,o=Kl(e,a).end;return Ht(n,[t,a],!0,Yl(e,i,o,"",""))}}function lf(e,t,r,n,a){return Ht(t,r,n,Yl(e,Kl(e,t).start,a,"",""))}function df(e){return function(t,r){switch(r.kind){case ud.ArgsTerm:return lf(e,t,r.nodes,r.isClosed,r.end);case ud.FieldRefTerm:var n=Kl(e,t).start,a=Yl(e,n,r.end,"",""),i=Kl(e,r.rhs),o=i.start,u=i.end,s=i.pre,c=i.post,l=!r.rhs.isBracketed&&jr(t,s);if(Vr(t)){var d=Yl(e,o,o,"",""),f=Vt(da,!0,d),h=Yl(e,o,u,s,c);return dr(yt.FieldRef,[t,rr(f,r.rhs,l,h)],a)}return rr(t,r.rhs,l,a);case ud.StructRefTerm:n=Kl(e,t).start,a=Yl(e,n,r.end,"","");return t.kind===pt.Name||Pr(t)?ar(t.kind===pt.Name?t:void 0,r.rhs,a):dr(yt.StructRef,[t,ar(void 0,r.rhs,Yl(e,r.start,r.end,"",""))],a);case pt.Operator:return lf(e,r,[t],!0,Kl(e,r).end)}}}function ff(e){var t=!0;return function(r,n){var a=Kl(e,n).start,i=Kl(e,r).end,o=Yl(e,a,i,"","");if((n.id===pa.Pos||n.id===pa.Neg)&&t&&(t=!1,Vr(r)&&""===Kl(e,n).post))return Vt(n.id===pa.Pos?r.oper:e.mathpack.neg(r.oper),!0,o);return Ht(n,[r],!0,o)}}var hf=Dl((function(e,t){return t.kind===ud.MaybeWSFTerm?t.node:wd(t)?t:void 0})),vf=Nl(Pl(_d,Zd,Ld,_d),(function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3];return dr(yt.Operator,n.chars,Yl(e,n.start,a,r,i))})),pf=Nl(Vd,(function(e,t){return dr(yt.Operator,function(e,t){var r;return null!==(r=lu(e.localeInfo,t,""))&&void 0!==r?r:"op:"+t}(e,t.id),t.label)})),mf=Nl(Pl(Ld,Bl(Tl(hf,vf,pf)),Ld),(function(e,t){var r=t[0],n=t[1],a=t[2];if(1===n.length)return n[0];var i=Yl(e,r,a,"","");return 0===n.length?Vt(da,!0,i):dr(yt.Sequence,n,i)})),gf=sf(bl((function(){return Tl(of,Gl(Ol(Vd),Ef),Gl(Ol(Pd),Cf),mf)})),Tl(Gd,Hd),df),Sf=sf(gf,Pl(Jd,gf),cf),yf=sf(Sf,Pl(Xd,Sf),cf),bf=sf(yf,ef,df),Ef=uf(Vd,bf,ff),Ff=sf(Ef,Pl(Qd,Ef),cf),Cf=uf(Pd,Ff,ff),Rf=sf(Cf,Yd,df),kf=sf(Rf,Pl(Kd,Rf),cf),Nf=sf(kf,Pl(jd,kf),cf),Af=sf(Nf,Pl(Wd,Nf),cf),Tf=sf(Af,Pl(qd,Af),cf),If=sf(Tf,Pl(zd,Tf),cf);var Of=Nl(Wl(Dl((function(e,t){return t.isIdentContinue&&!function(e){return e.kind===ic.Literal&&e.oper.kind===bt.Boolean}(t)&&t.chars.length>0&&46!==t.chars.charCodeAt(0)?t.chars:void 0})),Dl((function(e,t){return t.isIdentContinue||Ql(t)?t.chars:void 0}))),(function(e,t){return t.join("")})),Mf=Dl((function(e,t){return t.kind===ic.Ident?t.chars:void 0})),wf=/'/g;function Df(e,t,r,n,a,i){var o,u;if(null==t)null==n?(o=Ot(r,a,i),u=r):(o=Mt(r,n,void 0,a,i),u=r+":"+n);else{var s=e.localeInfo.leftBracket+t.document+e.localeInfo.rightBracket;null==n?(o=It(r,t,a,i),u=""+s+r):(o=Mt(r,n,t,a,i),u=""+s+r+":"+n)}return[o,a?"'"+u.replace(wf,"")+"'":u]}var _f=Dl((function(e,t){return ed(t)||t.kind===ic.Escape||t.kind===ic.End?void 0:t})),Lf=Tl(Gl(Rd,_f),_f),Uf=Nl(Pl(rd,yd,Wl(Lf),bd,rd),(function(e,t){var r=t[0],n=(t[1],t[2]),a=(t[3],t[4]);return Tt(n.map((function(e){return e.chars})).join(""),void 0,!1,Yl(e,r,a,"",""))})),xf=bl((function(){return Y(w.CalcStructuredReferences)?Uf:Rl()})),Bf=Nl(Pl(rd,Il(xf,void 0),Of,Il(Gl(Fd,Of),void 0),rd),(function(e,t){var r=t[0];return Df(e,t[1],t[2],t[3],!1,Yl(e,r,t[4],"",""))})),Wf=Nl(Pl(gd,Il(xf,void 0),Mf,Il(Gl(Fd,Mf),void 0),Sd,rd),(function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=(t[4],t[5]);return Df(e,n,a,i,!0,Yl(e,r.start,o,"",""))})),Pf=Nl(Pl(gd,Bl(Dl((function(e,t){return t.kind===ic.End||t.kind===ic.Right&&t.value===oc.SQuote?void 0:t.chars}))),Il(Pl(Sd,Il(Vl(dd,td),void 0)),[void 0,void 0]),rd),(function(e,t){var r=t[0],n=t[1],a=t[2],i=a[0],o=a[1],u=t[3],s="'"+n.join("")+(void 0!==i?"'":"")+(void 0!==o?"!":""),c=Yl(e,r.start,u,"","");return[dr(yt.Qualifier,s,c),s]})),Vf=Ll((function(e,t,r){if(Zl(t))return[Nt(Yl(e,t.start,r.start,"","")),t.chars]})),Gf=Nl(Pl(Tl(Bf,Wf,_l((function(e,t){return[At(Yl(e,t.start,t.start,"","")),""]}))),dd,td),(function(e,t){var r=t[0];return[r[0],r[1]+"!"]})),Hf=Tl(Vf,Gf,Pf);function jf(e,t){return e.refStyle===t.refStyle&&!t.isBadLocale}function Kf(e){return e.refStyle===it.R1C1||"object"==typeof e.row&&"object"==typeof e.col}function Yf(e,t){return t.kind===ic.CellRef&&jf(e,t)&&Kf(t)}var qf=wt(st.Rel,0);function zf(e){return!1===e?qf:e}function Jf(e,t){var r=e.refStyle===it.R1C1&&!e.isIdentContinue;if(null!=e.row&&null!=e.col)return _t(zf(e.row),zf(e.col),r,t);if(null!=e.row){var n=zf(e.row);return Ut(n,n,r,t)}if(null!=e.col){var a=zf(e.col);return xt(a,a,r,t)}var i="calc.parse.cellRefToken2cellRef: bad token "+d(e);return _.ULS.assertTag(589825159,s.LogCategory.msoulscat_ES_EWAJS,!1,i)}function Qf(e,t){return t.isIdentContinue&&e.localeInfo.isIdentStart(qa(t.chars,0))}var Xf,Zf=Dl((function(e,t){return Yf(e,t)&&!Qf(e,t)||Zl(t)?t:void 0})),$f=Dl((function(e,t){return Yf(e,t)&&Qf(e,t)?t:void 0})),eh=Nl(Pl(Tl(Zf,(Xf=function(e){return e.cellRefMustBeCellRefNode?$f:Vl($f,Ml(Tl(Nd,Ed)))},function(e,t,r,n,a){return Xf(r)(e,t,r,n,a)})),rd),(function(e,t){var r=t[0],n=t[1],a=r.kind===ic.CellRef?Jf(r,Yl(e,r.start,n,"","")):Dt(Yl(e,r.start,n,"","")),i=r.kind===ic.CellRef?r.chars:void 0;return Md(tr(a,void 0,Yl(e,r.start,n,"","")),i)}));var th=Ll((function(e,t,r){return t.kind!==ic.CellRef||!jf(e,t)||function(e,t,r){return r.kind===ic.Left&&r.value===oc.Paren&&t.isIdentContinue&&null!=hn(e.localeInfo,t.chars)}(e,t,r)||r.isIdentContinue?void 0:[t,r.start]})),rh=Tl(kl(Pl(th,td,Fd,td,th),(function(e,t){var r=t[0],n=r[0],a=r[1],i=t[1],o=(t[2],t[3]),u=t[4],s=u[0],c=u[1],l=Yl(e,n.start,a,"",i),d=Yl(e,s.start,c,o,""),f=Jf(n,l),h=Jf(s,d),v=void 0;if(f.kind===ut.Single&&h.kind===ut.Single)v=Lt(f,h,m=Yl(e,n.start,c,"",""));else if(0===i.length&&0===o.length)if(f.kind===ut.Row&&h.kind===ut.Row){var p=f.isBracketed||h.isBracketed,m=Yl(e,n.start,c,"","");v=Ut(f.row1,h.row1,p,m)}else if(f.kind===ut.Col&&h.kind===ut.Col){p=f.isBracketed||h.isBracketed,m=Yl(e,n.start,c,"","");v=xt(f.col1,h.col1,p,m)}if(null==v)return Rl();var g=Md(tr(v,void 0,Yl(e,n.start,c,"","")),void 0);return n.isIdentContinue&&s.isIdentContinue?_l((function(e,t){return t.kind===ic.Sep&&t.value===uc.Qual?void 0:g})):El(g)})),eh);var nh=Tl(Dl((function(e,t){return t.kind===ic.Ident&&e.localeInfo.isIdentStart(qa(t.chars,0))||t.kind===ic.CellRef&&Qf(e,t)?t:void 0})),Vl(Dl((function(e,t){return t.kind===ic.Literal&&t.oper.kind===bt.Boolean?t:void 0})),Ol(Ed))),ah=_l((function(e,t){return $l(t)})),ih=Nl(Pl(Wl(nh,Nd),Bl(Tl(Nd,Ed)),ah,rd),(function(e,t){var r,n,a,i,o,u,s,c,l,d,f=t[0],h=t[1],v=t[2],p=t[3],m=f[0],g=1===f.length&&(null===(r=h[0])||void 0===r?void 0:r.kind)===ic.Sep,S=m.kind!==ic.CellRef||(d=m).refStyle===it.A1&&null==d.row&&"object"==typeof d.col&&d.col.kind===st.Rel||function(e,t){return t.refStyle===it.A1&&e.refStyle===it.A1&&t.isIdentContinue||t.refStyle===it.R1C1&&gi(t.row,t.col)}(e,m)&&g;if(v||!Y(w.CalcDotOperator)||function(e,t,r){return 0===r.length||1===t.length&&t[0].kind===ic.Literal||r.length%2!=0||r.some((function(t,r){return r%2==0?t.kind!==ic.Sep:t.kind===ic.Sep||!e.localeInfo.isIdentStart(qa(t.chars,0))}))}(e,f,h)){var y=Jt(Qt(ie(f,h).map((function(e){return e.chars})).join(""),S,Yl(e,m.start,p,"","")),void 0,Yl(e,m.start,p,"",""));return Md(y,y.whole)}var b,E=S,F=0;if(1===f.length&&m.kind===ic.CellRef){var C=Yl(e,m.start,null!==(a=null===(n=h[F])||void 0===n?void 0:n.start)&&void 0!==a?a:p,"","");if(jf(e,m))if(Kf(m)){b=Xt(Jf(m,Yl(e,m.start,null!==(o=null===(i=h[F])||void 0===i?void 0:i.start)&&void 0!==o?o:p,"","")),m.chars,C)}else b=Qt(m.chars,E,C);else E=!1,b=Qt(m.chars,E,C)}else{var R=f.map((function(e){return e.chars})).join("");0===e.localeInfo.stringCompareCI(R,"_xlpm")&&F+1<h.length&&(R+="."+h[F+1].chars,F+=2),b=Qt(R,E,C=Yl(e,m.start,null!==(s=null===(u=h[F])||void 0===u?void 0:u.start)&&void 0!==s?s:p,"",""))}for(var k=b;F+1<h.length;F+=2){var N=h[F+1],A=null!==(l=null===(c=h[F+2])||void 0===c?void 0:c.start)&&void 0!==l?l:p;k=Zt(k,N.chars,F+2>=h.length?S:E,Yl(e,m.start,A,"",""))}k.kind===mt.CellRefNamePart&&U("calc.parse.pUnqualName: expected lhs.kind !== NamePartKind.CellRefNamePart");var T=Jt(k,void 0,Yl(e,m.start,p,"",""));return Md(T,T.whole)})),oh=Il(Tl(rh,ih),{node:void 0}),uh=kl(Hf,(function(e,t){var r=t[0],n=t[1];return Nl(r.kind===ot.SheetRange?Jl(r.isQuoted?oh:rh):r.kind===ot.Error?Jl(oh):oh,(function(e,t){var a=t.node;if(null==a)return r.kind===ot.Error?Vt($n,!0,r.label):r.kind===pt.Bad?r:dr(yt.Qualifier,n,r.label);var i=Kl(e,r).start,o=Kl(e,a).end;if(a.kind===pt.Name){var u=Yl(e,i,o,"","");if(r.kind===pt.Bad||r.kind===ot.Error||r.kind===ot.SheetRange){var s=r.kind===pt.Bad?r:dr(yt.Qualifier,n,r.label);return dr(yt.Sequence,[s,a],u)}return Jt(a.parts,r,u)}var c=Yl(e,i,o,"","");if(r.kind===pt.Bad||r.kind===ot.Document){s=r.kind===pt.Bad?r:dr(yt.Qualifier,n,r.label);return dr(yt.Sequence,[s,a],c)}return r.kind===ot.Ident&&(r=It(r.name,void 0,r.isQuoted,r.label)),tr(a.ref,r,c)}))})),sh=Nl(Tl(rh,ih),(function(e,t){return t.node.kind===pt.CellRef&&t.node.ref.kind===ut.Error?Vt($n,!0,t.node.label):t})),ch=Tl(uh,sh);var lh=Nl(Pl(Tl(Dl((function(e,t){return t.kind===ic.Literal&&t.oper.kind!==bt.Boolean?t:t.kind===ic.CellRef&&function(e){return e.refStyle===it.A1&&null==e.col&&"object"==typeof e.row&&e.row.kind===st.Rel}(t)?Ic(t.start,t.chars,e.mathpack.fromNumber(t.row.index+e.origin.row+1)):void 0})),Vl(Dl((function(e,t){return t.kind===ic.Literal&&t.oper.kind===bt.Boolean?t:void 0})),Ml(Ed))),rd),(function(e,t){var r=t[0],n=t[1],a=Yl(e,r.start,n,"","");if(r.oper.kind===sc.BadNumber)return dr(yt.Literal,r.chars,a);if(Yr(r.oper)&&r.oper.value.length>32767)return dr(yt.Literal,r.chars,a);var i=Vt(r.oper,r.hasRight,a);return qr(r.oper)?Md(i,r.chars):i})),dh=Nl(Pl(Wl(Tl(Dl((function(e,t){return ed(t)||t.kind===ic.Unexpected||t.kind===ic.Escape||t.kind===ic.End?void 0:t.chars})),Gl(Rd,Dl((function(e,t){return t.kind!==ic.Ident||t.chars!==e.localeInfo.leftBracket&&t.chars!==e.localeInfo.rightBracket&&"'"!==t.chars?void 0:t.chars}))))),kd),(function(e,t){var r=t[0];t[1];return r.join("")})),fh=Ul(Od,(function(e,t){var r=t[0],n=t[1],a=yl(dh,r,0,e);return X(a)?[a.value.output,!0,n]:void 0})),hh=Nl(Ad,(function(e,t){return[t.chars,!1,!0]})),vh=Nl(Pl(rd,td,fd,Tl(hh,fh),rd),(function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=i[0],u=i[1],s=i[2],c=t[4],l=nr(o,u,s,Yl(e,a.start,c,n,""));return function(e,t,r,n){return{kind:ud.FieldRefTerm,hasDotPreSpace:e,rhs:t,start:r,end:n}}(n.length>0,l,r,c)})),ph=bl((function(){return Y(w.CalcDotOperator)?vh:Rl()})),mh=Nl(Wl(Dl((function(e,t){return t.isIdentContinue||t.kind===ic.Spaces?t:void 0}))),(function(e,t){var r=t[0];return 1===t.length?r:mc(r.start,t.map((function(e){return e.kind===ic.Escape?"":e.chars})).join(""))})),gh=Nl(Wl(Dl((function(e,t){return t.isIdentContinue||t.kind===ic.Spaces||t.kind===ic.Escape||function(e){return e.kind===ic.Sep&&e.value===uc.List}(t)||Xl(t)?t:void 0}))),(function(e,t){var r=t[0];return 1===t.length?r:mc(r.start,t.map((function(e){return e.kind===ic.Escape?"":e.chars})).join(""))})),Sh=Dl((function(e,t){return t.kind===ic.SpecialRef?t:void 0})),yh=Tl(Nl(Pl(rd,Sh,rd),(function(e,t){var r=t[0],n=t[1],a=t[2];return ir(n.value,!1,!0,Yl(e,r,a,"",""))})),Nl(Pl(rd,yd,Sh,Il(bd,void 0),rd),(function(e,t){var r=t[0],n=(t[1],t[2]),a=t[3],i=t[4];return ir(n.value,!0,void 0!==a,Yl(e,r,i,"",""))}))),bh=Nl(Pl(rd,mh,rd),(function(e,t){var r=t[0],n=t[1],a=t[2];return or(n.chars,!1,!0,Yl(e,r,a,"",""))})),Eh=Nl(Pl(rd,yd,gh,Il(bd,void 0),rd),(function(e,t){var r=t[0],n=(t[1],t[2]),a=t[3],i=t[4];return or(n.chars,!0,void 0!==a,Yl(e,r,i,"",""))})),Fh=Nl(Pl(rd,gh,rd),(function(e,t){var r=t[0],n=t[1],a=t[2];return or(n.chars,!1,!0,Yl(e,r,a,"",""))})),Ch=Tl(bh,Eh),Rh=Nl(Pl(rd,Ch,Fd,Ch,rd),(function(e,t){var r=t[0],n=t[1];t[2];return ur(n,t[3],Yl(e,r,t[4],"",""))})),kh=Tl(Rh,Ch),Nh=Nl(Tl(Pl(rd,yh,sd,kh,rd),Pl(rd,kh,sd,yh,rd),Pl(rd,yh,sd,yh,rd)),(function(e,t){var r=t[0],n=t[1];t[2];return sr(n,t[3],Yl(e,r,t[4],"",""))})),Ah=Nl(Pl(rd,Cd,Il(kh,void 0),rd),(function(e,t){var r=t[0];t[1];return cr(t[2],Yl(e,r,t[3],"",""))})),Th=Tl(Vl(Fh,kd),Vl(Nh,kd),Vl(Ah,kd),Vl(Rh,kd),Vl(yh,kd),Vl(Eh,kd)),Ih=Ul(Pl(rd,Od,rd),(function(e,t){var r=t[0],n=t[1],a=n[0],i=n[1],o=t[2],u=yl(Th,a,0,e);return X(u)?function(e,t,r){return{kind:ud.StructRefTerm,rhs:e,start:t,end:r}}(lr(u.value.output,i,Yl(e,r,o,"","")),r,o):void 0})),Oh=bl((function(){return Y(w.CalcStructuredReferences)?Ih:Rl()})),Mh=Nl(Pl(td,bl((function(){return Hh})),td),(function(e,t){var r=t[0],n=t[1],a=t[2],i=Kl(e,n);return i.pre=r,i.post=a,n})),wh=Nl(Pl(hd,zl({delimId:oc.Paren,listSep:Fl.Union},Mh),Il(vd,void 0),rd),(function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3];return zt(n,void 0!==a,Yl(e,r.start,i,"",""))})),Dh=Wl(Mh,Gl(ld,Mh)),_h=Wl(Dh,Gl(cd,Dh));function Lh(e){return Ll((function(t,r,n){return e(r)?dr(yt.Unexpected,r.chars,Yl(t,r.start,n.start,"","")):void 0}))}var Uh=Tl(ch,lh,wh,Nl(Pl(pd,zl({delimId:oc.Brace,listSep:Fl.Union},_h),Il(md,void 0),rd),(function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3];return Gt(n,void 0!==a,Yl(e,r.start,i,"",""))})),ph,Oh,Nl(Pl(rd,Lh($l),zl({delimId:oc.Bracket,listSep:Fl.Union},Mh),Il(Lh((function(e){return e.kind===ic.Right&&e.value===oc.Bracket})),void 0),rd),(function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=t[4],u=[n,a];return null!=i&&u.push(i),dr(yt.Sequence,u,Yl(e,r,o,"",""))})),Ll((function(e,t,r){switch(t.kind){case ic.End:case ic.Operator:case ic.Spaces:return;case ic.Sep:if(t.value===uc.Dot||t.value!==uc.Qual&&(e.delim.delimId===oc.Brace||t.value!==uc.Col&&t.value!==uc.Row))return;break;case ic.Right:if(t.value===e.delim.delimId)return}return dr(t.kind===ic.CellRef?yt.CellRef:yt.Unexpected,t.chars,Yl(e,t.start,r.start,"",""))}))),xh=Nl(Pl(hd,zl({delimId:oc.Paren,listSep:Fl.Arg},Wl(Mh,Gl(sd,Mh))),Il(vd,void 0),rd),(function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3];return function(e,t,r,n){return{kind:ud.ArgsTerm,nodes:e,isClosed:t,start:r,end:n}}(n,void 0!==a,r.start,i)})),Bh=Dl((function(e,t){return t.kind!==ic.Operator||t.value!==pa.Percent&&t.value!==pa.Pound?void 0:t}));var Wh=Dl((function(e,t){return t.kind===ic.Operator||Ql(t)?t:function(e,t){return t.kind===ic.Sep&&t.value===uc.List&&e.delim.listSep===Fl.Union?Mc(t.start,e.localeInfo.listSeparator,pa.Union):void 0}(e,t)})),Ph=Dl((function(e,t){return t.kind===ic.Spaces?t:void 0})),Vh=Tl(Wl(Tl(Uh,Bh),Tl(xh,ph,Oh)),Pl(Wh)),Gh=Hl(Wl(Vh,jl(Il(Pl(Ph),[]),Vh))),Hh=Nl(Pl(Il(Gh,void 0),rd),(function(e,t){var r=t[0],n=t[1];if(null==r){var a=Yl(e,n,n,"","");return Vt(da,!0,a)}var i=r;return i.push(fc(n)),function(e,t){var r=t.length-1;if(1===r&&wd(t[0]))return t[0];if(r<1){var n="calc.parse.runTermParser: internal error: expected at least 1 term";return _.ULS.assertTag(589825161,s.LogCategory.msoulscat_ES_EWAJS,!1,n)}if(t[0].kind===ic.Spaces){n="calc.parse.runTermParser: internal error: array[0].kind === Spaces in "+d(t);return _.ULS.assertTag(589825162,s.LogCategory.msoulscat_ES_EWAJS,!1,n)}if(r-1>=0&&t[r-1].kind===ic.Spaces){n="calc.parse.runTermParser: internal error: array[n-1].kind === Spaces in "+d(t);return _.ULS.assertTag(589825163,s.LogCategory.msoulscat_ES_EWAJS,!1,n)}if(t[r].kind!==ic.End){n="calc.parse.runTermParser: internal error: array[n].kind !== End in "+d(t);return _.ULS.assertTag(589825164,s.LogCategory.msoulscat_ES_EWAJS,!1,n)}for(;;){var a=yl(If,t,0,e);if(X(a)&&a.value.index>=r)return a.value.output;if(!X(a)||0===a.value.index||1===a.value.index&&wd(t[0])){n="calc.parse.runTermParser: internal error: consumed "+(X(a)?a.value.index:0)+" out of "+r+" in "+d(t);return _.ULS.assertTag(589825165,s.LogCategory.msoulscat_ES_EWAJS,!1,n)}r=(t=ie([a.value.output],t.slice(a.value.index))).length-1}}(e,i)}));function jh(e,t,r,n,a,i){var o=i.length-1;if(o<0){var u="calc.parse.runTokenParser: internal error: expected at least 1 token";return _.ULS.assertTag(589825167,s.LogCategory.msoulscat_ES_EWAJS,!1,u)}if(i[o].kind!==ic.End){u="calc.parse.runTokenParser: internal error: array[n] !== End in "+d(i);return _.ULS.assertTag(589825168,s.LogCategory.msoulscat_ES_EWAJS,!1,u)}var c=function(e,t,r,n,a){return{localeInfo:e,mathpack:t,refStyle:r,lexicalKind:n,origin:a,delim:{delimId:void 0,listSep:Fl.Union},cellRefMustBeCellRefNode:!1,label:1,spans:[]}}(e,t,r,n,a),l=yl(Mh,i,0,c);if(!X(l)||l.value.index<o){u="calc.parse.runTokenParser: internal error: consumed "+(X(l)?l.value.index:0)+" out of "+o+" in "+d(i);return _.ULS.assertTag(589825169,s.LogCategory.msoulscat_ES_EWAJS,!1,u)}var f=l.value.output;return Bt(f,c.spans,Ls(e,f))}var Kh={getDocumentLoc:function(){return U("calc.lang.printFormula: default  getDocumentLoc")},getSheetIndex:function(){return U("calc.lang.printFormula: default  getSheetIndex")},getSheetName:function(){return U("calc.lang.printFormula: default  getSheetName")},getNameLoc:function(){return U("calc.lang.printFormula: default  getNameLoc")},getUserDefinedFuncLoc:function(){return U("calc.lang.printFormula: default  getUserDefinedFuncLoc")},getSheetRangeIndexes:function(){return U("calc.lang.printFormula: default  getSheetRangeIndexes")},getContainingTable:function(){return U("calc.lang.printFormula: default  getContainingTable")},getStructRefColumn:function(){return U("calc.lang.printFormula: default  getStructRefColumn")},getStructRefSpecialRef:function(){return U("calc.lang.printFormula: default  getStructRefSpecialRef")}};var Yh={"=":1,"+":0,"-":0,"@":-1};function qh(e,t,r){var n,a,i,o;try{var u=r[0],s=null!=u?Yh[u]:void 0;if(null==s)return Q(ac("first character is not '=', '+', '-' or '@'"));if(s<0)return Q(un(["Lotus 1-2-3 syntax"]));var c=null!==(a=null===(n=t.config)||void 0===n?void 0:n.localeInfo)&&void 0!==a?a:e.config.localeInfo,l=null!==(o=null===(i=t.config)||void 0===i?void 0:i.refStyle)&&void 0!==o?o:e.config.refStyle,d=e.config.mathpack,f=Sl(c,d,l,t.originGridCell.value,r,s);return q(jh(c,d,l,t.lexicalKind,t.originGridCell.value,f))}catch(e){return Q(Z(e))}}function zh(e){return{parseFormula:function(t,r,n,a){if("number"==typeof t){if(null==r){return _.ULS.assertTag(595980825,s.LogCategory.msoulscat_ES_EWAJS,!1,"calc.parse.parseFormula: expected range to be defined")}var i=t,o=r;return qh(e,ec(n,Mr(function(e){return void 0===e.range}(o)?o:o.range),{refStyle:i}),a)}return qh(e,t,r)},formatFormula:function(t,r){try{return Xs(function(e){var t,r,n,a,i,o,u,s,c,l,d,f,h,v,p,m,g,S;return{config:e.config,getDocumentLoc:null!==(r=null===(t=e.getDocumentLoc)||void 0===t?void 0:t.bind(e))&&void 0!==r?r:Kh.getDocumentLoc,getSheetIndex:null!==(a=null===(n=e.getSheetIndex)||void 0===n?void 0:n.bind(e))&&void 0!==a?a:Kh.getSheetIndex,getSheetName:null!==(o=null===(i=e.getSheetName)||void 0===i?void 0:i.bind(e))&&void 0!==o?o:Kh.getSheetName,getNameLoc:null!==(s=null===(u=e.getNameLoc)||void 0===u?void 0:u.bind(e))&&void 0!==s?s:Kh.getNameLoc,getUserDefinedFuncLoc:null!==(l=null===(c=e.getUserDefinedFuncLoc)||void 0===c?void 0:c.bind(e))&&void 0!==l?l:Kh.getUserDefinedFuncLoc,getSheetRangeIndexes:null!==(f=null===(d=e.getSheetRangeIndexes)||void 0===d?void 0:d.bind(e))&&void 0!==f?f:Kh.getSheetRangeIndexes,getContainingTable:null!==(v=null===(h=e.getContainingTable)||void 0===h?void 0:h.bind(e))&&void 0!==v?v:Kh.getContainingTable,getStructRefColumn:null!==(m=null===(p=e.getStructRefColumn)||void 0===p?void 0:p.bind(e))&&void 0!==m?m:Kh.getStructRefColumn,getStructRefSpecialRef:null!==(S=null===(g=e.getStructRefSpecialRef)||void 0===g?void 0:g.bind(e))&&void 0!==S?S:Kh.getStructRefSpecialRef}}(e),t,r)}catch(e){return Q(Z(e))}}}}function Jh(e,t){var r=e[t];return null==r?U("ParseResultHelper.getFormulaSpan: expected span for label "+t+" to be defined"):r}function Qh(e,t,r,n,a){return void 0===a&&(a=!1),!!X(e)&&(function(e,t,r,n,a){if(null==e||null==n)return;var i={};null!=r?r.forEach((function(e){i[e]=!0})):i["*"]=!0;var o=0,u=[];u.push({formulaNode:e.node,letNamesSet:Ds.create(t.stringCompareCI)});var s=function(){var t=u.pop();if(null==t)return"continue";var r=t.formulaNode,i=t.letNamesSet;switch(r.kind){case pt.Literal:l("literal")&&n("literal",{label:r.label,value:r});break;case pt.Array:r.nodes.map((function(e){return e.map((function(e){u.push({formulaNode:e,letNamesSet:i})}))}));break;case pt.App:case pt.Let:case pt.Lambda:var s=r.head;switch(s.kind){case pt.Operator:r.args.forEach((function(e){u.push({formulaNode:e,letNamesSet:i})})),l("operator")&&n("operator",{label:r.label,value:s.id});break;case pt.WSF:case pt.Name:if(a&&Br(r.head)&&r.head.id===la.LET){for(var c=i,f=i,h=0;h<r.args.length;h+=1){var v=r.args[h];h%2==0?(c=f,v.kind!==pt.Name||v.qualifier?v.kind===pt.Bad&&v.type===yt.CellRef&&(f=f.setValue(v.contents,o)):f=f.setValue(v.whole,o),u.push({formulaNode:v,letNamesSet:f})):u.push({formulaNode:v,letNamesSet:c})}o+=1}else r.args.forEach((function(e){u.push({formulaNode:e,letNamesSet:i})}));l("function")&&n("function",{label:r.label,name:s.whole,isClosed:r.isClosed,args:r.args});break;default:u.push({formulaNode:s,letNamesSet:i}),r.args.forEach((function(e){u.push({formulaNode:e,letNamesSet:i})}))}break;case pt.Paren:u.push({formulaNode:r.node,letNamesSet:i});break;case pt.Name:if(a&&i.contains(r.whole)&&!r.qualifier&&l("letName"))n("letName",{label:r.label,name:r.whole.toLocaleLowerCase(),number:i.getValue(r.whole),qualifier:void 0});else if(l("namedRange")){var p=r.whole.split(".");n("namedRange",{label:r.label,name:p[0],names:p.slice(1),qualifier:d(r)})}break;case pt.CellRef:l("range")&&function(t){if(null==e||null==n)return;switch(t.ref.kind){case ut.Error:break;case ut.Col:var r=t.ref;n("range",{label:t.label,type:"col",startIndex:r.col1,endIndex:r.col2,span:Jh(e.spans,r.label),qualifier:d(t)});break;case ut.Row:var a=t.ref;n("range",{label:t.label,type:"row",startIndex:a.row1,endIndex:a.row2,span:Jh(e.spans,a.label),qualifier:d(t)});break;case ut.Single:var i=t.ref;n("range",{label:t.label,type:"cell",row:i.row,col:i.col,span:Jh(e.spans,i.label),qualifier:d(t)});break;case ut.Range:var o=t.ref;n("range",{label:t.label,type:"range",top:o.ref1.row,left:o.ref1.col,bottom:o.ref2.row,right:o.ref2.col,topLeftSpan:Jh(e.spans,o.ref1.label),bottomRightSpan:Jh(e.spans,o.ref2.label),qualifier:d(t)})}}(r);break;case pt.FieldRef:u.push({formulaNode:r.lhs,letNamesSet:i});break;case pt.StructRef:break;case pt.Bad:r.type===yt.CellRef&&i.contains(r.contents)&&l("letName")&&n("letName",{label:r.label,name:r.contents.toLocaleLowerCase(),number:i.getValue(r.contents),qualifier:void 0});break;default:return{value:L("calc.parse.traverseFormula",r)}}};for(;u.length>0;){var c=s();if("object"==typeof c)return c.value}function l(e){return i[e]||i["*"]}function d(e){if(null!=e.qualifier){var t={};switch(e.qualifier.kind){case ot.Sheet:var r=e.qualifier;t.type=ot.Sheet,t.sheet=r.sheet,null!=r.document&&(t.document=r.document.document,null!=r.document.path&&(t.documentPath=r.document.path));break;case ot.SheetRange:var n=e.qualifier;t.type=ot.SheetRange,t.sheet1=n.sheet1,t.sheet2=n.sheet2;break;case ot.Ident:var a=e.qualifier;t.type=ot.Ident,t.name=a.name;break;case ot.Document:var i=e.qualifier;t.document=i.document,null!=i.path&&(t.documentPath=i.path)}return t}}}(e.value,null!=n?n:gu(),t,r,a),!0)}var Xh,Zh,$h,ev,tv,rv={isSuccess:X,traverse:Qh,extractReferences:function(e,t,r){if(void 0===r&&(r=!1),X(e)){var n=[];return Qh(e,["range","namedRange","letName"],(function(t,r){var a={kind:t,ref:r,span:Jh(e.value.spans,r.label)};n.push(a)}),t,r),n.sort((function(e,t){return e.span.start-t.span.start})),n}},extractLetVariables:function(e,t){if(X(e)){var r=e.value;if(void 0!==r){for(var n=[],a=r.node;void 0!==a&&(a.kind===pt.App||a.kind===pt.Let||a.kind===pt.Lambda);){for(var i=Br(a.head)&&a.head.id===la.LET,o=void 0,u=a.args,s=0;s<u.length;s+=1){var c=u[s],l=Jh(e.value.spans,c.label);if(i&&s%2==0&&s>=2&&u[s-2].kind===pt.Name&&n.push(u[s-2].whole),l.start<=t&&l.end>=t){o=c;break}}a=o}return n}}}};(Zh=Xh||(Xh={})).createParseGlobals=$s,Zh.ReasonKind=tc,Zh.parseLocals=ec,Zh.formatLocalsGrid=rc,Zh.formatLocalsName=nc,Zh.notFormulaString=ac,Zh.createParser=zh,Zh.parseResultHelper=rv,function(e){e.Unclosed_application="Unclosed_application",e.Unclosed_paren="Unclosed_paren",e.Unclosed_bracket="Unclosed_bracket",e.Unclosed_array="Unclosed_array",e.Unclosed_literal="Unclosed_literal",e.Invalid_literal="Invalid_literal",e.Invalid_name="Invalid_name",e.Illegal_array_literal_element="Illegal_array_literal_element",e.Empty_array_literal="Empty_array_literal",e.Irregular_array_shape="Irregular_array_shape",e.Empty_parenthesis="Empty_parenthesis",e.Missing_operation_argument="Missing_argument_for_operator",e.Bad_node="Bad_node",e.Invalid_binder="Invalid_binder",e.Empty_formula="Empty_formula",e.Invalid_rel_sheet_qualifier_in_cell="Invalid_rel_sheet_qualifier_in_cell",e.Invalid_rel_sheet_qualifier_in_name="Invalid_rel_sheet_qualifier_in_name",e.Invalid_unqualified_cell="Invalid_unqualified_cell",e.Unexpected_closing_paren="Unexpected_closing_paren",e.Unexpected_closing_brace="Unexpected_closing_brace",e.Unexpected_closing_bracket="Unexpected_closing_bracket",e.Unexpected_character="Unexpected_character",e.Unexpected_field_ref="Unexpected_field_ref",e.Invalid_struct_ref_table_name="Invalid_struct_ref_table_name",e.Invalid_struct_ref="Invalid_struct_ref"}(ev||(ev={})),function(e){e.Types_not_related="Types_not_related",e.Unexpected_application_head="Unexpected_application_head",e.Unexpected_application_head_with_fix="Unexpected_application_head_with_fix",e.Incorrect_number_of_operator_arguments="Incorrect_number_of_arguments_for_operator",e.Excess_function_arguments="Excess_arguments_for_function",e.Insufficient_function_arguments="Insufficient_arguments_for_function"}(tv||(tv={}));var nv=(($h={})[ev.Unclosed_application]={kind:ev.Unclosed_application},$h[ev.Unclosed_paren]={kind:ev.Unclosed_paren},$h[ev.Unclosed_bracket]={kind:ev.Unclosed_bracket},$h[ev.Unclosed_array]={kind:ev.Unclosed_array},$h[ev.Unclosed_literal]={kind:ev.Unclosed_literal},$h[ev.Invalid_literal]={kind:ev.Invalid_literal},$h[ev.Invalid_name]={kind:ev.Invalid_name},$h[ev.Illegal_array_literal_element]={kind:ev.Illegal_array_literal_element},$h[ev.Empty_array_literal]={kind:ev.Empty_array_literal},$h[ev.Irregular_array_shape]={kind:ev.Irregular_array_shape},$h[ev.Empty_parenthesis]={kind:ev.Empty_parenthesis},$h[ev.Bad_node]={kind:ev.Bad_node},$h[ev.Invalid_binder]={kind:ev.Invalid_binder},$h[ev.Empty_formula]={kind:ev.Empty_formula},$h[ev.Invalid_rel_sheet_qualifier_in_cell]={kind:ev.Invalid_rel_sheet_qualifier_in_cell},$h[ev.Invalid_rel_sheet_qualifier_in_name]={kind:ev.Invalid_rel_sheet_qualifier_in_name},$h[ev.Invalid_unqualified_cell]={kind:ev.Invalid_unqualified_cell},$h[ev.Unexpected_closing_paren]={kind:ev.Unexpected_closing_paren},$h[ev.Unexpected_closing_brace]={kind:ev.Unexpected_closing_brace},$h[ev.Unexpected_closing_bracket]={kind:ev.Unexpected_closing_bracket},$h[ev.Unexpected_field_ref]={kind:ev.Unexpected_field_ref},$h[ev.Invalid_struct_ref_table_name]={kind:ev.Invalid_struct_ref_table_name},$h[ev.Invalid_struct_ref]={kind:ev.Invalid_struct_ref},$h[tv.Types_not_related]={kind:tv.Types_not_related},$h[tv.Unexpected_application_head]={kind:tv.Unexpected_application_head},$h[tv.Unexpected_application_head_with_fix]={kind:tv.Unexpected_application_head_with_fix},$h);function av(e){switch(e.kind){case tv.Insufficient_function_arguments:case tv.Excess_function_arguments:return e.kind+": "+su(e.funcId);case ev.Missing_operation_argument:case tv.Incorrect_number_of_operator_arguments:return e.kind+": "+cu(e.opId);case ev.Unexpected_character:return e.kind+": "+b(e.text);default:return e.kind}}function iv(e){if(void 0!==e){var t={};return Object.keys(e).forEach((function(r){e[Number(r)].forEach((function(e){var r,n=av(e);t[n]=(null!==(r=t[n])&&void 0!==r?r:0)+1}))})),t}}function ov(e,t){return{config:e,getSheetName:t}}function uv(e,t,r){return{config:null!=r?r:void 0,lexicalKind:e,originGridCell:q(t.range),originSheet:q(t.sheet),allowRelativeQualifier:!1,allowUnqualifiedCell:!0,allowImplicitTable:!0,wrapCellReferences:!1}}function sv(e,t){return{config:null!=t?t:void 0,lexicalKind:vn.NameManager,originGridCell:q(e.range),originSheet:q(e.sheet),allowRelativeQualifier:!0,allowUnqualifiedCell:!1,allowImplicitTable:!1,wrapCellReferences:!0}}var cv={};function lv(e,t){return{context:e,result:t}}function dv(e){return function(t){return t.kind===pt.Literal&&e(t.oper)}}var fv=dv(Xr),hv=dv(Kr),vv=bt.String|bt.Boolean|bt.Error,pv=dv((function(e){return 0!=(e.kind&vv)}));function mv(e,t,r,n){void 0===n&&(n=!1),n||(e.errorData=e.reportError(t,r,e.errorData))}function gv(e,t){return t!==bt.Range||0!=(e&bt.Range)}function Sv(e,t){if(t.kind===pt.Literal)switch(mv(e,t,nv.Unclosed_literal,t.isClosed),t.oper.kind){case bt.Number:case bt.Boolean:case bt.String:case bt.Error:return;default:return void mv(e,t,nv.Illegal_array_literal_element)}mv(e,t,nv.Illegal_array_literal_element)}function yv(e,t,r){return _e.try((function(){mv(e,t,nv.Types_not_related,gv(bt.Array,r)),mv(e,t,nv.Unclosed_array,t.isClosed);var n=t.nodes.length>0;if(mv(e,t,nv.Empty_array_literal,n),!n)return lv(e,r);for(var a=t.nodes[0].length,i=0;i<t.nodes.length;i+=1){var o=t.nodes[i],u=o.length;mv(e,t,nv.Irregular_array_shape,u===a);for(var s=0;s<u;s+=1)Sv(e,o[s])}return lv(e,r)}))}function bv(e,t,r){return _e.try((function(){if(e.earlyExit&&!e.isOk())throw cv;switch(t.kind){case pt.Array:return yv(e,t,r);case pt.Paren:return mv(e,t,nv.Unclosed_paren,t.isClosed),mv(e,t,nv.Empty_parenthesis,!fv(t.node)),bv(e,t.node,r);case pt.Bad:case pt.Name:case pt.CellRef:case pt.FieldRef:case pt.StructRef:case pt.App:case pt.Let:case pt.Lambda:case pt.Literal:return Rv(e,t).bind((function(n){return mv(e,t,nv.Types_not_related,gv(n.result,r)),n.result=r,n}));default:return L("calc.analyze.checker.check: unhandled formula case",t)}}))}function Ev(e,t,r){if(Wr(r)&&r.parts.kind===mt.IdentNamePart){var n=gn(e.localeInfo,r.whole);return mv(e,r,nv.Invalid_binder,(n.indexOf(".")<0||!Y(w.CalcDotOperator))&&!t.contains(n)),t.setValue(n,!0)}return mv(e,r,nv.Invalid_binder),t}function Fv(e,t,r){return _e.try((function(){var n=Da(t),a=n.minArgs,i=n.headTypes,o=n.restTypes,u=n.tailTypes,s=r.args,c=s.length,l=Ur(r),d=l.length;if(d<a){var f=s[c-1];mv(e,void 0===f?r:f,{kind:tv.Insufficient_function_arguments,funcId:t})}if(0===o.length&&d>i.length){f=s[c-1];mv(e,void 0===f?r:f,{kind:tv.Excess_function_arguments,funcId:t})}if(o.length>1&&d>i.length&&(d-i.length)%o.length>u.length){f=s[c-1];mv(e,void 0===f?r:f,{kind:tv.Insufficient_function_arguments,funcId:t})}return _e.all(l.map((function(t,r){return bv(e,t,Gr(n,r,d))}))).bind((function(a){return e.specialDependencies|=n.staticPrecs,function(e,t,r,n){switch(t){case la.IF:return void(e.locals.lexicalKind!==vn.NameManager&&1===Ur(r).length&&mv(e,n[n.length-1],{kind:tv.Insufficient_function_arguments,funcId:t}));case la._UDF:return mv(e,r,nv.Unexpected_application_head);case la.LET:case la.LETREC:n.length>=3&&n.length%2!=1&&mv(e,n[n.length-1],{kind:tv.Insufficient_function_arguments,funcId:t});for(var a=e.localeInfo,i=Ds.create(a.stringCompareCI),o=0;o+1<n.length;o+=2)i=Ev(e,i,n[o]);x("calc.analyze.applySpecificWorksheetFunctionChecks",r.kind===pt.Let||!e.isOk());break;case la.LAMBDA:for(a=e.localeInfo,i=Ds.create(a.stringCompareCI),o=0;o<n.length-1;o+=1)i=Ev(e,i,n[o]);x("calc.analyze.applySpecificWorksheetFunctionChecks",r.kind===pt.Lambda||!e.isOk())}}(e,t,r,s),lv(e,n.returnType)}))}))}function Cv(e,t){return _e.try((function(){mv(e,t,nv.Unclosed_application,t.isClosed);var r=t.args;if(xr(t.head))return function(e,t,r){return _e.try((function(){var n=wa(t.id),a=r.length,i=a===n.minArgs;return mv(e,t,{kind:tv.Incorrect_number_of_operator_arguments,opId:t.id},i),_e.all(r.map((function(r,o){return _e.try((function(){return fv(r)&&(i=!1,mv(e,r,{kind:ev.Missing_operation_argument,opId:t.id})),bv(e,r,Gr(n,o,a))}))}))).bind((function(t){return i?(e.specialDependencies|=n.staticPrecs,lv(e,n.returnType)):lv(e,Et.All)}))}))}(e,t.head,r);if(Br(t.head))return Fv(e,t.head.id,t);var n=t.head;return _e.all(r.map((function(t){return bv(e,t,Et.All)}))).bind((function(t){return Rv(e,n).bind((function(t){return gv(t.result,bt.Range)||0!=(t.result&(bt.Array|bt.Rich))||mv(e,n,pv(n)||n.kind===pt.Array?nv.Unexpected_application_head:nv.Unexpected_application_head_with_fix),lv(e,Et.All)}))}))}))}function Rv(e,t){return _e.try((function(){var r,n;if(e.earlyExit&&!e.isOk())throw cv;switch(t.kind){case pt.App:case pt.Let:case pt.Lambda:return Cv(e,t);case pt.Array:return yv(e,t,bt.Array);case pt.Bad:return function e(t,r){switch(r.type){case yt.Sequence:for(var n=0,a=r.contents;n<a.length;n++){var i=a[n];if(i.kind===pt.Bad)return e(t,i)}return mv(t,r,nv.Bad_node);case yt.StructRef:return mv(t,r,nv.Invalid_struct_ref_table_name);case yt.FieldRef:return mv(t,r,nv.Unexpected_field_ref);case yt.Unexpected:switch(r.contents){case")":return mv(t,r,nv.Unexpected_closing_paren);case t.localeInfo.rightBrace:return mv(t,r,nv.Unexpected_closing_brace);case t.localeInfo.rightBracket:return mv(t,r,nv.Unexpected_closing_bracket);default:return mv(t,r,{kind:ev.Unexpected_character,text:r.contents})}case yt.Literal:return mv(t,r,nv.Invalid_literal);case yt.CellRef:case yt.Qualifier:case yt.Operator:return mv(t,r,nv.Bad_node);default:L("calc.analyze.diagnoseBadNode",r)}}(e,t),lv(e,Et.All);case pt.CellRef:return e.locals.allowRelativeQualifier||void 0===t.qualifier||t.qualifier.kind!==ot.Relative?e.locals.allowUnqualifiedCell||void 0!==t.qualifier?lv(e,bt.Range):(mv(e,t,nv.Invalid_unqualified_cell),lv(e,Et.All)):(mv(e,t,nv.Invalid_rel_sheet_qualifier_in_cell),lv(e,Et.All));case pt.Literal:return mv(e,t,nv.Unclosed_literal,t.isClosed),lv(e,t.oper.kind|(zr(t.oper)&&t.oper.type===Kn.REF?bt.Range:0));case pt.Name:if(!e.locals.allowRelativeQualifier&&void 0!==t.qualifier&&t.qualifier.kind===ot.Relative)return mv(e,t,nv.Invalid_rel_sheet_qualifier_in_name),lv(e,Et.All);var a=$t(t.parts).parts;return mv(e,t,nv.Invalid_name,(null===(r=e.annotations[a[0].label])||void 0===r?void 0:r.kind)===ct.LocalName||a.some((function(e){return e.canDenoteNamedObject}))),lv(e,Et.All);case pt.Paren:return mv(e,t,nv.Unclosed_paren,t.isClosed),mv(e,t,nv.Empty_parenthesis,!fv(t.node)),Rv(e,t.node);case pt.FieldRef:return mv(e,t,nv.Unclosed_bracket,t.rhs.isClosed),mv(e,t,nv.Unexpected_field_ref,!fv(t.lhs)&&!hv(t.lhs)),Rv(e,t.lhs).bind((function(t){return lv(e,Et.All)}));case pt.StructRef:return mv(e,t,nv.Unclosed_bracket,t.rhs.isClosed),mv(e,t,nv.Invalid_struct_ref_table_name,void 0===t.lhs&&e.locals.allowImplicitTable||(null===(n=t.lhs)||void 0===n?void 0:n.kind)===pt.Name&&t.lhs.parts.kind===mt.IdentNamePart&&t.lhs.parts.canDenoteNamedObject),mv(e,t.rhs.innerRef,nv.Invalid_struct_ref,t.rhs.innerRef.kind!==St.IsectOpRef||yn(t.rhs.innerRef)),t.rhs.innerRef.kind===St.IsectOpRef||t.rhs.innerRef.kind===St.RangeOpRef?(t.rhs.innerRef.lhs.kind!==St.RangeOpRef&&mv(e,t.rhs.innerRef.lhs,nv.Unclosed_bracket,t.rhs.innerRef.lhs.isClosed),t.rhs.innerRef.rhs.kind!==St.RangeOpRef&&mv(e,t.rhs.innerRef.rhs,nv.Unclosed_bracket,t.rhs.innerRef.rhs.isClosed)):t.rhs.innerRef.kind!==St.ThisRowOpRef&&mv(e,t.rhs.innerRef,nv.Unclosed_bracket,t.rhs.innerRef.isClosed),(void 0===t.lhs?_e.resolve(void 0):Rv(e,t.lhs)).bind((function(t){return lv(e,Et.All)}));default:return L("calc.analyze.checker.infer: unhandled formula case",t)}}))}var kv={ok:!0,isOk:se,collect:function(e,t,r){return!1}};function Nv(e,t,r,n,a){var i,o,u=r.annotations;void 0===a&&(a=!0);var s={globals:e,locals:t,localeInfo:null!==(o=null===(i=t.config)||void 0===i?void 0:i.localeInfo)&&void 0!==o?o:e.config.localeInfo,annotations:u,reportError:n.collect,isOk:function(){return n.isOk(s.errorData)},earlyExit:a,specialDependencies:Ft.None,errorData:n.ok};return s}function Av(e,t){try{return mv(e,t.node,nv.Empty_formula,!fv(t.node)),_e.settleOrThrow(bv(e,t.node,Et.All))}catch(t){if(t===cv)return lv(e,Et.All);throw t}}function Tv(e,t,r){try{return q(function(e,t,r){var n=Av(Nv(e,t,r,kv),r).context.errorData;return te(te({},r),{isWellFormed:n})}(e,t,r))}catch(e){return Q(Z(e))}}var Iv={getDocumentLoc:function(){return U("calc.analyze.autocorrectFormula: default getDocumentLoc")},getSheetIndex:function(){return U("calc.analyze.autocorrectFormula: default getSheetIndex")},getSheetName:function(){return U("calc.analyze.autocorrectFormula: default getSheetName")},getNameLoc:function(){return U("calc.analyze.autocorrectFormula: default getNameLoc")},getUserDefinedFuncLoc:function(){return U("calc.analyze.autocorrectFormula: default getUserDefinedFuncLoc")},getSheetRangeIndexes:function(){return U("calc.analyze.autocorrectFormula: default getSheetRangeIndexes")},getContainingTable:function(){return U("calc.analyze.autocorrectFormula: default getContainingTable")},getStructRefColumn:function(){return U("calc.analyze.autocorrectFormula: default getStructRefColumn")},getStructRefSpecialRef:function(){return U("calc.analyze.autocorrectFormula: default getStructRefSpecialRef")}};var Ov,Mv,wv,Dv=ln("AutocorrectError"),_v=te(te({},ze(Ke(!1),(function(e,t){return e||t}))),{badSequenceNode:function(e,t,r){return!0},badStringNode:function(e,t,r){return!0}}),Lv=function(e){function t(t,r,n){var a=e.call(this)||this;return a.f=n,a.seenUnclosed=!1,a.seenParen=!1,a.seenMissingOperand=!1,a.globals=function(e){var t,r,n,a,i,o,u,s,c,l,d,f,h,v,p,m,g,S;return{config:e.config,getDocumentLoc:null!==(r=null===(t=e.getDocumentLoc)||void 0===t?void 0:t.bind(e))&&void 0!==r?r:Iv.getDocumentLoc,getSheetIndex:null!==(a=null===(n=e.getSheetIndex)||void 0===n?void 0:n.bind(e))&&void 0!==a?a:Iv.getSheetIndex,getSheetName:null!==(o=null===(i=e.getSheetName)||void 0===i?void 0:i.bind(e))&&void 0!==o?o:Iv.getSheetName,getNameLoc:null!==(s=null===(u=e.getNameLoc)||void 0===u?void 0:u.bind(e))&&void 0!==s?s:Iv.getNameLoc,getUserDefinedFuncLoc:null!==(l=null===(c=e.getUserDefinedFuncLoc)||void 0===c?void 0:c.bind(e))&&void 0!==l?l:Iv.getUserDefinedFuncLoc,getSheetRangeIndexes:null!==(f=null===(d=e.getSheetRangeIndexes)||void 0===d?void 0:d.bind(e))&&void 0!==f?f:Iv.getSheetRangeIndexes,getContainingTable:null!==(v=null===(h=e.getContainingTable)||void 0===h?void 0:h.bind(e))&&void 0!==v?v:Iv.getContainingTable,getStructRefColumn:null!==(m=null===(p=e.getStructRefColumn)||void 0===p?void 0:p.bind(e))&&void 0!==m?m:Iv.getStructRefColumn,getStructRefSpecialRef:null!==(S=null===(g=e.getStructRefSpecialRef)||void 0===g?void 0:g.bind(e))&&void 0!==S?S:Iv.getStructRefSpecialRef}}(t),a.locals=r,a.resolver=_u(a.globals),a}return ee(t,e),t.prototype.autocorrect=function(){return dt(_v,this.f)?this.f.node:dt(this,this.f)},t.prototype.literalNode=function(e,t,r){return t||(this.seenUnclosed=!0),Vt(e,t,r)},t.prototype.nameNode=function(e,t,r){var n=Jt(e,t,r),a=$t(e);if(a.kind===mt.CellRefNamePart){var i=this.resolver.resolveDottedName(this.locals,n,this.f.annotations).resolved;if(i.kind===bu.ResolvedCellRef){var o=i.node,u=o.ref,s=o.qualifier,c=o.label,l=this.cellRefNode(u,s,c).ref;x("calc.analyze.autocorrectFormula",a.kind===mt.CellRefNamePart);var d=a.parts,f=d[0],h=d[1],v=function(e,t){return Zt(e,t.rhs,t.canDenoteNamedObject,t.label)};return Jt(d.slice(2).reduce(v,v(Xt(l,f.asWhole,f.label),h)),t,c)}if(i.resolution.kind!==H.Success&&i.resolution.reason.kind!==vu.NoOriginSheet)throw new Dv(i.resolution.reason)}return n},t.prototype.arrayNode=function(e,t,r){return t||(this.seenUnclosed=!0),Gt(e,t,r)},t.prototype.appNode=function(e,t,r,n){var a=this.appNodeBase(e,r,n);return r||(this.seenUnclosed=!0),xr(e)||(this.seenParen=!0),xr(e)&&t.some(Pr)&&(this.seenMissingOperand=!0),Ht(e,t,a,n)},t.prototype.letNode=function(e,t,r,n,a){var i=this.appNodeBase(e,n,a);return n||(this.seenUnclosed=!0),this.seenParen=!0,jt(e,t,r,i,a)},t.prototype.lambdaNode=function(e,t,r,n,a){var i=this.appNodeBase(e,n,a);return n||(this.seenUnclosed=!0),this.seenParen=!0,Kt(e,t,r,i,a)},t.prototype.parenNode=function(e,t,r){return t||(this.seenUnclosed=!0),this.seenParen=!0,zt(e,t,r)},t.prototype.cellRefNode=function(e,t,r){var n=this.globals.config.localeInfo;return e.isBracketed&&"("===n.leftBracket&&(this.seenParen=!0),this.locals.allowUnqualifiedCell||void 0!==t?tr(e,t,r):tr(e,this.qualifyCellRef(),r)},t.prototype.fieldRefNode=function(e,t,r,n){return t.isClosed||(this.seenUnclosed=!0),rr(e,t,r,n)},t.prototype.structRefNode=function(e,t,r){return t.isClosed||(this.seenUnclosed=!0),ar(e,t,r)},t.prototype.qualifyCellRef=function(){var e=this.locals.originSheet;if(!X(e))throw new Dv(e.reason);if(void 0!==e.value.index){var t=this.globals.getSheetName(e.value.document,e.value.index);if(!X(t))throw new Dv(t.reason);return It(t.value,void 0)}},t.prototype.appNodeBase=function(e,t,r){return t||!xr(e)&&this.isFormulaRoot(r)&&!this.seenParen&&!this.seenUnclosed&&!this.seenMissingOperand},t.prototype.isFormulaRoot=function(e){var t;return(null===(t=this.f.annotations[e])||void 0===t?void 0:t.kind)===ct.FormulaRoot},t}(Ge);function Uv(e){return{checkFormula:function(t,r){return Tv(e,t,r)},checkFormulaWithDiagnostics:function(t,r){return function(e,t,r){try{var n=Av(Nv(e,t,r,{ok:void 0,isOk:function(e){return void 0===e},collect:function(e,t,r){var n,a=null!=r?r:[];return(null!==(n=a[e.label])&&void 0!==n?n:a[e.label]=[]).push(t),a}},!1),r).context.errorData;return q([te(te({},r),{isWellFormed:void 0===n}),n])}catch(e){return Q(Z(e))}}(e,t,r)},autocorrectFormula:function(t,r){return function(e,t,r){try{var n=r.spans,a=r.annotations,i=r.depthUpperBound;return q(Bt(new Lv(e,t,r).autocorrect(),n,a,i))}catch(e){return Q(e instanceof Dv?e.reason:Z(e))}}(e,t,r)},findStaticPrecedents:function(e,t){return q(Yn([],[],Ft.All,Un.Upper))}}}(Mv=Ov||(Ov={})).analyzeLocalsGrid=uv,Mv.analyzeLocalsName=sv,Mv.diagnostics=a,Mv.summarizeFormulaDiagnostics=iv,Mv.createAnalyzeGlobals=ov,Mv.createAnalyzer=Uv,function(e){e.NotValueString="NotValueString",e.NotFormatString="NotFormatString",e.NoFormatPart="NoFormatPart",e.TooWide="TooWide",e.DateOverflow="DateOverflow",e.FractionOverflow="FractionOverflow",e.PreviousFormatFailure="PreviousFormatFailure"}(wv||(wv={}));var xv=te(te({},rn),wv);function Bv(e){return{kind:xv.NotValueString,message:e}}function Wv(e){return{kind:xv.NotFormatString,message:e}}var Pv={kind:xv.NoFormatPart};function Vv(e){return{kind:xv.TooWide,clip:e}}var Gv,Hv,jv,Kv,Yv,qv,zv,Jv,Qv={kind:xv.DateOverflow},Xv={kind:xv.FractionOverflow};function Zv(){return{kind:xv.PreviousFormatFailure}}function $v(e,t,r,n,a){return{kind:Jv.General,num:e,decimalSeparator:t,includeSign:r,numberShape:n,expNumberShape:a}}function ep(e){return{kind:Jv.String,str:e}}function tp(e){return{kind:Jv.Blank,str:e}}function rp(e){return{kind:Jv.Flexible,str:e}}function np(e,t,r,n){return{units:e,color:t,alignment:r,clip:n}}function ap(e,t){return np(e,t,Yv.Center,zv.None)}!function(e){e.General="General",e.Number="Number",e.Currency="Currency",e.Accounting="Accounting",e.Date="Date",e.Time="Time",e.Percentage="Percentage",e.Fraction="Fraction",e.Scientific="Scientific",e.Text="Text",e.Custom="Custom"}(Gv||(Gv={})),function(e){e.English="English",e.Lunar="Lunar"}(Hv||(Hv={})),function(e){e.SysDate="sysdate",e.SysTime="systime",e.Euro1="euro1",e.Euro2="euro2",e.GenLower="genlower",e.GenUpper="genupper",e.NomLower="nomlower",e.Bitcoin1="xbt1",e.Bitcoin2="xbt2",e.Gannen="gannen"}(jv||(jv={})),function(e){e.Black="Black",e.White="White",e.Red="Red",e.Green="Green",e.Blue="Blue",e.Yellow="Yellow",e.Magenta="Magenta",e.Cyan="Cyan"}(Kv||(Kv={})),function(e){e.Left="Left",e.Center="Center",e.Right="Right"}(Yv||(Yv={})),function(e){e.ValueCell="ValueCell",e.Volatile="Volatile",e.NonVolatile="NonVolatile"}(qv||(qv={})),function(e){e[e.MaxChars=2]="MaxChars",e[e.CellWidth=4]="CellWidth",e[e.None=0]="None",e[e.All=6]="All"}(zv||(zv={})),function(e){e.String="String",e.Blank="Blank",e.General="General",e.Flexible="Flexible"}(Jv||(Jv={}));var ip=np,op=np;function up(e){return!Array.isArray(e.units)}function sp(e,t){return{renderWidth:e,getTextWidth:t}}function cp(e){var t=ce();return sp(e.renderWidth,(function(r){if(null!=t[r])return t[r];var n=e.getTextWidth(r);return t[r]=n,n}))}var lp,dp,fp,hp={renderWidth:1/0,getTextWidth:function(e){return e.length}};function vp(e){for(var t="",r=0,n=e.units;r<n.length;r++){var a=n[r];switch(a.kind){case Jv.String:t+=a.str;break;case Jv.Blank:for(var i=0;i<a.str.length;i+=1)t+=" "}}return t}function pp(e){return{kind:lp.Formula,fmla:e}}function mp(e,t){return{kind:lp.String,value:e,tick:t}}function gp(e,t){return{kind:lp.Number,value:e,format:t}}function Sp(e){return{kind:lp.Other,value:e}}function yp(e,t){var r=wr(e.range);return{config:null!=t?t:void 0,lexicalSource:e,originGridCell:q(r.range),originSheet:q(r.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1}}!function(e){e.Formula="Formula",e.String="String",e.Number="Number",e.Other="Other"}(lp||(lp={}));var bp,Ep=((dp={})[xa.ArabicIndic]={zero:1632,one:1633},dp[xa.ExtendedArabicIndic]={zero:1776,one:1777},dp[xa.Devanagari]={zero:2406,one:2407},dp[xa.Bengali]={zero:2534,one:2535},dp[xa.Gurmukhi]={zero:2662,one:2663},dp[xa.Gujarati]={zero:2790,one:2791},dp[xa.Oriya]={zero:2918,one:2919},dp[xa.Tamil]={zero:48,one:3047},dp[xa.Telugu]={zero:3174,one:3175},dp[xa.Kannada]={zero:3302,one:3303},dp[xa.Malayalam]={zero:3430,one:3431},dp[xa.Thai]={zero:3664,one:3665},dp[xa.Lao]={zero:3792,one:3793},dp[xa.Tibetan]={zero:3872,one:3873},dp[xa.Myanmar]={zero:4160,one:4161},dp[xa.Ethiopic]={zero:48,one:4969},dp[xa.Khmer]={zero:6112,one:6113},dp[xa.Mongolian]={zero:6160,one:6161},dp),Fp=((fp={})[xa.Japanese1]={digits:[12295,19968,20108,19977,22235,20116,20845,19971,20843,20061],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20740,trillion:20806},fp[xa.Japanese2]={digits:[12295,22769,24336,21442,22235,20237,20845,19971,20843,20061],ten:25342,hundred:30334,thousand:38433,tenThousand:33836,hundredMillion:20740,trillion:20806},fp[xa.Japanese3]={digits:[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20740,trillion:20806},fp[xa.Korean1]={digits:[65296,19968,20108,19977,22235,20116,63953,19971,20843,20061],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20740,trillion:20806},fp[xa.Korean2]={digits:[63922,22777,36019,63851,22235,20237,63953,19971,20843,20061],ten:63859,hundred:30334,thousand:38433,tenThousand:33836,hundredMillion:20740,trillion:20806},fp[xa.Korean3]={digits:[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20740,trillion:20806},fp[xa.Korean4]={digits:[50689,51068,51060,49340,49324,50724,50977,52832,54036,44396],ten:49901,hundred:48177,thousand:52380,tenThousand:47564,hundredMillion:50613,trillion:51312},fp[xa.ChineseSimp1]={digits:[9675,19968,20108,19977,22235,20116,20845,19971,20843,20061],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20159,trillion:20806},fp[xa.ChineseSimp2]={digits:[38646,22777,36144,21441,32902,20237,38470,26578,25420,29590],ten:25342,hundred:20336,thousand:20191,tenThousand:19975,hundredMillion:20159,trillion:20806},fp[xa.ChineseSimp3]={digits:[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20159,trillion:20806},fp[xa.ChineseTrad1]={digits:[9675,19968,20108,19977,22235,20116,20845,19971,20843,20061],ten:21313,hundred:30334,thousand:21315,tenThousand:33836,hundredMillion:20740,trillion:20806},fp[xa.ChineseTrad2]={digits:[38646,22777,36019,21443,32902,20237,38520,26578,25420,29590],ten:25342,hundred:20336,thousand:20191,tenThousand:33836,hundredMillion:20740,trillion:20806},fp[xa.ChineseTrad3]={digits:[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],ten:21313,hundred:30334,thousand:21315,tenThousand:33836,hundredMillion:20740,trillion:20806},fp);function Cp(e,t){if(t===xa.ASCII)return e;switch(t){case xa.ArabicIndic:case xa.ExtendedArabicIndic:case xa.Devanagari:case xa.Bengali:case xa.Gurmukhi:case xa.Gujarati:case xa.Oriya:case xa.Tamil:case xa.Telugu:case xa.Kannada:case xa.Malayalam:case xa.Thai:case xa.Lao:case xa.Tibetan:case xa.Myanmar:case xa.Ethiopic:case xa.Khmer:case xa.Mongolian:for(var r="",n=Ep[t],a=0;a<e.length;a+=1){x("calc.numfmt.convertDigitsShape",48<=(i=e.charCodeAt(a))&&i<=57),r+=ja(48===i?n.zero:n.one+(i-49))}return r;case xa.Unknown:return e;case xa.ChineseTrad1:case xa.ChineseTrad2:case xa.ChineseTrad3:case xa.ChineseSimp1:case xa.ChineseSimp2:case xa.ChineseSimp3:case xa.Japanese1:case xa.Japanese2:case xa.Japanese3:case xa.Korean1:case xa.Korean2:case xa.Korean3:case xa.Korean4:for(r="",n=Fp[t],a=0;a<e.length;a+=1){var i;x("calc.numfmt.convertDigitsShape",48<=(i=e.charCodeAt(a))&&i<=57),r+=ja(n.digits[i-48])}return r}}function Rp(e,t,r){var n=e.decimalSeparator;if(r===xa.ASCII)return q(t);switch(r){case xa.ArabicIndic:case xa.ExtendedArabicIndic:case xa.Devanagari:case xa.Bengali:case xa.Gurmukhi:case xa.Gujarati:case xa.Oriya:case xa.Tamil:case xa.Telugu:case xa.Kannada:case xa.Malayalam:case xa.Thai:case xa.Lao:case xa.Tibetan:case xa.Myanmar:case xa.Ethiopic:case xa.Khmer:case xa.Mongolian:var a=t.indexOf(n);return q(Cp(t.substring(0,a<0?void 0:a),r)+(a<0?"":n)+(a<0?"":Cp(t.substring(a+n.length),r)));case xa.Unknown:return q(t);case xa.ChineseTrad1:case xa.ChineseTrad2:case xa.ChineseTrad3:case xa.ChineseSimp1:case xa.ChineseSimp2:case xa.ChineseSimp3:case xa.Japanese1:case xa.Japanese2:case xa.Japanese3:case xa.Korean1:case xa.Korean2:case xa.Korean3:case xa.Korean4:return Q(un(["convertNumberShape: ideographic"]))}}function kp(e,t,r){if(""===t)return"";for(var n=Ya(t,0,t.length),a="",i=0,o=0;i<t.length;){var u=za(qa(t,i));a+=t.substring(i,i+u),i+=u,o+=1,e.isThousandsPosition(r+(n-o))&&(a+=e.thousandsSeparator)}return a}function Np(e,t){var r,n=null!==(r=e.pictureSpecial[t])&&void 0!==r?r:nu[t];return x("calc.numfmt.knownFormat: getSpecial",void 0!==n),n}function Ap(e,t){var r,n=null!==(r=e.pictureSingle[t])&&void 0!==r?r:au[t];return x("calc.numfmt.knownFormat: getSingle",void 0!==n),n}function Tp(e,t,r,n){var a="";if(r>1){var i=C(Ap(e,Wo.Hash),r-1);a+=t?kp({isThousandsPosition:function(e){return e>0&&e%3==0},thousandsSeparator:Ap(e,Wo.Comma)},i,1):i}return a+="0",n>0&&(a+=Ap(e,Wo.Decimal),a+=C("0",n)),a}function Ip(e,t){var r="";return r+="0",t>0&&(r+=Ap(e,Wo.Decimal),r+=C("0",t)),e.isPercentSepBySpace&&(r+=Ap(e,Wo.Space)),r+=Ap(e,Wo.Percent)}function Op(e,t,r,n){var a="";return a+=Tp(e,!1,t,r),e.isExpSepBySpace&&(a+=Ap(e,Wo.Space)),a+=Ap(e,Wo.E),a+="+",a+=C("0",n)}function Mp(e,t){var r=Ap(e,Wo.Quote);return r+t+r}function wp(e,t){var r="";r+=Ap(e,Wo.Hash);var n=e.fractionSeparator;return r+=" "===n?Ap(e,Wo.Space):Mp(e,n),r+=C(Ap(e,Wo.Question),t),r+=Ap(e,Wo.Slash),r+=C(Ap(e,Wo.Question),t)}function Dp(e,t,r,n,a,i){for(var o=e.isCurrencySymbolLead,u=e.currencyFormat,s=e.isCurrencySepBySpace,c=a?3:1,l=Tp(e,!0,4,r),d="",f=function(c){0!==c&&(d+=Ap(e,Wo.Sep)),1===c&&t&&(d+=Ap(e,Wo.ColorStart)+function(e,t){var r,n=null!==(r=e.pictureColor[t])&&void 0!==r?r:iu[t];return x("calc.numfmt.knownFormat: getColor",void 0!==n),n}(e,Po.Red)+Ap(e,Wo.ColorEnd));var f=function(){return 2===c?function(e,t){var r="";return r+=Mp(e,"-"),t>0&&(r+=C(Ap(e,Wo.Question),t)),r}(e,r):3===c?Ap(e,Wo.Text):l},h=function(){return 3!==c?_p(e,Wo.Star,Wo.Space):""},v=function(){return 1===c?Ap(e,Wo.OpenParen):""},p=function(){return 3!==c||o?1===c?Ap(e,Wo.CloseParen):_p(e,Wo.Underscore,Wo.CloseParen):""},m=function(){var t="";if(1!==c)switch(u){case La.Intern:o||3===c||(t+=_p(e,Wo.Underscore,Wo.Minus));break;case La.Lead:case La.Trail:if(u===La.Lead&&!a)break;t+=_p(e,Wo.Underscore,Wo.Minus)}else t+=Ap(e,Wo.Minus);return a&&!o&&u===La.Lead&&(t+=h()),t},g=function(){var t="";return n&&!o&&s&&(t+=Ap(e,Wo.Space)),n&&(t+=null!=i?i:Np(e,Bo.Currency)),o&&s&&(t+=Ap(e,Wo.Space)),t},S=function(){var e="";return 3!==c&&(o?(n&&(e+=g()),a&&(e+=h())):e+=g()),e};if(a&&(d+=function(){var t="";if(o)switch(u){case La.Paren:t+=_p(e,Wo.Underscore,Wo.OpenParen);break;case La.Trail:t+=_p(e,Wo.Underscore,Wo.Minus);break;case La.Intern:t+=_p(e,Wo.Underscore,Wo.Space)}else{switch(u){case La.Trail:t+=_p(e,Wo.Underscore,Wo.Minus);break;case La.Paren:case La.Intern:t+=_p(e,Wo.Underscore,Wo.Space)}u!==La.Lead&&(t+=h())}return t}()),o)switch(u){case La.Paren:a||(d+=v()),d+=S(),a&&(d+=v()),d+=f(),d+=p();break;case La.Lead:d+=m(),d+=S(),d+=f();break;case La.Intern:d+=S(),d+=m(),d+=f();break;case La.Trail:d+=S(),d+=f(),d+=m()}else switch(u){case La.Paren:d+=v(),d+=f(),a&&(d+=p()),d+=S(),a||(d+=p());break;case La.Lead:d+=m(),d+=f(),d+=S();break;case La.Intern:d+=f(),d+=m(),d+=S();break;case La.Trail:d+=f(),d+=S(),d+=m()}a&&(d+=function(){if(o)switch(u){case La.Lead:return _p(e,Wo.Underscore,Wo.Minus);case La.Intern:return _p(e,Wo.Underscore,Wo.Space)}else switch(u){case La.Lead:return _p(e,Wo.Underscore,Wo.Minus);case La.Paren:case La.Intern:return _p(e,Wo.Underscore,Wo.Space)}return""}())},h=0;h<=c;h+=1)f(h);return d}function _p(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return t.map((function(t){return"string"==typeof t?t:Ap(e,t)})).join("")}var Lp=((bp={})[Ua.MDY]=[1,0,2],bp[Ua.DMY]=[0,1,2],bp[Ua.YMD]=[2,1,0],bp[Ua.MYD]=[1,2,0],bp[Ua.DYM]=[0,2,1],bp[Ua.YDM]=[2,0,1],bp);function Up(e,t){return _p(e,(t?e.hour2Digits&&!e.clock24Hour:e.hour2Digits)?Wo.Hour:"",Wo.Hour,Wo.Colon,Wo.Minute,Wo.Minute)}function xp(e,t){return Up(e,t)+_p(e,Wo.Colon,Wo.Second,Wo.Second)}function Bp(e){var t="";return e.isAMPMSepBySpace&&(t+=Ap(e,Wo.Space)),t+=Np(e,Bo.AP1)}function Wp(e,t){void 0===t&&(t=!1);for(var r=e.month2Digits,n=e.day2Digits,a=t||e.year4Digits,i=_p(e,a?Wo.Year:"",a?Wo.Year:"",Wo.Year,Wo.Year),o=_p(e,r?Wo.Month:"",Wo.Month),u=[_p(e,n?Wo.Day:"",Wo.Day),o,i],s=Lp[e.dateOrder],c="",l=0;l<3;l+=1)c+=u[s[l]],l<2&&(c+=Ap(e,Wo.DateSep));return c}function Pp(e,t,r){var n=e.day2Digits,a=e.country===Uo.GER,i="/"===e.dateSeparator&&" "!==e.dateAltSeparator,o="";return t&&(o+=_p(e,n?Wo.Day:"",Wo.Day),i?o+=e.dateAltSeparator:(o+=Ap(e,Wo.DateSep),a&&(o+=Ap(e,Wo.Space)))),o+=_p(e,Wo.Month,Wo.Month,Wo.Month),r&&(o+=i?e.dateAltSeparator:Ap(e,a?Wo.Space:Wo.DateSep),o+=_p(e,Wo.Year,Wo.Year)),o}function Vp(e,t){switch(t){case Wa.General:return Np(e,Bo.General);case Wa.NoComFixed0:return Tp(e,!1,1,0);case Wa.NoComFixed:return Tp(e,!1,1,2);case Wa.Fixed0:return Tp(e,!0,4,0);case Wa.Fixed:return Tp(e,!0,4,2);case Wa.Currency:return Dp(e,!1,0,!0,!1);case Wa.CoCurrency:return Dp(e,!0,0,!0,!1);case Wa.CurrencyDec:return Dp(e,!1,2,!0,!1);case Wa.CoCurrencyDec:return Dp(e,!0,2,!0,!1);case Wa.Pct0:return Ip(e,0);case Wa.Pct:return Ip(e,2);case Wa.Exp:return Op(e,1,2,2);case Wa.Fract:return wp(e,1);case Wa.FractBond:return wp(e,2);case Wa.MMDDYY:return Wp(e);case Wa.DDMMMYY:return Pp(e,!0,!0);case Wa.DDMMM:return Pp(e,!0,!1);case Wa.MMMYY:return Pp(e,!1,!0);case Wa.HHMMAP:return Up(e,!0)+Bp(e);case Wa.HHMMSSAP:return xp(e,!0)+Bp(e);case Wa.HHMM:return Up(e,!1);case Wa.HHMMSS:return xp(e,!1);case Wa.MDYHMS:return _p(e,Wp(e),Wo.Space,Up(e,!1));case Wa.USCoCurrency:case Wa.USCoCurrencyDec:return Dp(te(te({},e),{isCurrencySymbolLead:!0,isCurrencySepBySpace:!1,currencyFormat:La.Paren}),!0,t===Wa.USCoCurrencyDec?2:0,!0,!1,e.isChinaT?Mp(e,"US$"):"$");case Wa.Currency2:return Dp(e,!1,0,!1,!1);case Wa.CoCurrency2:return Dp(e,!0,0,!1,!1);case Wa.CurrencyDec2:return Dp(e,!1,2,!1,!1);case Wa.CoCurrencyDec2:return Dp(e,!0,2,!1,!1);case Wa.Acct:return Dp(e,!1,0,!1,!0);case Wa.AcctDec:return Dp(e,!1,2,!1,!0);case Wa.AcctCur:return Dp(e,!1,0,!0,!0);case Wa.AcctDecCur:return Dp(e,!1,2,!0,!0);case Wa.MMSS:return _p(e,Wo.Minute,Wo.Minute,Wo.Colon,Wo.Second,Wo.Second);case Wa.AbsHMMSS:return _p(e,Wo.ColorStart,Wo.Hour,Wo.ColorEnd,Wo.Colon,Wo.Minute,Wo.Minute,Wo.Colon,Wo.Second,Wo.Second);case Wa.SS0:return _p(e,Wo.Minute,Wo.Minute,Wo.Colon,Wo.Second,Wo.Second,Wo.Decimal,"0");case Wa.Eng:return Op(e,3,1,1);case Wa.Text:return Ap(e,Wo.Text)}}function Gp(e,t){switch(e){case Wa.USCoCurrency:case Wa.USCoCurrencyDec:return t.isEastAsia;default:return!0}}var Hp;Wa.General,Wa.NoComFixed0,Wa.NoComFixed,Wa.Fixed0,Wa.Fixed,Wa.Currency,Wa.CoCurrency,Wa.CurrencyDec,Wa.CoCurrencyDec,Wa.Pct0,Wa.Pct,Wa.Exp,Wa.Fract,Wa.FractBond,Wa.MMDDYY,Wa.DDMMMYY,Wa.DDMMM,Wa.MMMYY,Wa.HHMMAP,Wa.HHMMSSAP,Wa.HHMM,Wa.HHMMSS,Wa.MDYHMS,Wa.Currency2,Wa.CoCurrency2,Wa.CurrencyDec2,Wa.CoCurrencyDec2,Wa.Acct,Wa.AcctCur,Wa.AcctDec,Wa.AcctDecCur,Wa.MMSS,Wa.AbsHMMSS,Wa.SS0,Wa.Eng,Wa.Text;function jp(e,t,r,n){if(" "!==t&&""!==t){var a="$"===t;if(e.isEastAsia){if(n<r.length&&36===r.charCodeAt(n)&&!a)return{currency:1,i:n+1};if(n+2<r.length&&0===e.stringCompareCI(r.substring(n,n+3),"US$"))return{currency:e.isChinaT?1:2,i:n+3};if((""===t&&e.isJapan||""===t&&e.isKorea)&&n<r.length&&92===r.charCodeAt(n))return{currency:0,i:n+1};if(e.isChinaT&&n+2<r.length&&0===e.stringCompareCI(r.substring(n,n+3),"NT$"))return{currency:2,i:n+3}}return n+t.length<=r.length&&0===e.stringCompareCI(r.substring(n,n+t.length),t)?{currency:0,i:n+t.length}:void 0}}function Kp(e,t,r,n,a,i){var o,u=0,s=!1,c=!1,l=!1,d=e.isCurrencySymbolLead,f=e.currencySymbol;0!==a&&(d=1===a,f="");for(var h=0;h<r.length;){if(void 0===o&&d)if(void 0!==(g=jp(e,f,r,h))){o=g.currency,h=g.i;continue}switch(S=r.charCodeAt(h)){case 37:h+=1,u+=1;continue;case 32:h+=1;continue;case 40:case 45:case 43:if(h+=1,c)return q(void 0);c=!0,40===S&&(s=!0),l=43!==S;continue}break}var v=$a(e,t,r,h,!0,u>0||n,i);if(void 0===v||void 0===v.value)return q(void 0);h=v.i;for(var p,m=l?t.neg(v.value):v.value;h<r.length;){var g,S;if(void 0===o&&!d)if(void 0!==(g=jp(e,f,r,h))){o=g.currency,h=g.i;continue}switch(S=r.charCodeAt(h)){case 37:h+=1,u+=1;continue;case 32:h+=1;continue;case 41:if(h+=1,!s)return q(void 0);s=!1;continue}break}if(h!==r.length||s||u>1||void 0!==o&&u>0)return q(void 0);if(void 0!==v.format)p=v.format;else if(1===o)p=v.consumedDecimal?Wa.USCoCurrencyDec:Wa.USCoCurrency;else if(2===o){p=e.isChinaT?v.consumedDecimal?'"NT$"#,##0.00_);("NT$"#,##0.00)':'"NT$"#,##0_);("NT$"#,##0)':v.consumedDecimal?'"US$"#,##0.00_);("US$"#,##0.00)':'"US$"#,##0_);("US$"#,##0)'}else{if(v.numShape!==xa.ASCII)return Q(un(["parseConstInternal ifmt for non-ASCII"]));if(void 0!==o)switch(a){case 0:p=v.consumedDecimal?Wa.CoCurrencyDec:Wa.CoCurrency;break;case 1:p=Dp(te(te({},e),{isCurrencySymbolLead:!0,isCurrencySepBySpace:!0}),!0,v.consumedDecimal?2:0,!0,!1,"[$-x-euro2]");break;case 2:p=Dp(te(te({},e),{isCurrencySymbolLead:!1,isCurrencySepBySpace:!0}),!0,v.consumedDecimal?2:0,!0,!1,"[$-x-euro1]")}else p=u>0?v.consumedDecimal?Wa.Pct:Wa.Pct0:v.consumedThousands?v.consumedDecimal?Wa.Fixed:Wa.Fixed0:Wa.General}return q({value:m,format:p})}function Yp(e,t,r,n,a,i){if(!a)return Kp(e,t,r,n,0,i);for(var o=0;o<=2;o+=1){var u=Kp(e,t,r,n,o,i);if(!X(u))return u;if(void 0!==u.value)return u;if(0===o&&r.indexOf("")<0)break}return q(void 0)}var qp={getTime:function(){return U("calc.numfmt.parseDateInternal: default getTime")}};function zp(e){var t,r;return{config:e.config,getTime:null!==(r=null===(t=e.getTime)||void 0===t?void 0:t.bind(e))&&void 0!==r?r:qp.getTime}}function Jp(e,t){return x("calc.numfmt.monthToken",fm(e,1,12)),{kind:0,value:e,bidiDate:t}}var Qp=ie(new Array(12)).map((function(e,t){return Jp(t+1)})),Xp=function(e){return Qp[e]},Zp=function(e){return Jp(e+1,Hv.English)},$p=function(e){return Jp(e+1,Hv.Lunar)},em=[!0,!1].map((function(e){return{kind:1,am:e}})),tm=em[0],rm=em[1],nm=function(e){return 0===e?tm:rm};function am(e,t,r){return x("calc.numfmt.numberToken",E(e)&&fm(e,-9999,9999)&&fm(t,1,4)),{kind:2,value:e,digits:t,numShape:r}}var im=function(e){return 3===e||4===e},om=function(e,t){return e.lcid===xo.Hungarian&&2===t},um=function(e){return e<=1},sm=function(e){return e<=2},cm=["",""],lm=((Hp={})[Uo.FRN]=[["Jun",Jp(6)],["Jul",Jp(7)]],Hp[Uo.DUT]=[["Mrt",Jp(3)]],Hp[Uo.GER]=[["Mrz",Jp(3)]],Hp),dm=["",""," "," "," "," ","","","",""," "," "];function fm(e,t,r){return e>=t&&e<=r}function hm(e,t){var r=e.getTime(no.Year,t);if(!X(r))return r;var n=e.config,a=n.datepack.fromNum(n,r.value,uo.RoundSec);return x("calc.numfmt.parseDateInternal: current year fromNum",!1!==a),q(a.yr)}function vm(e,t,r,n){return n+t.length<=r.length&&0===e.stringCompareCI(t,r.substring(n,n+t.length))}function pm(e,t,r,n,a,i){for(var o=t.indexOf(" ",r),u=0;u<n.length;u+=1){var s=n[u],c=Se(a,s.length);if(o>=0&&s.indexOf(" ")<0&&o-r>=c&&o-r<=s.length)if(vm(e,f=s.substring(0,o-r),t,r))return[i(u),r+f.length];for(var l=void 0,d=c;d<=s.length;d+=1){var f;if(!vm(e,f=s.substring(0,d),t,r))break;l=r+f.length}if(void 0!==l)return[i(u),l]}}function mm(e,t,r,n,a){for(var i=0;i<n.length;i+=1){var o=n[i];if(vm(e,o,t,r))return[a(i),r+o.length]}}function gm(e,t,r){var n,a=lm[e.country];if(void 0!==a)for(var i=0,o=a;i<o.length;i++){var u=o[i],s=u[0],c=u[1];if(vm(e,s,t,r))return[c,r+s.length]}if(e.isEastAsia){if(void 0!==(n=pm(e,t,r,gu().monthNameLong,3,Xp)))return n}else if(e.isComplexScript){if(void 0!==(n=mm(e,t,r,e.monthNameLong,Xp)))return n;if(void 0!==(n=mm(e,t,r,e.monthNameShort,Xp)))return n;if(void 0!==(n=mm(e,t,r,gu().monthNameLong,Zp)))return n;if(void 0!==(n=mm(e,t,r,gu().monthNameShort,Zp)))return n}else if(void 0!==(n=pm(e,t,r,e.monthNameLong,3,Xp)))return n;return(e.lcid&xo.LANG)==(xo.Arabic&xo.LANG)&&void 0!==(n=mm(e,t,r,dm,$p))||void 0!==(n=pm(e,t,r,e.ampmSymbols,1,nm))||void 0!==(n=pm(e,t,r,gu().ampmSymbols,1,nm))||(e.isChinaS||e.isChinaT)&&void 0!==(n=pm(e,t,r,cm,1,nm))?n:[void 0,r]}function Sm(e,t,r,n){var a,i,o,u,s,c=r,l=45===t.charCodeAt(c);if(l&&(c+=1),5===n){if(o=(a=Xa(e,4,c+4<t.length?t.substring(0,c+4):t,c))[0],x("calc.numfmt.parseDateInternal: 0 < digits <= 4",fm(s=(u=a[1])-c,1,4)),4===s){for(var d=void 0;u<t.length&&e.isNumeral(d=qa(t,u));)u+=za(d);o=Math.round(o/10),s=3}}else if(o=(i=Xa(e,4,t,c))[0],(s=(u=i[1])-c)>4||s>2&&o<100)return[void 0,r];if(0===s)return[void 0,r];var f=function(e,t){for(var r=xa.ASCII,n=0,a=Ja(t);n<a.length;n++){var i=a[n],o=e.getNumberShape(i);o!==xa.ASCII&&(r=o)}return r}(e,t.substring(c,u));return c=u,[am(l?-o:o,s,f),c]}function ym(e,t,r,n){var a=0,i=r;if(32===t.charCodeAt(i))for(a=1;32===t.charCodeAt(i);)i+=1;return null!=e.timeAltSeparator&&e.timeAltSeparator!==e.timeSeparator&&3===n&&F(t,e.timeAltSeparator,i)?(a=4,i+=e.timeAltSeparator.length):F(t,e.dateSeparator,i)?(a=2,i+=e.dateSeparator.length):F(t,e.timeSeparator,i)?(a=3,i+=e.timeSeparator.length):F(t,e.decimalSeparator,i)&&3===n?(a=5,i+=e.decimalSeparator.length):47===t.charCodeAt(i)||45===t.charCodeAt(i)?(a=2,i+=1):58===t.charCodeAt(i)?(a=3,i+=1):F(t,", ",i)&&(a=6,i+=2),1===a&&(" "===e.dateSeparator?a=2:" "===e.timeSeparator?a=3:" "===e.decimalSeparator&&3===n&&(a=5)),[a,i]}function bm(e,t,r,n){var a=e.config,i=a.localeInfo;if(!i.isEastAsia&&!function(e,t){for(var r=0,n=Ja(t);r<n.length;r++){var a=n[r];if(e.isNumeral(a))return!0}return!1}(i,t))return q(void 0);if(i.isEastAsia)return Q(un(["parse East Asia date"]));if(i.isThai){var o=t.indexOf("b");if(o<0&&(o=t.indexOf("B")),o>=0&&o+1<t.length&&i.isNumeral(qa(t,o+1)))return Q(un(["parse Thai Buddhist date"]))}var u=function(e,t,r){for(var n,a=e.localeInfo,i=e.dateCompatibility,o=[],u=null==r?void 0:r.bidiDate,s=xa.ASCII,c=null==r?void 0:r.culture,l=!1,d=!1,f=0;f<t.length;){if(o.length>=9)return q(void 0);var h=void 0;if(a.isNumeral(qa(t,f))||!i&&f+1<t.length&&45===t.charCodeAt(f)&&a.isNumeral(qa(t,f+1))){var v=Sm(a,t,f,n),p=v[0],m=v[1];if(void 0===p)return q(void 0);f=m,p.numShape!==xa.ASCII&&(s=p.numShape),h=p}else{if(32===t.charCodeAt(f))return Q(un(["absurd date/time string with leading space"]));var g=gm(a,t,f),S=g[0],y=g[1];if(void 0===S)return q(void 0);if(f=y,0===S.kind){if(l)return q(void 0);l=!0,void 0!==S.bidiDate&&(u=S.bidiDate)}if(1===S.kind){if(d)return q(void 0);if(d=!0,0===o.length||1!==o[o.length-1].sep)return q(void 0);n=o[o.length-1].sep=3}h=S}var b=ym(a,t,f,n),E=b[0];for(f=b[1];f<t.length&&32===t.charCodeAt(f);)f+=1;o.push({tok:h,sep:E}),n=E}return x("calc.numfmt.parseDateInternal: > 0 tokens",0!==o.length),q({tokens:o,bidiDate:u,numShape:s,culture:c})}(a,t,r);if(!X(u)||void 0===u.value)return u;var s=u.value,c=s.tokens,l=s.bidiDate,d=s.numShape,f=s.culture;if(l===Hv.Lunar)return Q(un(["Lunar calendar"]));if(void 0!==f&&(f.localCalendarInput||f.tag===jv.Gannen))return Q(un(["parse date: possible local calendar"]));var h=function(e,t){for(var r,n,a,i,o,u,s,c=e.localeInfo,l=0;l<t.length;l+=1)if(im(t[l].sep)){r={start:l,end:l+1};break}if(void 0!==r){if(0!==r.start&&1!==t[r.start-1].sep&&!om(c,t[r.start-1].sep))return q(void 0);for(;r.end<t.length&&im(t[r.end-1].sep);)r.end+=1;if(r.end<t.length&&5===t[r.end-1].sep){r.end+=1;var d=t[r.end-1];if(2!==d.tok.kind)return q(void 0);d.tok;if(u=d,r.end<t.length&&im(t[r.end-1].sep)){if(r.end+=1,1!==(f=t[r.end-1]).tok.kind)return Q(un(["non-AM/PM after FracSec"]));f.tok;s=f}}else{var f;if(1===(f=t[r.end-1]).tok.kind){f.tok;s=f}}var h=r.end-r.start-(void 0!==u?1:0)-(void 0!==s?1:0);for(l=0;l<h;l+=1)if(2!==t[r.start+l].tok.kind)return Q(un(["non-number in H/M/S component"]));switch(h){case 0:return U("calc.numfmt.parseDateInternal: 0 time");case 1:x("calc.numfmt.parseDateInternal: 1 time => !fracSec",void 0===u),a=t[r.start];break;case 2:void 0===u?(a=t[r.start],i=t[r.start+1]):(i=t[r.start],o=t[r.start+1]);break;case 3:a=t[r.start],i=t[r.start+1],o=t[r.start+2];break;default:return q(void 0)}for(l=r.end;l<t.length;l+=1)if(im(t[l].sep))return q(void 0);if(r.end===t.length){var v=t[r.end-1].sep;if(!(um(v)||void 0!==s&&5===v))return Q(un(["trailing sep after time"]))}else{var p=t[r.end-1].sep;if(!um(p)&&6!==p)return Q(un(["unexpected sep between time and date"]))}if(0===r.start)r.end!==t.length&&(n={start:r.end,end:t.length});else{if(r.end!==t.length)return Q(un(["date part split around time part"]));n={start:0,end:r.start}}}else n={start:0,end:t.length};return q({time:r,date:n,hour:a,min:i,sec:o,fracSec:u,ampm:s})}(a,c);if(!X(h)||void 0===h.value)return h;var v=h.value,p=v.time,m=v.date,g=v.hour,S=v.min,y=v.sec,b=v.fracSec,E=v.ampm,F=function(e,t,r,n){var a,i,o,u=e.config,s=u.localeInfo,c=u.dateCompatibility,l=u.datepack,d=!1;if(void 0!==n){var f=n.end-n.start;if(f<2||f>3)return q(void 0);var h=r[n.start],v=h.tok,p=h.sep,m=r[n.start+1],g=m.tok,S=m.sep,y=r[n.end-1],b=y.tok,E=y.sep;if(x("calc.numfmt.parseDateInternal: all not AM/PM",1!==v.kind&&1!==g.kind&&1!==b.kind),!um(E)&&!om(s,E))return q(void 0);var F=void 0!==function(e,t){for(var r=t.start;r<t.end;r+=1)if(0===e[r].tok.kind)return r}(r,n);if(d=F,F)if(sm(p)&&sm(S))if(0===v.kind){if(f>2)return q(void 0);i=v,x("calc.numfmt.parseDateInternal: yr not Month",0!==b.kind),a=b}else{if(0!==g.kind)return q(void 0);o=v,i=g,3===f&&(x("calc.numfmt.parseDateInternal: yr not Month",0!==b.kind),a=b)}else{if(3!==f)return q(void 0);if(um(S))return q(void 0);var C=s.longDateFormat?v:g,R=s.longDateFormat?g:v;if(0!==C.kind)return q(void 0);x("calc.numfmt.parseDateInternal: Int1 dom & yr not Month",0!==R.kind&&0!==b.kind),o=R,i=C,a=b}else if(x("calc.numfmt.parseDateInternal: all not Month",0!==v.kind&&0!==g.kind&&0!==b.kind),2===f&&2===p)switch(d=!0,s.dateOrder){case Ua.MDY:i=v,a=b;break;case Ua.YMD:fm(v.value,1,12)?(i=v,o=b):(a=v,i=b);break;case Ua.DMY:fm(b.value,1,12)?(o=v,i=b):(i=v,a=b);break;default:return Q(un(["date parse date order"]))}else{if(f<3||2!==p||2!==S)return q(void 0);switch(v.value>999||!c&&v.value>99?Ua.YMD:s.dateOrder){case Ua.MDY:i=v,o=g,a=b;break;case Ua.YMD:a=v,i=g,o=b;break;case Ua.DMY:o=v,i=g,a=b;break;default:return Q(un(["date parse date order"]))}}}var k=!1;if(s.dateOrder!==Ua.DMY&&void 0===o&&void 0!==i&&fm(i.value,1,12)&&void 0!==a&&fm(a.value,1,31)){var N=hm(e,t);if(!X(N))return N;a.value<=l.daysPerMonth(i.value,N.value,c)&&(o=a,a=am(N.value,4,xa.ASCII),k=!0)}return q({yr:a,mon:i,dom:o,useMonthName:d,usingCurrentYear:k})}(e,n,c,m);if(!X(F)||void 0===F.value)return F;var C=F.value,R=C.yr,k=C.mon,N=C.dom,A=C.useMonthName,T=C.usingCurrentYear,I=function(e,t,r,n,a,i,o,u,s,c){var l,d,f,h,v=e.config,p=v.mathpack,m=v.datepack,g=v.dateCompatibility;if(void 0!==n||void 0!==a||void 0!==r){if(x("calc.numfmt.parseDateInternal: dom || yr",void 0!==a||void 0!==r),x("calc.numfmt.parseDateInternal: mon",void 0!==n),!fm(f=n.value,1,12))return q(void 0);if(void 0===r){var S=hm(e,t);if(!X(S))return S;d=S.value}else d=fm(r.value,0,99)?function(e){return 1900+(e<30?100:0)+e}(r.value):r.value;if(!fm(d,1900,9999))return q(void 0);if(!fm(h=null!==(l=null==a?void 0:a.value)&&void 0!==l?l:1,1,m.daysPerMonth(f,d,g)))return q(void 0)}else{var y=m.fromNum(v,p.zero,uo.RoundSec);x("calc.numfmt.parseDateInternal: zeroDtr fromNum",!1!==y),d=y.yr,f=y.mon,h=y.dom}var b,E=0,F=0,C=0,R=0,k=uo.RoundSec,N=0;if(void 0!==i){if(i.value<0)return Q(un(["negative hour"]));if(i.value>23){if(void 0!==b)return q(void 0);N=i.value,b=co.Hour}else E=i.value}if(void 0!==o){if(o.value<0)return Q(un(["negative minute"]));if(o.value>59){if(void 0!==b)return q(void 0);N=o.value,b=co.Minute}else F=o.value}if(void 0!==u){if(u.value<0)return Q(un(["negative second"]));if(u.value>59){if(void 0!==b)return q(void 0);N=u.value,b=co.Second}else C=u.value}if(void 0!==s){if(s.value<0)return Q(un(["negative fractional second"]));x("calc.numfmt.parseDateInternal: fracSec.digits",s.digits>=1&&s.digits<=3),k=s.digits,x("calc.numfmt.parseDateInternal: fracSec.value",s.value<(3===k?1001:2===k?100:10)),R=s.value}if(void 0!==c){if(void 0!==b||E>12)return q(void 0);c.am?12===E&&(E=0):E<12&&(E+=12)}var A=so(d,f,h,E,F,C,1,R,k),T=void 0!==b?m.toNumWithDuration(v,A,b,N):m.toNum(v,A);return zr(T)?q(void 0):q({value:T,duration:b})}(e,n,R,k,N,null==g?void 0:g.tok,null==S?void 0:S.tok,null==y?void 0:y.tok,null==b?void 0:b.tok,null==E?void 0:E.tok);if(!X(I)||void 0===I.value)return I;var O=I.value,M=O.value,w=function(e,t,r,n,a,i,o,u,s,c,l,d){if(e!==xa.ASCII)return Q(un(["parseDateInternal ifmt for non-ASCII"]));if(o)return 4===(null==u?void 0:u.sep)?Q(un(["parseDateInternal ifmt for alternate time separator"])):void 0!==c?q(Wa.SS0):void 0!==d?d!==co.Hour||void 0!==l||t?q(Wa.General):q(Wa.AbsHMMSS):q(t?Wa.MDYHMS:void 0!==l?void 0!==s?Wa.HHMMSSAP:Wa.HHMMAP:void 0!==s?Wa.HHMMSS:Wa.HHMM);if(x("calc.numfmt.parseDateInternal: !haveTime => haveDate",t),!a)return q(Wa.MMDDYY);var f=void 0!==r&&!i;return q(void 0===n?Wa.MMMYY:f?Wa.DDMMMYY:Wa.DDMMM)}(d,void 0!==m,R,N,A,T,void 0!==p,S,y,b,E,O.duration);return X(w)?q({value:M,format:w.value}):w}function Em(e){var t=F(e,"'"),r=t?e.substring(1):e;return r.length>32767?Q(Bv("cell text too long")):q(mp(zn(r),t))}function Fm(e,t,r){return bm(zp(e),t,r,qv.ValueCell)}function Cm(e,t,r){var n=e.config,a=n.localeInfo,i=n.mathpack,o=a.isEastAsia&&r.valueType===Gv.Percentage&&!0,u=!1;switch(r.valueType){case Gv.Number:case Gv.Currency:case Gv.Percentage:case Gv.Fraction:case Gv.Scientific:case Gv.Accounting:u=!0}return Yp(a,i,t,o,!0,u)}function Rm(e,t,r){var n=function(e,t){if(0===e.stringCompareCI(t,e.trueName))return ha;if(0===e.stringCompareCI(t,e.falseName))return va;for(var r=1;r<e.errorNames.length;r+=1){var n=e.errorNames[r];if(null!=n&&0===e.stringCompareCI(n,t))return Jn(r)}}(e.config.localeInfo,t);if(void 0!==n)return q(Sp(n));for(var a=0,i=r.valueType===Gv.Date||r.valueType===Gv.Time?[Fm,Cm]:[Cm,Fm];a<i.length;a++){var o=(0,i[a])(e,t,r);if(!X(o))return o;if(void 0!==o.value){var u=o.value;return q(gp(u.value,u.format))}}return q(void 0)}function km(e,t){return e!==t&&(!!t.isBuiltIn&&(t.valueType===Gv.General||function(e,t){return(null==e?void 0:e.valueType)!==Gv.Number&&t.valueType!==Gv.Number&&(null==e?void 0:e.valueType)!==t.valueType}(e,t)))}var Nm=function(){function e(e,t,r){W("calc.common.StrictArray2D",e),W("calc.common.StrictArray2D",t);var n=r.length;n<e&&U("calc.common.StrictArray2D: expected elements.length >= "+e+"; given "+n);for(var a=0;a<n;a+=1){var i=r[a].length;i<t&&U("calc.common.StrictArray2D: expected elements["+a+"].length >= "+e+"; given "+i)}this.rows=e,this.cols=t,this.elements=r}return e.prototype.get=function(e,t){return V("calc.common.StrictArray2D.get",e,this.rows),V("calc.common.StrictArray2D.get",t,this.cols),this.elements[e][t]},e.prototype.strict=function(){return this},e.prototype.map=function(e){var t=this;return new Im(this.rows,this.cols,(function(r,n){return e(t.elements[r][n])}))},e}();var Am,Tm=function(){function e(e,t,r,n,a,i){W("calc.common.StrictSparseArray2D",e),W("calc.common.StrictSparseArray2D",t),V("calc.common.StrictSparseArray2D",r,e+1),V("calc.common.StrictSparseArray2D",n,t+1);var o=a.length;o<r&&U("calc.common.StrictSparseArray2D: expected elements.length >= "+r+"; given "+o);for(var u=0;u<o;u+=1){var s=a[u].length;s<n&&U("calc.common.StrictSparseArray2D: expected elements["+u+"].length >= "+n+"; given "+s)}this.rows=e,this.cols=t,this.denseRows=r,this.denseCols=n,this.denseElements=a,this.sparseElement=i}return e.prototype.get=function(e,t){return V("calc.common.StrictSparseArray2D.get",e,this.rows),V("calc.common.StrictSparseArray2D.get",t,this.cols),e<this.denseRows&&t<this.denseCols?this.denseElements[e][t]:this.sparseElement},e.prototype.getSparse=function(){return this.sparseElement},e.prototype.strict=function(){return this},e.prototype.map=function(e){var t=this;return new Om(this.rows,this.cols,this.denseRows,this.denseCols,(function(r,n){return e(t.denseElements[r][n])}),(function(){return e(t.sparseElement)}))},e}(),Im=function(){function e(e,t,r){W("calc.common.NonstrictArray2D",e),W("calc.common.NonstrictArray2D",t),this.rows=e,this.cols=t,this.func=r}return e.prototype.get=function(e,t){return V("calc.common.NonstrictArray2D.get",e,this.rows),V("calc.common.NonstrictArray2D.get",t,this.cols),this.func(e,t)},e.prototype.strict=function(){var e=Mm(this.rows,this.cols,this.func);return new Nm(this.rows,this.cols,e)},e.prototype.map=function(t){var r=this;return new e(this.rows,this.cols,(function(e,n){return t(r.func(e,n))}))},e}(),Om=function(){function e(e,t,r,n,a,i){W("calc.common.NonstrictSparseArray2D",e),W("calc.common.NonstrictSparseArray2D",t),V("calc.common.NonstrictSparseArray2D",r,e+1),V("calc.common.NonstrictSparseArray2D",n,t+1),this.rows=e,this.cols=t,this.denseRows=r,this.denseCols=n,this.denseFunc=a,this.sparseFunc=i}return e.prototype.get=function(e,t){return V("calc.common.NonstrictSparseArray2D.get",e,this.rows),V("calc.common.NonstrictSparseArray2D.get",t,this.cols),e<this.denseRows&&t<this.denseCols?this.denseFunc(e,t):this.sparseFunc()},e.prototype.getSparse=function(){return this.sparseFunc()},e.prototype.strict=function(){var e=Mm(this.denseRows,this.denseCols,this.denseFunc),t=this.sparseFunc();return new Tm(this.rows,this.cols,this.denseRows,this.denseCols,e,t)},e.prototype.map=function(t){var r=this;return new e(this.rows,this.cols,this.denseRows,this.denseCols,(function(e,n){return t(r.denseFunc(e,n))}),(function(){return t(r.sparseFunc())}))},e}();function Mm(e,t,r){for(var n=[],a=0;a<e;a+=1){for(var i=[],o=0;o<t;o+=1)i[o]=r(a,o);n[a]=i}return n}function wm(e,t,r){for(var n=[],a=[],i=0;i<t;i+=1)a[i]=r;for(var o=0;o<e;o+=1)n[o]=a;return n}function Dm(e,t,r){return new Im(e,t,(function(e,t){return r}))}function _m(e){return{kind:Am.MachineCall,machine:e}}function Lm(e){return e.kind===Am.MachineCall}!function(e){e.MachineCall="MachineCall"}(Am||(Am={}));var Um=function(){function e(e,t,r,n){this.context=e,this.rows=t,this.cols=r,this.func=n,this.runStatus=!1,this.toDeref=void 0,this.row=[],this.opers=[]}return e.prototype.next=function(){var e;try{if(void 0!==this.toDeref){var t=this.context.coerceOper(Gm(this.context,this.toDeref,!0),Wm);x("calc.runtime.ArrayMachine.next",!Xr(t)&&!Jr(t)),Qr(t)&&(t=t.opers[0][0]),this.row.push(t),this.row.length===this.cols&&(this.opers.push(this.row),this.row=[]),this.toDeref=void 0}if(this.opers.length>=this.rows)return q(ua(this.rows,this.cols,this.opers));var r=this.func(this.opers.length,this.row.length);return Lm(r)?Te(r.machine,this):(this.toDeref=r,Ae)}catch(t){return null!==(e=this.context.handleEvaluationError(t))&&void 0!==e?e:Q(Z(t))}},e.prototype.receiveResult=function(e){return X(e)?(this.toDeref=e.value,this.next()):e},e}(),xm=bt.Number|bt.String|bt.Boolean|bt.Error|bt.Rich|bt.Array,Bm=bt.Number|bt.String|bt.Boolean|bt.Error|bt.Blank|bt.Rich,Wm=Bm|bt.Array;function Pm(e,t,r){var n=e+": generated Excel error, type "+t+"; "+r;_.ULS.traceTag(596120270,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Verbose,n)}function Vm(e,t,r){return ua(e,t,Qr(r)?function(e,t,r,n,a,i){if(e===r&&t===n)return a;if(1===e&&1===t)return wm(r,n,void 0===a[0]?i:a[0][0]);var o,u=[];o=1===e?function(e,r){return r<t?a[0][r]:i}:1===t?function(t,r){return t<e?a[t][0]:i}:function(r,n){return r<e&&n<t?a[r][n]:i};for(var s=0;s<r;s+=1){u.push([]);for(var c=0;c<n;c+=1)u[s][c]=o(s,c)}return u}(r.rows,r.cols,e,t,r.opers,ra):wm(e,t,r))}function Gm(e,t,r){if(!Jr(t))return t;if(!hr(t.sheets))return Zn;if(!r)return 1===t.ranges.length&&pr(t.ranges[0])?e.dereferenceOper(t,Et.All&~bt.Range):e.dereferenceOper(t,bt.Array);var n=e.dereferenceOper(t,Et.All&~(bt.Range|bt.Array));return Qr(n)?ra:n}function Hm(e){var t=function(e){return e&~(bt.Array|bt.Range)};return fr(e.minArgs,e.headTypes.map(t),e.restTypes.map(t),e.tailTypes.map(t),e.returnType,e.staticPrecs,e.flags)}function jm(e,t,r,n,a){switch(n.kind){case bt.Missing:case bt.Blank:return Dm(t,r,e.zero);case bt.Array:return 0!=(a&bt.Array)?Dm(t,r,n):function(e,t,r,n){return r.rows===e&&r.cols===t?r:1===r.rows&&1===r.cols?Dm(e,t,r.get(0,0)):1===r.rows?new Im(e,t,(function(e,t){return t<r.cols?r.get(0,t):n})):1===r.cols?new Im(e,t,(function(e,t){return e<r.rows?r.get(e,0):n})):new Im(e,t,(function(e,t){return e<r.rows&&t<r.cols?r.get(e,t):n}))}(t,r,new Nm(n.rows,n.cols,n.opers),ra);case bt.Range:default:return Dm(t,r,n)}}function Km(e,t,r,n){for(var a=0,i=0,o=0;o<n.length;o+=1){var u=n[o];Qr(u)&&0==(Gr(t,o,n.length)&bt.Array)?(a=ye(a,u.rows),i=ye(i,u.cols)):(a=ye(a,1),i=ye(i,1))}var s=n.map((function(r,n,o){return jm(e.mathpack,a,i,r,Gr(t,n,o.length))}));return _m(new Um(e,a,i,(function(e,t){return r(s.map((function(r){return r.get(e,t)})))})))}function Ym(e){return function(t,r){return e(t)(r[0])}}function qm(e){return function(t,r){return e(t)(r[0],r[1])}}var zm=function(e){return Kr(e)?e:U("calc.funcs.assertNumber")},Jm=function(e){return Yr(e)?e:U("calc.funcs.assertString")},Qm=zn("");function Xm(e){return Yr(e)&&""===e.value}function Zm(e,t){var r=Gm(e,t,!1),n=$r(r)?r.getFallback():r;switch(n.kind){case bt.Number:return n;case bt.Boolean:return Zn;case bt.String:var a=e.coerceOper(n,bt.Number);return Kr(a)?a:Zn;case bt.Error:return n;case bt.Array:return Zn;case bt.Missing:return ra;case bt.Blank:return e.mathpack.zero;default:return L("calc.funcs.chkNumOper",n)}}function $m(e,t){var r=Zm(e,t);if(zr(r))return r;var n=e.mathpack;return n.cond(r)<0?ta:eg(e,r=n.floor(r))?(e.config.date1904&&!Yr(t)&&(r=n.add(n.fromNumber(1462),r)),r):ta}function eg(e,t){var r,n,a=e.mathpack.lfix(t);return e.config.date1904?(r=0,n=2957003):(r=0,n=2958465),a>=r&&a<=n}function tg(e,t,r){var n=e.div(t,r);if(zr(n))return n;var a=e.mul(e.trunc(n),r);if(zr(a))return a;var i=e.sub(t,a);return!zr(i)&&e.cond(t)<0?e.abs(i):i}function rg(e,t){switch(e){case pa.Eq:return 0===t;case pa.Ne:return 0!==t;case pa.Lt:return t<0;case pa.Gt:return t>0;case pa.Le:return t<=0;case pa.Ge:return t>=0}}function ng(e,t,r){return rg(e,t.value-r.value)}function ag(e,t,r,n){return rg(t,e.stringCompareCI(r.value,n.value))}function ig(e,t,r,n){return rg(t,e.compare(r,n))}function og(e,t,r){if(hr(t.sheets))if(hr(r.sheets))if(kr(t.sheets.document,r.sheets.document)){if(t.sheets.index===r.sheets.index)return Tn(t.sheets.document,t.sheets.index);n="different sheet, range1 = "+d(t)+", range2 = "+d(r);Pm(e,Kn.VALUE,n)}else{var n="different document, range1 = "+d(t)+", range2 = "+d(r);Pm(e,Kn.VALUE,n)}else Pm(e,Kn.VALUE,"3D reference, range2 = "+d(r));else Pm(e,Kn.VALUE,"3D reference, range1 = "+d(t))}function ug(e,t,r,n){void 0===n&&(n=!1);var a,i,o,u=e.config.mathpack;if(1===r.length){var c=r[0];switch(t){case pa.Percent:return u.percent(c);case pa.Neg:return u.neg(c);case pa.Pos:return c;default:var l="calc.runtime.applyOperator: "+("bad application of "+t+" to 1 argument");return _.ULS.assertTag(593372496,s.LogCategory.msoulscat_ES_EWAJS,!1,l)}}if(2===r.length){c=r[0];var f=r[1];switch(t){case pa.Add:var h=u.add(c,f);return n&&Kr(h)?u.checkAlmostCancellation(c,h):h;case pa.Sub:h=u.sub(c,f);return n&&Kr(h)?u.checkAlmostCancellation(c,h):h;case pa.Mul:return u.mul(c,f);case pa.Div:return u.div(c,f);case pa.Pow:return u.power(c,f);case pa.Concat:return zn((c.value+f.value).substring(0,32767));case pa.Eq:case pa.Ne:case pa.Lt:case pa.Le:case pa.Gt:case pa.Ge:return qn(function(e,t,r,n){var a=e.config,i=a.localeInfo,o=a.mathpack;if(r.kind!==n.kind){if(Zr(r))switch(n.kind){case bt.Number:return ig(o,t,o.zero,n);case bt.String:return ag(i,t,Qm,n);case bt.Boolean:return ng(t,va,n)}if(Zr(n))switch(r.kind){case bt.Number:return ig(o,t,r,o.zero);case bt.String:return ag(i,t,r,Qm);case bt.Boolean:return ng(t,r,va)}return rg(t,r.kind-n.kind)}switch(r.kind){case bt.Number:return ig(o,t,r,n);case bt.String:return ag(i,t,r,n);case bt.Boolean:return ng(t,r,n);case bt.Blank:return rg(t,0);default:return!1}}(e,t,c,f));case pa.Range:return null==(o=og("calc.runtime.applyRangeOp",a=c,i=f))?Zn:sa(o,[yr(br(a.ranges),br(i.ranges))]);case pa.Isect:return function(e,t){var r=og("calc.runtime.applyIsectOp",e,t);if(null==r)return Zn;for(var n=[],a=0;a<e.ranges.length;a+=1)for(var i=0;i<t.ranges.length;i+=1){var o=Er(e.ranges[a],t.ranges[i]);null!=o&&n.push(o)}if(0===n.length){var u="empty intersection, range1 = "+d(e)+", range2 = "+d(t);return Pm("calc.runtime.applyIsectOp",Kn.NULL,u),Qn}return sa(r,n)}(c,f);case pa.Union:return function(e,t){var r=og("calc.runtime.applyUnionOp",e,t);return null==r?Zn:sa(r,e.ranges.concat(t.ranges))}(c,f);case pa.And:return qn(c.value&&f.value);case pa.Or:return qn(c.value||f.value);case pa.Xor:return qn(c.value!==f.value);case pa.Min:return u.cond2(c,f)<=0?c:f;case pa.Max:return u.cond2(c,f)>=0?c:f;default:var v="calc.runtime.applyOperator: "+("bad application of "+t+" to 2 arguments");return _.ULS.assertTag(593372497,s.LogCategory.msoulscat_ES_EWAJS,!1,v)}}var p="calc.runtime.applyOperator: "+("bad application of "+t+" to "+r.length+" arguments");return _.ULS.assertTag(593372498,s.LogCategory.msoulscat_ES_EWAJS,!1,p)}var sg=function(e){return e.kind!==Jv.General},cg=function(e){return e.kind!==Jv.Flexible};function lg(e,t,r){return 0!=(t&zv.MaxChars)&&r.length>255?zv.MaxChars:0!=(t&zv.CellWidth)&&e.renderWidth<1/0&&e.getTextWidth(r)>e.renderWidth?zv.CellWidth:void 0}function dg(e,t,r,n,a,i){var o=ye(0,255-r.length-n.length),u=0===a.length?o:Math.floor(o/a.length);if(e.renderWidth!==1/0){var s=e.getTextWidth(a);s>0&&(u=Se(u,ye(Math.floor((e.renderWidth-e.getTextWidth(r+n))/s),0)))}var c,l=i(u);if(!1===l||void 0===(c=lg(e,t,r+l+n))){for(var d=l,f=u+1;f<u+50;f+=1){if(!1!==(v=i(f))){if(v===d)break;if(void 0!==(p=lg(e,t,r+v+n))){!1===d&&(d=p);break}d=v}}return x("calc.numfmt.renderValue: false after upwards search",!1!==d),d}var h=c;for(f=u-1;f>=0;f-=1){var v,p;if(!1===(v=i(f)))break;if(void 0===(p=lg(e,t,r+v+n)))return v;h=p}return h}var fg,hg,vg,pg,mg,gg,Sg=ln("RenderHashesError"),yg=ln("RenderError");function bg(e,t,r){var n=e.fromNumber(t.num),a=t.includeSign&&e.cond(n)<0?"-":"",i=a+e.formatGeneral(t,e.abs(n),r-a.length);if("-0"===i&&(i="0"),i.length>r)return q(!1);var o=i.indexOf("E");if(o>=0){var u=Rp(t,i.substring(0,o),t.expNumberShape);if(!X(u))return u;var s=i.substring(o,o+2),c=Cp(i.substring(o+2),t.expNumberShape);return x("calc.numfmt.render: formatGeneral ePart","E-"===s||"E+"===s),q(u.value+s+c)}var l=Rp(t,i,t.numberShape);return X(l)?q(l.value):l}function Eg(e,t,r){try{return up(t)?q(ap(t.units,t.color)):q(function(e,t,r){var n,a,i=t.units,o=t.color,u=t.alignment,s=t.clip,c=cp(r);if(i.every(sg))n=i;else if(c.renderWidth===1/0)n=i.map((function(t){if(t.kind!==Jv.General)return t;var r=bg(e,t,11);if(!X(r))throw new yg(r.reason);return x("calc.numfmt.renderValue: false after format at defaultGenPrecision",!1!==r.value),ep(r.value)}));else{for(var l="",d="",f=void 0,h=void 0,v=0;v<i.length;v+=1){var p=i[v];switch(p.kind){case Jv.String:case Jv.Blank:void 0!==f?d+=p.str:l+=p.str;break;case Jv.General:x("calc.numfmt.renderValue: expected a single General unit",void 0===f),f=v,h=p;break;case Jv.Flexible:}}x("calc.numfmt.renderValue: genUnit",void 0!==f&&void 0!==h);var m=h,g=dg(c,s,l,d,"0",(function(t){var r=bg(e,m,Se(t,11));if(!X(r))throw new yg(r.reason);return r.value}));if("number"==typeof g)throw new Sg(Vv(g));n=i.map((function(e){return e.kind===Jv.General?ep(g):e}))}if(n.every(cg))a=n;else if(c.renderWidth===1/0)a=n.filter(cg);else{l="",d="";var S,y=void 0;for(v=0;v<n.length;v+=1){var b=n[v];switch(b.kind){case Jv.String:case Jv.Blank:void 0!==S?d+=b.str:l+=b.str;break;case Jv.Flexible:S=v,y=b}}x("calc.numfmt.renderValue: lastFlexUnit",void 0!==S&&void 0!==y);var E=y,F=dg(c,zv.All,l,d,y.str,(function(e){return C(E.str,e)}));if("number"==typeof F){if(0!=(F&s))throw new Sg(Vv(F));F=""}var R=F;a=n.map((function(e,t){return e.kind!==Jv.Flexible?e:ep(t===S?R:"")}))}if(s!==zv.None){var k="";for(v=0;v<a.length;v+=1)k+=a[v].str;var N=lg(c,s,k);if(void 0!==N)throw new Sg(Vv(N))}return op(a,o,u,s)}(e,t,r))}catch(e){return e instanceof Sg?q(ap(e.reason,t.color)):Q(e instanceof yg?e.reason:Z(e))}}var Fg={decimalSeparator:"NOTUSED"};function Cg(e,t,r,n){var a=e.formatFixed(t,0,0),i=a.mantissa,o=a.exponent;x("calc.numfmt.dtrInteger: mantissa len <= exponent",i.length<=o),x("calc.numfmt.dtrInteger: mantissa || !exponent",0!==i.length||0===o);var u=Cp(o<r?C("0",r-o):"",n),s=Rp(Fg,i+C("0",o-i.length),n);if(!X(s))throw new iS(s.reason);return u+s.value}function Rg(e,t,r,n,a){var i=e.formatFixed(t,0,0),o=i.mantissa,u=i.exponent;return x("calc.numfmt.dtrFracSeconds: mantissa len <= exponent",o.length<=u),x("calc.numfmt.dtrFracSeconds: mantissa || !exponent",0!==o.length||0===u),Cp(((u<r?C("0",r-u):"")+o+C("0",u-o.length)).substring(0,n),a)}function kg(e,t){var r=e.formatFixed(t,0,0),n=r.mantissa,a=r.exponent;return x("calc.numfmt.formatInt: mantissa len <= exponent",n.length<=a),x("calc.numfmt.formatInt: mantissa || !exponent",0!==n.length||0===a),""===n?"0":n.length<a?n+C("0",a-n.length):n}function Ng(e){for(var t=[],r=0;r<e.length;r+=1){var n=e[r];switch(n.kind){case Jv.Blank:case Jv.String:for(var a=n.str;r+1<e.length;){var i=e[r+1];if(i.kind!==n.kind)break;a+=i.str,r+=1}t.push({kind:n.kind,str:a});break;case Jv.Flexible:case Jv.General:t.push(n)}}return t}var Ag,Tg=function(e){return e.kind===Jv.Flexible},Ig=[xa.ChineseTrad1,xa.ChineseTrad2,xa.ChineseTrad3],Og=[xa.ChineseSimp1,xa.ChineseSimp2,xa.ChineseSimp3],Mg=[xa.Japanese1,xa.Japanese2,xa.Japanese3],wg=[xa.Korean1,xa.Korean2,xa.Korean3,xa.Korean4];function Dg(e){return e+1}!function(e){e[e.Ne=0]="Ne",e[e.Le=1]="Le",e[e.Ge=2]="Ge",e[e.Eq=3]="Eq",e[e.Lt=4]="Lt",e[e.Gt=5]="Gt"}(Ag||(Ag={}));var _g,Lg=N(((fg={})[Ag.Ne]="<>",fg[Ag.Le]="<=",fg[Ag.Ge]=">=",fg[Ag.Eq]="=",fg[Ag.Lt]="<",fg[Ag.Gt]=">",fg)),Ug=((hg={})[Ag.Ne]=pa.Ne,hg[Ag.Le]=pa.Le,hg[Ag.Ge]=pa.Ge,hg[Ag.Eq]=pa.Eq,hg[Ag.Lt]=pa.Lt,hg[Ag.Gt]=pa.Gt,hg),xg=((vg={})[pa.Ne]=Ag.Ne,vg[pa.Le]=Ag.Le,vg[pa.Ge]=Ag.Ge,vg[pa.Eq]=Ag.Eq,vg[pa.Lt]=Ag.Lt,vg[pa.Gt]=Ag.Gt,vg);function Bg(e,t,r,n){for(var a in t){var i=t[a];if(null!=i&&!(n+i.length>r.length)){var o=r.substring(n,n+i.length);if(0===e.stringCompareCI(i,o))return Number(a)}}}function Wg(e,t,r,n){for(var a in t){var i=t[a];if(null!=i&&F(r,i,n))return Number(a)}return Bg(e,t,r,n)}function Pg(e,t){var r;return null!==(r=e[t])&&void 0!==r?r:""}!function(e){e[e.AMPM=100]="AMPM",e[e.AMPMFE=101]="AMPMFE",e[e.General=102]="General",e[e.Currency=103]="Currency",e[e.Color=200]="Color",e[e.Dbnum=201]="Dbnum",e[e.Cond=202]="Cond",e[e.CurrCode=203]="CurrCode",e[e.Char=300]="Char",e[e.StrLit=301]="StrLit",e[e.Numeral=302]="Numeral",e[e.PrefixDigTh=303]="PrefixDigTh",e[e.LatinDate=304]="LatinDate",e[e.BidiDate=305]="BidiDate",e[e.Exp=306]="Exp"}(_g||(_g={}));var Vg=/^[0-9A-F]{1,8}$/i,Gg=/^(?:([a-z]{2,}(?:-[A-Z0-9]{2,})*)(?:-x-([a-z]+))?|x-([a-z0-9]+))?(?:,([0-9A-F]{1,4}))?$/i,Hg=N(((pg={})[1]=xa.ASCII,pg[2]=xa.ArabicIndic,pg[3]=xa.ExtendedArabicIndic,pg[4]=xa.Devanagari,pg[5]=xa.Bengali,pg[6]=xa.Gurmukhi,pg[7]=xa.Gujarati,pg[8]=xa.Oriya,pg[9]=xa.Tamil,pg[10]=xa.Telugu,pg[11]=xa.Kannada,pg[12]=xa.Malayalam,pg[13]=xa.Thai,pg[14]=xa.Lao,pg[15]=xa.Tibetan,pg[16]=xa.Myanmar,pg[17]=xa.Ethiopic,pg[18]=xa.Khmer,pg[19]=xa.Mongolian,pg[27]=xa.Japanese1,pg[28]=xa.Japanese2,pg[29]=xa.Japanese3,pg[30]=xa.ChineseSimp1,pg[31]=xa.ChineseSimp2,pg[32]=xa.ChineseSimp3,pg[33]=xa.ChineseTrad1,pg[34]=xa.ChineseTrad2,pg[35]=xa.ChineseTrad3,pg[36]=xa.Korean1,pg[37]=xa.Korean2,pg[38]=xa.Korean3,pg[39]=xa.Korean4,pg)),jg=N(((mg={})[1]=Ba.Gregorian,mg[2]=Ba.GregorianUS,mg[3]=Ba.Japan,mg[4]=Ba.Taiwan,mg[5]=Ba.Korea,mg[6]=Ba.Hijri,mg[7]=Ba.Thai,mg[8]=Ba.Hebrew,mg)),Kg=Object.keys(jv).reduce((function(e,t){var r=jv[t];return e[String(r)]=r,e}),Object.create(null));function Yg(e){return e.toString(16).toUpperCase()}function qg(e){return Number("0x"+e)}var zg=((gg={})[Wo.Hour]=co.Hour,gg[Wo.HourTh]=co.Hour,gg[Wo.Minute]=co.Minute,gg[Wo.MinuteTh]=co.Minute,gg[Wo.Second]=co.Second,gg[Wo.SecondTh]=co.Second,gg);function Jg(e){return 400===e.kind?e.formattedStr:void 0}var Qg={kind:_g.General};function Xg(e){return 1===e.length&&e[0].kind===_g.General}var Zg={code:[Qg],color:void 0,dbnum:void 0,dtrRounding:uo.RoundSec};function $g(e){return void 0===e.color&&void 0===e.dbnum&&Xg(e.code)}function eS(e){return void 0===e.color&&void 0===e.dbnum&&(1===(t=e.code).length&&t[0].kind===Wo.Text);var t}var tS,rS,nS={},aS=ln("ApplyHashesError"),iS=ln("ApplyError"),oS=ln("InitError"),uS=function(){function e(e,t){this.config=e,this.hasPercent=!1,this.hasDate=!1,this.hasTime=!1,this.posBeforeText=!0,this.onlyOneNumberPart=!0,this.parts=[void 0,void 0,void 0,void 0],void 0===t.old?(this.parseString(t.formatString),this.logFormatString=b(t.formatString),this.isBuiltIn=t.isBuiltIn):(this.hasPercent=t.old.hasPercent,this.hasDate=t.old.hasDate,this.hasTime=t.old.hasTime,this.posBeforeText=t.old.posBeforeText,this.onlyOneNumberPart=t.old.onlyOneNumberPart,this.parts=t.synth,this.currCode=t.old.currCode,this.condPos=t.old.condPos,this.condNeg=t.old.condNeg,this.logFormatString=t.logFormatString,this.isBuiltIn=!1),this.formatString=this.printFormatString(),this.valueType=this.determineValueType(),this.decimals=this.determineDecimals(),this.bidiDate=this.determineBidiDate()}return Object.defineProperty(e.prototype,"isPercent",{get:function(){return this.hasPercent},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDate",{get:function(){return this.hasDate},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isTime",{get:function(){return this.hasTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isTextOnly",{get:function(){return!this.posBeforeText},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"culture",{get:function(){return this.currCode},enumerable:!0,configurable:!0}),e.prototype.apply=function(e,t,r,n){try{return q(this.applyImpl(e,t,r,n))}catch(e){return Q(e instanceof iS?e.reason:Z(T(e,"(while applying format "+this.logFormatString+")")))}},e.prototype.applyImpl=function(e,t,r,n){var a,i=this.config,o=i.mathpack,u=i.localeInfo;if(this.formatString===Pg(u.pictureSpecial,Bo.General)){var s=void 0;if(Yr(e))return ip([ep(e.value)],s,t,r);if(!n&&0===o.cond(e))return ip([],s,t,r);var c=$v(o.toNumber(e),u.decimalSeparator,!0,xa.ASCII,xa.ASCII);return ip([c],s,t,r)}for(var l=!1;;){var d=void 0;try{var f=void 0,h=!1,v=[];if(Yr(e))f=3;else{var p=o.cond(e);void 0!==this.condPos||void 0!==this.condNeg?(f=(a=this.getPart(e)).partKind,h=a.forceNeg):f=p<0?1:p>0?0:2,p<0&&(this.onlyOneNumberPart||h)&&v.push(ep("-"))}s=(d=this.parts[f]).color;var m=d.dbnum,g=d.code,S=d.dtrRounding;if(!n&&2===f&&d===this.parts[0]&&!l)return ip([],s,t,r);var y=this.getNumShape(m);this.applyPart({dtrRounding:S,dbnum:m,forceNeg:h,units:v,numShape:y},g,e,void 0);var b=r|(3!==f||$g(d)||eS(d)?zv.None:zv.MaxChars),E=v.some(Tg)?Yv.Left:t;return ip(Ng(v),s,E,b)}catch(t){if(t===nS){x("calc.numfmt.NumberFormatImpl: applyImpl restart",!Yr(e)&&0!==o.cond(e)),e=o.zero,l=!0;continue}if(t instanceof aS)return ap(t.reason,null==d?void 0:d.color);throw t}}},e.prototype.applyPart=function(e,t,r,n){for(var a,i,o,u,s,c,l=this,d=this.config,f=d.mathpack,h=d.datepack,v=d.localeInfo,p=function(){var t,n;if(void 0!==c)return c;x("calc.numfmt.NumberFormatImpl: applyPart getDtr value",!Yr(r));var a=l.config,i=a.date1904,o=a.dateCompatibility;if(!o&&f.cond(r)<0)throw new aS(Qv);if(o&&!i&&f.cond(r)<0)throw new aS(Qv);var u=h.fromNum(l.config,f.abs(r),e.dtrRounding);if(!1===u)throw new aS(Qv);var s=null!==(n=null===(t=l.currCode)||void 0===t?void 0:t.calendar)&&void 0!==n?n:Ba.Gregorian;if(s!==Ba.Gregorian)throw new iS(un(["calendar: "+s]));return x("calc.numfmt.NumberFormatImpl: components within range",u.yr>=0&&u.mon>=1&&u.mon<=12&&u.dom>=0&&u.dom<=31&&u.hour>=0&&u.hour<=23&&u.min>=0&&u.min<=59&&u.sec>=0&&u.sec<=59&&u.fracSec>=0&&u.wdy>=1&&u.wdy<=7),c=u},m=function(){if(void 0!==c)throw new iS(un(["use of value after date component"]));return r},g=!1,S=e.numShape,y=e.units,b=0;b<t.length;b+=1){var E=t[b];switch(E.kind){case _g.General:g=!0;var F=m();if(Yr(F))y.push(ep(F.value));else{var R=f.abs(F);if(f.cond(F)<0&&"0"===f.formatGeneral(v,R,1))throw new iS(un(["potential LRestart in interval (-0.5,0)"]));var k=$v(f.toNumber(R),v.decimalSeparator,!1,S,this.getNumShape(void 0));if(void 0!==e.dbnum){var N=bg(f,k,255);if(!X(N))throw new iS(N.reason);x("calc.numfmt.NumberFormatImpl: applyPart General renderRes",!1!==N.value),y.push(ep(N.value));break}y.push(k)}break;case Wo.Text:var A=m();x("calc.numfmt.NumberFormatImpl: applyPart Text value",Yr(A)),y.push(ep(A.value));break;case _g.Exp:case Wo.Slash:case 400:y.push(ep(E.formattedStr));break;case Wo.Star:y.push(rp(E.escaped));break;case Wo.Underscore:y.push(tp(E.escaped));break;case _g.StrLit:y.push(ep(E.escaped));break;case Wo.Percent:case _g.Numeral:y.push(ep(E.formattedStr));break;case _g.Currency:y.push(ep(v.currencySymbol));break;case _g.CurrCode:var T=E.currencySymbol,I=E.currCode;void 0!==T&&y.push(ep(T));var O=null==I?void 0:I.tag;if(O===jv.SysDate||O===jv.SysTime)throw new iS(un(["special format: x-"+O]));break;case 405:y.push(ep(v.dateSeparator));break;case 406:E.printAsTimeSep?y.push(ep(v.timeSeparator)):y.push(ep(E.formattedStr));break;case 403:var M=m();x("calc.numfmt.NumberFormatImpl: applyPart Num value",!Yr(M)),x("calc.numfmt.NumberFormatImpl: applyPart Num numState",void 0===n);var w=E.numDigLeft,D=E.numDigDec,_=2*(J=E.numPercent)-3*(Q=E.numThousands),U=f.formatFixed(M,_,D),B=U.mantissa,W=U.exponent;if(x("calc.numfmt.NumberFormatImpl: applyPart Num mantissa || !exponent",0!==B.length||0===W),x("calc.numfmt.NumberFormatImpl: applyPart Num mantissa len",B.length<=W+D),f.cond(M)<0&&(this.onlyOneNumberPart||e.forceNeg)&&0===B.length)throw nS;this.applyPart(e,E.codeBefore,f.zero,void 0),this.applyPart(e,E.code,f.zero,{comma:E.comma,fractionDenom:!1,decimal:!1,digits:B,digitsExp:W,numDigLeft:w});break;case 402:var P=m();x("calc.numfmt.NumberFormatImpl: applyPart Exp value",!Yr(P)),x("calc.numfmt.NumberFormatImpl: applyPart Exp numState",void 0===n);var V=E.numMantDigLeft,G=E.numMantDigDec,H=0===V&&0===G,j=f.formatScientific(P,V,G);B=j.mantissa,W=j.exponent;x("calc.numfmt.NumberFormatImpl: applyPart Exp mantissa || !exponent",0!==B.length||0===W||H);var K=Uu(W,V);x("calc.numfmt.NumberFormatImpl: applyPart Exp mantissa len",B.length<=K+G),this.applyPart(e,E.codeMant,f.zero,{comma:E.commaMant,fractionDenom:!1,decimal:!1,digits:B,digitsExp:K,numDigLeft:E.numMantDigLeft}),this.applyPart(e,E.codeBetween,f.zero,void 0);var Y=""!==B||H?W-K:0;Y<0?y.push(ep("-")):E.isNeg||y.push(ep("+"));var q=kg(f,f.fromNumber(Y));this.applyPart(e,E.codeExp,f.zero,{comma:E.commaMant,fractionDenom:!1,decimal:!1,digits:q,digitsExp:q.length,numDigLeft:E.numExpDigLeft});break;case 401:var z=m();x("calc.numfmt.NumberFormatImpl: applyPart Fraction value",!Yr(z)),x("calc.numfmt.NumberFormatImpl: applyPart Fraction numState",void 0===n);var J=E.numPercent,Q=E.numThousands,Z=E.numIntDigLeft,$=E.numNumerDig,ee=E.numDenomDig,te=E.commaInt,re=E.denomValue,ne=(_=2*J-3*Q,f.tenTo(_)),ae=zr(ne)?ne:f.mul(f.abs(z),ne);if(zr(ae))throw new iS(un(["overflow on fraction exp adjust"]));var ie=function(e){for(var t=e;t<y.length;t+=1){var r=y[t];r.kind===Jv.String&&(y[t]=tp(r.str))}},oe=E.anyZeroNumer,ue=void 0,se=void 0,ce=void 0;if(void 0!==E.codeInt){var le=f.trunc(ae),de=f.sub(ae,le);if(x("calc.numfmt.NumberFormatImpl: applyPart fracPart sub",Kr(de)),ue=(a=this.formFraction(de,re,ee)).numer,se=a.denom,x("calc.numfmt.NumberFormatImpl: applyPart numer <= denom",f.cond2(ue,se)<=0),0===f.cond2(ue,se)){ue=f.zero;var fe=f.add(le,f.one);x("calc.numfmt.NumberFormatImpl: applyPart bumped error",Kr(fe)),le=fe}0!==f.cond(ue)&&(oe=!0);var he=kg(f,le),ve={comma:te,fractionDenom:!1,decimal:!1,digits:he,digitsExp:he.length,numDigLeft:Z},pe=y.length;this.applyPart(e,E.codeInt,f.zero,ve),ce=y.length,x("calc.numfmt.NumberFormatImpl: applyPart Fraction lastDigInt",void 0!==E.lastDigInt),0!==f.cond(le)||!oe||E.lastDigInt===Wo.Zero?this.applyPart(e,E.codeBetween1,f.zero,void 0):(E.lastDigInt!==Wo.Question&&(y.length=pe),this.applyPart(e,E.codeBetween1,f.zero,void 0),ie(pe),E.firstDigNumer!==Wo.Question&&(y.length=pe))}else{if(ue=(i=this.formFraction(ae,re,ee)).numer,se=i.denom,f.cond(z)<0&&(this.onlyOneNumberPart||e.forceNeg)&&0===f.cond(ue))throw nS;oe=!0,ce=y.length}var me=kg(f,ue),ge={comma:!1,fractionDenom:!1,decimal:!1,digits:me,digitsExp:me.length,numDigLeft:$};this.applyPart(e,E.codeNumer,f.zero,ge),this.applyPart(e,E.codeBetween2,f.zero,void 0);var ye=kg(f,se),be={comma:!1,fractionDenom:!0,decimal:ge.decimal,digits:ye,digitsExp:ye.length,numDigLeft:ee};this.applyPart(e,E.codeDenom,f.zero,be),oe||(E.anyQuestionNumer||E.firstDigDenom===Wo.Question?ie(ce):y.length=ce);break;case Wo.Decimal:x("calc.numfmt.NumberFormatImpl: applyPart Decimal numState",void 0!==n),n.digitsExp>0&&(n.numDigLeft=n.digitsExp,this.dumpDigLeft(e,n,n.digitsExp)),n.decimal=!0,y.push(ep(v.decimalSeparator));break;case Wo.Hash:case Wo.Zero:case Wo.Question:x("calc.numfmt.NumberFormatImpl: applyPart H/Z/Q numState",void 0!==n);var Ee=E.count;if(n.decimal||n.fractionDenom&&E.kind===Wo.Question){if(n.fractionDenom&&b!==t.length-1)throw new iS(un(["left-align bug in denominator"]));if(n.digitsExp<0){var Fe=Cp(C("0",Re=Se(Ee,-n.digitsExp)),S);y.push(ep(Fe)),n.digitsExp+=Re,Ee-=Re}var Ce=Se(Ee,n.digits.length);Fe=Cp(n.digits.substring(0,Ce),S);if(y.push(ep(Fe)),n.digits=n.digits.substring(Ce),Ee-=Ce,E.kind!==Wo.Hash&&Ee>0){Fe=Cp(C("0",Ee),S);y.push(E.kind===Wo.Question?tp(Fe):ep(Fe))}break}if(n.numDigLeft>n.digitsExp){var Re=Se(Ee,n.numDigLeft-n.digitsExp);if(E.kind!==Wo.Hash){Fe=Cp(C("0",Re),S);n.comma&&(Fe=kp(v,Fe,n.numDigLeft-Re)),y.push(E.kind===Wo.Question?tp(Fe):ep(Fe))}Ee-=Re,n.numDigLeft-=Re}else Ee+=n.digitsExp-n.numDigLeft,n.numDigLeft=n.digitsExp;this.dumpDigLeft(e,n,Ee);break;case _g.PrefixDigTh:v.isThai&&(S=e.numShape=xa.Thai);break;case _g.LatinDate:throw new iS(un(["TokenKind.LatinDate"]));case _g.BidiDate:throw new iS(un(["TokenKind.BidiDate"]));case Wo.HourTh:throw new iS(un(["PictureSingle.HourTh"]));case Wo.MinuteTh:throw new iS(un(["PictureSingle.MinuteTh"]));case Wo.SecondTh:throw new iS(un(["PictureSingle.SecondTh"]));case Wo.Hour:case Wo.Minute:case Wo.Second:if(E.isAbs){var ke=m();x("calc.numfmt.NumberFormatImpl: applyPart H/M/S value",!Yr(ke));var Ne=h.toTime(this.config,f.abs(ke),zg[E.kind],e.dtrRounding);if(!1===Ne)throw new iS(un(["absolute time overflow"]));y.push(ep(Cg(f,f.fromNumber(Ne),E.count,S)))}else{var Ae=p(),Te=void 0;E.kind===Wo.Minute?Te=Ae.min:E.kind===Wo.Second?Te=Ae.sec:(Te=Ae.hour,E.isAMPM&&(Te>12&&(Te-=12),0===Te&&(Te=12))),y.push(ep(Cg(f,f.fromNumber(Te),E.count,S)))}break;case _g.AMPM:case _g.AMPMFE:var Ie=void 0;if(Ie=!!Yr(r)||p().hour<12,(void 0===(Le=null===(o=this.currCode)||void 0===o?void 0:o.culture)||E.kind===_g.AMPMFE)&&(E.kind===_g.AMPMFE||v.isEastAsia||E.pictureKind===Bo.AP2)){var Oe=E.tokenStr.indexOf(Pg(v.pictureSingle,Wo.APDelim));Oe<0&&(Oe=E.tokenStr.length>>1),y.push(ep(Ie?E.tokenStr.substring(0,Oe):E.tokenStr.substring(Oe+1)));break}if(void 0!==Le)throw new iS(un(["localised AM/PM string"]));y.push(ep(v.ampmSymbols[Ie?0:1]));break;case 404:var Me=p();x("calc.numfmt.NumberFormatImpl: applyPart FracSeconds rounding",Me.rounding>=E.rounding);var we=Rg(f,f.fromNumber(Me.fracSec),Me.rounding,E.rounding,S);y.push(ep(v.decimalSeparator+we));break;case Wo.Era:throw new iS(un(["PictureSingle.Era"]));case Wo.EraYear:throw new iS(un(["PictureSingle.EraYear"]));case Wo.YearTh:throw new iS(un(["PictureSingle.YearTh"]));case Wo.EngYearTh:throw new iS(un(["PictureSingle.EngYearTh"]));case Wo.ThYear:throw new iS(un(["PictureSingle.ThYear"]));case Wo.MonthTh:throw new iS(un(["PictureSingle.MonthTh"]));case Wo.DayTh:throw new iS(un(["PictureSingle.DayTh"]));case Wo.Year:var De=p().yr;Te=E.count>2?De:De%100;y.push(ep(Cg(f,f.fromNumber(Te),E.count,S)));break;case Wo.Month:var _e=p().mon,Le=null===(u=this.currCode)||void 0===u?void 0:u.culture;switch(E.count){case 1:case 2:y.push(ep(Cg(f,f.fromNumber(_e),E.count,S)));break;case 3:case 4:case 5:if(void 0!==Le)throw new iS(un(["localised month string"]));3===E.count?y.push(ep(v.monthNameShort[_e-1])):4===E.count?y.push(ep(v.monthNameLong[_e-1])):y.push(ep(v.monthNameLong[_e-1].substring(0,1)))}break;case Wo.Day:case Wo.LocDay:if(E.count<3){var Ue=p().dom;y.push(ep(Cg(f,f.fromNumber(Ue),E.count,S)))}else{var xe=p().wdy,Be=(Le=null===(s=this.currCode)||void 0===s?void 0:s.culture,void 0);if(v.isEastAsia&&E.kind===Wo.Day)Be=gu();else{if(void 0!==Le)throw new iS(un(["localised day string"]));Be=v}Fe=3===E.count?Be.dayNameShort[xe-1]:Be.dayNameLong[xe-1];y.push(ep(Fe))}break;default:return L("calc.numfmt.NumberFormatImpl: applyPart code",E)}}g&&m()},e.prototype.dumpDigLeft=function(e,t,r){var n=this.config.localeInfo,a=e.units,i=e.numShape,o=r,u=Se(o,t.digits.length),s=Cp(t.digits.substring(0,u),i);if(t.comma&&(s=kp(n,s,t.numDigLeft-u)),a.push(ep(s)),t.digits=t.digits.substring(u),o-=u,t.digitsExp-=u,t.numDigLeft-=u,o>0){s=Cp(C("0",o),i);t.comma&&(s=kp(n,s,t.numDigLeft-o)),a.push(ep(s)),t.digitsExp-=o,t.numDigLeft-=o}},e.prototype.getPart=function(e){for(var t=this.config.mathpack,r=0;r<2;r+=1){var n=r,a=void 0;if(0===r){if(void 0===(a=this.condPos)&&t.cond(e)>0)return{partKind:n,forceNeg:!1}}else{if(this.parts[n]===this.parts[0])throw new aS(Pv);if(0===this.parts[0].code.length)throw new iS(un(['emulation of ";[COND]foo" bug']));if(void 0===(a=this.condNeg)){if(this.parts[2]===this.parts[0])return x("calc.numfmt.NumberFormatImpl: getPart condPos",void 0!==this.condPos),{partKind:n,forceNeg:t.cond(this.condPos.operand)>0||this.condPos.operator===pa.Eq};if(t.cond(e)<0)return{partKind:n,forceNeg:!1}}}if(void 0!==a){var i=a.operator,o=a.operand;if(zr(t.sub(e,o)))throw new iS(un(["overflow in condition check"]));if(rg(i,t.cond2(e,o)))switch(i){case pa.Eq:return{partKind:n,forceNeg:!1};case pa.Ne:case pa.Gt:case pa.Ge:return{partKind:n,forceNeg:!0};case pa.Lt:return{partKind:n,forceNeg:t.cond(o)>0};case pa.Le:return{partKind:n,forceNeg:t.cond(o)>=0}}}}if(this.parts[2]===this.parts[0])throw new aS(Pv);return{partKind:2,forceNeg:!0}},e.prototype.getNumShape=function(e){var t=this.currCode,r=null==t?void 0:t.numberShape;if(void 0!==r)return r;if(void 0===e)return xa.ASCII;if(void 0!==(null==t?void 0:t.culture))throw new iS(un(["localised DBNUM culture"]));var n=this.config.localeInfo;return n.isEastAsia&&(n.isKorea?r=wg[e]:n.isJapan?r=Mg[e]:n.isChinaT?r=Ig[e]:n.isChinaS&&(r=Og[e])),null!=r?r:xa.ASCII},e.prototype.formFraction=function(e,t,r){var n,a,i,o=this.config.mathpack;if(void 0!==t){var u=o.fromNumber(137438953472);if(zr(o.sub(e,u)))throw new iS(un(["overflow in fraction threshold check"]));if(o.cond2(e,u)<0){var s=o.mul(e,o.fromNumber(1.0000000000000002));x("calc.numfmt.NumberFormatImpl: formFraction nudged error",Kr(s)),e=s}var c=t,l=o.toNumber(c)<<1,d=o.mul(e,o.fromNumber(l));if(!Kr(d))throw new iS(un(["overflow in fraction denom mul"]));var f=o.lfix(d);if(f<0||f>=65535)throw new aS(Xv);return{numer:o.fromNumber(f+1>>1),denom:c}}switch(r){case 1:i=10;break;case 2:i=100;break;case 3:i=1e3;break;case 4:i=1e4;break;case 5:i=1e5;break;case 6:i=1e6;break;default:i=1e7}var h=o.fix(e);if(h>=2147483647)throw new aS(Xv);for(var v=e,p=1,m=1,g=0,S=0;;){var y=p*h;S+=y;var b=g*h;if(m+=b,y>2147483647||b>2147483647||m>=i){1===g&&2===h&&0===o.cond2(v,o.trunc(v))&&(p+=1);break}p=(n=[S,p])[0],S=n[1],g=(a=[m,g])[0],m=a[1];var E=o.sub(v,o.trunc(v));if(x("calc.numfmt.NumberFormatImpl: formFraction frac sub",Kr(E)),0===o.cond(E))break;var F=o.div(o.one,E);if(zr(F))throw new iS(un(["overflow in fraction inversion"]));if(v=F,(h=o.fix(v))>2147483647)break}return 0===g&&(g=p=1),{numer:o.fromNumber(p),denom:o.fromNumber(g)}},e.prototype.synthesizeDecimals=function(t){for(var r=this,n=[],a=function(e){var a=i.parts[e];if((1===e||2===e)&&a===i.parts[0])return n.push(n[0]),"continue";if(3===e)return n.push(a===i.parts[0]?n[0]:a),"continue";var o=a.code,u=a.color,s=a.dbnum,c=a.dtrRounding,l={code:o.map((function(n){if(403===n.kind){var a=n.numDigLeft,i=n.numPercent,o=n.numThousands,u=n.comma,s=n.codeBefore;return{kind:403,numDigLeft:a,numDigDec:t,numPercent:i,numThousands:o,comma:u,code:r.adjustDecimals(e,n.numDigDec,n.code,t),codeBefore:s}}if(402===n.kind){var c=n.isNeg,l=n.numMantDigLeft,d=n.numExpDigLeft,f=n.commaMant,h=n.codeBetween,v=n.codeExp;return{kind:402,isNeg:c,numMantDigLeft:l,numMantDigDec:t,numExpDigLeft:d,commaMant:f,codeMant:r.adjustDecimals(e,n.numMantDigDec,n.codeMant,t),codeBetween:h,codeExp:v}}return n})),color:u,dbnum:s,dtrRounding:c};n.push(l)},i=this,o=0;o<=3;o+=1)a(o);return new e(this.config,{old:this,logFormatString:"synthesizeDecimals(dec="+t+" on "+this.logFormatString+")",synth:n})},e.prototype.adjustDecimals=function(e,t,r,n){var a;if(n===t)return r;for(var i=!1,o=void 0,u=void 0,s=void 0,c=0;c<r.length;c+=1){switch((S=r[c]).kind){case Wo.Decimal:void 0===s&&(s=c);break;case Wo.Hash:case Wo.Question:case Wo.Zero:void 0!==s?u=c:(o=c,S.kind===Wo.Question&&(i=!0))}}var l=function(e){return e===Wo.Percent||e===_g.Currency||e===_g.CurrCode||e===Wo.Star};if(0===n){if(void 0===s)return r;var d=0,f=0;void 0===o?void 0!==u&&(d=s+1,f=u+1):(d=s,f=(null!=u?u:s)+1);var h=r.slice(0,d);for(c=d;c<f;c+=1)l(r[c].kind)&&h.push(r[c]);return he(h,r.slice(f)),h}if(t>n){x("calc.numfmt.NumberFormatImpl: adjustDecimals dec",void 0!==s);var v=void 0;!function(e){e[e.AfterDigs=0]="AfterDigs",e[e.Dropping=1]="Dropping",e[e.Keeping=2]="Keeping"}(v||(v={}));var p=v.AfterDigs,m=[],g=t-n;for(c=r.length-1;c>=0;c-=1){c<=s&&(p=v.Keeping);var S=r[c];if(p===v.AfterDigs&&(S.kind!==Wo.Hash&&S.kind!==Wo.Question&&S.kind!==Wo.Zero||(p=v.Dropping)),p===v.Keeping||p===v.AfterDigs||l(S.kind))m.push(S);else if(S.kind===Wo.Hash||S.kind===Wo.Question||S.kind===Wo.Zero){var y=Se(g,S.count);y<S.count&&m.push({kind:S.kind,count:S.count-y}),0===(g-=y)&&(p=v.Keeping)}}return m.reverse(),m}if(2===e&&i&&void 0===u)return r;var b=n-t;if(void 0!==u){var E=r.slice();S=E[u];return E[u]={kind:S.kind,count:S.count+b},E}var F=r.slice(),C=null!==(a=null!=s?s:o)&&void 0!==a?a:F.length-1,R=[];return void 0===s&&R.push({kind:Wo.Decimal}),R.push({kind:Wo.Zero,count:b}),F.splice.apply(F,ie([C+1,0],R)),F},e.prototype.parseString=function(e){if(e.length>80)throw new oS(un(["long format string"]));for(var t,r,n=!1,a=!1,i=0,o=!1,u=0;u<=3&&!o;u+=1){var s=this.tokenize(e.substring(i)),c=s.cond,l=s.color,d=s.dbnum,f=this.convertTokToSun(s),h=f.dtrRounding,v=f.currCode,p=f.hasPercent,m=f.hasDate,g=f.hasTime,S=this.classifySunPartKind(f,3===u?3:0),y={code:this.convertSunToCode(f),color:l,dbnum:d,dtrRounding:h};if(i+=s.consumed,o=s.eos,p&&(this.hasPercent=!0),m&&(this.hasDate=!0),g&&(this.hasTime=!0),void 0!==v){if(0!==u&&(void 0===this.currCode||(t=this.currCode,r=v,t.culture!==r.culture||t.numberShape!==r.numberShape||t.nationalNumberInput!==r.nationalNumberInput||t.calendar!==r.calendar||t.localCalendarInput!==r.localCalendarInput||t.tag!==r.tag)))throw new oS(un(["inconsistent CurrCode in number parts"]));void 0===this.currCode&&(this.currCode=v)}if((3===S||0===u&&1===S)&&(n=!0,this.parts[3]=y,3===S)){if(void 0!==c)throw new oS(Wv("condition in text part"));if(void 0!==v)throw new oS(un(["CurrCode in text part"]));break}if(a=!0,this.parts[u]=y,this.onlyOneNumberPart=0===u,0===u)this.parts[1]=y,this.parts[2]=y,this.condPos=c;else if(1===u)this.condNeg=c;else if(void 0!==c)throw new oS(Wv("condition in zero part"))}if(!o)throw new oS(Wv("too many parts"));a||(this.parts[0]=Zg,this.parts[1]=Zg,this.parts[2]=Zg,this.posBeforeText=!1),n||(this.parts[3]=Zg),a&&!n&&this.onlyOneNumberPart&&void 0!==this.condPos&&!Xg(this.parts[0].code)&&(this.parts[1]=Zg,this.onlyOneNumberPart=!1),x("calc.numfmt.NumberFormatImpl.parseString",this.parts.every((function(e){return void 0!==e})))},e.prototype.tokenize=function(e){for(var t,r=this.config.localeInfo,n={color:void 0,dbnum:void 0,cond:void 0,currCode:void 0,tokens:[],consumed:0,eos:!0};n.consumed<e.length&&n.eos;){var a=this.readToken(n,e,n.consumed),i=t;switch(t=a,n.consumed+=a.tokenStr.length,a.kind){case Wo.Sep:n.eos=!1;continue;case _g.Color:if(void 0!==n.color)throw new oS(Wv("more than one color"));if(0!==n.tokens.length)throw new oS(un(["colour in middle of format"]));n.color=a.color;continue;case _g.Dbnum:if(void 0!==n.dbnum)throw new oS(Wv("more than one DBNUM"));if(0!==n.tokens.length)throw new oS(un(["DBNUM in middle of format"]));n.dbnum=a.dbnum;continue;case _g.Cond:if(void 0!==n.cond)throw new oS(Wv("more than one condition"));if(0!==n.tokens.length)throw new oS(un(["condition in middle of format"]));n.cond=a.cond;continue;case _g.CurrCode:if(void 0!==n.currCode)throw new oS(Wv("more than one currency code in section"));n.currCode=a.currCode;break;case _g.AMPM:case _g.AMPMFE:case Wo.Colon:case Wo.DateSep:case _g.LatinDate:case _g.BidiDate:case Wo.Year:case Wo.Month:case Wo.Day:case Wo.Hour:case Wo.Minute:case Wo.Second:case Wo.Reign:case Wo.LocDay:case Wo.Era:case Wo.EraYear:case Wo.EngYearTh:case Wo.DayTh:case Wo.MonthTh:case Wo.YearTh:case Wo.ThYear:case Wo.HourTh:case Wo.MinuteTh:case Wo.SecondTh:if((null==i?void 0:i.kind)===a.kind){i.count+=a.count;continue}}n.tokens.push(a)}return 4!==n.dbnum||r.isKorea||void 0===n.currCode&&!r.isThai||(n.dbnum=void 0),n},e.prototype.readToken=function(e,t,r){var n=this.config,a=n.mathpack,i=n.localeInfo,o=Bg(i,i.pictureSpecial,t,r);if(void 0!==o){var u=o,s=Pg(i.pictureSpecial,u);i.isJapan&&u===Bo.GeneralOldMAC&&(u=Bo.General);var c=t.substring(r,r+s.length);switch(u){case Bo.AP1:case Bo.AP2:return{kind:_g.AMPM,tokenStr:c,count:1,pictureKind:u};case Bo.AP3:return{kind:_g.AMPMFE,tokenStr:c,count:1};case Bo.General:return{kind:_g.General,tokenStr:c};case Bo.Currency:return{kind:_g.Currency,tokenStr:c}}}var l,d=qa(t,r),f=za(d),h=t.substring(r,r+f),v=Wg(i,i.pictureSingle,t,r);if(void 0!==v){u=v;if((i.isJapan||i.isChinaT)&&(u===Wo.E||u===Wo.EraYear)){var p=void 0,m=void 0;u=!(r+f+1<t.length)||45!==(p=t.charCodeAt(r+f))&&43!==p||48!==(m=t.charCodeAt(r+f+1))&&35!==m&&46!==m?Wo.EraYear:Wo.E}if(u===Wo.BidiDate||u===Wo.EngYearTh){p=void 0;if(r+f<t.length&&(49===(p=t.charCodeAt(r+f))||50===p))return{kind:49===p?_g.LatinDate:_g.BidiDate,tokenStr:t.substring(r,r+f+1),count:1};u=Wo.EngYearTh}if(u===Wo.BidiNum)throw new oS(Wv("bidi num not allowed"));switch(u){case Wo.Star:case Wo.Underscore:if(r+f>=t.length)throw new oS(Wv("unterminated "+h));var g=za(p=qa(t,r+f)),S=ja(p);return{kind:u,tokenStr:c=t.substring(r,r+f+g),escaped:S};case Wo.Backslash:return this.readToken_Backslash(t,r,f);case Wo.Quote:var y=t.indexOf(h,r+f);if(y<0)throw new oS(Wv("unterminated quoted string"));var b=t.substring(r+f,y),E=(c=t.substring(r,y+f),Bg(i,i.pictureSpecial,b,0));return void 0!==E&&E===Bo.Currency&&Pg(i.pictureSpecial,E).length===b.length?{kind:_g.Currency,tokenStr:c}:{kind:_g.StrLit,tokenStr:c,escaped:b};case Wo.E:if(i.isEastAsia){if(void 0!==e.dbnum)throw new oS(Wv("invalid DBNUM with exp"));e.dbnum=1}if(r+f>=t.length)throw new oS(Wv("unterminated exp"));if(43!==(p=t.charCodeAt(r+f))&&45!==p)throw new oS(Wv("exp not followed by sign"));c=t.substring(r,r+f+1);return{kind:_g.Exp,tokenStr:c,eStr:h,isNeg:45===p};case Wo.Hash:case Wo.Year:case Wo.Month:case Wo.Day:case Wo.Hour:case Wo.Minute:case Wo.Second:case Wo.YearTh:case Wo.MonthTh:case Wo.DayTh:case Wo.HourTh:case Wo.MinuteTh:case Wo.SecondTh:case Wo.EngYearTh:case Wo.ThYear:case Wo.Question:case Wo.Comma:case Wo.Reign:case Wo.LocDay:case Wo.Era:case Wo.EraYear:if(u===Wo.Reign&&!i.isJapan&&!i.isChinaT)break;for(var C=f,R=1;F(t,h,r+C)&&void 0===Bg(i,i.pictureSpecial,t,r+C);)C+=f,R+=1;if(u===Wo.LocDay&&R<3)break;return{kind:u,tokenStr:c=t.substring(r,r+C),count:R};case Wo.Sep:case Wo.Text:case Wo.Decimal:case Wo.Slash:case Wo.Minus:case Wo.Plus:return{kind:u,tokenStr:h};case Wo.Space:return{kind:_g.Char,tokenStr:h,escaped:h};case Wo.Colon:return{kind:u,tokenStr:h,count:1};case Wo.Percent:if(i.isEastAsia){if(void 0!==e.dbnum)throw new oS(Wv("invalid DBNUM with pct"));e.dbnum=1}return{kind:Wo.Percent,tokenStr:h};case Wo.DateSep:return h===Pg(i.pictureSingle,Wo.Slash)?{kind:Wo.Slash,tokenStr:h}:h===Pg(i.pictureSingle,Wo.Minus)?{kind:Wo.Minus,tokenStr:h}:{kind:Wo.DateSep,tokenStr:h,count:1};case Wo.ColorStart:var k=Pg(i.pictureSingle,Wo.ColorEnd),N=t.indexOf(k,r+f);if(N<0)throw new oS(Wv("unterminated ["));var A=t.substring(r+f,N),T=(c=t.substring(r,N+k.length),Bg(i,Lg,A,0));if(void 0!==T){for(var I=Pg(Lg,T).length;I<A.length&&Qa(A.charCodeAt(I));)I+=1;var O=function(e,t,r,n,a){var i=n,o=!1;if(i<r.length){var u=r.charCodeAt(i);if((43===u||45===u)&&(o=45===u,i+=1,a))for(;i<r.length&&Qa(r.charCodeAt(i));)i+=1}var s=$a(e,t,r,i,!1,!1,!1);return void 0===(null==s?void 0:s.value)?[t.zero,n]:(i=s.i,[o?t.neg(s.value):s.value,i])}(i,a,A,I,!1);if(O[1]===I)throw new oS(un(["invalid number in condition"]));if(O[1]!==A.length)throw new oS(un(["trailing junk after condition"]));return{kind:_g.Cond,tokenStr:c,cond:{operator:Ug[T],operand:O[0]}}}var M=Bg(i,i.pictureColor,A,0);if(void 0!==M){var w=Pg(i.pictureColor,M);if(M!==Po.Color){if(w.length!==A.length)throw new oS(un(["trailing junk after named color"]));return{kind:_g.Color,tokenStr:c,color:(l=M,Po[l])}}if(M===Po.Color){for(var D=w.length;D<A.length&&Qa(A.charCodeAt(D));)D+=1;var _=Xa(i,4,A,D),U=_[0],x=_[1];if(x===D)throw new oS(Wv("missing number for numbered color"));if(x!==A.length)throw new oS(un(["trailing junk after numbered color"]));if(U<1||U>56)throw new oS(Wv("out-of-range numbered color"));return{kind:_g.Color,tokenStr:c,color:U+8}}}var B=Bg(i,i.pictureDbnum,A,0);if(void 0!==B){if(Pg(i.pictureDbnum,B).length!==A.length)throw new oS(un(["trailing junk after DBNUM"]));return{kind:_g.Dbnum,tokenStr:c,dbnum:Dg(B)}}return F(A,"$")?te({kind:_g.CurrCode,tokenStr:c},this.parseCurrCode(A.substring("$".length))):{kind:u,tokenStr:h};case Wo.ColorEnd:return{kind:u,tokenStr:h};case Wo.OpenParen:case Wo.CloseParen:return{kind:u,tokenStr:h,escaped:h};case Wo.Extra:case Wo.APDelim:case Wo.Nen1:case Wo.Gatsu1:case Wo.Nichi1:case Wo.Nen2:case Wo.Gatsu2:case Wo.Nichi2:break;case Wo.Zero:case Wo.ZeroTh:break;default:return L("calc.numfmt.NumberFormatImpl: readToken single picKind",u)}}if(i.isNumeral(d)){if(i.getNumberShape(d)!==xa.ASCII)throw new oS(un(["non-ASCII digits"]));var W=i.getOrdinal(d);if(0===W){var P=f;for(R=1;F(t,h,r+P);)P+=f,R+=1;c=t.substring(r,r+P);return{kind:Wo.Zero,tokenStr:c,count:R}}return{kind:_g.Numeral,tokenStr:h,ordinal:W}}switch(d){case 40:return{kind:Wo.OpenParen,tokenStr:h,escaped:h};case 41:return{kind:Wo.CloseParen,tokenStr:h,escaped:h};case 92:return this.readToken_Backslash(t,r,f);case 116:if(i.isThai)return{kind:_g.PrefixDigTh,tokenStr:h}}return{kind:_g.Char,tokenStr:h,escaped:h}},e.prototype.readToken_Backslash=function(e,t,r){if(t+r>=e.length)throw new oS(Wv("unterminated backslash"));var n=qa(e,t+r),a=za(n),i=ja(n),o=e.substring(t,t+r+a);return 40===n||41===n?{kind:40===n?Wo.OpenParen:Wo.CloseParen,tokenStr:o,escaped:i}:{kind:_g.Char,tokenStr:o,escaped:i}},e.prototype.convertTokToSun=function(e){var t,r,n,a,i,o,u,s=e.color,c=e.dbnum,l=e.cond,d=e.currCode,f=e.tokens,h=this.config.localeInfo,v={suns:[],dtrRounding:uo.RoundSec,dbnum:c,currCode:d,hasPercent:!1,hasDate:!1,hasTime:!1,get isEmpty(){return 0===this.suns.length&&void 0===l&&void 0===s&&void 0===c&&void 0===d}},p=0===h.stringCompareCI(Pg(h.pictureSingle,Wo.Month),Pg(h.pictureSingle,Wo.Minute)),m=!1,g=0,S=0,y=!1,b=!1,E=!1,F=!1,C=0;function R(e,t){var n=zg[e];if(t){if(b)throw new oS(Wv("more than one absolute time"));if(void 0!==r&&n>=r)throw new oS(Wv("absolute time must be largest division"));b=!0}else if(b&&n<=r)throw new oS(un(["larger time division after absolute time"]));(void 0===r||n<r)&&(r=n)}function k(e,t,n){var a=r;if(R(e,t),e===Wo.Hour||e===Wo.HourTh)E=!0,i=n,o=void 0;else if(e===Wo.Second||e===Wo.SecondTh)if(void 0===o||b)void 0===a&&(E=!0);else{var u=o.code[0];x("calc.numfmt.NumberFormatImpl: onTime ambigCode",u.kind===Wo.Month);var s=Wo.Minute,c=u.count;x("calc.numfmt.NumberFormatImpl: onTime ambigCount",1===c||2===c);R(s,!1),g-=1,S+=1,o.code=[{kind:s,count:c,isAbs:!1}],o=void 0}else E=!1}function N(e){var t=Pg(h.pictureSingle,e.kind);return{kind:406,printAsTimeSep:g>0||S>0,formattedStr:t}}function A(e){var t=Pg(h.pictureSingle,e.kind);return t===Pg(h.pictureSingle,Wo.DateSep)?{kind:405}:t===Pg(h.pictureSingle,Wo.Colon)?N(e):{kind:400,formattedStr:t}}for(var T=0;T<f.length;T+=1){var I=f[T];switch(I.kind){case _g.AMPM:case _g.AMPMFE:case Wo.Colon:case Wo.DateSep:case Wo.Year:case Wo.Month:case Wo.Day:case Wo.Hour:case Wo.Minute:case Wo.Second:case Wo.Reign:case Wo.LocDay:case Wo.Era:case Wo.EraYear:case Wo.EngYearTh:case _g.LatinDate:case _g.BidiDate:case Wo.DayTh:case Wo.MonthTh:case Wo.YearTh:case Wo.ThYear:case Wo.HourTh:case Wo.MinuteTh:case Wo.SecondTh:var O={kind:1,code:[]};switch(v.suns.push(O),y=!0,I.kind){case _g.LatinDate:case _g.BidiDate:if(0!==T)throw new oS(Wv("bidi date must be first"));O.code.push(I);break;case Wo.DateSep:O.code.push({kind:405});break;case Wo.Colon:O.code.push(N(I));break;case Wo.Reign:g+=1,h.isJapan&&I.count>=2&&O.code.push({kind:Wo.Era,count:3}),O.code.push({kind:Wo.EraYear,count:h.isChinaT?1:2});break;case Wo.Era:g+=1,O.code.push({kind:Wo.Era,count:Se(3,I.count)});break;case Wo.EraYear:g+=1,O.code.push({kind:Wo.EraYear,count:Se(2,I.count)});break;case Wo.Year:case Wo.YearTh:case Wo.EngYearTh:case Wo.ThYear:o=void 0,g+=1,O.code.push({kind:I.kind,count:I.count<=2?2:4});break;case Wo.Month:if(p&&I.count<=2){if(E){k(z=Wo.Minute,M=!1,O),S+=1,O.code.push({kind:z,count:I.count,isAbs:M}),E=!1;break}o=O}else o=void 0;g+=1,O.code.push({kind:I.kind,count:Se(5,I.count)});break;case Wo.MonthTh:g+=1,O.code.push({kind:I.kind,count:Se(4,I.count)});break;case Wo.Day:case Wo.DayTh:o=void 0,g+=1,O.code.push({kind:I.kind,count:Se(4,I.count)});break;case Wo.LocDay:o=void 0,g+=1,O.code.push({kind:Wo.LocDay,count:3===I.count?3:4});break;case Wo.Hour:case Wo.HourTh:case Wo.Minute:case Wo.MinuteTh:case Wo.Second:case Wo.SecondTh:var M=!1;k(I.kind,M,O),S+=1;var w=Se(2,I.count);I.kind===Wo.Hour||I.kind===Wo.HourTh?O.code.push({kind:I.kind,count:w,isAbs:M,isAMPM:!1}):O.code.push({kind:I.kind,count:w,isAbs:M});break;case _g.AMPM:case _g.AMPMFE:if(b)throw new oS(Wv("AM/PM after absolute time"));if(I.count>1)throw new oS(un(["multiple AM/PM symbols"]));if(void 0!==i)(G=i.code[0]).isAMPM=!0,i=void 0;F=!0,O.code.push(I);break;default:return L("calc.numfmt.NumberFormatImpl: convertTokToSun tok as date",I)}break;case Wo.Decimal:case _g.Numeral:case Wo.Hash:case Wo.Zero:case Wo.Question:case Wo.Comma:if(y){if(I.kind!==Wo.Decimal&&I.kind!==Wo.Comma)throw new oS(Wv("number picture in date/time format"));var D={kind:1,code:[]};v.suns.push(D);var _=f[T+1];if(I.kind===Wo.Decimal&&(null==_?void 0:_.kind)===Wo.Zero){var U=_.count;if(U>3)throw new oS(Wv("invalid number of fractional seconds"));T+=1,k(Wo.Second,!1,D),S+=1,D.code.push({kind:404,rounding:U}),v.dtrRounding=ye(v.dtrRounding,U)}else D.code.push(A(I));break}if(I.kind===Wo.Comma){var B={kind:7,code:[{kind:400,formattedStr:Pg(h.pictureSingle,I.kind)}]};v.suns.push(B);break}O={kind:0,code:[],numDigLeft:0,numDigDec:0,numPercent:0,numThousands:0,comma:!1,decimal:!1,numVal:!1,nonZero:!1,get digitTokens(){return this.anyHash||this.anyQuestion},get reallyNum(){return this.anyHash||this.anyQuestion||this.anyZero},lastDig:void 0,firstDig:void 0,anyHash:!1,anyQuestion:!1,anyZero:!1};v.suns.push(O),void 0===n&&(n=O),a=O;var W=void 0;for(T-=1;T+1<f.length;T+=1){var P=f[T+1],V=!0;switch(P.kind){case Wo.Decimal:m=O.decimal=!0,O.code.push(P),W=void 0;break;case _g.Numeral:O.code.push({kind:P.kind,formattedStr:P.tokenStr,ordinal:P.ordinal}),O.numVal=O.nonZero=!0,W=void 0;break;case Wo.Hash:case Wo.Zero:case Wo.Question:if(O.decimal?O.numDigDec+=P.count:O.numDigLeft+=P.count,void 0===O.firstDig&&(O.firstDig=P.kind),O.lastDig=P.kind,P.kind===Wo.Hash?O.anyHash=!0:P.kind===Wo.Question?O.anyQuestion=!0:(O.anyZero=!0,O.numVal=!0),void 0!==W&&W.kind===P.kind)W.count+=P.count;else{var G={kind:P.kind,count:P.count};O.code.push(G),W=G}break;case Wo.Comma:_=null===(t=f[T+2])||void 0===t?void 0:t.kind;if((u=_)!==_g.Numeral&&u!==Wo.Hash&&u!==Wo.Zero&&u!==Wo.Question){w=P.count;var H=Pg(h.pictureSingle,Wo.Space);H===Pg(h.pictureSingle,Wo.Comma)&&(!h.isCurrencySymbolLead&&h.isCurrencySepBySpace&&_===_g.Currency||h.isPercentSepBySpace&&_===Wo.Percent)&&(O.code.push({kind:400,formattedStr:H}),w-=1),w>0&&(O.numThousands+=w)}else m||(O.comma=!0);break;default:V=!1}if(!V)break}break;case Wo.Percent:C+=1;O={kind:3,code:[{kind:Wo.Percent,formattedStr:I.tokenStr}]};v.suns.push(O),v.hasPercent=!0;break;case _g.Exp:O={kind:4,code:[{kind:_g.Exp,formattedStr:I.eStr,isNeg:I.isNeg}],isNeg:I.isNeg};v.suns.push(O);break;case _g.General:O={kind:6,code:[I]};v.suns.push(O);break;case Wo.Star:case _g.PrefixDigTh:case Wo.Underscore:case _g.Currency:case _g.CurrCode:O={kind:7,code:[I]};v.suns.push(O);break;case Wo.Text:O={kind:5,code:[I]};v.suns.push(O);break;case _g.StrLit:O={kind:7,code:[I]};v.suns.push(O);break;case Wo.ColorEnd:case Wo.Plus:O={kind:7,code:[{kind:400,formattedStr:I.tokenStr}]};v.suns.push(O);break;case Wo.OpenParen:case Wo.CloseParen:case _g.Char:O={kind:7,code:[{kind:400,formattedStr:I.escaped}]};v.suns.push(O);break;case Wo.Slash:if(y){var j={kind:1,code:[A(I)]};v.suns.push(j);break}O={kind:2,code:[{kind:Wo.Slash,formattedStr:I.tokenStr}]};v.suns.push(O);break;case Wo.Minus:if(y){var K={kind:1,code:[A(I)]};v.suns.push(K);break}O={kind:7,code:[{kind:400,formattedStr:Pg(h.pictureSingle,I.kind)}]};v.suns.push(O);break;case Wo.ColorStart:var Y=0;for(O={kind:1,code:[]};T+1<f.length&&2!==Y;T+=1){var q=f[T+1];switch(q.kind){case Wo.ColorEnd:if(1!==Y)throw new oS(Wv("unexpected closing ]"));Y=2;continue;case Wo.Hour:case Wo.Month:case Wo.Minute:case Wo.Second:if(q.kind===Wo.Month&&!p)break;var z;k(z=q.kind===Wo.Month?Wo.Minute:q.kind,M=!0,O),S+=1;w=Se(2,q.count);z===Wo.Hour?O.code.push({kind:z,count:w,isAbs:M,isAMPM:!1}):O.code.push({kind:z,count:w,isAbs:M}),y=!0,Y=1;continue;case _g.Char:if(q.tokenStr===Pg(h.pictureSingle,Wo.Space))continue;break;case Wo.HourTh:throw new oS(un(["Thai hour in ["]))}throw new oS(Wv("unexpected token after ["))}if(2!==Y)throw new oS(un(["semicolon inside [ ]"]));v.suns.push(O);break;default:return L("calc.numfmt.NumberFormatImpl: convertTokToSun tok",I)}}(void 0!==n&&(n.numThousands=a.numThousands,n.numPercent=C),F&&void 0!==i)&&((G=i.code[0]).isAMPM=!0);if(b)for(var J=0,Q=v.suns;J<Q.length;J++){if(1===(O=Q[J]).kind)for(var X=0,Z=O.code;X<Z.length;X++){switch((G=Z[X]).kind){case Wo.Hour:case Wo.HourTh:case Wo.Minute:case Wo.MinuteTh:case Wo.Second:case Wo.SecondTh:G.isAbs=zg[G.kind]===r}}}return v.hasDate=g>0,v.hasTime=S>0,v},e.prototype.classifySunPartKind=function(e,t){for(var r=e.suns,n=e.isEmpty,a=e.hasDate,i=e.hasTime,o=2===t,u=3===t,s=!o&&!u,c=0,l=r;c<l.length;c++){var d=l[c];switch(d.kind){case 0:case 2:case 3:case 4:o=!0;break;case 5:u=!0;break;case 6:continue;case 7:case 1:break;default:return L("calc.numfmt.NumberFormatImpl: classifySunPartKind sun",d)}s=!1}if((o?1:0)+(a||i?1:0)+(u?1:0)>1)throw new oS(Wv("cannot mix number/date/text"));return o||a||i?2:u?3:s&&!n?1:t},e.prototype.convertSunToCode=function(e){var t,r=e.suns,n=e.isEmpty,a=e.dbnum,i=this.config.localeInfo,o=[];function u(e){for(var t=e-1;t>=0;t-=1){var n=r[t];if(0===n.kind)return[t,n]}}function s(e){for(var t=e+1;t<r.length;t+=1){var n=r[t];if(0===n.kind)return[t,n]}}for(var c=!1,l=0,d=0;d<r.length;d+=1){var f=r[d];switch(f.kind){case 5:if(5===t)break;if(void 0!==t)throw new oS(Wv("@ after other control"));t=5;break;case 6:if(void 0!==t)throw new oS(Wv("General after other control"));if(c)throw new oS(Wv("General after number"));t=6;break;case 0:if(c=!0,6===t)throw new oS(Wv("number after General"));break;case 2:if(void 0!==t)throw new oS(Wv("/ after other control"));if(i.isEastAsia&&void 0!==a)throw new oS(Wv("/ not allowed with DBNUM"));t=2;var h=u(d);if(void 0===h)throw new oS(Wv("no number before /"));var v=this.mergeNumSuns(r,l,h[0]),p=v[0],m=v[1],g=v[2],S=s(d);if(void 0===S)throw new oS(Wv("no number after /"));var y=r.slice(h[0]+1,S[0]),b=void 0!==s(S[0]);he(o,this.flattenSuns(p)),he(o,this.buildFractCode(m,g,h[1],y,S[1],b)),l=S[0]+1;break;case 4:if(void 0!==t)throw new oS(Wv("E after other control"));t=4;var E=this.mergeNumSuns(r,l,d),F=E[0],C=E[1],R=E[2];if(void 0===C)throw new oS(Wv("no number before E"));var k=this.mergeNumSuns(r,d+1,r.length),N=k[0],A=k[1],T=k[2];if(void 0===A)throw new oS(Wv("no number after E"));he(o,this.flattenSuns(F)),he(o,this.buildExpCode(f.isNeg,C,ie(R,[r[d]],N),A)),he(o,this.flattenSuns(T)),l=r.length;break;case 3:case 7:case 1:break;default:return L("calc.numfmt.NumberFormatImpl: convertSunToCode sun",f)}}if(void 0===t){var I=this.mergeNumSuns(r,l,r.length),O=(p=I[0],I[1]),M=I[2];he(o,void 0!==O?this.buildNumberCode(p,O):this.flattenSuns(p)),he(o,this.flattenSuns(M)),l=r.length}return he(o,this.flattenSuns(r.slice(l))),0!==r.length||n||o.push(Qg),o},e.prototype.flattenSuns=function(e){return ve([],e.map((function(e){return e.code})))},e.prototype.buildExpCode=function(e,t,r,n){if(n.comma)throw new oS(Wv("comma following E"));var a=this.bumpDigitsForComma(t),i=a.code,o=a.comma;return[{kind:402,isNeg:e,numMantDigLeft:a.numDigLeft,numMantDigDec:t.numDigDec,numExpDigLeft:n.numDigLeft,commaMant:o,codeMant:i,codeBetween:this.flattenSuns(r),codeExp:this.flattenSuns([n])}]},e.prototype.buildNumberCode=function(e,t){var r=this.bumpDigitsForComma(t),n=r.code,a=r.comma;return[{kind:403,numDigLeft:r.numDigLeft,numDigDec:t.numDigDec,numPercent:t.numPercent,numThousands:t.numThousands,comma:a,codeBefore:this.flattenSuns(e),code:n}]},e.prototype.buildFractCode=function(e,t,r,n,a,i){var o,u,s,c,l=this.config.mathpack;if(r.comma)throw new oS(Wv("comma in numerator"));if(r.decimal)throw new oS(un(["decimals in numerator"]));if(a.comma)throw new oS(Wv("comma in denominator"));if(a.decimal)throw new oS(Wv("decimals in denominator"));if(0!==r.numDigDec)throw new oS(Wv("decimals in numerator"));if((c=a).numVal&&c.nonZero&&c.digitTokens)throw new oS(Wv("literal and placeholder digits mixed in denominator"));if(i)throw new oS(un(["fraction number formats with trailing numbers"]));var d,f=!1,h=0;if(void 0!==e){if(!e.reallyNum)throw new oS(un(["fixed numerals in fraction integer part"]));if(e.decimal)throw new oS(un(["decimal in fraction integer part"]));if(0!==e.numDigDec)throw new oS(Wv("decimals in fraction integer part"));if(e.numVal&&e.nonZero)throw new oS(un(["numerals in fraction integer part"]));d=(o=this.bumpDigitsForComma(e)).code,f=o.comma,h=o.numDigLeft}var v=null!==(u=null==e?void 0:e.numPercent)&&void 0!==u?u:r.numPercent,p=null!==(s=null==e?void 0:e.numThousands)&&void 0!==s?s:r.numThousands;if(p>0)throw new oS(un(["fraction number formats with thousands"]));var m,g=a.code,S=a.numDigLeft,y=a.firstDig;if(a.numVal&&a.nonZero){if(i)throw new oS(un(["fraction number formats with specified denominator and trailing numbers"]));if(a.code.length>5)throw new oS(un(["too many digits in denominator"]));for(var b=0,E=0;E<a.code.length;E+=1){var F=a.code[E];switch(F.kind){case _g.Numeral:b=10*b+F.ordinal;break;case Wo.Zero:if(0===E)throw new oS(un(["leading zero in denominator"]));b*=10;break;default:return U("calc.numfmt.NumberFormatImpl: buildFractCode denomCode")}}if(b>32767)throw new oS(un(["overflow in denominator not emulated"]));g=[{kind:Wo.Hash,count:1}],S=1,y=void 0,m=l.fromNumber(b)}return[{kind:401,numIntDigLeft:h,numPercent:v,numThousands:p,numNumerDig:r.numDigLeft,numDenomDig:S,commaInt:f,codeInt:d,codeBetween1:this.flattenSuns(t),codeNumer:r.code,codeBetween2:this.flattenSuns(n),codeDenom:g,denomValue:m,lastDigInt:void 0!==e?e.lastDig:void 0,firstDigNumer:r.firstDig,firstDigDenom:y,anyZeroNumer:r.anyZero,anyQuestionNumer:r.anyQuestion}]},e.prototype.mergeNumSuns=function(e,t,r){for(var n,a=[],i=[],o=t;o<e.length&&o<r;o+=1){var u=e[o];void 0!==n?0===u.kind?(n.decimal?n.numDigDec+=u.numDigLeft+u.numDigDec:(n.numDigLeft+=u.numDigLeft,n.numDigDec+=u.numDigDec),n.comma=n.comma||u.comma,n.decimal=n.decimal||u.decimal,n.numVal=n.numVal||u.numVal,n.nonZero=n.nonZero||u.nonZero,void 0!==u.lastDig&&(n.lastDig=u.lastDig),void 0===n.firstDig&&(n.firstDig=u.firstDig),n.anyHash=n.anyHash||u.anyHash,n.anyQuestion=n.anyQuestion||u.anyQuestion,n.anyZero=n.anyZero||u.anyZero,he(n.code,this.flattenSuns(i)),i.length=0,he(n.code,u.code)):i.push(u):0===u.kind?n=u:a.push(u)}return[a,n,i]},e.prototype.bumpDigitsForComma=function(e){if(!e.comma)return e;if(this.anyLegalCommaPosition(e))return e;for(var t=e.numDigLeft%3,r=(0===t?0===e.numDigLeft?3:e.numDigLeft:e.numDigLeft+3-t)+1,n=0;n<e.code.length;n+=1){var a=e.code[n];switch(a.kind){case Wo.Hash:return(i=e.code.slice())[n]=te(te({},a),{count:a.count+(r-e.numDigLeft)}),{code:i,comma:!0,numDigLeft:r};case Wo.Zero:case Wo.Question:case Wo.Decimal:var i;return(i=e.code.slice()).splice(n,0,{kind:Wo.Hash,count:r-e.numDigLeft}),{code:i,comma:!0,numDigLeft:r}}}throw new oS(un(["comma with pure number literal"]))},e.prototype.anyLegalCommaPosition=function(e){if(e.numDigLeft<4)return!1;for(var t=function(e){var t=null==e?void 0:e.kind;return t===Wo.Hash||t===Wo.Zero||t===Wo.Question},r=e.numDigLeft,n=0;n<e.code.length;n+=1){var a=e.code[n];if(a.kind===Wo.Decimal)return!1;if(t(a))for(var i=0;i<a.count;i+=1)if((r-=1)>0&&r%3==0&&(i+1<a.count||t(e.code[n+1])))return!0}return!1},e.prototype.parseCurrCode=function(e){if(!Y(w["OfficeVSO:3852168_CalcCGSimpleCurrCode"]))throw new oS(un(["parsing of CurrCode: "+b(e)]));var t,r,n,a=this.config.localeInfo,i=e.indexOf("-");if(0!==e.length&&0!==i){if((t=i<0?e:e.substring(0,i)).length>61)throw new oS(Wv("currencySymbol too long"));for(var o=0,u=Ja(t);o<u.length;o++){var s=u[o];if(a.isNumeral(s)&&a.getNumberShape(s)!==xa.ASCII)throw new oS(un(["non-ASCII digits in currencySymbol"]))}}if(i>=0&&(n=e.substring(i+"-".length)),void 0!==n&&void 0===(r=this.parseFormatCulture(n)))throw new oS(un(["unhandled CurrCode: "+b(e)]));return{currencySymbol:t,currCode:r}},e.prototype.parseFormatCulture=function(e){var t,r,n={culture:"",numberShape:void 0,nationalNumberInput:!1,calendar:void 0,localCalendarInput:!1,tag:void 0},a=e.match(Gg);if(null!=a){n.culture=null!==(t=a[1])&&void 0!==t?t:"";var i=null!==(r=a[2])&&void 0!==r?r:a[3];if(null!=i){if(n.tag=Kg[i.toLowerCase()],void 0===n.tag)return;switch(n.tag){case jv.SysDate:case jv.SysTime:case jv.Euro1:case jv.Euro2:case jv.Bitcoin1:case jv.Bitcoin2:if(""!==n.culture)return;break;case jv.GenLower:case jv.GenUpper:case jv.NomLower:case jv.Gannen:if(""===n.culture)return}}var o=a[4];if(null!=o){var u=qg(o),s=(32512&u)>>8;if(0!==s&&(n.numberShape=Hg[s],void 0===n.numberShape))return;n.nationalNumberInput=0!=(32768&u);var c=127&u;if(0!==c&&(n.calendar=jg[c],void 0===n.calendar))return;n.localCalendarInput=0!=(128&u)}return n}if(Vg.test(e)){var l=qg(e);switch(l){case xo.SystemLongDate:n.tag=jv.SysDate;break;case xo.SystemTime:n.tag=jv.SysTime;break;case xo.EuroTrailing:n.tag=jv.Euro1;break;case xo.EuroLeading:n.tag=jv.Euro2;break;default:64512==(64512&l)&&(n.tag=jv.GenLower),63488==(64512&l)&&(n.tag=jv.GenUpper),62464==(64512&l)&&(n.tag=jv.NomLower),void 0!==n.tag&&(l&=-63489),n.culture=l}return n}},e.prototype.determineValueType=function(){for(var e=this.config.localeInfo,t={accountFill:!1,fvt:void 0},r=0,n=this.parts;r<n.length;r++){var a=n[r];t.accountFill=!1;var i=this.determineValueTypeCodes(t,a.code);if(void 0!==i)return i;if(t.accountFill&&(t.fvt===Gv.Number||t.fvt===Gv.Currency))return Gv.Accounting;if(void 0!==t.fvt)return t.fvt}return void 0!==t.fvt?t.fvt:this.formatString===Pg(e.pictureSpecial,Bo.General)?Gv.General:Gv.Custom},e.prototype.determineValueTypeCodes=function(e,t){for(var r=this.config.localeInfo,n=0;n<t.length;n+=1){var a=t[n];switch(a.kind){case _g.General:break;case Wo.Text:return Gv.Text;case Wo.Star:e.accountFill=!0;break;case 400:case _g.Exp:case Wo.Slash:case _g.StrLit:case Wo.Percent:case Wo.Underscore:case _g.Numeral:case 405:case 406:break;case _g.Currency:e.fvt=Gv.Currency;break;case _g.CurrCode:void 0!==a.currencySymbol&&(e.fvt=Gv.Currency);break;case 403:e.fvt=1===a.numPercent&&0===a.numThousands?Gv.Percentage:Gv.Number;var i=a.codeBefore,o=0;if(r.isEastAsia){if(o<i.length&&"("===Jg(i[o])&&(o+=1),o<i.length&&"US$"===Jg(i[o]))return Gv.Currency;if(r.isChinaT){if(o<i.length&&"NT$"===Jg(i[o]))return Gv.Currency}else if(o<i.length&&"$"===Jg(i[o]))return Gv.Currency}var u=void 0;if(void 0!==(u=this.determineValueTypeCodes(e,a.codeBefore.slice(o))))return u;if(void 0!==(u=this.determineValueTypeCodes(e,a.code)))return u;break;case 402:e.fvt=Gv.Scientific;u=void 0;if(void 0!==(u=this.determineValueTypeCodes(e,a.codeMant)))return u;if(void 0!==(u=this.determineValueTypeCodes(e,a.codeBetween)))return u;if(void 0!==(u=this.determineValueTypeCodes(e,a.codeExp)))return u;break;case 401:e.fvt=Gv.Fraction;u=void 0;if(void 0!==a.codeInt&&void 0!==(u=this.determineValueTypeCodes(e,a.codeInt)))return u;if(void 0!==(u=this.determineValueTypeCodes(e,a.codeBetween1)))return u;if(void 0!==(u=this.determineValueTypeCodes(e,a.codeNumer)))return u;if(void 0!==(u=this.determineValueTypeCodes(e,a.codeBetween2)))return u;if(void 0!==(u=this.determineValueTypeCodes(e,a.codeDenom)))return u;break;case Wo.Decimal:case Wo.Hash:case Wo.Zero:case Wo.Question:break;case _g.PrefixDigTh:case _g.LatinDate:case _g.BidiDate:break;case Wo.HourTh:case Wo.MinuteTh:case Wo.SecondTh:case Wo.Hour:case Wo.Minute:case Wo.Second:case 404:return Gv.Time;case _g.AMPM:case _g.AMPMFE:break;case Wo.Era:case Wo.EraYear:case Wo.YearTh:case Wo.EngYearTh:case Wo.ThYear:case Wo.MonthTh:case Wo.DayTh:case Wo.Year:case Wo.Month:case Wo.Day:case Wo.LocDay:return Gv.Date;default:return L("calc.numfmt.NumberFormatImpl: determineValueTypeCodes code",a)}}},e.prototype.determineDecimals=function(){for(var e=0,t=this.parts[0].code;e<t.length;e++){var r=t[e];switch(r.kind){case 403:return r.numDigDec;case 402:return r.numMantDigDec}}return 0},e.prototype.determineBidiDate=function(){var e=Pg(this.config.localeInfo.pictureSingle,Wo.BidiDate);return F(this.formatString,e+"1")?Hv.English:F(this.formatString,e+"2")?Hv.Lunar:void 0},e.prototype.printFormatString=function(){var e=this.config.localeInfo,t=this.parts,r=t[0],n=t[1],a=t[2],i=t[3],o=!($g(i)||i===r),u=this.posBeforeText||!o,s="";return u&&(s+=this.printPart(r,this.condPos),n!==r&&(s+=Pg(e.pictureSingle,Wo.Sep),s+=this.printPart(n,this.condNeg),a!==r&&(s+=Pg(e.pictureSingle,Wo.Sep),s+=this.printPart(a,void 0)))),o&&(u&&(s+=Pg(e.pictureSingle,Wo.Sep)),s+=this.printPart(i,void 0)),s},e.prototype.printPart=function(e,t){var r,n=this.config,a=n.mathpack,i=n.localeInfo,o="";if(void 0!==e.color&&(o+=Pg(i.pictureSingle,Wo.ColorStart)+("number"==typeof e.color?Pg(i.pictureColor,Po.Color)+String(e.color-8):Pg(i.pictureColor,(r=e.color,Po[r])))+Pg(i.pictureSingle,Wo.ColorEnd)),void 0!==t){o+=Pg(i.pictureSingle,Wo.ColorStart)+Pg(Lg,xg[t.operator])+a.formatGeneral(i,t.operand,21)+Pg(i.pictureSingle,Wo.ColorEnd)}return void 0!==e.dbnum&&(o+=Pg(i.pictureSingle,Wo.ColorStart)+Pg(i.pictureDbnum,e.dbnum-1)+Pg(i.pictureSingle,Wo.ColorEnd)),o+=this.printCodes({seenDig:!1,wasPrevDig:!1},e.code,void 0)},e.prototype.printCodes=function(e,t,r){var n,a=this.config,i=a.mathpack,o=a.localeInfo,u="";if(void 0!==r&&r.numThousands>0){for(var s=0;s<t.length;s+=1){var c=t[s].kind;c!==Wo.Zero&&c!==Wo.Hash&&c!==Wo.Question&&c!==Wo.Decimal&&c!==_g.Numeral||(n=s)}x("calc.numfmt.NumberFormatImpl: printCodes thousandsAfter",void 0!==n)}var l=function(a){var s=t[a],c=e.wasPrevDig;switch(e.wasPrevDig=!1,s.kind){case _g.General:u+=Pg(o.pictureSpecial,Bo.General);break;case Wo.Decimal:void 0!==r&&(r.decimal=!0),e.wasPrevDig=!0,u+=Pg(o.pictureSingle,Wo.Decimal);break;case Wo.Hash:case Wo.Zero:case Wo.Question:e.seenDig=!0,e.wasPrevDig=!0;var l=C(s.kind===Wo.Zero?"0":Pg(o.pictureSingle,s.kind),s.count);if(void 0===r||r.decimal){u+=l;break}if(r.comma){var f=r.numDigLeft-s.count;u+=kp({isThousandsPosition:function(e){var r,n;return e>0&&e%3==0&&(e>f||((n=null===(r=t[a+1])||void 0===r?void 0:r.kind)===Wo.Hash||n===Wo.Zero||n===Wo.Question))},thousandsSeparator:Pg(o.pictureSingle,Wo.Comma)},l,f)}else u+=l;r.numDigLeft-=s.count;break;case _g.Numeral:e.wasPrevDig=!0,u+=s.formattedStr;break;case 402:u+=d.printCodes(e,s.codeMant,{comma:s.commaMant,numThousands:0,decimal:!1,numDigLeft:s.numMantDigLeft})+d.printCodes(e,s.codeBetween,void 0)+d.printCodes(e,s.codeExp,{comma:!1,numThousands:0,decimal:!1,numDigLeft:s.numExpDigLeft});break;case 403:u+=d.printCodes(e,s.codeBefore,void 0)+d.printCodes(e,s.code,{comma:s.comma,numThousands:s.numThousands,decimal:!1,numDigLeft:s.numDigLeft});break;case 401:var h=void 0===s.codeInt?"":d.printCodes(e,s.codeInt,{comma:s.commaInt,numThousands:0,decimal:!1,numDigLeft:s.numIntDigLeft}),v=d.printCodes(e,s.codeBetween1,void 0),p=d.printCodes(e,s.codeNumer,{comma:!1,numThousands:0,decimal:!1,numDigLeft:s.numNumerDig}),m=d.printCodes(e,s.codeBetween2,void 0),g=d.printCodes(e,s.codeDenom,{comma:!1,numThousands:s.numThousands,decimal:!1,numDigLeft:s.numDenomDig});u+=h+v+p+m+(void 0!==s.denomValue?kg(i,s.denomValue):g);break;case 400:var S=Pg(o.pictureSingle,Wo.Backslash),y=Wg(o,o.pictureSingle,s.formattedStr,0),b=function(e,t,r,n){var a=r.substring(n,n+za(qa(r,n)));for(var i in t){var o=t[i];if(null!=o&&0!==o.length){var u=o.substring(0,za(qa(o,0)));if(0===e.stringCompareCI(a,u))return!0}}return!1}(o,o.pictureSpecial,s.formattedStr,0);if(void 0!==y&&y!==Wo.Extra&&y!==Wo.Zero)switch(y){case Wo.Comma:var E=t[a+1];if(c){var F=Pg(o.pictureSingle,Wo.Space);if(s.formattedStr!==F||void 0===E||(o.isCurrencySymbolLead||!o.isCurrencySepBySpace||E.kind!==_g.Currency)&&(!o.isPercentSepBySpace||E.kind!==Wo.Percent)){u+=S;break}}if(400===(null==E?void 0:E.kind)&&(null==E?void 0:E.formattedStr)===s.formattedStr){u+=S;break}break;case Wo.Decimal:u+=S;break;case Wo.Slash:e.seenDig&&(u+=S);break;case Wo.Space:case Wo.Minus:case Wo.Plus:case Wo.OpenParen:case Wo.CloseParen:break;case Wo.DateSep:Pg(o.pictureSingle,Wo.DateSep)!==Pg(o.pictureSingle,Wo.Minus)&&(u+=S);break;default:u+=S}else(b||o.isNumeral(qa(s.formattedStr,0)))&&(u+=S);u+=s.formattedStr;break;case _g.Exp:u+=s.formattedStr+(s.isNeg?"-":"+");break;case _g.StrLit:S=Pg(o.pictureSingle,Wo.Quote);x("calc.numfmt.NumberFormatImpl: printCodes StrLit",s.escaped.indexOf(S)<0),u+=S+s.escaped+S;break;case Wo.Slash:u+=Pg(o.pictureSingle,Wo.Slash);break;case Wo.Percent:u+=Pg(o.pictureSingle,Wo.Percent);break;case Wo.Star:u+=Pg(o.pictureSingle,Wo.Star)+s.escaped;break;case Wo.Underscore:u+=Pg(o.pictureSingle,Wo.Underscore)+s.escaped;break;case _g.PrefixDigTh:u+="t";break;case _g.Currency:u+=Pg(o.pictureSpecial,Bo.Currency);break;case _g.CurrCode:if(u+=Pg(o.pictureSingle,Wo.ColorStart),u+="$",void 0!==s.currencySymbol&&(u+=s.currencySymbol),void 0!==s.currCode){var R=s.currCode,k=R.culture,N=R.numberShape,A=R.nationalNumberInput,T=R.calendar,I=R.localCalendarInput,O=R.tag;switch(u+="-",typeof k){case"number":var M=k;switch(x("calc.numfmt.NumberFormatImpl: printCodes lcid",void 0===N&&!A&&void 0===T&&!I),O){case void 0:break;case jv.GenLower:M|=64512;break;case jv.GenUpper:M|=63488;break;case jv.NomLower:M|=62464;break;default:U("calc.numfmt.NumberFormatImpl: printCodes lcid2")}u+=Yg(M);break;case"string":u+=k,""!==k&&void 0!==O&&(u+="-"),void 0!==O&&(u+="x-",u+=String(O));var w=0;void 0!==N&&(w|=Hg.indexOf(N)<<8),A&&(w|=32768),void 0!==T&&(w|=jg.indexOf(T)),I&&(w|=128),0!==w&&(u+=",",u+=Yg(w))}}u+=Pg(o.pictureSingle,Wo.ColorEnd);break;case Wo.Text:u+=Pg(o.pictureSingle,Wo.Text);break;case _g.LatinDate:u+=Pg(o.pictureSingle,Wo.BidiDate)+"1";break;case _g.BidiDate:u+=Pg(o.pictureSingle,Wo.BidiDate)+"2";break;case 404:u+=Pg(o.pictureSingle,Wo.Decimal)+C("0",s.rounding);break;case 405:u+=Pg(o.pictureSingle,Wo.DateSep);break;case 406:u+=Pg(o.pictureSingle,Wo.Colon);break;case Wo.Era:case Wo.EraYear:case Wo.Year:case Wo.YearTh:case Wo.EngYearTh:case Wo.ThYear:case Wo.Month:case Wo.MonthTh:case Wo.Day:case Wo.DayTh:case Wo.LocDay:u+=C(Pg(o.pictureSingle,s.kind),s.count);break;case Wo.Hour:case Wo.HourTh:case Wo.Minute:case Wo.MinuteTh:case Wo.Second:case Wo.SecondTh:if(s.isAbs){u+=Pg(o.pictureSingle,Wo.ColorStart)+C(Pg(o.pictureSingle,s.kind),s.count)+Pg(o.pictureSingle,Wo.ColorEnd);break}u+=C(Pg(o.pictureSingle,s.kind),s.count);break;case _g.AMPM:case _g.AMPMFE:s.kind===_g.AMPMFE||o.isEastAsia||s.pictureKind===Bo.AP2?u+=s.tokenStr:u+=Pg(o.pictureSpecial,s.pictureKind);break;default:return{value:L("calc.numfmt.NumberFormatImpl: printCodes code",s)}}a===n&&(u+=C(Pg(o.pictureSingle,Wo.Comma),r.numThousands))},d=this;for(s=0;s<t.length;s+=1){var f=l(s);if("object"==typeof f)return f.value}return u},e}();function sS(e,t,r,n){try{var a=void 0,i=void 0,o=void 0,u=e.config.localeInfo;switch(r.kind){case bt.String:a=function(e){if(0===e.length)return!1;var t=qa(e,0);return t>=1424&&t<=1535||8207===t||t>=64285&&t<=64335||t>=1536&&t<=1791||t>=1872&&t<=1919||t>=2208&&t<=2303||t>=64336&&t<=65023||t>=65136&&t<=65279}(r.value)?Yv.Right:Yv.Left,i=zv.None,o=r;break;case bt.Number:a=t.isTextOnly?Yv.Left:Yv.Right,i=zv.All,o=r;break;case bt.Boolean:a=Yv.Center,i=zv.All,o=zn(r.value?u.trueName:u.falseName);break;case bt.Blank:return q(ip([],void 0,Yv.Left,zv.All));case bt.Error:var s=u.errorNames[r.type];return null==s?Q(cn("missing error name")):q(ip([ep(s)],void 0,Yv.Center,zv.All));case bt.Array:return Q(un(["Array applyFormat"]));case bt.Rich:return Q(un(["Rich applyFormat"]))}return t.apply(o,a,i,n)}catch(e){return Q(Z(e))}}var cS=function(e,t,r,n){return{strong:e,format:t,valueType:r,decimals:n}},lS={},dS=ln("InferenceError"),fS={getDocumentLoc:function(){return U("calc.numfmt.evalFormula: default getDocumentLoc")},getSheetIndex:function(){return U("calc.numfmt.evalFormula: default getSheetIndex")},getSheetName:function(){return U("calc.numfmt.evalFormula: default getSheetName")},getNameLoc:function(){return U("calc.numfmt.evalFormula: default getNameLoc")},getUserDefinedFuncLoc:function(){return U("calc.numfmt.evalFormula: default getUserDefinedFuncLoc")},getSheetRangeIndexes:function(){return U("calc.numfmt.evalFormula: default getSheetRangeIndexes")},getCellFormat:function(){return U("calc.numfmt.evalFormula: default getCellFormat")},getKnownFormat:function(){return U("calc.numfmt.evalFormula: default getKnownFormat")},getIformat:function(){return U("calc.numfmt.evalFormula: default getIformat")},getFormatString:function(){return U("calc.numfmt.evalFormula: default getFormatString")},getContainingTable:function(){return U("calc.numfmt.evalFormula: default getContainingTable")},getStructRefColumn:function(){return U("calc.numfmt.evalFormula: default getStructRefColumn")},getStructRefSpecialRef:function(){return U("calc.numfmt.evalFormula: default getStructRefSpecialRef")}};function hS(e,t){var r,n,a=function(e){var t,r,n,a,i,o,u,s,c,l,d,f,h,v,p,m,g,S,y,b,E,F,C,R,k,N;return{config:e.config,getDocumentLoc:null!==(r=null===(t=e.getDocumentLoc)||void 0===t?void 0:t.bind(e))&&void 0!==r?r:fS.getDocumentLoc,getSheetIndex:null!==(a=null===(n=e.getSheetIndex)||void 0===n?void 0:n.bind(e))&&void 0!==a?a:fS.getSheetIndex,getSheetName:null!==(o=null===(i=e.getSheetName)||void 0===i?void 0:i.bind(e))&&void 0!==o?o:fS.getSheetName,getNameLoc:null!==(s=null===(u=e.getNameLoc)||void 0===u?void 0:u.bind(e))&&void 0!==s?s:fS.getNameLoc,getUserDefinedFuncLoc:null!==(l=null===(c=e.getUserDefinedFuncLoc)||void 0===c?void 0:c.bind(e))&&void 0!==l?l:fS.getUserDefinedFuncLoc,getSheetRangeIndexes:null!==(f=null===(d=e.getSheetRangeIndexes)||void 0===d?void 0:d.bind(e))&&void 0!==f?f:fS.getSheetRangeIndexes,getCellFormat:null!==(v=null===(h=e.getCellFormat)||void 0===h?void 0:h.bind(e))&&void 0!==v?v:fS.getCellFormat,getKnownFormat:null!==(m=null===(p=e.getKnownFormat)||void 0===p?void 0:p.bind(e))&&void 0!==m?m:fS.getKnownFormat,getIformat:null!==(S=null===(g=e.getIformat)||void 0===g?void 0:g.bind(e))&&void 0!==S?S:fS.getIformat,getFormatString:null!==(b=null===(y=e.getFormatString)||void 0===y?void 0:y.bind(e))&&void 0!==b?b:fS.getFormatString,getContainingTable:null!==(F=null===(E=e.getContainingTable)||void 0===E?void 0:E.bind(e))&&void 0!==F?F:fS.getContainingTable,getStructRefColumn:null!==(R=null===(C=e.getStructRefColumn)||void 0===C?void 0:C.bind(e))&&void 0!==R?R:fS.getStructRefColumn,getStructRefSpecialRef:null!==(N=null===(k=e.getStructRefSpecialRef)||void 0===k?void 0:k.bind(e))&&void 0!==N?N:fS.getStructRefSpecialRef}}(e);return{globals:a,locals:t,config:e.config,localeInfo:null!==(n=null===(r=t.config)||void 0===r?void 0:r.localeInfo)&&void 0!==n?n:e.config.localeInfo,mathpack:e.config.mathpack,get document(){var e=t.originSheet;if(!X(e))throw new dS(e);return e.value.document},get defaultFormat(){var e=bS(this,Wa.General);return cS(!1,e,e.valueType,e.decimals)},get unitlessFormat(){var e=bS(this,Wa.General);return cS(!0,e,e.valueType,e.decimals)},resolver:_u(a),multOrDivTainted:!1}}var vS,pS=((tS={})[Gv.General]=0,tS[Gv.Number]=1,tS[Gv.Currency]=2,tS[Gv.Accounting]=2,tS[Gv.Percentage]=3,tS[Gv.Date]=4,tS[Gv.Time]=5,tS[Gv.Fraction]=6,tS[Gv.Scientific]=7,tS[Gv.Text]=8,tS[Gv.Custom]=9,tS);!function(e){e[e.Propagate=-2147483648]="Propagate",e[e.Ignore=-2147483647]="Ignore"}(vS||(vS={}));var mS=((rS={})[la.INT]=vS.Propagate,rS[la.MOD]=vS.Propagate,rS[la.ROUND]=vS.Propagate,rS[la.SUM]=vS.Propagate,rS[la.TRUNC]=vS.Propagate,rS[la.AVERAGE]=vS.Propagate,rS[la.MAX]=vS.Propagate,rS[la.MEDIAN]=vS.Propagate,rS[la.MIN]=vS.Propagate,rS[la.ROUNDUP]=vS.Propagate,rS[la.ROUNDDOWN]=vS.Propagate,rS[la.NPV]=Wa.CoCurrencyDec,rS[la.PV]=Wa.CoCurrencyDec,rS[la.FV]=Wa.CoCurrencyDec,rS[la.PMT]=Wa.CoCurrencyDec,rS[la.RATE]=Wa.Pct0,rS[la.MIRR]=Wa.Pct0,rS[la.IRR]=Wa.Pct0,rS[la.DATE]=Wa.MMDDYY,rS[la.TIME]=Wa.HHMMAP,rS[la.NOW]=Wa.MDYHMS,rS[la.SLN]=Wa.CoCurrencyDec,rS[la.SYD]=Wa.CoCurrencyDec,rS[la.DDB]=Wa.CoCurrencyDec,rS[la.IPMT]=Wa.CoCurrencyDec,rS[la.PPMT]=Wa.CoCurrencyDec,rS[la.TODAY]=Wa.MMDDYY,rS[la.VDB]=Wa.CoCurrencyDec,rS[la.DB]=Wa.CoCurrencyDec,rS);var gS=[[Gv.General,Gv.Number,Gv.Currency,Gv.Percentage,Gv.Date,Gv.Time,Gv.Fraction,Gv.Scientific,Gv.Text,Gv.Custom],[Gv.General,Gv.Number,Gv.Currency,Gv.Percentage,Gv.Date,Gv.Time,Gv.Number,Gv.Scientific,Gv.Text,Gv.Custom],[Gv.General,Gv.General,Gv.Currency,Gv.General,Gv.General,Gv.General,Gv.Currency,Gv.Currency,Gv.Text,Gv.Custom],[Gv.General,Gv.General,Gv.General,Gv.Percentage,Gv.General,Gv.General,Gv.Percentage,Gv.Percentage,Gv.Text,Gv.Custom],[Gv.General,Gv.General,Gv.General,Gv.General,Gv.General,Gv.Date,Gv.General,Gv.General,Gv.Text,Gv.Custom],[Gv.General,Gv.General,Gv.General,Gv.General,Gv.General,Gv.Time,Gv.General,Gv.General,Gv.Text,Gv.Custom],[Gv.General,Gv.General,Gv.General,Gv.General,Gv.General,Gv.General,Gv.Fraction,Gv.Scientific,Gv.Text,Gv.Custom],[Gv.General,Gv.General,Gv.General,Gv.General,Gv.General,Gv.General,Gv.General,Gv.Scientific,Gv.Text,Gv.Custom],[Gv.General,Gv.General,Gv.General,Gv.General,Gv.General,Gv.General,Gv.General,Gv.General,Gv.Text,Gv.Custom],[Gv.General,Gv.General,Gv.General,Gv.General,Gv.General,Gv.General,Gv.General,Gv.General,Gv.General,Gv.Custom]],SS=[[Gv.General,Gv.Number,Gv.Currency,Gv.General,Gv.Date,Gv.Time,Gv.Fraction,Gv.Scientific,Gv.Text,Gv.Custom],[Gv.General,Gv.Number,Gv.Currency,Gv.Number,Gv.Date,Gv.Time,Gv.Fraction,Gv.Scientific,Gv.Text,Gv.Custom],[Gv.General,Gv.General,Gv.General,Gv.Currency,Gv.General,Gv.General,Gv.Currency,Gv.Currency,Gv.Text,Gv.Custom],[Gv.General,Gv.General,Gv.General,Gv.Percentage,Gv.Date,Gv.Time,Gv.Percentage,Gv.Scientific,Gv.Text,Gv.Custom],[Gv.General,Gv.General,Gv.General,Gv.General,Gv.General,Gv.General,Gv.Date,Gv.Date,Gv.Text,Gv.Custom],[Gv.General,Gv.General,Gv.General,Gv.General,Gv.General,Gv.General,Gv.Time,Gv.Time,Gv.Text,Gv.Custom],[Gv.General,Gv.General,Gv.General,Gv.General,Gv.General,Gv.General,Gv.Fraction,Gv.Scientific,Gv.Text,Gv.Custom],[Gv.General,Gv.General,Gv.General,Gv.General,Gv.General,Gv.General,Gv.General,Gv.Scientific,Gv.Text,Gv.Custom],[Gv.General,Gv.General,Gv.General,Gv.General,Gv.General,Gv.General,Gv.General,Gv.General,Gv.Text,Gv.Custom],[Gv.General,Gv.General,Gv.General,Gv.General,Gv.General,Gv.General,Gv.General,Gv.General,Gv.General,Gv.Custom]];function yS(e,t){if("number"!=typeof t)return t;var r=e.globals.getIformat(e.document,t);if(!X(r))throw new dS(r.reason);return r.value}function bS(e,t){var r=e.globals.getKnownFormat(e.document,t);if(!X(r))throw new dS(r.reason);return r.value}function ES(e,t){if("number"==typeof t)return t;var r=e.globals.getFormatString(e.document,t.formatString);if(!X(r))throw new dS(r.reason);return void 0!==r.value?r.value:t}function FS(e,t,r){return x("calc.numfmt.evalFormula: well-formed bin op",2===t.length),r(e,t[0],t[1])}function CS(e,t,r,n){var a=r[0],i=n[0],o=pS[a.valueType],u=pS[i.valueType],s=o<=u?t[o][u]:t[u][o],c=pS[s],l=i.decimals>a.decimals?i.decimals:a.decimals;switch(c){case o:return cS(!0,a.format,a.valueType,l);case u:return cS(!0,i.format,i.valueType,l);default:return e.unitlessFormat}}function RS(e,t,r){return CS(e,SS,t,r)}function kS(e,t,r){var n=t[0],a=r[0];if(n.format===a.format&&n.valueType===a.valueType&&n.valueType===Gv.Time)return cS(!0,n.format,n.valueType,n.decimals);if(n.valueType===Gv.Date&&a.valueType===Gv.Time||n.valueType===Gv.Time&&a.valueType===Gv.Date){var i=bS(e,Wa.MDYHMS),o=i.valueType,u=i.decimals;return cS(!0,i,o,u)}return CS(e,gS,t,r)}var NS=function(e){return e.unitlessFormat};function AS(e,t,r){var n=t[0],a=r[0];return n.format===a.format?cS(!0,n.format,n.valueType,n.decimals):e.unitlessFormat}function TS(e){return pS[e]===pS[Gv.General]}var IS=function(){function e(e){var t=this;this.context=e,this.visitFormulaNode=function(e){return Le(t,e)},this.lazyVisitFormulaNode=function(e){return _e.resolve(e).bind(t.visitFormulaNode)}}return e.prototype.literalNode=function(e){switch(e.kind){case bt.String:case bt.Boolean:case bt.Error:case bt.Missing:return _e.resolve(this.context.defaultFormat);case bt.Number:var t=this.context.mathpack.formatGeneral(this.context.localeInfo,this.context.mathpack.abs(e),21),r=t.indexOf(this.context.localeInfo.decimalSeparator),n=r>=0?t.length-r-1:0,a=bS(this.context,Wa.General);return _e.resolve(cS(!1,a,a.valueType,n));default:return L("calc.numfmt.evalFormat: unexpected literal oper",e)}},e.prototype.arrayNode=function(e){return _e.resolve(this.context.defaultFormat)},e.prototype.appNode=function(e,t){var r,n=this;if(xr(e))return _e.all(t.map((function(e){return n.lazyVisitFormulaNode(e).bind((function(t){return[t,e]}))}))).bind((function(t){return function(e,t,r){switch(t){case pa.Mul:case pa.Div:return e.multOrDivTainted=!0,FS(e,r,RS);case pa.Pow:return FS(e,r,RS);case pa.Add:case pa.Sub:return FS(e,r,kS);case pa.Percent:x("calc.numfmt.evalFormat: well-formed unary op",1===r.length);var n=r[0],a=n[0];if(!Vr(n[1]))return e.defaultFormat;var i=a.strong,o=a.decimals,u=bS(e,Wa.Pct);return cS(i,u,u.valueType,o);case pa.Pound:case pa.At:return e.defaultFormat;case pa.Neg:case pa.Pos:return x("calc.numfmt.evalFormat: well-formed unary op",1===r.length),a=r[0][0];case pa.Lt:case pa.Le:case pa.Eq:case pa.Ge:case pa.Gt:case pa.Ne:return FS(e,r,NS);case pa.Isect:case pa.Union:case pa.Range:case pa.Concat:return FS(e,r,AS);case pa.And:case pa.Or:case pa.Xor:case pa.Min:case pa.Max:throw new dS(un(["evalFormat for Yellow ops"]));default:return L("calc.numfmt.evalFormat: unexpected operator id",t)}}(n.context,e.id,t)}));if(Br(e)){var a=e.id,i=null!==(r=mS[a])&&void 0!==r?r:vS.Ignore,o=Da(a),u=Ur(Ht(e,t));if(x("calc.numfmt.evalFormula: well-formed WSF args",Hr(o,u.length)),i===vS.Ignore)return _e.resolve(this.context.defaultFormat);if(i===vS.Propagate)return 0===u.length?_e.resolve(this.context.defaultFormat):_e.all(t.map(this.lazyVisitFormulaNode)).bind((function(e){var t=e[0],r=t.format,a=t.valueType,i=t.decimals,o=!TS(a);if(!t.strong&&o)return n.context.unitlessFormat;for(var u=o,s=1;s<e.length;s+=1){var c=e[s],l=!TS(c.valueType);if(!c.strong&&l)return n.context.unitlessFormat;u||(r=c.format,a=c.valueType,i=c.decimals,u=l)}return cS(!0,r,a,i)}));var s=bS(this.context,i),c=s.valueType,l=s.decimals;return _e.resolve(cS(!0,s,c,l))}return this.lazyVisitFormulaNode(e)},e.prototype.letNode=function(e,t,r){return _e.resolve(this.context.defaultFormat)},e.prototype.lambdaNode=function(e,t,r){return _e.resolve(this.context.defaultFormat)},e.prototype.parenNode=function(e){return this.lazyVisitFormulaNode(e)},e.prototype.nameNode=function(e,t){return _e.resolve(this.context.defaultFormat)},e.prototype.cellRefNode=function(e,t){var r=this.context.resolver.resolveCellRef(this.context.locals,tr(e,t)).resolution;if(!X(r))throw x("calc.numfmt.evalFormat: NoOriginSheet",r.reason.kind!==vu.NoOriginSheet),new dS(r.reason);var n=r.value;if(void 0===n)throw lS;return mr(n)?_e.resolve(MS(this.context,n)):_e.resolve(this.context.unitlessFormat)},e.prototype.fieldRefNode=function(e,t){var r=this;return this.lazyVisitFormulaNode(e).bind((function(e){return r.context.defaultFormat}))},e.prototype.structRefNode=function(e,t){var r=ar(e,t),n=this.context.resolver.resolveStructRef(this.context.locals,r).resolution;if(!X(n)){if(x("calc.numfmt.evalFormat: NoOriginSheet",n.reason.kind!==vu.NoOriginSheet),n.reason.kind===vu.EmptyIntersection)throw lS;throw new dS(n.reason)}var a=n.value;if(void 0===a)throw lS;return _e.resolve(MS(this.context,a))},e.prototype.badSequenceNode=function(e,t){return U("calc.numfmt.evalFormat: unexpected bad node")},e.prototype.badStringNode=function(e,t){return U("calc.numfmt.evalFormat: unexpected bad node")},e.prototype.operatorNode=function(e,t){return _e.resolve(Yt(e,t))},e.prototype.wsfNode=function(e,t,r){return _e.resolve(qt(e,t,r))},e}();function OS(e,t){return ht(new IS(e),t)}function MS(e,t){var r=wr(t),n=e.globals.getCellFormat(r);if(!X(n))throw new dS(n.reason);var a=n.value,i=yS(e,a);if(!(kr(r.sheet.document,e.document)||"number"==typeof a&&i.isBuiltIn))return e.defaultFormat;var o=i.valueType,u=i.decimals;return cS(!0,a,o,u)}function wS(e,t,r){try{var n=hS(e,t);return q(function(e,t){var r=t.strong,n=t.format,a=t.valueType,i=t.decimals;if(a!==Gv.Number||!e.multOrDivTainted){if(i>0&&r&&(a===Gv.Number||a===Gv.Currency||a===Gv.Accounting||a===Gv.Percentage)){var o=yS(e,n);i!==o.decimals&&(n=o.synthesizeDecimals(i))}if(a!==Gv.General&&r)return n=ES(e,n)}}(n,OS(n,r)))}catch(e){return e instanceof dS?Q(e.reason):e===lS?J:Q(Z(e))}}var DS,_S,LS,US={getKnownFormat:function(){return U("calc.numfmt: default getKnownFormat")},getIformat:function(){return U("calc.numfmt: default getIformat")},getFormatString:function(){return U("calc.numfmt: default getFormatString")}};function xS(e,t,r,n){var a=t.getFormatString(r,n);if(!X(a))return a;if(void 0!==a.value)return t.getIformat(r,a.value);var i=e.createFormat(n,!1);return X(i)?i:i.reason.kind===wv.NotFormatString?Q(Zv()):Q(i.reason)}function BS(e,t,r){var n=Yr(r)?zv.None:zv.All,a=t.apply(r,Yv.Right,n,!0);if(!X(a))return a;var i=e.renderValue(a.value,hp);return X(i)?up(i.value)?q(i.value.units):q(vp(i.value)):i}function WS(e,t,r,n,a){if(a.isDate||a.isTime){var i=function(e,t,r,n,a){var i=t.config,o=i.mathpack,u=i.localeInfo;if(o.cond(n)<0)return q(void 0);var s="",c=0!==o.fix(n)||a.isDate,l=n;if(c){var d=o.trunc(n),f=xS(e,t,r,Wp(u,!0));if(!X(f))return f;if(!X(v=BS(e,f.value,d)))return v;if("string"!=typeof v.value)return q(void 0);s+=v.value;var h=o.sub(n,d);x("calc.numfmt.renderFormulaBar: sub error",!zr(h)),l=h}if(o.cond(l)>0||a.isTime){c&&(s+="  ");var v,p=t.getKnownFormat(r,u.clock24Hour?Wa.HHMMSS:Wa.HHMMSSAP);if(!X(p))return p;if(!X(v=BS(e,p.value,l)))return v;if("string"!=typeof v.value)return q(void 0);s+=v.value}return q(s)}(e,function(e){var t,r,n,a,i,o;return{config:e.config,getKnownFormat:null!==(r=null===(t=e.getKnownFormat)||void 0===t?void 0:t.bind(e))&&void 0!==r?r:US.getKnownFormat,getIformat:null!==(a=null===(n=e.getIformat)||void 0===n?void 0:n.bind(e))&&void 0!==a?a:US.getIformat,getFormatString:null!==(o=null===(i=e.getFormatString)||void 0===i?void 0:i.bind(e))&&void 0!==o?o:US.getFormatString}}(t),r,n,a);if(!X(i))return i;if(void 0!==i.value){i.value;return i}}var o=t.config,u=o.mathpack,s=o.localeInfo;if(a.isPercent){var c=u.mul(n,u.fromNumber(100));return zr(c)?Q(un(["renderFormulaBar % overflow"])):q(u.formatGeneral(s,c,21)+"%")}return q(u.formatGeneral(s,n,21))}function PS(e){return{createFormat:function(t,r){return function(e,t,r){try{return q(new uS(e.config,{old:void 0,formatString:t,isBuiltIn:r}))}catch(e){return Q(e instanceof oS?e.reason:Z(e))}}(e,t,r)},applyFormat:function(t,r,n){return sS(e,t,r,n)},renderValue:function(t,r){return Eg(e.config.mathpack,t,r)},renderFormulaBar:function(t,r,n,a){return function(e,t,r,n,a,i){try{var o=t.config.localeInfo;switch(n.kind){case bt.Number:return WS(e,t,r,n,a);case bt.String:return q(i?"'"+n.value:n.value);case bt.Boolean:return q(n.value?o.trueName:o.falseName);case bt.Error:var u=o.errorNames[n.type];return null==u?Q(cn("missing error name")):q(u);case bt.Array:return Q(un(["Array renderFormulaBar"]));case bt.Rich:return Q(un(["Rich renderFormulaBar"]));case bt.Blank:return q("");default:return L("calc.numfmt.renderFormulaBar: never value",n)}}catch(e){return Q(Z(e))}}(this,e,t,r,n,a)},parseGeneral:function(t,r,n,a){return function(e,t,r,n,a){try{var i=e.config,o=Yp(i.localeInfo,i.mathpack,t,r,n,!1);return X(o)?void 0!==o.value?o:bm(zp(e),t,void 0,a):o}catch(e){return Q(Z(e))}}(e,t,r,n,a)},parseDate:function(t,r){return function(e,t,r){try{return bm(zp(e),t,void 0,r)}catch(e){return Q(Z(e))}}(e,t,r)},parseEdit:function(t,r){return function(e,t,r){try{if(r.valueType===Gv.Text)return Em(t);if(""===t)return q(Sp(fa));if(F(t,"="))return q(pp(t));if(!F(t,"'")){var n=Rm(e,t,r);if(!X(n))return n;if(void 0!==n.value)return q(n.value)}return"="===(a=t.charAt(0))||"+"===a||"-"===a||"@"===a?q(pp(t)):Em(t)}catch(e){return Q(Z(e))}var a}(e,t,r)},evalFormat:function(t,r){return wS(e,t,r)}}}(_S=DS||(DS={})).FormatReasonKind=wv,_S.ReasonKind=xv,_S.notValueString=Bv,_S.notFormatString=Wv,_S.noFormatPart=Pv,_S.tooWide=Vv,_S.dateOverflow=Qv,_S.fractionOverflow=Xv,_S.previousFormatFailure=Zv,_S.FormatValueType=Gv,_S.BidiDate=Hv,_S.CultureTag=jv,_S.NamedColor=Kv,_S.Alignment=Yv,_S.GetTimeKind=qv,_S.Clip=zv,_S.FormattedUnitKind=Jv,_S.formattedUnitGeneral=$v,_S.formattedUnitString=ep,_S.formattedUnitBlank=tp,_S.formattedUnitFlexible=rp,_S.formattedValue=ip,_S.renderedValue=op,_S.hashesValue=ap,_S.isHashesValue=up,_S.renderCallback=sp,_S.memoizedRenderCallback=cp,_S.renderInfiniteWidth=hp,_S.renderedValueToString=vp,_S.EditKind=lp,_S.formulaEdit=pp,_S.stringEdit=mp,_S.numberEdit=gp,_S.otherEdit=Sp,_S.evalFormatLocalsGrid=yp,_S.KnownFormat=Wa,_S.CurrencyFormat=La,_S.DateOrder=Ua,_S.NumberShape=xa,_S.Calendar=Ba,_S.getKnownFormat=Vp,_S.isKnownFormatDefined=Gp,_S.shouldInstallFormat=km,_S.createNumberFormatter=PS,function(e){e.Timeout="Timeout",e.Stopped="Stopped",e.NameCycle="NameCycle",e.CellCycle="CellCycle",e.PreviousFailure="PreviousFailure",e.PreviousNameFailure="PreviousNameFailure",e.LimitExceeded="LimitExceeded",e.IllFormedFormula="IllFormedFormula"}(LS||(LS={}));var VS=te(te(te(te({},on),LS),wv),vu);function GS(e){return{config:e}}function HS(e,t,r){return{config:null!=r?r:void 0,lexicalKind:e,originGridCell:q(t),allowUnqualifiedCell:!0}}function jS(e,t){return{config:null!=t?t:void 0,lexicalKind:vn.NameManager,originGridCell:q(e),allowUnqualifiedCell:!1}}var KS,YS,qS,zS=function(e,t){return P("calc.runtime.interval: end",t),V("calc.runtime.interval: start",e,t),{start:e,end:t}};function JS(e,t,r){return{kind:VS.IllFormedFormula,message:e,mode:t,diagnostics:r}}function QS(e){return{kind:KS.FinalValue,oper:e}}function XS(e){return{kind:KS.PendingValue,anchor:e}}function ZS(e,t){return{kind:KS.Formula,source:e,formula:t}}!function(e){e.FinalValue="FinalValue",e.PendingValue="PendingValue",e.Formula="Formula"}(KS||(KS={})),function(e){e[e.Continue=1]="Continue",e[e.Stop=2]="Stop"}(YS||(YS={})),function(e){e[e.CellChain=0]="CellChain",e[e.NameChain=1]="NameChain",e[e.LambdaCalls=2]="LambdaCalls",e[e.LambdaDepth=3]="LambdaDepth"}(qS||(qS={}));var $S={kind:VS.Stopped};function ey(e,t){return{arity:e,func:t}}function ty(e,t,r,n,a,i,o,u,s,c,l,d,f,h,v,p,m,g,S,y,b,E,F,C,R,k,N,A,T){return{config:e,getDocumentLoc:t,getSheetIndex:r,getSheetName:n,getSheetRangeIndexes:a,getNameLoc:i,getUserDefinedFuncLoc:o,getCellValue:u,getCellValues:s,getWorksheetFunc:c,getUserDefinedFunc:l,getNameFormula:d,getCellFormula:f,getUsedRange:h,interruptToken:[YS.Continue],getHiddenRows:v,isInFilterMode:p,getKnownFormat:m,getIformat:g,getFormatString:S,getRandom:y,getTime:b,schedulerConfig:null!=A?A:{},limits:null!=T?T:{},setCellValue:E,setCellValues:F,setCellFailure:C,getContainingTable:R,getStructRefColumn:k,getStructRefSpecialRef:N}}var ry,ny,ay,iy=function(e,t,r,n,a,i,o,u,s,c){return{lexicalSource:e,originGridCell:t,originSheet:r,calcingArray:n,reflectionGridCell:a,reflectionSheet:i,implicitIntersect:o,allowUnqualifiedCell:u,wrapCellReferences:s,followHyperlinks:c}};function oy(e){return{kind:VS.NameCycle,names:e}}function uy(e){return{kind:VS.CellCycle,cells:e}}function sy(e){return{kind:VS.PreviousFailure,range:e}}function cy(e){return{kind:VS.PreviousNameFailure,name:e}}function ly(e){return{kind:VS.LimitExceeded,limit:e}}function dy(e){return{kind:H.Paused,reason:VS.Timeout,resume:e}}function fy(e){if(e.kind===H.Failure)return e.reason.kind}!function(e){e[e.Array=-2147483648]="Array",e[e.Lambda=-2147483647]="Lambda",e[e.Let=-2147483646]="Let",e[e.App=-2147483645]="App",e[e.Name=-2147483644]="Name",e[e.Udf=-2147483643]="Udf",e[e.CellRef=-2147483642]="CellRef",e[e.ReadStack=-2147483641]="ReadStack",e[e.ReadClosure=-2147483640]="ReadClosure",e[e.Conditional=-2147483639]="Conditional",e[e.StructRef=-2147483638]="StructRef",e[e.CallLambda=-2147483637]="CallLambda"}(ay||(ay={}));var hy,vy=(ry=oe(se,se)).wrap,py=ry.unwrap,my=(ny=oe((function(e){return-e}),(function(e){return-e}))).wrap,gy=ny.unwrap;function Sy(e){return e>0}function yy(e){return{kind:e,data:void 0,children:void 0}}function by(e,t,r){var n=yy(ay.Array);return n.children=r,n.data={rows:e,cols:t},n}function Ey(e,t,r,n){var a=yy(ay.Lambda);return a.children=n,a.data={arity:e,closureId:t,closedIdents:r},a}function Fy(e,t,r){var n=yy(ay.Let);return n.children=ie(e,[r]),n.data={rec:t},n}function Cy(e,t,r,n){var a=yy(ay.App);return a.children=n,a.data={funName:e,funType:t,isFormulaRoot:r},a}function Ry(e,t,r,n){var a=yy(ay.Name);return a.data={name:e,qualifier:t,source:r},a.children=n,a}function ky(e,t,r){var n=yy(ay.Udf);return n.data={name:e,qualifier:t},n.children=r,n}function Ny(e,t){var r=yy(ay.CellRef);return r.data={ref:e,qualifier:t},r}function Ay(e){var t=yy(ay.ReadStack);return t.data=e,t}function Ty(e,t,r,n,a){var i=yy(ay.Conditional);return i.children=ie([n],a),i.data={funName:e,funType:t,isFormulaRoot:r},i}function Iy(e){return e.kind>0}var Oy=ln("CompileError"),My=fr(1,[bt.Number|bt.String|bt.Boolean|bt.Rich|bt.Error|bt.Blank|bt.Array],[bt.Number|bt.String|bt.Boolean|bt.Rich|bt.Error|bt.Blank|bt.Missing|bt.Array|bt.Range],[],Et.All,Ft.None,Ct.Allow3dRef),wy=Hm(Da(la.IF)),Dy=Hm(Da(la.CHOOSE));function _y(e){return Iy(e)&&0!=(e.kind&nn)}var Ly=function(){function e(e){this.id=e,this.slots=[],this.idToSlot={}}return e.prototype.mapStackId=function(e){var t=this.idToSlot[e];return null!=t?t:this.idToSlot[e]=this.slots.push(e)-1},e}(),Uy=Ds.create((function(e,t){return e-t})),xy=function(){function e(e){var t=this;this.context=e,this.visitFormulaNode=function(e){return Le(t,e)},this.lazyVisitFormulaNode=function(e){return _e.resolve(e).bind(t.visitFormulaNode)}}return e.prototype.literalNode=function(e,t,r){return _e.resolve(e)},e.prototype.arrayNode=function(e,t,r){var n=this;return _e.all(e.map((function(e){return _e.all(e.map(n.lazyVisitFormulaNode))}))).bind((function(e){return n.toArrayTerm(e)}))},e.prototype.toArrayTerm=function(e){var t=e.length,r=void 0===e[0]?0:e[0].length;return e.every((function(e){return e.every(_y)}))?ua(t,r,e):by(t,r,e)},e.prototype.appNode=function(t,r,n,a){var i,o=this,u=Ur(Ht(t,r,n)),s=(null===(i=this.context.annotations[a])||void 0===i?void 0:i.kind)===ct.FormulaRoot;if(xr(t)){var c=wa(t.id);return _e.all(u.map(this.lazyVisitFormulaNode)).bind((function(e){return Cy(vy(t.id),c,s,e)}))}if(Br(t)){var l=t.id;switch(l){case la.IFERROR:case la.IFNA:x("calc.runtime.toIfPredicateTerm: expected wff",2===u.length);var d=u[0],f=u[1],h=new e(te(te({},this.context),{numNames:this.context.numNames+1}));return _e.all([this.lazyVisitFormulaNode(d),_e.try((function(){return Le(h,f)}))]).bind((function(e){var t=e[0],r=e[1];return o.toIfPredicateTerm(l===la.IFERROR?la.ISERROR:la.ISNA,t,r)}));case la._UDF:return U("calc.runtime.appNode: expected wff (not UDF)")}return _e.all(u.map(this.lazyVisitFormulaNode)).bind((function(e){switch(l){case la.IF:return o.toIfTerm(e);case la.CHOOSE:return o.toChooseTerm(e)}var t=Da(l);return Cy(my(l),t,!1,e)}))}return this.lazyVisitFormulaNode(t).bind((function(e){return _e.all(u.map(o.lazyVisitFormulaNode)).bind((function(t){return o.toAppTerm(e,t)}))}))},e.prototype.toIfPredicateTerm=function(e,t,r){var n=Ay(0);return Fy([t],!1,Ty(my(la.IF),wy,!1,Cy(my(e),Da(e),!1,[n]),[r,n]))},e.prototype.toIfTerm=function(e){switch(e.length){case 3:return Ty(my(la.IF),wy,!1,e[0],[e[1],e[2]]);case 2:return Ty(my(la.IF),wy,!1,e[0],[e[1],va]);case 1:throw new Oy(un(["single-argument IF"]));default:return U("calc.runtime.toIfTerm: expected wff")}},e.prototype.toChooseTerm=function(e){return x("calc.runtime.toChooseTerm: expected wff",e.length>=1),Ty(my(la.CHOOSE),Dy,!1,e[0],e.slice(1))},e.prototype.toAppTerm=function(e,t){return Cy(my(la._UDF),My,!1,ie([e],t))},e.prototype.letNode=function(t,r,n,a,i){var o=this,u=t.id===la.LETREC||t.id!==la.LET&&U("calc.runtime.compile"),s=this.context,c=s.names,l=s.numNames,d=s.closures,f=[c];r.reduce((function(e,t,r){var n=t[0],a=e.setValue(gn(o.context.localeInfo,n.whole),{closureId:d.getCount(),nameId:l+r});return f.push(a),a}),c);var h=new e(te(te({},this.context),{names:f[r.length],numNames:l+r.length}));return(u?_e.all(r.map((function(e){var t=e[1];return _e.try((function(){return Le(h,t)}))}))):_e.all(r.map((function(t,r){var n=t[1],a=new e(te(te({},o.context),{names:f[r],numNames:l+r}));return _e.try((function(){return Le(a,n)}))})))).bind((function(e){return Le(h,n).bind((function(t){return Fy(e,u,t)}))}))},e.prototype.lambdaNode=function(t,r,n,a,i){var o=this,u=this.context,s=u.names,c=u.numNames,l=u.closures,d=new Ly(l.getCount()+1),f=l.setValue(d.id,d),h=r.reduce((function(e,t,r){return e.setValue(gn(o.context.localeInfo,t.whole),{closureId:f.getCount(),nameId:c+r})}),s),v=new e(te(te({},this.context),{names:h,numNames:c+r.length,closures:f}));return _e.try((function(){return Le(v,n)})).bind((function(e){var t=d.slots.map((function(e){return c-e-1}));return Ey(r.length,d.id,t,e)}))},e.prototype.parenNode=function(e,t,r){return this.lazyVisitFormulaNode(e)},e.prototype.nameNode=function(e,t,r){var n,a=(null===(n=this.context.annotations[r])||void 0===n?void 0:n.kind)===ct.AppHeadName;return _e.resolve(this.toNameTerm(e,t,a))},e.prototype.toNameTerm=function(e,t,r){var n=this,a=this.context,i=a.locals,o=a.names,u=a.numNames,s=a.closures;if(!t){var c=$t(e);if(c.kind===mt.IdentNamePart){var l=c.parts,d=l[0],f=l.slice(1),h=o.getEntry(gn(this.context.localeInfo,d.asWhole));if(void 0!==h){var v=h.value,p=v.closureId,m=v.nameId,g=void 0;if(p===s.getCount())g=Ay(u-m-1);else{var S=s.getValue(p+1);x("calc.runtime.toNameTerm: closure",void 0!==S),g=function(e,t){var r=yy(ay.ReadClosure);return r.data=[e,t],r}(S.id,S.mapStackId(m))}return _e.resolve(f.reduce((function(e,t){return n.toFieldRefTerm(e,t.rhs)}),g))}}}var y=function(e,r){var a=_e.resolve(void 0);return r.kind===mt.FieldRefNamePart&&(a=_e.try((function(){return y(!1,r.lhs)})).bind((function(e){return void 0===e?void 0:n.toFieldRefTerm(e,r.rhs)}))),r.kind===mt.CellRefNamePart&&(null==t&&i.allowUnqualifiedCell||null!=t&&t.kind!==ot.Document)&&(a=_e.resolve(Ny(r.ref,null!=t&&t.kind===ot.Ident?It(t.name):t))),r.canDenoteNamedObject&&(!e||t&&t.kind!==ot.Document&&t.kind!==ot.Ident||(a=a.bind((function(e){return ky(r.asWhole,t,e)}))),a=a.bind((function(n){return Ry(r.asWhole,t,e?pn.AppHead:pn.Plain,n)}))),a};return y(r,e).bind((function(e){return void 0!==e?e:U("calc.runtime.compile: expected wff NameNode")}))},e.prototype.cellRefNode=function(e,t,r){return _e.resolve(Ny(e,t))},e.prototype.fieldRefNode=function(e,t,r,n){var a=this;return this.lazyVisitFormulaNode(e).bind((function(e){return a.toFieldRefTerm(e,t.field)}))},e.prototype.toFieldRefTerm=function(e,t){var r=la.FIELDVALUE;return Cy(my(r),Da(r),!1,[e,zn(t)])},e.prototype.structRefNode=function(e,t,r){return _e.resolve((n=ar(e,t,r),(a=yy(ay.StructRef)).data=n,a));var n,a},e.prototype.badSequenceNode=function(e,t,r){return U("calc.runtime.compile: unexpected bad node")},e.prototype.badStringNode=function(e,t,r){return U("calc.runtime.compile: unexpected bad node")},e.prototype.operatorNode=function(e,t){return _e.resolve(Yt(e,t))},e.prototype.wsfNode=function(e,t,r){return _e.resolve(qt(e,t,r))},e}(),By=((hy={})[pa.At]=la.SINGLE,hy[pa.Pound]=la.ANCHORARRAY,hy);var Wy,Py=[function(e){if(!Iy(e)&&e.kind===ay.App&&Sy(e.data.funName)){var t=By[py(e.data.funName)];if(void 0!==t)return Cy(my(t),Da(t),e.data.isFormulaRoot,e.children)}return e}],Vy=function(e,t){return t(e)},Gy=function(e){return Py.reduce(Vy,e)};function Hy(e){return function(e,t){function r(e){if(Iy(e))return _e.resolve(e);switch(e.kind){case ay.Let:return _e.all(e.children.map(n)).bind((function(t){return Fy(t.slice(0,t.length-1),e.data.rec,t[t.length-1])}));case ay.App:return _e.all(e.children.map(n)).bind((function(t){return Cy(e.data.funName,e.data.funType,e.data.isFormulaRoot,t)}));case ay.Conditional:return _e.all(e.children.map(n)).bind((function(t){var r=t[0],n=t.slice(1);return Ty(e.data.funName,e.data.funType,e.data.isFormulaRoot,r,n)}));case ay.Lambda:return n(e.children).bind((function(t){return Ey(e.data.arity,e.data.closureId,e.data.closedIdents,t)}));case ay.Array:return _e.all(e.children.map((function(e){return _e.all(e.map(n))}))).bind((function(t){return by(e.data.rows,e.data.cols,t)}));case ay.Name:return(void 0===e.children?_e.resolve(void 0):n(e.children)).bind((function(t){return Ry(e.data.name,e.data.qualifier,e.data.source,t)}));case ay.Udf:return(void 0===e.children?_e.resolve(void 0):n(e.children)).bind((function(t){return ky(e.data.name,e.data.qualifier,t)}));case ay.CellRef:case ay.StructRef:case ay.ReadStack:case ay.ReadClosure:return _e.resolve(e);default:return L("calc.runtime.transformBottomUp",e)}}function n(e){return _e.resolve(e).bind(r).bind(t)}return _e.settleOrThrow(n(e))}(e,Gy)}function jy(e,t){return"object"!=typeof t.term?U(e+": expected known compiled formula type; given "+d(t)):t.term}function Ky(e,t,r){var n,a,i;try{var o=null!==(a=null===(n=t.config)||void 0===n?void 0:n.localeInfo)&&void 0!==a?a:e.config.localeInfo,u=Ds.create(o.stringCompareCI),s={globals:e,locals:t,localeInfo:o,annotations:r.annotations,names:u,numNames:0,closures:Uy},c=Hy(ht(new xy(s),r));return q((i=c,te(te({},r),{term:i})))}catch(e){return Q(e instanceof Oy?e.reason:Z(e))}}function Yy(e){return{compileFormula:function(t,r){return Ky(e,t,r)}}}function qy(e){return 0===e.length&&U("calc.runtime.unevaluated: expected nonempty array"),{kind:Wy.Unevaluated,anchors:e}}!function(e){e.Unevaluated="Unevaluated"}(Wy||(Wy={}));var zy=ln("EvaluationError");function Jy(e){throw new zy(e)}function Qy(e,t,r){var n;switch(r.kind){case Wy.Unevaluated:if(t.map.getCount()+1>(null!==(n=e.globals.limits.maxCellChain)&&void 0!==n?n:1/0))return Q(ly(qS.CellChain));var a=r.anchors.map((function(r){return e.createCellEvaluationMachine(e,t,r,!0)}));return Te(new De(a),Oe());default:return Q(r)}}function Xy(){return Yn([],[],Ft.None,Un.Lower)}function Zy(e,t,r){return void 0===e?void 0===t?0:-1:void 0===t?1:r(e,t)}function $y(e,t){return e<t?-1:e===t?0:1}function eb(e,t){return"string"==typeof e?"string"!=typeof t?1:$y(e,t):"string"==typeof t||e<t?-1:e===t?0:1}function tb(e,t){var r;return 0!==(r=$y(e.name,t.name))?r:Zy(e.path,t.path,$y)}function rb(e,t){return{current:e,map:t}}var nb=rb(void 0,Ds.create((function(e,t){var r;return 0!=(r=e.range.col-t.range.col)||0!=(r=e.range.row-t.range.row)||0!==(r=eb(e.sheet.index,t.sheet.index))?r:tb(e.sheet.document,t.sheet.document)})));function ab(e,t){return{current:e,map:t}}var ib=ab(void 0,Ds.create((function(e,t){var r;return 0!==(r=$y(e.name,t.name))||0!==(r=Zy(e.scope.index,t.scope.index,eb))?r:tb(e.scope.document,t.scope.document)})));var ob=function(){function e(e,t,r,n){var a=this;this.context=e,this.visitedCells=t,this.cell=r,this.isPrecedent=n,this.receiveSuccess=function(e){return function(t){if(Jr(t)||Xr(t)){var r="calc.runtime.CellEvaluationMachine.receiveSuccess: "+("expected ReadOper; given "+d(t));return _.ULS.assertTag(595980815,s.LogCategory.msoulscat_ES_EWAJS,!1,r)}return a.writeSuccess(e.source,t,e.precedents),t}},this.receiveFailure=function(e){return function(t){if(t.kind===Wy.Unevaluated){var r="calc.runtime.CellEvaluationMachine.receiveFailure: "+("unexpected reason "+d(t));return _.ULS.assertTag(595980817,s.LogCategory.msoulscat_ES_EWAJS,!1,r)}var n=t.kind===VS.PreviousFailure&&void 0!==e.cycle?e.cycle:t;return a.writeFailure(e.source,n,e.precedents),_e.reject(a.isPrecedent?sy(e.source.range):n)}}}return e.prototype.evalCell=function(){var e=this.context.globals.getCellValue(this.cell);if(e.kind===H.Failure)return _e.reject(e.reason);var t=e.value;if(t.kind===KS.FinalValue)return t.oper;var r=this.context.globals.getCellFormula(t.anchor);if(r.kind===H.Failure){var n="calc.runtime.CellEvaluationMachine.next: unexpected Failure from getCellFormula";return _.ULS.assertTag(595980813,s.LogCategory.msoulscat_ES_EWAJS,!1,n)}var a=r.value;if(null==a){n="calc.runtime.CellEvaluationMachine.next: "+("client error: expected getCellFormula("+d(t.anchor)+") != null");return _.ULS.assertTag(595980814,s.LogCategory.msoulscat_ES_EWAJS,!1,n)}var i,o,u,c,l,f,h=this.visitAnchor(a),v=this.context.createFormulaEvaluationMachine(this.context,(u=h.source,c=wr(u.range),l=q(c.range),f=q(c.sheet),iy(u,l,f,u.kind===vn.Range,l,f,u.kind===vn.Cell,!0,!1,q(!1))),h.precedents,(i=this.visitedCells,x("calc.runtime.appendVisitedCell",(o=h).previous===i.current),rb(o,i.map.setValue(o.cell,o))),a.formula);return _e.fromMachine(v).bind(this.receiveSuccess(h)).catch(this.receiveFailure(h))},e.prototype.visitAnchor=function(e){var t=wr(e.source.range),r=this.visitedCells.map.getValue(t);if(null!=r){var n="calc.runtime.CellEvaluationMachine.visitAnchor: "+("unexpected visitValue at "+d(t)+"; given "+d(r));return _.ULS.assertTag(595980812,s.LogCategory.msoulscat_ES_EWAJS,!1,n)}return{cell:t,cycle:void 0,previous:this.visitedCells.current,source:e.source,precedents:Xy()}},e.prototype.writeSuccess=function(e,t,r){this.setCellValue(e,t,r)},e.prototype.writeFailure=function(e,t,r){this.context.globals.setCellFailure(e.range,t,r)},e.prototype.setCellValue=function(e,t,r){var n=this.context.globals.config.mathpack.zero,a=Zr(t)?n:t;if(e.kind===vn.Cell){if(Qr(a)){var i=void 0===a.opers[0]?ra:a.opers[0][0],o=Zr(i)?n:i;return this.context.globals.setCellValue(e.range,o,r)}return this.context.globals.setCellValue(e.range,a,r)}var u=e.range.range,s=Vm(u.rows,u.cols,a).opers,c=function(e){return Zr(e)?n:e},l=s.map((function(e){return e.map(c)}));return this.context.globals.setCellValues(e.range,l,r)},e}();function ub(e,t,r,n){return _e.try((function(){return new ob(e,t,r,n).evalCell()}))}function sb(e,t){for(var r=fb(e),n=[],a=0;a<t.length;a+=1)n.push(ub(r.machineContext,nb,t[a],!1));return new pb(r,n)}function cb(e){return{yieldIntervalMs:e.yieldIntervalMs,endTimeMs:null==e.totalTimeMs?void 0:Re()+e.totalTimeMs,scheduleFunction:null!=e.scheduleFunction?e.scheduleFunction:function(e){return setTimeout(e,0)}}}function lb(e){if(void 0!==e.yieldIntervalMs||void 0!==e.endTimeMs){if(void 0===e.yieldIntervalMs)return e.endTimeMs;var t=Re()+e.yieldIntervalMs;return void 0===e.endTimeMs?t:Se(e.endTimeMs,t)}}var db={kind:VS.Timeout};function fb(e){return{globals:e,timer:{doTimeout:function(e){return void 0!==e&&Re()>=e}},machineContext:hb(e)}}function hb(e){return{globals:e,resolver:_u(e),numberFormatter:PS(e),parser:zh(e),analyzer:Uv(e),createCellEvaluationMachine:ub,createFormulaEvaluationMachine:Jb,createLambdaEvaluationMachine:Qb}}var vb,pb=function(){function e(e,t){P("calc.runtime.EvaluationRuntime",t.length),this.context=e,this.machineRuntimes=t.map((function(e){return new we(e)})),this.results=[]}return e.prototype.evaluateAsync=function(e){var t=this;if(this.context.globals.interruptToken[0]===YS.Stop)return this.generatePartialResults(),Promise.resolve(this.results);if(this.context.timer.doTimeout(e.endTimeMs))return this.generatePartialResults(),Promise.resolve(this.results);try{var r=this.evaluate(lb(e));return Array.isArray(r)?Promise.resolve(r):new Promise((function(r,n){return e.scheduleFunction((function(){try{r(t.evaluateAsync(e))}catch(e){n(e)}}))}))}catch(e){return Promise.reject(e)}},e.prototype.evaluateSync=function(e){var t=this,r=function(n){if(t.context.globals.interruptToken[0]===YS.Stop||t.context.timer.doTimeout(e.endTimeMs))return t.generatePartialResults(),t.results;var a=t.evaluate(n);return Array.isArray(a)?a:dy((function(t){return r(void 0!==t?t:lb(e))}))};return r(lb(e))},e.prototype.evaluate=function(e){var t=this,r=function(){return t.context.timer.doTimeout(e)};try{for(;this.results.length<this.machineRuntimes.length;){var n=this.machineRuntimes[this.results.length].run(r);if(!n)return db;this.pushResult(n)}return this.results}catch(e){var a="calc.runtime.EvaluationRuntime.evaluate: unhandled error "+A(e);return _.ULS.assertTag(595980807,s.LogCategory.msoulscat_ES_EWAJS,!1,a)}},e.prototype.pushResult=function(e){return this.results.push(e),Ae},e.prototype.generatePartialResults=function(){for(;this.results.length<this.machineRuntimes.length;)this.results.push(Q($S))},e}();function mb(e){return{kind:vb.RangeValues,arrays:e}}function gb(e){return e.kind===vb.RangeValues}function Sb(e,t,r,n){if(r.kind===st.Abs)return r;var a=Ri(e,r.index,n)-t;return a===r.index?r:wt(st.Rel,a)}function yb(e,t,r,n){var a=Sb(t.row,r.row,n.row,1<<20),i=Sb(t.col,r.col,n.col,16384);return _t(a,i,ki(e,a)||ki(e,i),n.label)}function bb(e,t,r,n){switch(n.kind){case ut.Error:return n;case ut.Single:return yb(e,t,r,n);case ut.Range:var a=yb(e,t,r,n.ref1),i=yb(e,t,r,n.ref2);return a===n.ref1&&i===n.ref2?n:Lt(a,i,n.label);case ut.Row:var o=Sb(t.row,r.row,n.row1,1<<20),u=Sb(t.row,r.row,n.row2,1<<20);return Ut(o,u,ki(e,o)||ki(e,u),n.label);case ut.Col:var s=Sb(t.col,r.col,n.col1,16384),c=Sb(t.col,r.col,n.col2,16384);return xt(s,c,ki(e,s)||ki(e,c),n.label)}}!function(e){e.RangeValues="RangeValues"}(vb||(vb={}));var Eb=ln("TransformRefsError"),Fb=function(e){function t(t,r,n,a){var i=e.call(this)||this;return i.fn=t,i.locals=n,i.annotations=a,i.resolver=_u(r),i}return ee(t,e),t.prototype.nameNode=function(e,t,r){var n=Jt(e,t,r),a=this.resolver.resolveDottedName(this.locals,n,this.annotations).resolved;if(a.kind===bu.ResolvedCellRef){var i=$t(e);x("calc.lang.adjustFormulaOrigin",i.kind===mt.CellRefNamePart);var o=i.parts,u=o[0],s=o[1],c=function(e,t){return Zt(e,t.rhs,t.canDenoteNamedObject,t.label)};return Jt(o.slice(2).reduce(c,c(Xt(this.fn(u.ref),u.asWhole,u.label),s)),t,r)}if(a.resolution.kind!==H.Success&&a.resolution.reason.kind!==vu.NoOriginSheet)throw new Eb(a.resolution.reason);return n},t.prototype.cellRefNode=function(e,t,r){return tr(this.fn(e),t,r)},t}(Ge);function Cb(e,t,r,n){var a=t.originGridCell.value;if(Ar(a,r))return q(n);try{var i=dt(new Fb(bb.bind(void 0,e.config.refStyle,a,r),e,t,n.annotations),n);return q(te(te({},n),{node:i}))}catch(e){if(e instanceof Eb)return Q(e.reason);throw e}}var Rb,kb=function(){function e(e,t){void 0===t&&(t=Zn),this._fields=e,this._fallback=t,this.kind=bt.Rich}return e.prototype.getFallback=function(){return this._fallback},e.prototype.getField=function(e){return this._fields.getValue(e)},e}(),Nb=function(){function e(e,t,r,n){this.arity=e,this.kind=bt.Rich,this.locals=t,this.env=r,this.term=n}return e.prototype.getFallback=function(){return Zn},e.prototype.getField=function(e){},e}();function Ab(e,t){var r=t.map.getValue(e);if(void 0!==r)return Jy(function(e,t){for(var r=[],n=uy(r),a=t;r.push(a.cell),a.cycle=n,a!==e;a=a.previous);return r.reverse(),n}(r,t.current))}function Tb(e,t,r){e.precedents.cells.push(t);var n=e.globals.getCellValue(t);if(n.kind===H.Failure)return Jy(n.reason);var a=n.value;if(a.kind===KS.FinalValue)return a.oper;Ab(a.anchor,e.visitedCells),r.push(a.anchor)}function Ib(e,t,r,n){var a;if(e.precedents.cells.push(t),!n||Rr(t.range)<=16)a=t;else{var i=e.globals.getUsedRange(t.sheet),o=void 0;X(i)?o=null==i.value?void 0:i.value.range:Jy(i.reason);var u=void 0===o?void 0:Er(t.range,wn(0,0,o.row+o.rows,o.col+o.cols));if(void 0===u)return new Tm(t.range.rows,t.range.cols,0,0,[],fa);a=Bn(t.sheet,u)}var s=e.globals.getCellValues(a);if(s.kind===H.Failure)return Jy(s.reason);var c=r.length,l=function(e,t,r,n,a){var i=[],o=n.length,u=0;x("calc.runtime.deference: readIntoArray2D number of rows",o===r.rows);for(var s=0;s<o;s+=1){i.push([]);var c=n[s].length;x("calc.runtime.deference: readIntoArray2D number of cols",c===r.cols),u=0===s?c:Se(c,u);for(var l=0;l<c;l+=1){var d=n[s][l];KS.FinalValue===d.kind?i[s][l]=d.oper:(Ab(d.anchor,e.visitedCells),x("calc.runtime.deference: readIntoArray2D correct sheet",Nr(d.anchor.sheet,t.sheet)),a.push(d.anchor),i[s][l]=$n)}}return new Tm(t.range.rows,t.range.cols,o,u,i,fa)}(e,t,a.range,s.value,r);return c===r.length?l:void 0}function Ob(e,t,r){var n,a=Ib(e,t,r,!1);if(null!=a)return ua(a.rows,a.cols,a.rows===a.denseRows&&a.cols===a.denseCols?a.denseElements:Mm((n=a).rows,n.cols,n.get.bind(n)))}function Mb(e,t,r,n){if(0!=(r&bt.Range))return t;if(!Jr(t))return t;var a=t.sheets;if(!hr(a))return Pm("calc.runtime.dereference",Kn.REF,"3D range, oper = "+d(t)),$n;if(1!==t.ranges.length)return Pm("calc.runtime.dereference",Kn.VALUE,"union range, oper = "+d(t)),Zn;var i=t.ranges[0];if(0!=(r&Bm)){if(pr(i))return Tb(e,Wn(a,i),n);if(e.locals.implicitIntersect&&!Y(w.CalcSupportDynamicArrays)&&!Y(w.CalcPreventSpillingHack)){var o=e.locals.originGridCell;if(!X(o))return Jy(o.reason);var u=Cr(o.value,i);return null==u?(Pm("calc.runtime.dereference",Kn.VALUE,"empty intersection, oper = "+d(t)),Zn):Tb(e,Wn(a,u),n)}return Ob(e,Bn(a,i),n)}return 0!=(r&bt.Array)?Ob(e,Bn(a,i),n):(Pm("calc.runtime.dereference",Kn.VALUE,"bad target type "+r),Zn)}function wb(e,t,r){var n=[],a=Mb(e,t,r,n);if(null==a){if(n.length>0)return Jy(qy(n));var i="calc.runtime.dereferenceOper: internal error: expected nonempty anchors; oper = "+d(t);return _.ULS.assertTag(595980819,s.LogCategory.msoulscat_ES_EWAJS,!1,i)}return a}function Db(e,t,r){for(var n=[],a=0;a<t.length;a+=1){var i=Mb(e,t[a],Gr(r,a,t.length),n);null!=i&&(t[a]=i)}if(n.length>0)return Jy(qy(n))}function _b(e,t){return 0!=(t&bt.Number)?e.zero:0!=(t&bt.String)?Qm:0!=(t&bt.Boolean)?va:Zn}function Lb(e,t,r){var n=function e(t,r,n){var a=t.globals.config,i=a.localeInfo,o=a.mathpack;if(Kr(r)){if(0!=(n&bt.Number))return r;if(0!=(n&bt.String)){return zn(o.formatGeneral(i,r,20))}return 0!=(n&bt.Boolean)?qn(0!==o.cond(r)):0!=(n&bt.Array)?ua(1,1,[[r]]):Zn}if(Yr(r)){if(0!=(n&bt.String))return r;if(0!=(n&bt.Number)){if(0===r.value.length)return Zn;if(r.value.length>255)return Zn;var u=t.numberFormatter.parseGeneral(r.value,!1,!0,qv.NonVolatile);return X(u)||Jy(u.reason),void 0!==u.value?u.value.value:Zn}return 0!=(n&bt.Boolean)?0===i.stringCompareCI(r.value,i.trueName)?ha:0===i.stringCompareCI(r.value,i.falseName)?va:Zn:0!=(n&bt.Array)?ua(1,1,[[r]]):Zn}if(qr(r))return 0!=(n&bt.Boolean)?r:0!=(n&bt.Number)?r.value?o.one:o.zero:0!=(n&bt.String)?zn(r.value?i.trueName:i.falseName):0!=(n&bt.Array)?ua(1,1,[[r]]):Zn;if(0!=(n&r.kind))return r;switch(r.kind){case bt.Error:return r;case bt.Missing:return 0!=(n&bt.Blank)?fa:_b(o,n);case bt.Blank:return _b(o,n);case bt.Rich:return e(t,r.getFallback(),n);default:return Zn}}(e,t,r);return zr(n)&&!zr(t)&&Pm("calc.runtime.coerceOper",n.type,"kind = "+t.kind),n}function Ub(e,t){return x("calc.runtime.lambdaCall",t.length===e.arity),{kind:Rb.LambdaCall,lambda:e,args:t}}function xb(e){return e.kind===Rb.LambdaCall}!function(e){e.LambdaCall="LambdaCall"}(Rb||(Rb={}));var Bb=function(){function e(e){this.kind=bt.Rich,this.arity=e.arity,this.func=e.func}return e.prototype.getFallback=function(){return U("calc.runtime.UdfOper.getFallback")},e.prototype.getField=function(e){return U("calc.runtime.UdfOper.getField")},e}(),Wb=function(){function e(e,t,r,n,a,i){this.context=e,this.locals=t,this.precedents=r,this.visitedCells=n,this.visitedNames=a,this.usage=i;var o=e.globals.config.refStyle;this.config={localeInfo:e.globals.config.localeInfo,get refStyle(){return r.special|=Ft.RefStyle,o},mathpack:e.globals.config.mathpack,date1904:e.globals.config.date1904,dateCompatibility:e.globals.config.dateCompatibility,timezone:e.globals.config.timezone,datepack:e.globals.config.datepack},this.mathpack=this.config.mathpack,this.datepack=this.config.datepack}return Object.defineProperty(e.prototype,"globals",{get:function(){return this.context.globals},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numberFormatter",{get:function(){return this.context.numberFormatter},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"calcingArray",{get:function(){return this.locals.calcingArray},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"originGridCell",{get:function(){var e=this.locals.originGridCell;return X(e)?e.value:Jy(e.reason)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"originSheet",{get:function(){var e=this.locals.originSheet;return X(e)?e.value:Jy(e.reason)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reflectionGridCell",{get:function(){var e=this.locals.reflectionGridCell;return X(e)?e.value:Jy(e.reason)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reflectionSheet",{get:function(){var e=this.locals.reflectionSheet;return X(e)?e.value:Jy(e.reason)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"followHyperlinks",{get:function(){var e=this.locals.followHyperlinks;return X(e)?e.value:Jy(e.reason)},enumerable:!0,configurable:!0}),e.prototype.applyFunction=function(e,t){var r=Da(e),n=t.some(Jr)?t.slice(0):t;return Db(this,n,r),this.handleLambda(this.dispatchFunction(my(e),r,!1,n))},e.prototype.applyLambda=function(e,t){return this.handleLambda(Ub(e,t))},e.prototype.handleEvaluationError=function(e){if(e instanceof zy)return Qy(this.context,this.visitedCells,e.reason)},e.prototype.applyOperatorOrFunction=function(e,t,r){if(Sy(e))return ug(this.globals,py(e),t,r);var n=gy(e);if(n===la._UDF){if(t[0]instanceof Nb){var a=t[0];return t.length-1!==a.arity?Zn:Ub(a,t.slice(1))}if(t[0]instanceof Bb){var i=t[0];if(t.length-1!==i.arity)return Zn;if((c=i.func(this,t.slice(1))).kind===bt.Error){var o="UDF function return value";Pm("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",c.type,o)}return c}switch(t[0].kind){case bt.Error:return t[0];case bt.Number:return Zn;case bt.Rich:return Jy(un(["Rich UDF head"]));case bt.String:case bt.Boolean:case bt.Blank:case bt.Missing:case bt.Array:return $n;case bt.Range:return U("calc.runtime.FunctionDispatcher.applyOperatorOrFunction: UDF head should be derefed");default:return L("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",t[0])}}var u=this.globals.getWorksheetFunc(n);if(u.kind===H.Failure)return Jy(u.reason);var s=u.value;if(null==s){o="nonexistent worksheet function "+n;return Pm("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",Kn.NAME,o),ea}try{var c;if((c=s(this,t)).kind===bt.Error){o="worksheet function "+n+" return value";Pm("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",c.type,o)}return c}catch(e){throw T(e,"(in WSF "+su(n)+")")}},e.prototype.handleLambda=function(e){return xb(e)?_m(this.context.createLambdaEvaluationMachine(this.context,this.locals,this.precedents,this.visitedCells,this.visitedNames,this.usage,e.lambda,e.args)):e},e.prototype.dispatchFunction=function(e,t,r,n){var a=this;if(!Hr(t,n.length)){var i=JSON.stringify(t),o="calc.runtime.FunctionDispatcher.dispatchFunction: "+(g="bad application of "+JSON.stringify(e)+" to "+n.length+" arguments, ftype = "+i);return _.ULS.assertTag(593372499,s.LogCategory.msoulscat_ES_EWAJS,!1,o)}for(var u=n.length,c=Et.None,l=0;l<u;l+=1){var f=n[l],h=f.kind;0==(h&Gr(t,l,u))&&(c|=h),Jr(f)&&0==(t.flags&Ct.Allow3dRef)&&!hr(f.sheets)&&(c|=h)}if(c===Et.None)return this.applyOperatorOrFunction(e,n,r);if(0!=(c&bt.Array)){return Km(this,t,(function(r){return a.handleLambda(a.dispatchFunction(e,t,!1,r))}),n)}c&=~bt.Array;var v=[];for(l=0;l<u;l+=1){var p=n[l];if(0!=(c&p.kind)){var m=Gr(t,l,u);if(zr(p=this.coerceOper(p,m))&&0==(m&bt.Error))return p;if(Jr(p)&&0==(t.flags&Ct.Allow3dRef)&&!hr(p.sheets)){var g="3D reference, oper = "+d(p);return Pm("calc.runtime.FunctionDispatcher.dispatchFunction",Kn.VALUE,g),Zn}}v[l]=p}return this.applyOperatorOrFunction(e,v,r)},e.prototype.getAvailableFormula=function(e){var t=this.globals.getCellFormula(e);return X(t)?me(t.value)?void 0:t.value:Jy(t.reason)},e.prototype.getNameFormula=function(e,t,r){var n=this.context.resolver.resolveName(this.locals,Jt(Qt(t,!0),e),r).resolution;if(X(n)){var a=n.value;if(a){this.precedents.names.push(a);var i=this.globals.getNameFormula(a,r);X(i)||Jy(i.reason);var o=i.value;if(!me(o))return[a,o.node]}}else n.reason.kind!==vu.NoOriginSheet&&Jy(n.reason)},e.prototype.getCellRef=function(e,t,r,n){var a={originGridCell:q(r.range),originSheet:q(r.sheet),allowUnqualifiedCell:!0,wrapCellReferences:n},i=this.context.resolver.resolveCellRef(a,tr(t,e)).resolution;if(X(i)){var o=i.value;if(o)return ca(o.sheet,o.range)}else i.reason.kind!==vu.NoOriginSheet&&Jy(i.reason)},e.prototype.dereferenceOper=function(e,t){return wb(this,e,t)},e.prototype.dereferenceOpers=function(e,t){Db(this,e,t)},e.prototype.getCellFormula=function(e){this.precedents.cells.push(e);var t=this.globals.getCellValue(e);return X(t)?this.getAvailableFormula(e):Jy(t.reason)},e.prototype.getSheetIndex=function(e,t){var r=this.globals.getSheetIndex(e,t);return X(r)?(this.precedents.special|=Ft.OwnDocSheets,null==r.value?void 0:Tn(e,r.value)):Jy(r.reason)},e.prototype.getSheetRangePosition=function(e){this.precedents.special|=Ft.OwnDocSheets;var t=this.globals.getSheetRangeIndexes(e);return X(t)?t.value.position:Jy(t.reason)},e.prototype.getSheetRangeIndexes=function(e){if(void 0!==e.index&&e.index===e.index2)return[e.index];this.precedents.special|=Ft.OwnDocSheets;var t=this.globals.getSheetRangeIndexes(e);return X(t)?t.value.sheets:Jy(t.reason)},e.prototype.dereferenceAllOpersInner=function(e,t,r){var n=this;void 0===r&&(r=!1);for(var a=[],i=[],o=function(o){var s=e[o];if(!Jr(s))return i.push(s),"continue";for(var c=[],l=function(e){var r=Ib(n,e,a,!0);void 0!==r&&c.push(t(r,e))},d=u.getSheetRangeIndexes(s.sheets),f=function(e){for(var t=Tn(s.sheets.document,d[e]),n=function(e){var n=s.ranges[e];if(!r)return l(Bn(t,n)),"continue";var a=u.globals.getHiddenRows(t,n.row,n.row+n.rows);if(!X(a))return{value:Jy(a.reason)};var i=a.value;if(0===i.length)return l(Bn(t,n)),"continue";for(var o=function(e,r){var a=wn(e,n.col,r-e,n.cols);l(Bn(t,a))},c=0;c<i.length;c+=1){var d=i[c],f=d.start,h=d.end,v=0===c?n.row:i[c-1].end;x("calc.runtime.FunctionDispatcher.dereferenceAllOpersInner: valid interval",v<=f&&f<h&&h<=n.row+n.rows),v!==f&&o(v,f);var p=wn(f,n.col,h-f,n.cols);u.precedents.cells.push(Bn(t,p))}var m=i[i.length-1].end;m!==n.row+n.rows&&o(m,n.row+n.rows)},a=0;a<s.ranges.length;a+=1){var i=n(a);if("object"==typeof i)return i}},h=0;h<d.length;h+=1){var v=f(h);if("object"==typeof v)return v}i.push({kind:vb.RangeValues,arrays:c})},u=this,s=0;s<e.length;s+=1){var c=o(s);if("object"==typeof c)return c.value}return a.length>0?Jy(qy(a)):i},e.prototype.dereferenceAllOpers=function(e,t){return this.dereferenceAllOpersInner(e,se,t)},e.prototype.dereferenceAllOpersAndFormulae=function(e,t){var r=this;return this.dereferenceAllOpersInner(e,(function(e,t){return new Om(e.rows,e.cols,e.denseRows,e.denseCols,(function(n,a){var i=e.get(n,a),o=Wn(t.sheet,Dn(t.range.row+n,t.range.col+a));return[i,r.getAvailableFormula(o)]}),(function(){return[e.getSparse(),void 0]})).strict()}),t)},e.prototype.parseFormula=function(e,t,r,n){var a=this.context.parser.parseFormula(ec(r.lexicalKind,t,{refStyle:e}),n);if(!X(a))return a;var i=this.context.analyzer.checkFormula(r,a.value);if(!X(i))return i;if(!vr(i.value))return Q(JS("ill-formed indirect formula","indirect"));i.value;return i},e.prototype.getRandom=function(){this.precedents.special|=Ft.Calc;var e=this.globals.getRandom();return X(e)||Jy(e.reason),e.value},e.prototype.getTime=function(e){this.precedents.special|=Ft.Time;var t=this.globals.getTime(e,qv.Volatile);return X(t)||Jy(t.reason),t.value},e.prototype.coerceOper=function(e,t){return Lb(this,e,t)},e.prototype.parseGeneral=function(e,t){var r,n=this.numberFormatter.parseGeneral(e,!1,t,qv.NonVolatile);return X(n)||Jy(n.reason),null===(r=n.value)||void 0===r?void 0:r.value},e.prototype.parseDate=function(e){var t,r=this.numberFormatter.parseDate(e,qv.NonVolatile);return X(r)||Jy(r.reason),null===(t=r.value)||void 0===t?void 0:t.value},e.prototype.getBinaryOperator=function(e){var t=this,r=wa(e),n=[va,va];return function(a,i){n[0]=a,n[1]=i,Db(t,n,r);var o=t.dispatchFunction(vy(e),r,!1,n);return x("calc.runtime.FunctionDispatcher.getBinaryOperator",!xb(o)&&!Lm(o)),o}},e.prototype.getUnaryOperator=function(e){var t=this,r=wa(e),n=[va];return function(a){n[0]=a,Db(t,n,r);var i=t.dispatchFunction(vy(e),r,!1,n);return x("calc.runtime.FunctionDispatcher.getUnaryOperator",!xb(i)&&!Lm(i)),i}},e.prototype.isInFilterMode=function(e){this.precedents.special|=Ft.InFilterMode;for(var t=0,r=e;t<r.length;t++){var n=r[t];if(Jr(n))for(var a=0,i=this.getSheetRangeIndexes(n.sheets);a<i.length;a++){var o=i[a],u=this.globals.isInFilterMode(Tn(n.sheets.document,o));if(!X(u))return Jy(u.reason);if(u.value)return!0}}return!1},e.prototype.formatFormula=function(e,t){var r=Wn(e.source.range.sheet,t),n=Cb(this.globals,uv(vn.Cell,wr(e.source.range)),t,e.formula);if(!X(n))return Jy(n.reason);var a=this.context.parser.formatFormula(rc(e.source,r,{refStyle:this.config.refStyle}),n.value);return X(a)?a.value:Jy(a.reason)},e.prototype.applyFormat=function(e,t,r){var n;if("number"==typeof t){var a=this.globals.getKnownFormat(e,t);if(!X(a))return Jy(a.reason);n=a.value}else{var i=xS(this.context.numberFormatter,this.globals,e,t);if(!X(i))switch(i.reason.kind){case wv.PreviousFormatFailure:return;default:return Jy(i.reason)}n=i.value}var o=BS(this.context.numberFormatter,n,r);return X(o)?"string"==typeof o.value?o.value:void 0:Jy(o.reason)},e}(),Pb=[void 0,ea],Vb=[void 0,$n],Gb=function(){function e(){}return Object.defineProperty(e.prototype,"value",{get:function(){return void 0===this._value?Jy(un(["LETREC cycle"])):this._value},set:function(e){this._value=e},enumerable:!0,configurable:!0}),e}(),Hb=Ds.create((function(e,t){return e-t})),jb={kind:ay.CallLambda};var Kb,Yb,qb,zb=function(){function e(e,t,r,n,a,i,o,u,s,c,l){this.context=e,this.locals=t,this.precedents=r,this.visitedCells=n,this.visitedNames=a,this.stackEnv=i,this.closureEnv=o,this.usage=u,this.target=s,this.isLambda=c,this.runStatus=!1,this.term=l,this.continuation=[]}return Object.defineProperty(e.prototype,"globals",{get:function(){return this.context.globals},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numberFormatter",{get:function(){return this.context.numberFormatter},enumerable:!0,configurable:!0}),e.prototype.next=function(){try{return this.doNext()}catch(e){if(e instanceof zy)return Qy(this.context,this.visitedCells,e.reason);throw e}},e.prototype.receiveResult=function(e){return X(e)?this.updateTermTransition(e.value):e},e.prototype.doNext=function(){if(Iy(this.term)){var e=this.continuation;if(0===e.length){var t=Lb(this,wb(this,this.term,this.target),this.target);return this.precedents.bound=Un.Exact,!Y(w.CalcPreventSpillingHack)||this.isLambda||this.locals.lexicalSource.kind!==vn.Cell||!Qr(t)||1===t.rows&&1===t.cols?q(t):Q(un(["spilling"]))}var r=e[e.length-1];return this.applyContinuation(this.term,r)}return this.reduceFormula(this.term)},e.prototype.applyContinuation=function(e,t){var r=t.context;switch(r.kind){case ay.App:var n=t.holeIndex,a=r.children.length;return(i=t.locals)[n]=e,n+1<a?this.nextHoleTransition(t,r.children[n+1]):this.dispatchFunction(i,i,r.data);case ay.Conditional:var i;if(0===(n=t.holeIndex)){var o=gy(r.data.funName),u=o===la.IF?bt.Boolean:bt.Number,s=wb(this,e,u);if(Qr(s))return t.locals=[s],this.nextHoleTransition(t,r.children[n+1]);if($r(s))return Q(un(["IF/CHOOSE with a rich value condition"]));if(s=Lb(this,s,u),o===la.IF&&qr(s))return this.popContextTransition(r.children[s.value?1:2]);if(o===la.CHOOSE&&Kr(s)){var c=this.context.globals.config.mathpack.fix(s);if(c<1||c>r.children.length-1){var l="CHOOSE; out of bounds option = "+d(c);return Pm("calc.runtime.FormulaEvaluationMachine.applyContinuation",Kn.VALUE,l),this.popContextTransition(Zn)}return this.popContextTransition(r.children[c])}return x("calc.runtime.FormulaEvaluationMachine.applyContinuation",zr(s)),this.popContextTransition(s)}return(i=t.locals)[n]=e,n+1<r.children.length?this.nextHoleTransition(t,r.children[n+1]):this.dispatchFunction(i,i,r.data);case ay.Name:var f=this.popContextTransition(e),h=t.locals;return this.locals=h.locals,this.visitedNames=h.visitedNames,f;case ay.Let:n=t.holeIndex;var v=r.children.length-1;if(n>=v){f=this.popContextTransition(e),h=t.locals;return this.stackEnv.length=h.stackEnvLen,f}if(r.data.rec){var p=this.stackEnv.length-v+n;this.stackEnv[p].value=e,this.stackEnv[p]=e}else this.stackEnv.push(e);return this.nextHoleTransition(t,r.children[n+1]);case ay.Array:var m=wb(this,e,xm),g=r.data,S=g.rows,y=g.cols,b=t.holeIndex,E=b%y,F=y===E+1,C=(b-E)/y,R=t.locals;if(R[C][E]=Lb(this,m,xm),S===C+1&&F)return this.popContextTransition(ua(S,y,R));var k=F?C+1:C,N=F?0:E+1;return this.nextHoleTransition(t,r.children[k][N]);case ay.CallLambda:f=this.popContextTransition(e),h=t.locals;return this.locals=h.locals,this.stackEnv.length=h.stackEnvLen,this.closureEnv=h.closureEnv,this.usage.lambdaDepth-=1,f;default:return L("calc.runtime.FormulaEvaluationMachine.applyContinuation",r)}},e.prototype.reduceFormula=function(e){var t=this;switch(e.kind){case ay.CellRef:return this.updateTermTransition(this.evalCellRefTerm(e));case ay.StructRef:return this.updateTermTransition(this.evalStructRefTerm(e));case ay.App:var r=e.data.funName;if(!Sy(r)){var n=gy(r);if(n!==la._UDF){var a=this.globals.getWorksheetFunc(n);if(a.kind===H.Failure)return Jy(a.reason)}}return 0===e.children.length?xb(i=new Wb(this.context,this.locals,this.precedents,this.visitedCells,this.visitedNames,this.usage).dispatchFunction(r,e.data.funType,e.data.isFormulaRoot,[]))?this.evaluateLambdaTransition(void 0,i):Lm(i)?this.evaluateMachineTransition(void 0,i):this.updateTermTransition(i):this.pushContextTransition(e,e.children[0],[]);case ay.Conditional:return this.pushContextTransition(e,e.children[0],void 0);case ay.Let:return this.evaluateLetTransition(e);case ay.Name:var i;if(void 0!==(i=this.evalNameTerm(e))[0]){var o=i[0],u=i[1],s=i[2],c=this.pushContextTransition(e,u,{locals:this.locals,visitedNames:this.visitedNames});return this.locals=function(e,t){var r,n=e.name.scope;if(void 0!==n.index)r=q(n);else{var a=t.originSheet;if(!X(a))return Jy(a.reason);r=kr(a.value.document,n.document)?a:q(n)}var i=t.originGridCell;return iy(e,i,r,t.calcingArray,i,r,!1,!1,!0,q(!1))}(Rn(o),this.locals),this.visitedNames=s,c}var l=i[1];return this.updateTermTransition(l);case ay.Udf:return this.updateTermTransition(this.evalUdfTerm(e));case ay.ReadStack:return x("calc.runtime.FormulaEvaluationMachine.reduceFormula",void 0!==(d=this.stackEnv[this.stackEnv.length-1-e.data])),this.updateTermTransition(d instanceof Gb?d.value:d);case ay.ReadClosure:var d;return x("calc.runtime.FormulaEvaluationMachine.reduceFormula",void 0!==(h=this.closureEnv.getValue(e.data[0]))),x("calc.runtime.FormulaEvaluationMachine.reduceFormula",void 0!==(d=h[e.data[1]])),d instanceof Gb&&(d=d.value,h[e.data[1]]=d),this.updateTermTransition(d);case ay.Array:return this.pushContextTransition(e,e.children[0][0],e.children.map((function(){return[]})));case ay.Lambda:var f=e.data.closedIdents.map((function(e){var r=t.stackEnv[t.stackEnv.length-1-e];return x("calc.runtime.FormulaEvaluationMachine.reduceFormula",void 0!==r),r})),h=this.closureEnv.setValue(e.data.closureId,f);return this.updateTermTransition(new Nb(e.data.arity,this.locals,h,e.children));default:return L("calc.runtime.FormulaEvaluationMachine.reduceFormula",e)}},e.prototype.dispatchFunction=function(e,t,r){var n=r.funName,a=r.funType,i=r.isFormulaRoot;Db(this,t,a);var o=new Wb(this.context,this.locals,this.precedents,this.visitedCells,this.visitedNames,this.usage).dispatchFunction(n,a,i,t);return xb(o)?this.evaluateLambdaTransition(e,o):Lm(o)?this.evaluateMachineTransition(e,o):this.popContextTransition(o)},e.prototype.pushContextTransition=function(e,t,r){var n=function(e,t){return{context:e,holeIndex:0,locals:t}}(e,r);return this.continuation[this.continuation.length]=n,this.updateTermTransition(t)},e.prototype.popContextTransition=function(e){return this.continuation.pop(),this.updateTermTransition(e)},e.prototype.evaluateMachineTransition=function(e,t){var r=t.machine;return void 0!==e&&this.continuation.pop(),Te(r,this)},e.prototype.evaluateLambdaTransition=function(e,t){var r,n,a,i=t.lambda,o=t.args,u=this.continuation[this.continuation.length-1-(void 0!==e?1:0)],s=(null==u?void 0:u.context.kind)===ay.CallLambda?u:void 0;return this.usage.lambdaCalls[0]+1>(null!==(r=this.globals.limits.maxLambdaCalls)&&void 0!==r?r:1/0)?Jy(ly(qS.LambdaCalls)):void 0===s&&this.usage.lambdaDepth+1>(null!==(n=this.globals.limits.maxLambdaDepth)&&void 0!==n?n:1/0)?Jy(ly(qS.LambdaDepth)):(void 0!==e&&this.continuation.pop(),void 0!==s?(a=this.updateTermTransition(i.term),this.stackEnv.length=s.locals.stackEnvLen):(a=this.pushContextTransition(jb,i.term,{locals:this.locals,stackEnvLen:this.stackEnv.length,closureEnv:this.closureEnv}),this.usage.lambdaDepth+=1),he(this.stackEnv,o),this.closureEnv=i.env,this.locals=function(e,t){return iy(e.locals.lexicalSource,e.locals.originGridCell,e.locals.originSheet,t.calcingArray,t.reflectionGridCell,t.reflectionSheet,t.implicitIntersect,e.locals.allowUnqualifiedCell,e.locals.wrapCellReferences,q(!1))}(i,this.locals),this.usage.lambdaCalls[0]+=1,a)},e.prototype.evaluateLetTransition=function(e){var t=this.pushContextTransition(e,e.children[0],{stackEnvLen:this.stackEnv.length});if(e.data.rec)for(var r=e.children.length-1,n=0;n<r;n+=1)this.stackEnv.push(new Gb);return t},e.prototype.nextHoleTransition=function(e,t){return e.holeIndex+=1,this.updateTermTransition(t)},e.prototype.updateTermTransition=function(e){return this.term=e,Ae},e.prototype.getNameFormulaAsTerm=function(e,t){this.precedents.names.push(e);var r=this.globals.getNameFormula(e,t);if(r.kind===H.Failure)return Jy(r.reason);var n=r.value;return null!=n?jy("calc.runtime.FormulaEvaluationMachine.getNameFormulaAsTerm",n):void 0},e.prototype.checkForNameCycle=function(e){var t,r=this.visitedNames,n=r.map.getValue(e);return void 0!==n?Jy(function(e,t){for(var r=[],n=t;r.push(n.name),n!==e;n=n.previous);return r.reverse(),oy(r)}(n,r.current)):this.visitedNames.map.getCount()+1>(null!==(t=this.globals.limits.maxNameChain)&&void 0!==t?t:1/0)?Jy(ly(qS.NameChain)):function(e,t){var r={name:t,previous:e.current};return ab(r,e.map.setValue(t,r))}(this.visitedNames,e)},e.prototype.evalNameTerm=function(e){var t=this.context.resolver.resolveName(this.locals,Jt(Qt(e.data.name,!0),e.data.qualifier),e.data.source).resolution;if(!X(t)){if(t.reason.kind===vu.NoOriginSheet){var r="name resolution, no sheet; qualifier = "+d(e.data.qualifier);return Pm("calc.runtime.FormulaEvaluationMachine.evalName",Kn.REF,r),Vb}return Jy(t.reason)}var n,a=t.value;if(void 0===a||void 0===(n=this.getNameFormulaAsTerm(a,e.data.source))){var i=e.children;if(void 0===i){r="name resolution; qualifier = "+d(e.data.qualifier);return Pm("calc.runtime.FormulaEvaluationMachine.evalName",Kn.NAME,r),Pb}return[void 0,i]}return[a,n,this.checkForNameCycle(a)]},e.prototype.evalCellRefTerm=function(e){var t=this.context.resolver.resolveCellRef(this.locals,tr(e.data.ref,e.data.qualifier)).resolution;if(!X(t)){if(t.reason.kind===vu.NoOriginSheet){var r="error ref, no sheet, qualifier = "+d(e.data.qualifier);return Pm("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",Kn.REF,r),$n}return Jy(t.reason)}var n=t.value;if(!n){r="error ref, qualifier = "+d(e.data.qualifier);return Pm("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",Kn.REF,r),$n}return ca(n.sheet,n.range)},e.prototype.evalStructRefTerm=function(e){var t=this.context.resolver.resolveStructRef(this.locals,e.data).resolution;if(!X(t)){if(t.reason.kind===vu.NoOriginSheet){var r="error ref, no sheet, struct ref = "+d(e.data);return Pm("calc.runtime.FormulaEvaluationMachine.evalStructRefTerm",Kn.REF,r),$n}if(t.reason.kind===vu.EmptyIntersection){r="error ref, empty intersection, struct ref = "+d(e.data);return Pm("calc.runtime.FormulaEvaluationMachine.evalStructRefTerm",Kn.VALUE,r),Zn}return Jy(t.reason)}var n=t.value;if(!n){r="error ref, struct ref = "+d(e.data);return Pm("calc.runtime.FormulaEvaluationMachine.evalStructRefTerm",Kn.REF,r),$n}return ca(n.sheet,n.range)},e.prototype.evalUdfTerm=function(e){var t=this.context.resolver.resolveUserDefinedFunc(this.locals,Jt(Qt(e.data.name,!0),e.data.qualifier)).resolution;X(t)||Jy(t.reason);var r=t.value;if(!r){var n=e.children;if(void 0===n){var a="UDF resolution, qualifier = "+d(e.data.qualifier);return Pm("calc.runtime.FormulaEvaluationMachine.evalUdfTerm",Kn.NAME,a),ea}return n}if(r.length>1){a="UDF resolution, ambiguous name";return Pm("calc.runtime.FormulaEvaluationMachine.evalUdfTerm",Kn.NAME,a),ea}var i=this.globals.getUserDefinedFunc(r[0]);return X(i)||Jy(i.reason),new Bb(i.value)},e}();function Jb(e,t,r,n,a){return new zb(e,t,r,n,ib,[],Hb,{lambdaCalls:[0],lambdaDepth:0},Wm,!1,jy("calc.runtime.createFormulaEvaluationMachine",a))}function Qb(e,t,r,n,a,i,o,u){return x("calc.runtime.createLambdaEvaluationMachine",u.length===o.arity),new zb(e,t,r,n,a,ie(u),o.env,i,Et.All,!0,o.term)}function Xb(e,t,r){var n,a=fb(e),i=Xy(),o=Jb(a.machineContext,t,i,nb,r),u=new pb(a,[o]),s=cb(null!==(n=t.schedulerConfig)&&void 0!==n?n:e.schedulerConfig);return function e(t){return Array.isArray(t)?t[0]:dy((function(r){return e(t.resume(r))}))}(u.evaluateSync(s))}function Zb(e){return{evalFormula:function(t,r){return Xb(e,t,r)},evalCells:function(t){return function(e,t){if(0===t.length)return[];var r=sb(e,t),n=cb(e.schedulerConfig);return r.evaluateSync(n)}(e,t)},evalCellsAsync:function(t){return function(e,t){if(0===t.length)return Promise.resolve([]);var r=sb(e,t),n=cb(e.schedulerConfig);return r.evaluateAsync(n)}(e,t)}}}function $b(e,t,r,n){var a=zh($s(e)).parseFormula(it.A1,n,vn.Range,r);if(X(a)){var i=a.value;if(!(t<0||t>=r.length))return{formula:i,subexpression:_r(i,t)}}}function eE(e){return e.formula.spans[e.subexpression.label]}function tE(e,t,r){var n=t.formula;return function(e,t,r,n){if((t.kind===pt.App||t.kind===pt.Let)&&Br(t.head)&&t.head.id===la.LET){for(var a=[],i=r.spans[t.label],o=0;o<t.args.length-1;o+=2){var u=0===o?r.spans[t.head.label]:r.spans[t.args[o].label],s=r.spans[t.args[o+1].label];if(i&&u&&s){var c=n.indexOf(e.listSeparator,s.end);c>=0?c+=1:(c=n.indexOf(")",s.end))<0&&(c=s.end);var l=Wt(0===o?u.end+1:u.start,c,"","");a.push(l)}}return a}if(t.kind===pt.Name||t.kind===pt.Bad)return function e(t,r,n,a){switch(r.kind){case pt.App:case pt.Let:case pt.Lambda:if(Br(r.head)&&r.head.id===la.LET)for(var i=0;i<r.args.length;i+=1)if(i%2==0&&i<r.args.length-1){var o=r.args[i],u=r.args[i+1];if(o.kind===pt.Name&&a.kind===pt.Name&&0===t.stringCompareCI(o.whole,a.whole)||o.kind===pt.Bad&&a.kind===pt.Bad&&o.type===yt.CellRef&&a.type===yt.CellRef&&0===t.stringCompareCI(o.contents,a.contents)){var s=[],c=n.spans[o.label],l=n.spans[u.label],d=n.spans[a.label];if(d&&c&&l&&c.start===d.start&&c.end===d.end)return s.push(Wt(c.start,l.end,"","")),s}}else{if((s=e(t,r.args[i],n,a)).length>0)return s}else for(i=0;i<r.args.length;i+=1){if((s=e(t,r.args[i],n,a)).length>0)return s}return[];case pt.Array:for(i=0;i<r.nodes.length;i+=1)for(var f=0;f<r.nodes[i].length;f+=1){if((s=e(t,r.nodes[i][f],n,a)).length>0)return s}return[];case pt.Paren:return e(t,r.node,n,a);case pt.Bad:case pt.CellRef:case pt.FieldRef:case pt.Literal:case pt.Name:case pt.StructRef:return[];default:return L("calc.runtime.addLETNameSubspans",r)}}(e,r.node,r,t);return[]}(e,t.subexpression,n,r)}function rE(e,t,r,n){var a=r;a.startsWith("=")||(a="="+r);var i=zh($s(e)),o=i.parseFormula(it.A1,n,vn.Range,t),u=i.parseFormula(it.A1,n,vn.Range,a);if(X(o)&&X(u))return{formula:o.value,subexpression:u.value.node}}function nE(e,t,r,n){var a=aE(e.localeInfo,t.formula,t.formula.node,r,t.subexpression),i=Lo(gu()),o=t.formula,u=o.spans,s=o.annotations,c=o.depthUpperBound,l=Xs(zs(i),Js(Cn(vn.Cell,n),n,i),Bt(a,u,s,c));return X(l)?l.value:""}function aE(e,t,r,n,a){switch(r.kind){case pt.App:case pt.Let:case pt.Lambda:if(Br(r.head)&&r.head.id===la.LET)return function(e,t,r,n,a){for(var i=[],o=0;o<r.args.length;o+=1){var u=t.spans[r.args[o].label];if(u&&n.start>=u.start&&n.end<=u.end){var s=r.args[o];if((n.start>u.start||n.end<u.end)&&(s=aE(e,t,r.args[o],n,a)),o===r.args.length-1&&r.args.length%2==1)i.push(s);else if(o%2==1){if(1===o)return s;i.pop(),i.push(s)}else i.push(s),i.push(r.args[o+1]),i.push(s);return Ht(r.head,i,!0,r.label)}i.push(r.args[o])}return a}(e,t,r,n,a);for(var i=0;i<r.args.length;i+=1){var o=t.spans[r.args[i].label];if(o&&n.start>=o.start&&n.end<=o.end)return aE(e,t,r.args[i],n,a)}return a;case pt.Array:for(i=0;i<r.nodes.length;i+=1)for(var u=0;u<r.nodes[i].length;u+=1){var s=t.spans[r.nodes[i][u].label];if(s&&n.start>=s.start&&n.end<=s.end)return aE(e,t,r.nodes[i][u],n,a)}return a;case pt.Paren:var c=t.spans[r.node.label];return c&&n.start>=c.start&&n.end<=c.end?aE(e,t,r.node,n,a):a;case pt.Bad:case pt.CellRef:case pt.FieldRef:case pt.Literal:case pt.Name:case pt.StructRef:return a;default:return L("calc.runtime.makeSubstitutions",r)}}function iE(e,t){var r=[];for(r.push(t.subexpression);r.length>0;){var n=r.pop();if(void 0!==n)switch(n.kind){case pt.App:case pt.Let:case pt.Lambda:if(Br(n.head)&&0!=(Da(n.head.id).staticPrecs&(Ft.Time|Ft.Calc)))return!0;n.args.map((function(e){r.push(e)}));break;case pt.Array:n.nodes.map((function(e){return e.map((function(e){r.push(e)}))}));break;case pt.FieldRef:r.push(n.lhs);break;case pt.Paren:r.push(n.node);break;case pt.Bad:case pt.CellRef:case pt.StructRef:case pt.Literal:case pt.Name:case pt.Operator:break;default:L("calc.runtime.isVolatile",n)}}return!1}(qb=Kb||(Kb={})).ReasonKind=VS,qb.interval=zS,qb.CellKind=KS,qb.Interrupt=YS,qb.finalValue=QS,qb.pendingValue=XS,qb.cellFormula=ZS,qb.userDefinedFunc=ey,qb.stopped=$S,qb.nameCycle=oy,qb.cellCycle=uy,qb.paused=dy,qb.previousFailure=sy,qb.previousNameFailure=cy,qb.evalGlobals=ty,qb.evalLocals=iy,qb.compileLocalsGrid=HS,qb.compileLocalsName=jS,qb.getEvalFailureReason=fy,qb.illFormedFormula=JS,qb.createCompileGlobals=GS,qb.limitExceeded=ly,qb.LimitKind=qS,qb.createCompiler=Yy,qb.createEvaluator=Zb,(Yb=qb.extension||(qb.extension={})).DerefOperKind=vb,Yb.machine=i,qb.getSubExpressionFromFormulaCharacterIndex=$b,qb.getSubExpressionSpan=eE,qb.getFormulaSubExpressionObject=rE,qb.getSubstitutedSubExpressionString=nE,qb.getSubExpressionSubspans=tE,qb.isFormulaSubExpressionVolatile=iE;var oE=function(e,t){return{functionId:e,functionName:t}},uE=function(e,t){return{errorType:e,errorName:t}},sE=function(e,t,r,n,a,i,o,u,s,c,l,d,f,h,v,p,m,g,S,y,b,E,F,C,R,k,N,A,T,I,O,M,w,D,_,L,U,x,B,W,P,V,G,H,j,K,Y,q,z){return{worksheetFunctionNames:e,errorTypeNames:t,specialRefNames:z,trueName:r,falseName:n,rowLetter:a,columnLetter:i,leftBrace:o,rightBrace:u,leftBracket:s,rightBracket:c,decimalSeparator:l,listSeparator:d,columnSeparator:f,rowSeparator:h,thousandsData:v,thousandsSeparator:p,lcid:m,country:g,numberDecimals:S,isExpSepBySpace:y,fractionSeparator:b,isPercentSepBySpace:E,currencyFormat:F,isCurrencySymbolLead:C,isCurrencySepBySpace:R,currencySymbol:k,currencyDecimals:N,dateOrder:A,dateSeparator:T,dateAltSeparator:I,year4Digits:O,month2Digits:M,day2Digits:w,longDateFormat:D,timeSeparator:_,timeAltSeparator:L,hour2Digits:U,clock24Hour:x,isAMPMSepBySpace:B,ampmSymbols:W,dayNameShort:P,dayNameLong:V,monthNameShort:G,monthNameLong:H,pictureSpecial:j,pictureSingle:K,pictureColor:Y,pictureDbnum:q}},cE=function(e,t,r){return{iformat:e,formatString:t,builtIn:r}},lE=function(e,t){return{sheetId:e,sheetName:t}},dE={kind:"Blank"},fE=function(e){return{kind:"Error",type:e}},hE=function(e){return{kind:"Rich",fields:e}};function vE(e){return"object"==typeof e?e.kind:typeof e}function pE(e){return"object"==typeof e?e.kind:typeof e}var mE=function(e,t){return{row:e,column:t}},gE=function(e,t,r,n){return{row:e,column:t,lastRow:r,lastColumn:n}},SE=function(e,t,r,n,a){return{sheetId:e,row:t,column:r,lastRow:n,lastColumn:a}},yE=function(e,t,r){return{sheetId:e,row:t,column:r,lastRow:void 0,lastColumn:void 0}},bE=function(e,t,r,n,a){return{formulaBarText:e,value:t,iformat:r,failureReason:n,kind:a}};function EE(e,t,r,n){return bE(e,t,r,n,"CellFormula")}function FE(e,t,r){return bE(void 0,e,t,r,"ArrayFormula")}function CE(e,t,r,n){return bE(e,t,r,n,"Value")}var RE=function(e,t,r,n,a){return{range:e,data:t,fromStateId:r,excludeRows:n,excludeColumns:a}},kE=function(e,t,r,n){return RE(e,t,void 0,r,n)};function NE(e,t,r,n){return RE(e,void 0,t,r,n)}var AE=function(e,t){return{isSpilled:e,formulaBarText:t}},TE=function(e,t,r){return{range:e,data:t,fromStateId:r}};function IE(e,t){return TE(e,t,void 0)}function OE(e,t){return TE(e,void 0,t)}var ME=function(e,t){return{sheetId:e,usedRange:t}},wE=function(e){return{kind:"NamedValue",value:e}},DE=function(e){return{kind:"NamedFormula",formulaBarText:e}},_E=function(e){return{kind:"NamedRange",range:e}},LE=function(e,t){return{column:e,name:t}},UE=function(e,t,r,n){return{kind:"NamedTable",range:e,hasHeadersRow:t,hasTotalsRow:r,columns:n}},xE=function(e,t){return{kind:"NamedFailure",failureReason:e,objectKind:t}},BE=function(e,t){return{name:e,data:t}},WE=function(e,t,r){return{scope:e,objects:t,fromStateId:r}};function PE(e,t){return WE(e,t,void 0)}function VE(e){return WE(e,void 0,void 0)}function GE(e,t){return WE(e,void 0,t)}var HE=function(e,t,r,n,a,i){return void 0===i&&(i="Inferred"),{range:Array.isArray(e)?e:[e],formulaBarText:t,value:r,origin:n,viewport:a,kind:i}};function jE(e,t,r,n){return HE(e,t,void 0,r,n,"CellFormula")}function KE(e,t,r,n){return HE(e,t,r,void 0,n,"Value")}function YE(e,t,r,n){return HE(e,t,void 0,r,n,"Inferred")}var qE=function(e,t){return{kind:e,format:t}};function zE(e){return qE("SetFormat",e)}var JE=function(e,t,r,n){return{range:e,operation:t,origin:r,viewport:n}},QE=function(e,t,r,n){return{range:e,formulaBarText:t,origin:r,viewport:n}},XE=function(e,t,r){return{isExact:"number"==typeof e,iformat:"number"==typeof e?e:0,format:e,category:t,decimals:r}},ZE=function(e,t,r,n,a){return{formulaBarText:e,value:t,format:r,formatted:n,hasHyperlink:a}},$E=function(e,t){return{range:e,data:t}},eF=function(e,t){return{range:e,data:t}},tF=function(e,t){return{range:e,reason:t}},rF=function(e,t,r,n,a,i){return{stateId:e,priorityGroup:t,isFinished:r,rangeDeltas:n,arrayDeltas:a,rangeFailures:i}},nF=function(e,t){return{kind:e,iformat:t}};function aF(){return nF("Origin")}function iF(e){return nF("Iformat",e)}function oF(){return nF("Inferred")}function uF(e,t){return{value:e,formatted:t}}var sF,cF,lF,dF,fF=function(e,t,r){return{rangeUpdateRanges:e,arrayUpdateRanges:t,namesUpdateScopes:r}},hF=function(e,t){return{name:e,param:t}},vF=function(e,t,r,n,a,i,o,u,s,c,l){return{totalEvalTimeMs:e,samplePrecisionEvalRate:t,samplePrecisionPrintFormulaRate:c,sampleRecalcStatisticsRate:u,sampleWorkbookStatisticsRate:n,sampleRecalcEditedStopwatchRate:a,sampleRecalcViewportStopwatchRate:i,sampleCellEvalStopwatchRate:o,rngSeed:r,volatileMode:l,runExperiments:s}},pF=function(e,t,r){return{date1904:e,dateCompatibility:t,timezone:r}};function mF(e,t){return e.then((function(e){return t(),e}),(function(e){return t(),Promise.reject(e)}))}function gF(){var e;return[new Promise((function(t,r){return e=[t,r]})),e]}function SF(e,t){var r=gF(),n=r[0],a=r[1],i=a[0],o=a[1],u=setTimeout(t,Math.max(0,e));return[n,[function(e){clearTimeout(u),i(e)},function(e){clearTimeout(u),o(e)}]]}function yF(e,t,r){var n=SF(e,(function(){return c(t())})),a=n[0],i=n[1],o=i[0],u=i[1],s=!1;function c(e){u(e),s=!0}var l=Promise.resolve().then((function(e){return r(c,(function(){return s}))}));return mF(Promise.race([a,l]),o)}function bF(e,t){var r;return new Promise((function(n,a){Promise.resolve(t).then((function t(i){if(void 0!==i){r=i;try{Promise.resolve(e(r)).then(t,a)}catch(e){a(e)}}else n(r)}),a)}))}function EF(e,t){return{setMessageListeners:function(t){e.onmessage=function(e){return t.onMessage(e.data)},e.onmessageerror=function(e){return t.onMessageError(e.data)}},postMessage:e.postMessage.bind(e),close:t.bind(e)}}function FF(e){return null!=e&&(e instanceof Error||"string"==typeof e.name&&"string"==typeof e.message&&(void 0===e.stack||"string"==typeof e.stack))}!function(e){e.FunctionCall="FunctionCall",e.MessageChannel="MessageChannel",e.Dedicated="Dedicated"}(sF||(sF={})),function(e){e.PostCallError="PostCallError",e.PostNotifyError="PostNotifyError",e.PostResultError="PostResultError",e.UnhandledNotifyError="UnhandledNotifyError",e.UnhandledError="UnhandledError"}(cF||(cF={})),function(e){e.App="App",e.Result="Result",e.Close="Close"}(lF||(lF={})),function(e){e[e.Fulfilled=0]="Fulfilled",e[e.Rejected=1]="Rejected"}(dF||(dF={}));var CF,RF={Error:Error,EvalError:EvalError,RangeError:RangeError,ReferenceError:ReferenceError,SyntaxError:SyntaxError,TypeError:TypeError,URIError:URIError};function kF(e){return[e.name,e.message,e.stack]}function NF(e){var t,r=e[0],n=e[1],a=e[2],i=RF[r];return null!=i?t=new i(n):(t=new Error(n)).name=r,void 0!==a&&(t.stack=a),t}function AF(e){return FF(e)?[CF.Error,kF(e)]:[CF.Unknown,e]}function TF(e,t,r,n){var a=new Error(e);return a.stack=e+"\n    at "+t+":"+r+":"+n,a}!function(e){e[e.Unknown=0]="Unknown",e[e.Error=1]="Error"}(CF||(CF={}));function IF(e){var t=e.message.indexOf("__START_ERROR__"),r=e.message.indexOf("__END_ERROR__");return t>=0&&r>=0?NF(JSON.parse(e.message.substring(t+"__START_ERROR__".length,r))):null!=e.error?e.error:TF(e.message,e.filename,e.lineno,e.colno)}function OF(e,t,r,n){var a=e[t];null!=a&&(delete e[t],a[r](n))}function MF(e,t,r,n,a,i){var o={port:t,callbacks:{},lastAppId:-1,modules:{}};function u(){if(null==o)throw new Error("endpoint is closed");return o}function s(e,t,r,n,a){var i;try{i=u()}catch(e){return Promise.reject(e)}var o=i.lastAppId+1,s=[lF.App,o,e,t,r,a],c=SF(n,(function(){l(s,new Error("exceeded timeout; callTimeout = "+n+"ms"))})),d=c[0],f=c[1];i.callbacks[o]=f,i.lastAppId=o;try{i.port.postMessage(s)}catch(e){l(s,e)}return d}function c(e,t,r,n){var a=u(),i=[lF.App,-1,e,t,r,n];try{a.port.postMessage(i)}catch(e){l(i,e)}}function l(e,t){var r=e[1],n=e[5];null!=o&&(r>=0&&OF(o.callbacks,r,dF.Rejected,t),n?m(r>=0?cF.PostCallError:cF.PostNotifyError,t,!0):(r<0&&m(cF.PostNotifyError,t,!1),s("","",[],Math.max(g.callTimeout,g.initTimeout),!0).catch((function(e){}))))}function d(e){var t=e[1],r=e[2],n=e[3],a=e[4],i=e[5];if(null!=o)if(""!==r||""!==n){var u=Promise.resolve().then((function(e){if(null!=o){var t=r,i=n,u=o.modules[t],s=null!=u?u[i]:void 0;if(null==s)throw new Error("method "+t+"."+i+" has not been exported");return s.apply(u,a)}}));t>=0?u.then((function(e){return f(t,dF.Fulfilled,e,i)}),(function(e){return f(t,dF.Rejected,e,i)})):u.catch((function(e){m(cF.UnhandledNotifyError,function(e,t,r){var n=t+"."+r+".notify: ";if(FF(e))return e.message=n+e.message,null!=e.stack&&(e.stack=n+e.stack),e;var a=new Error(n+String(e));return a.stack=void 0,a}(e,r,n),!1)}))}else f(t,dF.Fulfilled,void 0,i)}function f(e,t,r,n){if(null!=o){var a=[lF.Result,e,t,AF(r),n];try{o.port.postMessage(a)}catch(e){h(a,e)}}}function h(e,t){var r=e[1],n=e[4];null!=o&&(n?m(cF.PostResultError,t,!0):f(r,dF.Rejected,AF(t),!0))}function v(e){var t=e[1],r=e[2],n=e[3];null!=o&&OF(o.callbacks,t,r,function(e){return e[0]===CF.Unknown?e[1]:NF(e[1])}(n))}function p(e){if(void 0===e&&(e=!0),null!=o){var t=o.port,r=o.callbacks;if(o=void 0,e)try{t.postMessage([lF.Close])}catch(e){}var n=new Error((e?"this":"other")+" endpoint closed while waiting for a response");for(var a in r)OF(r,Number(a),dF.Rejected,n);try{t.close()}catch(e){}if(null!=i)try{i(g)}catch(n){var u=A(n);console.log("calc.worker.createPortEndpoint.close: unhandled error: "+u)}}}function m(e,t,r){if(null!=o){var n=void 0;try{a(g,{kind:e,closing:r,error:t})||(n=[t])}catch(t){n=[t]}if(r&&p(),null!=n){var i=A(n[0]);console.log("calc.worker.createPortEndpoint.dispatchError: unhandled error: "+i)}}}var g={workerKind:e,initTimeout:r,callTimeout:n,setExports:function(e,t){return u().modules[e]=t},getImports:function(e,t){var r={};return t.forEach((function(t){return r[t]=function(e,t){var r={callTimeout:void 0,isCritical:!1,call:function(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];var i=null!=r.callTimeout?r.callTimeout:g.callTimeout;return s(e,t,n,i,r.isCritical)},notify:function(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];c(e,t,n,r.isCritical)}};return r}(e,t)})),r},close:p,dispatchError:m};return o.port.setMessageListeners({onMessage:function(e){switch(e[0]){case lF.App:return d(e);case lF.Result:return v(e);case lF.Close:return p(!1);default:return L("calc.worker.createPortEndpoint.onMessage",e)}},onMessageError:function(e){var t=new Error("failed to send "+e[0]+" message");switch(e[0]){case lF.App:return l(e,t);case lF.Result:return h(e,t);case lF.Close:return;default:return L("calc.worker.createPortEndpoint.onMessageError",e)}}}),g}function wF(e,t,r){var n=this,a=null!=t.initTimeout?t.initTimeout:6e4,i=null!=t.callTimeout?t.callTimeout:3e4;return yF(a,(function(){return new Error("exceeded timeout; initTimeout = "+a+"ms")}),(function(o,u){return ne(n,void 0,void 0,(function(){function n(e){return function(t,r){return c?null!=e.onError&&(e.onError(t,r),!0):(o(r.error),!0)}}function s(e){return function(t){c&&null!=e.onClosed&&e.onClosed(t)}}var c,l,d;return ae(this,(function(o){switch(o.label){case 0:return c=!1,l=MF(e,r.outside,a,i,n(t.outside),s(t.outside)),d=MF(e,r.inside,a,i,n(t.inside),s(t.inside)),u()||null==t.inside.onInit?[3,2]:[4,t.inside.onInit(d)];case 1:o.sent(),o.label=2;case 2:return u()||null==t.outside.onInit?[3,4]:[4,t.outside.onInit(l)];case 3:o.sent(),o.label=4;case 4:return c=!0,[2,l]}}))}))}))}function DF(){return"undefined"!=typeof MessageChannel}var _F=function(){function e(){this.other=void 0}return e.prototype.onMessage=function(e){return U("calc.worker.FunctionCallPort.onMessage: "+("expected onMessage to be set before receiving messages; received "+JSON.stringify(e)))},e.prototype.open=function(e){this.other=e,e.other=this},e.prototype.setMessageListeners=function(e){null!=this.other&&(this.onMessage=e.onMessage)},e.prototype.postMessage=function(e){null!=this.other&&this.other.onMessage(e)},e.prototype.close=function(){if(null!=this.other){var e=this.other;this.other=e.other=void 0,this.onMessage=e.onMessage=function(){}}},e}();var LF,UF;function xF(){if(null==As.getCalcAbsUrl()){return _.ULS.traceTag(595907587,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"calc.worker.isDedicatedWorkerSupported: initCalc was not passed calcAbsUrl"),!1}return"undefined"!=typeof Worker}function BF(e){setTimeout((function(){try{e.terminate()}catch(e){}}),100)}function WF(){var e={};for(var t in w){var r=w[t];null!=r&&(e[r]=Y(r))}return e}var PF=((LF={})[sF.FunctionCall]=function(){return!0},LF[sF.MessageChannel]=DF,LF[sF.Dedicated]=xF,LF);function VF(e){return PF[e]()}var GF=((UF={})[sF.FunctionCall]=function(e){return wF(sF.FunctionCall,e,(t=new _F,r=new _F,t.open(r),{outside:t,inside:r}));var t,r},UF[sF.MessageChannel]=function(e){if(!DF())return U("calc.worker.createMessageChannelWorker: expected an execution context where message channel workers are supported");var t=function(){var e=new MessageChannel;return{outside:EF(e.port1,e.port1.close.bind(e.port1)),inside:EF(e.port2,e.port2.close.bind(e.port1))}}();try{return wF(sF.MessageChannel,e,t)}catch(e){try{t.outside.close()}catch(e){}throw e}},UF[sF.Dedicated]=function(e){var t=this,r=e.outside,n=e.inside,a=e.initTimeout,i=e.callTimeout,o=n.scriptName;if(null==o)return U("calc.worker.createDedicatedWorker: expected workerDef.inside.scriptName to be defined");var u=As.getCalcAbsUrl();if(!xF()||null==u)return U("calc.worker.createDedicatedWorker: expected a context where dedicated workers are supported");var c=null!=a?a:6e4,l=null!=i?i:3e4;return yF(c,(function(){return new Error("exceeded timeout; initTimeout = "+c+"ms")}),(function(e,n){return Ji("calc.worker.createDedicatedWorker (total)",(function(){return ne(t,void 0,void 0,(function(){function t(t){return ne(this,void 0,void 0,(function(){function a(t,n){return o?null!=r.onError&&(r.onError(t,n),!0):(e(n.error),!0)}function i(e){o&&null!=r.onClosed&&r.onClosed(e)}var o,s,d,f,h;return ae(this,(function(e){switch(e.label){case 0:o=!1,e.label=1;case 1:return e.trys.push([1,6,,7]),s=new Worker(t),f=EF(s,(function(){return BF(s)})),d=MF(sF.Dedicated,f,c,l,a,i),s.onerror=function(e){var r;e.preventDefault(),r=null==e.message?new Error("worker.onerror received non-ErrorEvent (worker script fetch probably failed); url = "+t):IF(e),d.dispatchError(cF.UnhandledError,r,!o)},function(e,t){var r={shipAssertTag:function(e,r,n,a){try{t.ULS.shipAssertTag(e,r,n,a)}catch(e){}},assertTag:function(e,r,n,a){try{t.ULS.assertTag(e,r,n,a)}catch(e){}},traceTag:function(e,r,n,a){try{t.ULS.traceTag(e,r,n,a)}catch(e){}},debugTraceTag:function(e,r,n,a){try{t.ULS.debugTraceTag(e,r,n,a)}catch(e){}}};e.setExports("",r)}(d,_),n()?[3,3]:[4,Ji("calc.worker.createDedicatedWorker (inside)",(function(){var e=d.getImports("",["init"]).init;return e.callTimeout=c,e.isCritical=!0,e.call({initTimeout:c,callTimeout:l,calcAbsUrl:u,features:WF()})}))];case 2:e.sent(),e.label=3;case 3:return n()||null==r.onInit?[3,5]:[4,r.onInit(d)];case 4:e.sent(),e.label=5;case 5:return o=!0,[2,d];case 6:throw h=e.sent(),null!=d?d.close():null!=s&&BF(s),h;case 7:return[2]}}))}))}var a,i,d,f;return ae(this,(function(e){switch(e.label){case 0:n=o+(/\.min\.js$/.test(r=u)?".min.js":".js"),c=r.lastIndexOf("/"),a=r.substring(0,c+1)+n,i="calc.worker.createDedicatedWorker: workerUrl = "+a,_.ULS.traceTag(595907588,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,i),e.label=1;case 1:e.trys.push([1,6,,7]),d=new Blob(['importScripts("'+encodeURI(a)+'");'],{type:"application/javascript"}),f=URL.createObjectURL(d),e.label=2;case 2:return e.trys.push([2,,4,5]),[4,t(f)];case 3:return[2,e.sent()];case 4:return URL.revokeObjectURL(f),[7];case 5:return[3,7];case 6:return e.sent(),_.ULS.traceTag(595881991,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Warning,"calc.worker.createDedicatedWorker: failed to start worker from blob url for "+a+". Attempting with string url instead..."),[2,t(a)];case 7:return[2]}var r,n,c}))}))}))}))},UF);function HF(e,t){return GF[e](t)}function jF(e,t){return ne(this,void 0,void 0,(function(){var r,n,a,i,o;return ae(this,(function(u){switch(u.label){case 0:r=0,u.label=1;case 1:if(!(r<e.length))return[3,6];if(!VF(n=e[r]))return[3,5];u.label=2;case 2:return u.trys.push([2,4,,5]),[4,HF(n,t)];case 3:return[2,u.sent()];case 4:return a=u.sent(),i=A(a),o="calc.worker.tryCreateWorker: starting "+n+" worker threw "+i,_.ULS.traceTag(595907598,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Warning,o),[3,5];case 5:return r+=1,[3,1];case 6:return[2,void 0]}}))}))}function KF(e,t){var r=e[0],n=e[1],a=t[0],i=t[1];return[Se(r,a),ye(n,i)]}function YF(e,t){var r=e[0],n=e[1],a=t[0],i=t[1];return[ye(r,a),Se(n,i)]}function qF(e,t){var r=e[0],n=e[1],a=t[0],i=t[1];return ye(r,a)<Se(n,i)}function zF(e,t){var r=e[0],n=e[1],a=t[0],i=t[1];return r<a&&i>=n?[r,a]:r>=a&&i<n?[i,n]:void 0}function JF(e,t){var r=e[0],n=e[1],a=t[0],i=t[1];return r===a&&n===i?0:r>=a&&n<=i?-1:r<=a&&n>=i?1:void 0}var QF,XF=te;function ZF(e){var t,r,n,a=te(te({},e),{split:(t=e.split,r=e.top,void 0===n&&(n=10),function(e){if(void 0!==e.split)return e.split;var a=t(e),i=e===r?0:e.depth;return void 0!==i&&i<n&&(e.split=a,a[0][0].depth=i+1,a[1][0].depth=i+1),a})});return function(e){return $F(a,hC(a,a.top,e))}}function $F(e,t){return t===dC||t===lC?t:{setOperations:e,root:t}}function eC(e,t){return t===dC?e:t===lC||e===dC?t:e===lC?e:$F(e.setOperations,tC(e.setOperations,e.setOperations.top,e.root,t.root))}function tC(e,t,r,n){if(n===dC)return r;if(n===lC)return n;if(r===dC)return n;if(r===lC)return r;if(r.isExact&&n.isExact){var a=function(e,t,r,n){var a=r.key,i=n.key,o=e.compare(a,i);if(void 0!==o)return o<0?n:r;var u=e.union(a,i);if(void 0!==u){var s=e.compare(u,t);return void 0!==s&&0===s?lC:vC(e,t,u,!0)}return}(e,t,r,n);if(void 0!==a)return a}var i=pC(e,t,r),o=pC(e,t,n),u=e.split(t),s=u[0][0],c=u[1][0];return cC(e,s,c,tC(e,s,i.left,o.left),tC(e,c,i.right,o.right))}function rC(e,t){return e===dC?e:t===dC||e===lC?t:t===lC?e:$F(e.setOperations,nC(e.setOperations,e.setOperations.top,e.root,t.root))}function nC(e,t,r,n){if(r===dC)return r;if(n===dC)return n;if(r===lC)return n;if(n===lC)return r;if(r.isExact&&n.isExact){var a=function(e,t,r,n){var a=r.key,i=n.key;if(!e.meets(a,i))return dC;var o=e.compare(a,i);if(void 0!==o)return o<0?r:n;var u=e.intersect(a,i);if(void 0!==u)return vC(e,t,u,!0);return}(e,t,r,n);if(void 0!==a)return a}var i=pC(e,t,r),o=pC(e,t,n),u=e.split(t),s=u[0][0],c=u[1][0];return cC(e,s,c,nC(e,s,i.left,o.left),nC(e,c,i.right,o.right))}function aC(e,t,r,n){if(r===dC||n===dC)return!1;if(r===lC||n===lC)return!0;if(r.isExact&&n.isExact)return e.meets(r.key,n.key);var a=pC(e,t,r),i=pC(e,t,n),o=e.split(t),u=o[0][0],s=o[1][0];return aC(e,u,a.left,i.left)||aC(e,s,a.right,i.right)}function iC(e,t){return e===dC||t===dC?e:t===lC?dC:e===lC?$F(t.setOperations,oC(t.setOperations,t.setOperations.top,e,t.root)):$F(e.setOperations,oC(e.setOperations,e.setOperations.top,e.root,t.root))}function oC(e,t,r,n){if(r===dC)return r;if(n===dC)return r;if(n===lC)return dC;if(r===lC){var a=pC(e,t,n),i=e.split(t),o=i[0][0],u=i[1][0];return cC(e,o,u,oC(e,o,lC,a.left),oC(e,u,lC,a.right))}if(r.isExact&&n.isExact){var s=function(e,t,r,n){var a=r.key,i=n.key;if(!e.meets(a,i))return r;var o=e.except(a,i);if(void 0!==o)return vC(e,t,o,!0);return}(e,t,r,n);if(void 0!==s)return s}var c=pC(e,t,r),l=pC(e,t,n),d=e.split(t),f=d[0][0],h=d[1][0];return cC(e,f,h,oC(e,f,c.left,l.left),oC(e,h,c.right,l.right))}function uC(e,t){if(void 0!==e&&void 0!==t)return 0===e?t:0===t||e===t?e:void 0}function sC(e,t,r,n){if(r===n)return 0;if(r===dC)return-1;if(n===dC)return 1;if(r===lC)return n===lC?0:1;if(n===lC)return-1;if(r.isExact&&n.isExact)return function(e,t,r){return e.compare(t.key,r.key)}(e,r,n);var a=pC(e,t,r),i=pC(e,t,n),o=e.split(t),u=o[0][0],s=o[1][0],c=sC(e,u,a.left,i.left);if(void 0!==c){var l=sC(e,s,a.right,i.right);if(void 0!==l)return uC(c,l)}}function cC(e,t,r,n,a){return n===dC?a===dC?dC:a===lC?fC(n,a,void 0,!1,e.infimum(r,r),e.supremum(r,r)):fC(n,a,void 0,!1,a.infimum,a.supremum):a===dC?n===lC?fC(n,a,void 0,!1,e.infimum(t,t),e.supremum(t,t)):fC(n,a,void 0,!1,n.infimum,n.supremum):n===lC?a===lC?lC:fC(n,a,void 0,!1,e.combineInfima(e.infimum(t,t),a.infimum),e.combineSuprema(e.supremum(t,t),a.supremum)):a===lC?fC(n,a,void 0,!1,e.combineInfima(n.infimum,e.infimum(r,r)),e.combineSuprema(n.supremum,e.supremum(r,r))):fC(n,a,void 0,!1,e.combineInfima(n.infimum,a.infimum),e.combineSuprema(n.supremum,a.supremum))}!function(e){e[e.Dense=0]="Dense",e[e.Empty=1]="Empty"}(QF||(QF={}));var lC=QF.Dense,dC=QF.Empty;function fC(e,t,r,n,a,i){return{key:r,left:e,right:t,isExact:n,infimum:a,supremum:i}}function hC(e,t,r){if(!e.meets(t,r))return dC;var n=e.compare(t,r);if(void 0!==n)return n<=0?lC:vC(e,t,r,!0);var a=e.intersect(t,r);return void 0!==a?vC(e,t,a,!0):vC(e,t,r,!1)}function vC(e,t,r,n){return fC(void 0,void 0,r,!!n,e.infimum(r,t),e.supremum(r,t))}function pC(e,t,r){if(void 0!==r.left)return r;var n=e.split(t),a=n[0][0],i=n[1][0],o=cC(e,a,i,hC(e,a,r.key),hC(e,i,r.key));if(o===dC||o===lC)throw new Error("incorrect set operations implementation");var u=o;return XF(r,{left:u.left,right:u.right})}function mC(e){return e===dC||e===lC?0:function e(t){if(void 0===t||t===dC||t===lC)return 0;return e(t.left)+e(t.right)+1}(e.root)}function gC(e,t){return e===dC||function(e,t,r){return function t(n,a){if(a===dC)return!0;if(a===lC)return r(n);if(a.isExact)return r(a.key);var i=pC(e,n,a),o=e.split(n),u=o[0][0],s=o[1][0];return t(u,i.left)&&t(s,i.right)}(e.top,t)}(e.setOperations,e.root,t)}function SC(e,t,r){var n=function(e,t,r){var n=Math.pow(t,e),a=1-Math.pow(t/r,e),i=Math.pow(r,e),o=i*n,u=i-n,s=-1/e;return{cdf:1===e?function(e){return(1-n/e)/a}:function(t){return(1-n*Math.pow(t,-e))/a},invCdf:1===e?function(e){return 1/((i-e*u)/o)}:function(e){return Math.pow((i-e*u)/o,s)}}}(e,t,r);return{canSplit:function(e){var t=e[0];return e[1]-t>1},split:function(e){var t=e[0],r=e[1],a=n.cdf(r),i=n.cdf(t+1),o=n.invCdf((a+i)/2),u=Se(ye(Math.round(o),t+1),r-1);return[[[t,u],n.cdf(u)-n.cdf(t+1)],[[u,r],n.cdf(r)-n.cdf(u)]]}}}function yC(e,t,r,n,a){var i=SC(e,t,r);return{id:a,split:function(e){return i.split(e)},canSplit:function(e){return i.canSplit(e)},meets:qF,intersect:YF,union:function(e,t){return n=t,a=(r=e)[0],i=r[1],o=n[0],u=n[1],ye(a,o)<=Se(i,u)?KF(e,t):void 0;var r,n,a,i,o,u},except:zF,compare:JF,top:n,infimum:function(e){return e[0]},supremum:function(e){return e[1]},combineInfima:function(e,t){return Se(e,t)},combineSuprema:function(e,t){return ye(e,t)}}}var bC=function(e,t){var r,n,a=e[0],i=t[0];return r=String(a),n=String(i),r<n?-1:r>n?1:0},EC={};var FC=function(e){for(var t=[],r=0,n=Object.keys(e);r<n.length;r++){var a=n[r];t.push([a,e[a].id])}var i=function(e){for(var t="",r=0,n=e;r<n.length;r++){var a=n[r];t+=String(a[0]),t+="\0",t+=String(a[1]),t+="\0"}return t}(t.sort(bC)),o=EC[i];return void 0===o&&(o={box:{},probabilities:{},depth:1},EC[i]=o),o};function CC(e){for(var t=!0,r=0,n=Object.keys(e);r<n.length;r++){var a=n[r];if(Object.prototype.hasOwnProperty.call(e,a)){t=!1;break}}return t?lC:{isSubspace:!0,bounds:e}}function RC(e){return e.isSubspace?1:e.subspaceCount}var kC=function(e,t,r){return{isSubspace:!1,left:e,right:t,bounds:r,subspaceCount:RC(e)+RC(t)}};function NC(e,t){if(t===lC)return t;if(t.isSubspace){for(var r=!1,n=0,a=Object.keys(t.bounds);n<a.length;n++){var i=a[n];if(Object.prototype.hasOwnProperty.call(e,i)){r=!0;break}}if(!r)return lC}return{productOperations:e,root:t}}function AC(e){return void 0===e?lC:e}var TC={unzip:function(e){for(var t={},r={},n=0,a=Object.keys(e);n<a.length;n++){var i=a[n];if(Object.prototype.hasOwnProperty.call(e,i)){var o=e[i];if(o===dC)return dC;if(o===lC)continue;t[i]=o.setOperations,r[i]=o.root}}return NC(t,CC(r))},combineProduct:function(e,t,r,n){for(var a={},i=0,o=Object.keys(e);i<o.length;i++){var u=o[i];if(Object.prototype.hasOwnProperty.call(e,u)){var s=n(e[u],e[u].top,AC(t[u]),AC(r[u]));if(s===dC)return s;if(s===lC)continue;a[u]=s}}return a},restrict:function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var n={},a=0,i=t;a<i.length;a++){var o=i[a];if(Object.prototype.hasOwnProperty.call(e,o)){var u=e[o];n[o]=u}}return n},fromUntypedProduct:function(e,t,r){for(var n={},a=0,i=r;a<i.length;a++){var o=i[a],u=t[o];n[o]=$F(e[o],void 0!==u?u:lC)}return n},denseProduct:function(e){for(var t={},r=0,n=e;r<n.length;r++){t[n[r]]=lC}return t}},IC=TC.unzip.bind(TC);function OC(e,t,r){var n=TC.combineProduct(e,t,r,tC);if(n===dC)throw new Error("broken invariant: the union of two non-empty products cannot be empty");return n}function MC(e,t,r){for(var n=0,a=0,i=Object.keys(e);a<i.length;a++){var o=i[a];if(Object.prototype.hasOwnProperty.call(e,o)){var u=AC(t[o]),s=AC(r[o]),c=e[o];if(void 0===(n=uC(n,sC(c,c.top,u,s))))return}}return n}var wC,DC=(wC={},function(e,t,r){var n;if(t===wC.left&&r===wC.right)return wC.res;wC.left=t,wC.right=r;var a,i=MC(e,t.bounds,r.bounds);if(void 0!==i)return wC.res=i<=0?r:t;for(var o=0,u=Object.keys(e);o<u.length;o++){var s=u[o];if(Object.prototype.hasOwnProperty.call(e,s)&&0!==sC(e[s],e[s].top,AC(t.bounds[s]),AC(r.bounds[s]))){if(void 0!==a)return wC.res=void 0;a=s}}if(void 0!==a){var c=tC(e[a],e[a].top,AC(t.bounds[a]),AC(r.bounds[a]));if(c===dC)return wC.res=dC;if(c===lC){var l=t.bounds,d=a,f=(l[d],re(l,["symbol"==typeof d?d:d+""]));return wC.res=CC(f)}var h=te(te({},t.bounds),((n={})[a]=c,n));return wC.res=CC(h)}return wC.res=void 0});function _C(e,t,r){if(r===dC)return t;if(r===lC)return r;if(t===dC)return r;if(t===lC)return t;if(!t.isSubspace||!r.isSubspace)return kC(t,r,OC(e,t.bounds,r.bounds));var n=DC(e,t,r);return void 0!==n?n:kC(t,r,OC(e,t.bounds,r.bounds))}function LC(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var a=TC.restrict.apply(TC,ie([t.bounds],r));if(t.isSubspace)return CC(a);var i=LC.apply(void 0,ie([e,t.left],r));if(i===lC)return lC;var o=LC.apply(void 0,ie([e,t.right],r));return _C(e,i,o)}function UC(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(e===lC||e===dC)return e;var n=TC.restrict.apply(TC,ie([e.productOperations],t)),a=LC.apply(void 0,ie([n,e.root],t));return a===dC?a:NC(n,a)}function xC(e,t){var r,n,a,i;if(void 0!==t.children)return t.children;for(var o,u,s=t.box,c=t.probabilities,l=0,d=0,f=Object.keys(e);d<f.length;d++){var h=f[d];if(Object.prototype.hasOwnProperty.call(e,h)){var v=c[h],p=e[h];if(void 0===v){o=h,u=p.top;break}if(v>l){var m=AC(s[h]);if(m===dC)throw new Error("the key split can never return empty");var g=p.top;if(m!==lC){if(!m.isExact)throw new Error("the key can always be represented exactly");g=m.key}if(!p.canSplit(g))continue;o=h,l=v,u=g}}}if(void 0===o||void 0===u)throw new Error("there has to be at least one dimension");var S=e[o],y=S.split(u),b=y[0],E=b[0],F=b[1],C=y[1],R=C[0],k=C[1],N=[{box:te(te({},s),(r={},r[o]=hC(S,S.top,E),r)),probabilities:te(te({},c),(n={},n[o]=F,n)),depth:t.depth+1},{box:te(te({},s),(a={},a[o]=hC(S,S.top,R),a)),probabilities:te(te({},c),(i={},i[o]=k,i)),depth:t.depth+1}];return t.depth<10&&(t.children=N),N}var BC=function(e,t,r,n){return function e(t,r,n,a){if(r===dC)return[dC,dC];if(r===lC)return[CC(n),CC(a)];var i=MC(t,r.bounds,n);if(void 0!==i&&i<=0)return[r,dC];var o=TC.combineProduct(t,r.bounds,n,nC);if(o===dC)return[dC,r];var u=TC.combineProduct(t,r.bounds,a,nC);if(r.isSubspace)return[CC(o),u===dC?dC:CC(u)];var s=e(t,r.left,n,a),c=s[0],l=s[1],d=e(t,r.right,n,a),f=d[0],h=d[1];return[_C(t,c,f),_C(t,l,h)]}(e,t,r.box,n.box)};function WC(e,t,r,n,a){var i=xC(e,n),o=i[0],u=i[1],s=BC(e,t,o,u),c=s[0],l=s[1],d=BC(e,r,o,u),f=d[0],h=d[1],v=a(e,c,f,o);return v===lC?lC:_C(e,v,a(e,l,h,u))}function PC(e,t,r,n){if(r===dC)return t;if(t===dC)return r;if(t===lC)return t;if(r===lC)return r;if(t.isSubspace&&r.isSubspace){var a=DC(e,t,r);if(void 0!==a)return a}return WC(e,t,r,n,PC)}function VC(e,t){if(t===dC)return e;if(t===lC)return t;if(e===dC)return t;if(e===lC)return e;var r=te(te({},e.productOperations),t.productOperations),n=PC(r,e.root,t.root,FC(r));return n===dC?n:NC(r,n)}function GC(e,t,r,n){if(t===dC||r===dC)return dC;if(t===lC)return r;if(r===lC)return t;if(t.isSubspace&&r.isSubspace){var a=TC.combineProduct(e,t.bounds,r.bounds,nC);return a===dC?dC:CC(a)}return WC(e,t,r,n,GC)}function HC(e,t){if(e===dC)return e;if(t===dC)return t;if(e===lC)return t;if(t===lC)return e;var r=te(te({},e.productOperations),t.productOperations),n=GC(r,e.root,t.root,FC(r));return n===dC?n:NC(r,n)}function jC(e,t,r,n){if(t===dC)return t;if(r===lC)return dC;if(r===dC)return t;if(t===lC)return WC(e,t,r,n,jC);if(t.isSubspace&&r.isSubspace){var a=function(e,t,r){var n,a,i=MC(e,t.bounds,r.bounds);if(0===i||-1===i)return dC;for(var o=0,u=Object.keys(e);o<u.length;o++){var s=u[o];if(Object.prototype.hasOwnProperty.call(e,s)){var c=sC(e[s],e[s].top,AC(t.bounds[s]),AC(r.bounds[s]));if(void 0===c||c>0){if(void 0!==a)return;a=s}}}if(void 0!==a){var l=oC(e[a],e[a].top,AC(t.bounds[a]),AC(r.bounds[a]));if(l===dC)return dC;if(l===lC){var d=t.bounds,f=a;d[f];return CC(re(d,["symbol"==typeof f?f:f+""]))}return CC(te(te({},t.bounds),((n={})[a]=l,n)))}}(e,t,r);if(void 0!==a)return a}return WC(e,t,r,n,jC)}function KC(e,t){if(e===dC)return e;if(t===dC)return e;if(t===lC)return dC;if(e===lC){var r=jC(t.productOperations,lC,t.root,FC(t.productOperations));return r===dC?r:NC(t.productOperations,r)}var n=te(te({},e.productOperations),t.productOperations),a=jC(n,e.root,t.root,FC(n));return a===dC?a:NC(n,a)}function YC(e,t){if(e===t)return 0;if(e===dC)return-1;if(t===dC)return 1;if(e===lC)return t===lC?0:1;if(t===lC)return-1;var r=te(te({},e.productOperations),t.productOperations);return function e(t,r,n,a){if(r===n)return 0;if(r===dC)return-1;if(n===dC)return 1;if(r===lC)return n===lC?0:1;if(n===lC)return-1;if(r.isSubspace&&n.isSubspace)return MC(t,r.bounds,n.bounds);var i=xC(t,a),o=i[0],u=i[1],s=BC(t,r,o,u),c=s[0],l=s[1],d=BC(t,n,o,u),f=d[0],h=d[1],v=e(t,c,f,o);return void 0!==v?uC(v,e(t,l,h,u)):void 0}(r,e.root,t.root,FC(r))}function qC(e,t,r,n){if(t===dC||r===dC)return!1;if(t===lC||r===lC)return!0;if(!function(e,t,r){for(var n=0,a=Object.keys(e);n<a.length;n++){var i=a[n];if(Object.prototype.hasOwnProperty.call(e,i)){var o=AC(t[i]),u=AC(r[i]),s=e[i];if(!aC(s,s.top,o,u))return!1}}return!0}(e,t.bounds,r.bounds))return!1;if(t.isSubspace&&r.isSubspace)return!0;var a=xC(e,n),i=a[0],o=a[1],u=BC(e,t,i,o),s=u[0],c=u[1],l=BC(e,r,i,o),d=l[0],f=l[1];return qC(e,s,d,i)||qC(e,c,f,o)}function zC(e,t){if(e===dC||t===dC)return!1;if(e===lC||t===lC)return!0;var r=te(te({},e.productOperations),t.productOperations);return qC(r,e.root,t.root,FC(r))}function JC(e){return e===dC||e===lC?0:RC(e.root)}var QC=function(){function e(e){void 0===e&&(e=[]),this.buffer=e,this.cursor=0}return e.prototype.putBack=function(e){this.cursor-=1,this.buffer[this.cursor]=e},e.prototype.pick=function(){return this.buffer[this.cursor]},Object.defineProperty(e.prototype,"length",{get:function(){return this.buffer.length-this.cursor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return 0===this.length},enumerable:!0,configurable:!0}),e.prototype.pop=function(){var e=this.pick();return this.cursor+=1,e},e}(),XC=function(){var e=this;this.size=0,this.clear=function(){},this.get=function(){},this.set=function(){return e}};function ZC(e,t){return function(r,n){for(var a=[],i=2;i<arguments.length;i++)a[i-2]=arguments[i];var o=t.get(r);void 0===o?(e.apply(void 0,ie([r,n],a)),t.set(r,t.size)):n.push("__cached__",o)}}function $C(e,t){return function(r){for(var n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];if("__cached__"===r.pick()){r.pop();var i=r.pop();return t[i]}var o=e.apply(void 0,ie([r],n));return t.push(o),o}}var eR;!function(){function e(t){var r,n,a,i,o=this;for(var u in this.globalProductOperations=t,this.cached="undefined"!=typeof Map?new Map:new XC,this.cache=[],this.serializers={},this.serializeProductSet=function(e,t){if(e!==dC&&e!==lC){var r=e,n=o.getDims(r.productOperations);t.push(n),o.serializeUntypedSparseProductCached(r.root,t,n)}else t.push(e)},this.deserializeProductSet=function(e){var t=e.pop();if(t===dC||t===lC)return t;e.putBack(t);for(var r={},n=e.pop(),a=0,i=n;a<i.length;a++){var u=i[a],s=o.globalProductOperations[u];r[u]=s}return{productOperations:r,root:o.deserializeUntypedSparseProductCached(e,n)}},this.serializeUntypedSparse=function(t,r,n){r.push(null==t?void 0:t.isExact),r.push(o.serializers[n].serializeBound(null==t?void 0:t.infimum)),r.push(o.serializers[n].serializeBound(null==t?void 0:t.supremum));var a=e.normalizeKey(null==t?void 0:t.key);r.push(o.serializers[n].serializeKey(a));for(var i=0,u=[null==t?void 0:t.left,null==t?void 0:t.right];i<u.length;i++){var s=u[i];null==s||s===dC||s===lC?r.push(s):(r.push("us"),o.serializeUntypedSparseCached(s,r,n))}},this.deserializeUntypedSparse=function(e,t){var r=e.pop(),n=o.serializers[t].deserializeBound(e.pop()),a=o.serializers[t].deserializeBound(e.pop()),i=o.serializers[t].deserializeKey(e.pop()),u=["left","right"].map((function(r){var n=e.pop();return"us"===n?o.deserializeUntypedSparseCached(e,t):n}));return{infimum:n,supremum:a,isExact:r,key:i,left:u[0],right:u[1]}},this.serializeUntypedSparseProduct=function(e,t,r){t.push(e.isSubspace);for(var n=0,a=r;n<a.length;n++){var i=a[n],u=e.bounds[i];o.serializeUntypedSparseCached(u,t,i)}e.isSubspace||(o.serializeUntypedSparseProductCached(e.left,t,r),o.serializeUntypedSparseProductCached(e.right,t,r),t.push(e.subspaceCount))},this.deserializeUntypedSparseProduct=function(e,t){for(var r=e.pop(),n={},a=0,i=t;a<i.length;a++){var u=i[a],s=o.deserializeUntypedSparseCached(e,u);n[u]=s}return r?{isSubspace:r,bounds:n}:{isSubspace:r,bounds:n,left:o.deserializeUntypedSparseProductCached(e,t),right:o.deserializeUntypedSparseProductCached(e,t),subspaceCount:e.pop()}},this.serializeUntypedSparseCached=ZC(this.serializeUntypedSparse,this.cached),this.deserializeUntypedSparseCached=$C(this.deserializeUntypedSparse,this.cache),this.serializeProductSetCached=ZC(this.serializeProductSet,this.cached),this.deserializeProductSetCached=$C(this.deserializeProductSet,this.cache),this.serializeUntypedSparseProductCached=ZC(this.serializeUntypedSparseProduct,this.cached),this.deserializeUntypedSparseProductCached=$C(this.deserializeUntypedSparseProduct,this.cache),t){var s={serializeKey:null!==(r=t[u].serializeKey)&&void 0!==r?r:function(e){return JSON.stringify(e)},deserializeKey:null!==(n=t[u].deserializeKey)&&void 0!==n?n:function(e){return JSON.parse(e)},serializeBound:null!==(a=t[u].serializeBound)&&void 0!==a?a:function(e){return JSON.stringify(e)},deserializeBound:null!==(i=t[u].deserializeBound)&&void 0!==i?i:function(e){return JSON.parse(e)}};this.serializers[u]=s}}e.prototype.getDims=function(e){return Object.keys(e)},e.prototype.serialize=function(e){this.cached.clear();var t=[];t.push(e.length);for(var r=0,n=e;r<n.length;r++){var a=n[r];this.serializeProductSetCached(a,t)}return JSON.stringify(t)},e.prototype.deserialize=function(e){this.cache.length=0;for(var t=new QC(JSON.parse(e)),r=t.pop(),n=[],a=0;a<r;a+=1){var i=this.deserializeProductSetCached(t);n.push(i)}return n},e.normalizeKey=function(e){if("object"==typeof e){var t=te({},e);return delete t.depth,delete t.split,t}return e}}();!function(e){e[e.AvailableSet=0]="AvailableSet",e[e.AvailableRead=1]="AvailableRead"}(eR||(eR={}));var tR=[eR.AvailableSet,eR.AvailableRead+1],rR=[0,1<<20],nR=[0,16384],aR={availability:yC(1,tR[0]+1,tR[1],tR,"Availability operations, alpha = 1"),row:yC(.2,rR[0]+1,rR[1],rR,"Row operations, alpha = 0.2"),col:yC(.35,nR[0]+1,nR[1],nR,"Col operations, alpha = 0.35")},iR={availability:ZF(aR.availability),row:ZF(aR.row),col:ZF(aR.col)};function oR(e){return IC({row:iR.row([e.row,e.row+e.rows]),col:iR.col([e.col,e.col+e.cols])})}function uR(e){if(e!==dC){var t,r,n=e===lC?void 0:e.root.bounds.row,a=e===lC?void 0:e.root.bounds.col,i=void 0===n?aR.row.top:(t=$F(aR.row,n),r=[],hR(t,(function(e){return r.push(e),!0})),r.reduce(KF)),o=i[0],u=i[1],s=void 0===a?aR.col.top:function(e){var t=[];return vR(e,(function(e){return t.push(e),!0})),t.reduce(KF)}($F(aR.col,a)),c=s[0];return wn(o,c,u-o,s[1]-c)}}var sR,cR,lR=IC({availability:iR.availability([eR.AvailableSet,eR.AvailableSet+1])}),dR=IC({availability:iR.availability([eR.AvailableRead,eR.AvailableRead+1])}),fR=IC({availability:iR.availability([eR.AvailableSet,eR.AvailableRead+1])});function hR(e,t){return e!==lC?gC(e,t):t(aR.row.top)}function vR(e,t){return e!==lC?gC(e,t):t(aR.col.top)}function pR(e,t){return function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var a=UC.apply(void 0,ie([e],r));if(a===dC)return!0;if(a===lC)return t(TC.denseProduct(r));var i=a.productOperations,o=a.root;function u(e){return e.isSubspace?t(TC.fromUntypedProduct(i,e.bounds,r)):u(e.left)&&u(e.right)}return u(o)}(e,(function(e){return hR(e.row,(function(r){var n=r[0],a=r[1];return vR(e.col,(function(e){var r=e[0],i=e[1];return t(wn(n,r,a-n,i-r))}))}))}),"row","col")}function mR(e,t){return pR(e,(function(e){return Sr(e,t)}))}function gR(e,t){return{sheet:e,set:t}}!function(e){e.PrecisionTest="PrecisionTest",e.EditedCell="EditedCell",e.DependentCell="DependentCell",e.EvalFormula="EvalFormula",e.ParseEdit="ParseEdit"}(sR||(sR={})),function(e){e.EditedCell="EditedCell",e.DependentCell="DependentCell",e.IndependentCell="IndependentCell",e.UnknownNonEditedCell="UnknownNonEditedCell"}(cR||(cR={}));var SR,yR,bR,ER,FR,CR={calculatedCellCount:{},changedCellCount:{},continueCount:0,editFinishedCount:0,stateTimedOut:!1,recalcFinishedCount:0};function RR(e,t){var r;return te(te({},e),((r={})[t]=(e[t]||0)+1,r))}function kR(e,t){switch(t.message){case SR.ChangedCell:return te(te({},e),{changedCellCount:RR(e.changedCellCount,t.cellKind),calculatedCellCount:RR(e.calculatedCellCount,t.cellKind)});case SR.UnchangedCell:return te(te({},e),{calculatedCellCount:RR(e.calculatedCellCount,t.cellKind)});case SR.ContinueComputation:return te(te({},e),{continueCount:e.continueCount+1});case SR.StateTimedOut:return te(te({},e),{stateTimedOut:!0});case SR.EditFinished:return te(te({},e),{editFinishedCount:e.editFinishedCount+1});case SR.RecalcFinished:return te(te({},e),{recalcFinishedCount:e.recalcFinishedCount+1});default:return L("calc.calc.partialWorkbookMessages.mergeRecalcStatistics",t)}}function NR(e,t){e[t]=(e[t]||0)+1}function AR(e,t,r){return e.push(t.join(".")+": expected "+r),!1}function TR(e,t){return function(r,n,a){return pe(r)&&e(r)||AR(n,a,t)}}function IR(e,t,r,n){for(var a=[],i=t(e,a,[n]),o=0,u=a;o<u.length;o++){NR(r,u[o])}return i}function OR(e,t,r,n){if(!IR(e,JR,r,n))return[];var a=n+".<index>";return e.filter((function(e){return IR(e,t,r,a)}))}function MR(e){return function(t,r,n){return!!me(t)||e(t,r,n)}}function wR(e){return function(t,r,n){if(me(t))return AR(r,n,"non-null object");var a=n.length;try{var i=!0;for(var o in e)n[a]=o,i=i&&e[o](t[o],r,n);return i}finally{n.length=a}}}function DR(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t,r,n){return e.reduce((function(e,a){return e&&a(t,r,n)}),!0)}}function _R(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return function(r,n,a){return t.reduce((function(e,t){return e&&t(r)(r,n,a)}),e(r,n,a))}}function LR(e){return function(t,r,n){if(!Array.isArray(t))return AR(r,n,"Array");n.push("<index>");try{return t.reduce((function(t,a){return t&&e(a,r,n)}),!0)}finally{n.pop()}}}function UR(e){var t="one of "+JSON.stringify(Object.getOwnPropertyNames(e).sort());return function(r,n,a){if(me(r))return AR(n,a,"non-null object");var i=a.length;try{var o="string"==typeof r.kind||"number"==typeof r.kind?e[r.kind]:void 0;return me(o)?(a.push("kind"),AR(n,a,t)):o(r,n,a)}finally{a.length=i}}}function xR(e){var t="typeof one of "+JSON.stringify(Object.getOwnPropertyNames(e).sort());return function(r,n,a){var i=e[typeof r];return me(i)?AR(n,a,t):i(r,n,a)}}function BR(e){return"number"==typeof e&&e>-1/0&&e<1/0}function WR(e){return(0|e)===e||Math.floor(e)===e}function PR(e,t,r){return void 0===r&&(r=0!==e?"integer >= "+e+" and < "+t:"natural < "+t),TR((function(r){return"number"==typeof r&&r>=e&&r<t&&WR(r)}),r)}!function(e){e.ChangedCell="ChangedCell",e.UnchangedCell="UnchangedCell",e.ContinueComputation="ContinueComputation",e.EditFinished="EditFinished",e.StateTimedOut="StateTimedOut",e.RecalcFinished="RecalcFinished"}(SR||(SR={})),function(e){e.SetSheetNames="SetSheetNames",e.SetRefStyle="SetRefStyle",e.SetLocaleInfo="SetLocaleInfo",e.SetNumberFormats="SetNumberFormats",e.WriteNamedObject="WriteNamedObject",e.WriteUndefinedNames="WriteUndefinedNames",e.PromoteNamedObjects="PromoteNamedObjects",e.ExtendUnusedRange="ExtendUnusedRange",e.WriteHiddenRows="WriteHiddenRows",e.WriteInFilterMode="WriteInFilterMode",e.SetCellContents="SetCellContents",e.SetRangeFormula="SetRangeFormula",e.PromoteCellContents="PromoteCellContents"}(yR||(yR={})),function(e){e.Unavailable="Unavailable",e.Weak="Weak",e.ClientValueUnknown="ClientValueUnknown",e.Origin="Origin",e.Inferred="Inferred"}(bR||(bR={})),function(e){e.StateAdvanced="StateAdvanced",e.CellWrite="CellWrite",e.RangeWrite="RangeWrite",e.NameFailure="NameFailure",e.RangeFailure="RangeFailure",e.NumberFormatFailure="NumberFormatFailure",e.PrintFormulaFailure="PrintFormulaFailure",e.InferFormatFailure="InferFormatFailure",e.FormatValueFailure="FormatValueFailure",e.UnhandledFailure="UnhandledFailure",e.UpdateRequest="UpdateRequest",e.UpdateNamesRequest="UpdateNamesRequest",e.GarbageCollected="GarbageCollected",e.RecalcStatistics="RecalcStatistics",e.WorkbookStatistics="WorkbookStatistics",e.ExperimentRunResult="ExperimentRunResult"}(ER||(ER={}));var VR=TR((function(e){return!1}),"never"),GR=TR((function(e){return"number"==typeof e&&!isNaN(e)}),"number (non-NaN)"),HR=TR(BR,"finite number"),jR=TR((function(e){return BR(e)&&WR(e)}),"integer"),KR=PR(0,1/0,"natural"),YR=TR((function(e){return"string"==typeof e}),"string"),qR=TR((function(e){return"string"==typeof e&&e.length>0}),"nonempty string"),zR=TR((function(e){return"boolean"==typeof e}),"boolean"),JR=TR((function(e){return Array.isArray(e)}),"Array");function QR(e){return TR((function(t){return t===e}),JSON.stringify(e))}function XR(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r={},n=0,a=e;n<a.length;n++){var i=a[n];r[i]=!0}var o="one of "+JSON.stringify(e.sort());return TR((function(e){return"string"==typeof e&&!0===r[e]}),o)}function ZR(e){return"="===e[0]||"+"===e[0]||"-"===e[0]}var $R=TR((function(e){return"string"==typeof e&&ZR(e)}),"formula text"),ek=wR({functionId:KR,functionName:qR}),tk=wR({errorType:KR,errorName:TR((function(e){return"string"==typeof e&&e.length>1&&F(e,"#")}),"error name")}),rk=wR({iformat:KR,formatString:YR,builtIn:zR}),nk=TR((function(e){return"string"==typeof e||BR(e)}),"string or finite number"),ak=wR({sheetId:nk,sheetName:YR}),ik=PR(0,1<<20),ok=PR(0,16384),uk=wR({row:ik,column:ok}),sk=DR(uk,wR({lastRow:MR(ik),lastColumn:MR(ok)})),ck=DR(sk,wR({sheetId:nk})),lk=DR(ck,wR({lastRow:MR(VR),lastColumn:MR(VR)})),dk=wR({kind:QR("Blank")}),fk=wR({kind:QR("Error"),type:KR}),hk=xR({number:HR,string:YR,boolean:zR,object:UR({Blank:dk,Error:fk})}),vk=xR({number:KR,string:YR}),pk=DR(wR({value:hk,iformat:KR,failureReason:MR(YR)}),UR({CellFormula:wR({formulaBarText:$R}),ArrayFormula:wR({formulaBarText:MR(VR)}),Value:wR({formulaBarText:YR})})),mk=wR({range:ck,excludeRows:MR(LR(ik)),excludeColumns:MR(LR(ok)),data:MR(pk),fromStateId:MR(jR)}),gk=wR({isSpilled:zR,formulaBarText:$R}),Sk=wR({range:ck,data:MR(gk),fromStateId:MR(jR)}),yk=wR({sheetId:nk,usedRange:MR(sk)}),bk=xR({number:HR,string:YR,boolean:zR,object:UR({Error:fk})}),Ek=wR({kind:QR("NamedValue"),value:bk}),Fk=wR({kind:QR("NamedFormula"),formulaBarText:$R}),Ck=wR({kind:QR("NamedRange"),range:ck}),Rk=wR({column:KR,name:qR}),kk=wR({kind:QR("NamedTable"),range:ck,hasHeadersRow:zR,hasTotalsRow:zR,columns:LR(Rk)}),Nk=wR({kind:QR("NamedFailure"),failureReason:YR,objectKind:MR(XR("NamedValue","NamedFormula","NamedRange","NamedTable"))}),Ak=wR({name:YR,data:MR(UR({NamedValue:Ek,NamedFormula:Fk,NamedRange:Ck,NamedTable:kk,NamedFailure:Nk}))}),Tk=wR({scope:MR(nk),objects:MR(JR),fromStateId:MR(jR)}),Ik=TR((function(e){return e.length>0}),"a non-empty array"),Ok=TR((function(e){return e.every((function(t){return t.sheetId===e[0].sheetId}))}),"ranges on the same sheet"),Mk=_R(LR(ck),(function(e){return Ik}),(function(e){return Ok})),wk=DR(wR({range:Mk,origin:MR(uk),viewport:MR(ck)}),UR({CellFormula:wR({formulaBarText:$R,value:MR(VR)}),Value:wR({formulaBarText:YR,value:hk}),Inferred:wR({formulaBarText:YR,value:MR(VR)})})),Dk=UR({SetFormat:wR({format:vk})}),_k=wR({range:Mk,operation:Dk,origin:MR(uk),viewport:MR(ck)}),Lk=wR({range:ck,formulaBarText:TR((function(e){return"string"==typeof e&&(0===e.length||ZR(e))}),"empty string or text denoting formula"),origin:MR(uk),viewport:MR(ck)}),Uk=TR((function(e){return 2===e.length}),"2 AM/PM symbols"),xk=TR((function(e){return 7===e.length}),"7 day symbols"),Bk=TR((function(e){return 12===e.length}),"12 month symbols");function Wk(e){var t=fe(e,se);return TR((function(e){return e.every((function(e,r){return null==e||r in t}))}),"indexes in enum")}var Pk=Wk(gt),Vk=Wk(Bo),Gk=Wk(Wo),Hk=Wk(Po),jk=Wk(Vo),Kk=wR({worksheetFunctionNames:JR,thousandsData:MR(LR(KR)),errorTypeNames:JR,specialRefNames:MR(_R(LR(MR(qR)),(function(e){return Pk}))),trueName:qR,falseName:qR,rowLetter:qR,columnLetter:qR,leftBrace:qR,rightBrace:qR,leftBracket:qR,rightBracket:qR,decimalSeparator:qR,listSeparator:qR,columnSeparator:qR,rowSeparator:qR,thousandsSeparator:MR(YR),lcid:MR(KR),country:MR(KR),numberDecimals:MR(KR),isExpSepBySpace:MR(zR),fractionSeparator:MR(qR),isPercentSepBySpace:MR(zR),currencyFormat:MR(XR(La.Paren,La.Lead,La.Intern,La.Trail)),isCurrencySymbolLead:MR(zR),isCurrencySepBySpace:MR(zR),currencySymbol:MR(YR),currencyDecimals:MR(KR),dateOrder:MR(XR(Ua.MDY,Ua.DMY,Ua.YMD,Ua.MYD,Ua.DYM,Ua.YDM)),dateSeparator:MR(YR),dateAltSeparator:MR(YR),year4Digits:MR(zR),month2Digits:MR(zR),day2Digits:MR(zR),longDateFormat:MR(zR),timeSeparator:MR(YR),timeAltSeparator:MR(YR),hour2Digits:MR(zR),clock24Hour:MR(zR),isAMPMSepBySpace:MR(zR),ampmSymbols:MR(_R(LR(YR),(function(e){return Uk}))),dayNameShort:MR(_R(LR(YR),(function(e){return xk}))),dayNameLong:MR(_R(LR(YR),(function(e){return xk}))),monthNameShort:MR(_R(LR(YR),(function(e){return Bk}))),monthNameLong:MR(_R(LR(YR),(function(e){return Bk}))),pictureSpecial:MR(_R(LR(MR(qR)),(function(e){return Vk}))),pictureSingle:MR(_R(LR(MR(qR)),(function(e){return Gk}))),pictureColor:MR(_R(LR(MR(qR)),(function(e){return Hk}))),pictureDbnum:MR(_R(LR(MR(qR)),(function(e){return jk})))}),Yk=wR({yr:jR,mon:PR(1,13),dom:PR(1,6),wdy:PR(1,8),hour:PR(0,24),min:PR(0,60),sec:PR(0,60),fracSec:QR(0),rounding:PR(0,4)}),qk=_R(wR({bias:HR,standardDate:MR(Yk),standardBias:HR,daylightDate:MR(Yk),daylightBias:HR}),(function(e){return TR((function(e){return me(e.standardDate)===me(e.daylightDate)}),"standardDate iff daylightDate")})),zk=wR({date1904:MR(zR),dateCompatibility:MR(zR),timezone:MR(qk)}),Jk=MR(UR({Origin:wR({value:MR(VR)}),Iformat:wR({value:MR(KR)}),Inferred:wR({value:MR(VR)})})),Qk=((FR={})[bt.Number]=!0,FR[bt.String]=!0,FR[bt.Boolean]=!0,FR[bt.Error]=!0,FR[bt.Array]=!1,FR[bt.Blank]=!0,FR[bt.Rich]=!1,FR),Xk=TR((function(e){return Qk[e.kind]}),"supported ReadOper");function Zk(e,t,r){if(void 0!==r){var n=e.slice();return n[t]=r,n}var a=e.slice(0,-1);return t<e.length-1&&(a[t]=e[e.length-1]),a}function $k(e,t,r){return{kind:e,key:t,value:r}}function eN(e,t){return $k(1,e,t)}function tN(e,t){return $k(2,e,t)}function rN(e,t){return $k(3,e,t)}var nN=function(){function e(e,t,r){this.lattice=e,this.root=t,this.count=r}return e.create=function(t,r,n,a,i){void 0===i&&(i=2);var o=i>1?Math.ceil(i):1;return new e({keyJoin:t,keyMeets:r,keyCompare:n,keyDistance:a,minChildren:o,maxChildren:2*o,keyGe:function(e,t){var r=n(e,t);return void 0!==r&&r>=0},keyLe:function(e,t){var r=n(e,t);return void 0!==r&&r<=0}},void 0,0)},e.prototype.getCount=function(){return this.count},Object.defineProperty(e.prototype,"bounds",{get:function(){var e;return null===(e=this.root)||void 0===e?void 0:e.key},enumerable:!0,configurable:!0}),e.prototype.getValue=function(e){if(void 0!==this.root)return function t(r,n){var a=r.keyCompare(n.key,e);if(1===n.kind)return 0===a?n.value:void 0;if(!(void 0===a||a<0))for(var i=0,o=n.value;i<o.length;i++){var u=t(r,o[i]);if(void 0!==u)return u}}(this.lattice,this.root)},e.prototype.getEntry=function(e){var t=this.getValue(e);return void 0===t?void 0:Zi(e,t)},e.prototype.setValue=function(t,r,n){void 0===n&&(n=function(e){return!0});var a=cN(this.lattice,this.root,t,n,r);return void 0!==a?a===this.root?this:new e(this.lattice,a,this.count):new e(this.lattice,sN(this.lattice,this.root,eN(t,r)),this.count+1)},e.prototype.filter=function(t){var r=new e(this.lattice,void 0,0);return this.forEach((function(e,n){return t(e,n)&&(r=r.setValue(e,n)),!0})),r},e.prototype.contains=function(e,t){return void 0===t&&(t=function(e){return!0}),void 0!==cN(this.lattice,this.root,e,t)},e.prototype.getOrSetValue=function(e,t){var r=this.getValue(e);if(void 0===r){var n=t();return[this.setValue(e,n),n]}return[this,r]},e.prototype.forEach=function(e){return aN(this.root,e)},e.prototype.forEachGe=function(e,t){var r=this;return aN(this.root,t,(function(t){return r.lattice.keyGe(t,e)}),(function(t){return r.lattice.keyGe(t,e)}))},e.prototype.forEachLe=function(e,t){var r=this;return aN(this.root,t,(function(t){return r.lattice.keyMeets(t,e)}),(function(t){return r.lattice.keyLe(t,e)}))},e.prototype.forEachMeets=function(e,t){var r=this;return aN(this.root,t,(function(t){return r.lattice.keyMeets(t,e)}),(function(t){return r.lattice.keyMeets(t,e)}))},e.prototype.remove=function(t){var r=this;if(null==this.root)return this;var n=[],a=this.lattice,i=function(e,r){var o=a.keyCompare(e.key,t);if(void 0===o||o<0)return ge(e,1);if(2===e.kind){for(var u=e.value,s=0;s<u.length;s+=1)if(0===a.keyCompare(u[s].key,t)){if((h=Zk(u,s)).length<r){var c=tN(e.key,h);return n.push(c),ge(c,3)}return ge(tN(oN(a,h),h),2)}}else for(u=e.value,s=0;s<u.length;s+=1){var l=i(u[s],a.minChildren),d=l[0],f=l[1];if(3===f){var h;if((h=Zk(u,s)).length>=r)return ge(rN(oN(a,h),h),2);c=rN(e.key,h);return n.push(c),ge(c,3)}if(2===f)return ge(rN(e.key,Zk(u,s,d)),2)}return ge(e,1)},o=2===this.root.kind?1:2,u=i(this.root,o),s=u[0],c=u[1];if(s===this.root)return this;for(var l=3===c?void 0:s,d=0;d<n.length;d+=1)aN(n[d],(function(e,t){return l=sN(r.lattice,l,eN(e,t)),!0}));return new e(this.lattice,l,this.count-1)},e}();function aN(e,t,r,n){var a=void 0!==r?r:function(){return!0},i=void 0!==n?n:function(){return!0};if(null==e)return!0;var o=function(e){if(!a(e.key))return!0;if(2===e.kind)for(var r=e.value,n=0;n<r.length;n+=1){var u=r[n];if(i(u.key)&&!t(u.key,u.value))return!1}else for(r=e.value,n=0;n<r.length;n+=1)if(!o(r[n]))return!1;return!0};return o(e)}function iN(e,t){for(var r=function(e,t){for(var r=0,n=1,a=e.keyDistance(t[0].key,t[1].key),i=2;i<t.length;i+=1)for(var o=0;o<i;o+=1){var u=e.keyDistance(t[o].key,t[i].key);u>a&&(r=o,n=i,a=u)}return ge(r,n)}(e,t),n=r[0],a=r[1],i=t[n].key,o=t[a].key,u=[],s=0;s<t.length;s+=1){var c=t[s];u.push([c,e.keyDistance(i,c.key)-e.keyDistance(o,c.key)])}u.sort((function(e,t){return e[1]-t[1]}));for(var l=e.minChildren;l<t.length-e.minChildren&&u[l][1]<0;l+=1);var d=[],f=[];for(s=0;s<l;s+=1)d.push(u[s][0]);for(s=l;s<t.length;s+=1)f.push(u[s][0]);return ge(d,f)}function oN(e,t){for(var r=t[0].key,n=1;n<t.length;n+=1)r=e.keyJoin(r,t[n].key);return r}function uN(e,t,r){var n=iN(e,r),a=n[0],i=n[1];return ge($k(t,oN(e,a),a),$k(t,oN(e,i),i))}function sN(e,t,r){if(null==t)return tN(r.key,[r]);var n=function t(n){if(2===n.kind){var a=ie(n.value,[r]);if(a.length>e.maxChildren){var i=uN(e,n.kind,a),o=i[0],u=i[1];return ge(tN(o.key,o.value),u)}return ge(tN(e.keyJoin(n.key,r.key),a),void 0)}var s=n.value.slice(),c=function(e,t,r){for(var n=0,a=e.keyDistance(t[0].key,r),i=t[0].value.length,o=1;o<t.length;o+=1){var u=t[o],s=e.keyDistance(u.key,r);(s<a||s===a&&u.value.length<i)&&(n=o,a=s,i=u.value.length)}return n}(e,s,r.key),l=t(s[c]),d=l[0],f=l[1];if(s[c]=d,null!=f&&(s.push(f),s.length>e.maxChildren)){var h=uN(e,n.kind,s),v=h[0];u=h[1];return ge(rN(v.key,v.value),u)}return ge(rN(e.keyJoin(n.key,r.key),s),void 0)}(t),a=n[0],i=n[1];return null!=i?rN(e.keyJoin(a.key,i.key),[a,i]):a}function cN(e,t,r,n,a){if(void 0!==t)return function t(n){if(2!==n.kind)for(a=0;a<n.value.length;a+=1){o=n.value[a];if(e.keyMeets(o.key,r))if(void 0!==(u=t(o)))return rN(n.key,Zk(n.value,a,u))}else for(var a=0;a<n.value.length;a+=1){var o,u;if(void 0!==(u=i(o=n.value[a])))return tN(n.key,Zk(n.value,a,u))}}(t);function i(t){if(0===e.keyCompare(t.key,r))return void 0!==a&&t.value!==a&&n(t.value)?eN(t.key,a):t}}function lN(e,t){var r=e.row,n=e.col,a=e.rows,i=e.cols,o=t.row,u=t.col,s=r+a,c=o+t.rows,l=n+i,d=u+t.cols;return r===o&&s===c&&n===u&&l===d?0:r<=o&&s>=c&&n<=u&&l>=d?1:r>=o&&s<=c&&n>=u&&l<=d?-1:void 0}function dN(e,t){var r=e.row,n=e.col,a=e.rows,i=e.cols,o=t.row,u=t.col,s=t.rows,c=t.cols;return be(r-o+.5*(a-s))+be(n-u+.5*(i-c))}function fN(){return nN.create(yr,Fr,lN,dN)}function hN(e){return Array.isArray(e)}var vN,pN=function(e){return 0===e};!function(e){e.ClientValueUnknown="ClientValueUnknown"}(vN||(vN={}));var mN,gN={fmla:"",lexicalKind:vn.Cell,origin:Dn(0,0),compiledFmla:void 0,hasHyperlink:!1},SN={fmla:"",lexicalKind:vn.Range,origin:Dn(0,0),compiledFmla:void 0,hasHyperlink:!1},yN=function(e,t){return""===e&&!t},bN=gN;!function(e){e.ClientValueUnknown="ClientValueUnknown"}(mN||(mN={}));var EN={kind:mN.ClientValueUnknown};function FN(e){return e.kind===mN.ClientValueUnknown}var CN={oper:fa,failure:void 0};function RN(e,t){return Zr(e)&&void 0===t}function kN(e,t,r){return e.setValue(t,r,(function(e){return e.fmla!==r.fmla||e.lexicalKind!==r.lexicalKind||void 0!==e.compiledFmla&&!Ar(e.origin,r.origin)||null==e.compiledFmla!=(null==r.compiledFmla)}))}function NN(e,t){return e.forEachMeets(t,(function(t,r){if(r.fmla.length>0){var n=r.lexicalKind===vn.Cell?gN:SN;e=e.setValue(t,n)}return!0})),e}function AN(e,t,r,n){var a=HC(t,dR);return mR(KC(t,UC(HC(r,a),"row","col")),(function(t){return e=e.setValue(t,n),!0})),e}var TN={values:fN(),formats:fN(),formulae:fN(),dirty:dC},IN={serverFormulaeNodeCount:0,serverFormatsNodeCount:0,serverValuesNodeCount:0,serverDirtySetSubspaceCount:0,editedFormulaeNodeCount:0,editedFormatsNodeCount:0,editedValuesNodeCount:0,editedDirtySetSubspaceCount:0,clientFormulaeNodeCount:0,clientFormatsNodeCount:0,clientValuesNodeCount:0,recalcValuesNodeCount:0,recalcDirtySetSubspaceCount:0,recalcFailuresSetSubspaceCount:0,recalcTaintSetSubspaceCount:0,availabilitySetSubspaceCount:0,availabilityHistorySize:0,hiddenRowsNodeCount:0};var ON=wn(0,0,1<<20,16384);var MN=function(){function e(e,t,r,n,a,i,o,u){void 0===t&&(t=TN),void 0===r&&(r=dC),void 0===n&&(n=ON),void 0===a&&(a=dC),void 0===i&&(i=dC),void 0===o&&(o=!1),void 0===u&&(u=!1),this.sheet=e,this.oldAvailabilities={},this.availabilityHistorySize=0,this.serverContents=t,this.serverAvailability=r,this.serverUsed=n,this.hiddenRows=a,this.hiddenAvailability=i,this.inFilterMode=o,this.filterModeAvailable=u,this.rollBackToServerState()}return e.create=function(t){return new e(t)},e.prototype.clone=function(t){void 0===t&&(t=wO.Server);var r=new e(this.sheet,this.serverContents,this.serverAvailability,this.serverUsed,this.hiddenRows,this.hiddenAvailability,this.inFilterMode,this.filterModeAvailable);return t===wO.Client&&(r.editedContents=this.editedContents,r.clientContents=this.clientContents,r.recalcValues=this.recalcValues,r.recalcDirty=this.recalcDirty,r.recalcFailures=this.recalcFailures,r.editedTaint=this.editedTaint,r.recalcTaint=this.recalcTaint,r.editedAvailability=this.editedAvailability),r},e.prototype.advanceState=function(e){this.oldAvailabilities[e]=this.serverAvailability,this.availabilityHistorySize+=1,this.serverAvailability=dC,this.serverUsed=ON,this.hiddenRows=this.hiddenAvailability=dC,this.inFilterMode=this.filterModeAvailable=!1,this.rollBackToServerState()},e.prototype.rollBackToServerState=function(){this.editedContents=this.serverContents,this.editedAvailability=this.serverAvailability,this.editedUsed=this.serverUsed,this.editedTaint=dC,this.rollBackToEditedState()},e.prototype.rollBackToEditedState=function(){this.clientContents=this.editedContents,this.recalcValues=this.editedContents.values,this.recalcFailures=dC,this.recalcDirty=this.editedContents.dirty,this.recalcTaint=this.editedTaint},e.prototype.allServerAvailable=function(e){return this.allAvailable(e,this.serverAvailability)},e.prototype.allEditedAvailable=function(e){return this.allAvailable(e,this.editedAvailability)},e.prototype.allAvailable=function(e,t){var r=HC(oR(e),dR),n=HC(t,r),a=UC(KC(r,n),"row","col"),i=YC(n,r);return!!(void 0!==i&&i>=0)||a},e.prototype.forEachRecalcDirty=function(e,t){return mR(HC(this.recalcDirty,oR(e)),t)},e.prototype.hasRecalcDirty=function(e){return zC(this.recalcDirty,oR(e))},e.prototype.hasRecalcFailure=function(e){return zC(this.recalcFailures,oR(e))},e.prototype.hasEditedEditTaint=function(e){return zC(this.editedTaint,oR(e))},e.prototype.hasRecalcEditTaint=function(e){return zC(this.recalcTaint,oR(e))},e.prototype.getEditedUsedRange=function(){return this.editedUsed},e.prototype.getServerUsedRange=function(){return this.serverUsed},e.prototype.getServerAvailability=function(){return this.serverAvailability},e.prototype.getHiddenRows=function(e,t){var r,n,a=iR.row(ge(e,t)),i=(r=this.hiddenAvailability)===(n=a)?0:r===dC?-1:n===dC?1:r===lC?n===lC?0:1:n===lC?-1:sC(r.setOperations,r.setOperations.top,r.root,n.root);if(!(void 0!==i&&i>=0))return Q({kind:AO.HiddenRows});var o=[];return hR(rC(this.hiddenRows,a),(function(e){var t=e[0],r=e[1];return o.push(zS(t,r)),!0})),q(o)},e.prototype.setHiddenRows=function(e,t){var r=iR.row(ge(e.row,e.row+e.rows));this.hiddenRows=eC(iC(this.hiddenRows,r),rC(t,r)),this.hiddenAvailability=eC(this.hiddenAvailability,r)},e.prototype.isInFilterMode=function(){return this.filterModeAvailable?q(this.inFilterMode):Q({kind:AO.InFilterMode})},e.prototype.setInFilterMode=function(e){this.inFilterMode=e,this.filterModeAvailable=!0},e.prototype.forEachNonBlankSetCellInSet=function(e,t,r,n){var a=HC(e,lR);return pR(HC(r,a),(function(e){return n.formulae.forEachMeets(e,(function(r,n){return!!yN(n.fmla,void 0!==n.compiledFmla)||Sr(Er(e,r),t)}))}))},e.prototype.forEachReadableCellInSet=function(e,t,r){var n=HC(e,dR);return pR(HC(r,n),(function(e){return Sr(e,t)}))},e.prototype.forEachEditedNonBlankCellInSet=function(e,t){return this.forEachNonBlankSetCellInSet(e,t,this.editedAvailability,this.editedContents)},e.prototype.forEachServerNonBlankCellInSet=function(e,t){return this.forEachNonBlankSetCellInSet(e,t,this.serverAvailability,this.serverContents)},e.prototype.forEachEditedCellInSet=function(e,t){return this.forEachReadableCellInSet(e,t,this.editedAvailability)},e.prototype.promoteServerAvailability=function(e,t){var r=HC(e,lR),n=this.oldAvailabilities[t];if(void 0===n)return!1;var a=YC(n,r);return void 0!==a&&a>=0&&(this.unionAvailability(!0,HC(e,fR)),this.unionTaint(!0,dC),this.unionUsed(!0,uR(e)),!0)},e.prototype.extendServerUnused=function(e){var t=void 0===e?dC:oR(e),r=KC(lC,t),n=this.serverContents,a=n.values,i=n.formats,o=n.formulae,u=n.dirty;pR(r,(function(e){return a.forEachLe(e,(function(e,t){return RN(t.oper,t.failure)||(a=a.setValue(e,CN)),!0})),i.forEachLe(e,(function(e,t){return pN(t)||(i=i.setValue(e,0)),!0})),!0})),pR(r,(function(e){return o=NN(o,e),!0})),u=KC(u,r),this.setContents(!0,{values:a,formats:i,formulae:o,dirty:u});var s=HC(r,dR);this.serverAvailability=this.editedAvailability=VC(this.serverAvailability,s),this.editedTaint=this.recalcTaint=dC;var c,l,d=this.serverUsed;l=e,d=void 0===(c=d)||void 0===l?void 0:Er(c,l),this.serverUsed=this.editedUsed=d},e.prototype.setRecalcFailure=function(e){this.recalcFailures=VC(this.recalcFailures,e)},e.prototype.setRecalcEditTaint=function(e){this.recalcTaint=VC(this.recalcTaint,e)},e.prototype.setRecalcValue=function(e,t){var r=this;Sr(e,(function(e,n,a){return r.recalcValues=r.recalcValues.setValue(e,{oper:hN(t)?t[n][a]:t,failure:void 0}),!0})),this.recalcDirty=KC(this.recalcDirty,oR(e))},e.prototype.setClientValue=function(e,t){var r=this.clientContents.values;Sr(e,(function(e,n,a){return r=r.setValue(e,{oper:hN(t)?t[n][a]:t,failure:void 0}),!0})),this.clientContents=te(te({},this.clientContents),{values:r})},e.prototype.setClientFormula=function(e,t,r){var n=this.clientContents.formulae;n=function(e,t){return e.forEachMeets(t,(function(t,r){return r.fmla.length>0&&(e=e.setValue(t,bN)),!0})),e}(n,e),void 0!==t?n=n.setValue(t,r):Sr(e,(function(e){return n=n.setValue(e,r),!0})),this.clientContents=te(te({},this.clientContents),{formulae:n})},e.prototype.setClientFormat=function(e,t){var r=this.clientContents.formats;Sr(e,(function(e){return r=r.setValue(e,t),!0})),this.clientContents=te(te({},this.clientContents),{formats:r})},e.prototype.getRecalcValues=function(e){for(var t=e.row,r=e.col,n=e.rows,a=e.cols,i=new Array(n),o=0;o<n;o+=1)i[o]=R(new Array(a),CN);return this.recalcValues.forEachLe(e,(function(e,n){return i[e.row-t][e.col-r]=n,!0})),i},e.prototype.getClientValue=function(e){var t=this.clientContents.values.getValue(e);return null!=t?t:CN},e.prototype.getServerValue=function(e){var t=this.serverContents.values.getValue(e);return null!=t?t:CN},e.prototype.getServerFormula=function(e){return this.serverContents.formulae.getValue(e)},e.prototype.getClientFormula=function(e){return this.getFormula(e,this.clientContents.formulae)},e.prototype.setEditedFormat=function(e,t){this.editedContents=te(te({},this.editedContents),{formats:this.editedContents.formats.setValue(e,t)})},e.prototype.getEditedFormat=function(e){var t=this.editedContents.formats.getValue(e);return null!=t?t:0},e.prototype.getServerFormat=function(e){var t=this.serverContents.formats.getValue(e);return null!=t?t:0},e.prototype.getClientFormat=function(e){var t=this.clientContents.formats.getValue(e);return null!=t?t:0},e.prototype.getEditedFormula=function(e){return this.getFormula(e,this.editedContents.formulae)},e.prototype.getFormula=function(e,t){var r=void 0;return t.forEachGe(e,(function(e,t){return!!yN(t.fmla,void 0!==t.compiledFmla)||(r=[e,t],!1)})),r},e.prototype.setContents=function(e,t){e&&(this.serverContents=t),this.editedContents=t,e&&(this.clientContents=this.editedContents),this.recalcValues=this.editedContents.values,this.recalcDirty=this.editedContents.dirty,this.recalcFailures=dC},e.prototype.unionAvailability=function(e,t){var r=e?this.serverAvailability:this.editedAvailability;r=VC(r,t),e&&(this.serverAvailability=r),this.editedAvailability=r},e.prototype.unionTaint=function(e,t){this.editedTaint=e?dC:VC(this.editedTaint,t),this.recalcTaint=this.editedTaint},e.prototype.unionUsed=function(e,t){var r,n,a=e?this.serverUsed:this.editedUsed;n=t,a=void 0===(r=a)?n:void 0===n?r:yr(r,n),e&&(this.serverUsed=a),this.editedUsed=a},e.prototype.setCellContents=function(e,t,r,n,a,i,o){this.setCommon(e,t,void 0,r,n,a,i,o)},e.prototype.setRangeFormula=function(e,t,r,n,a,i){var o=oR(t);this.setCommon(e,o,t,r,n,void 0,a,i)},e.prototype.setCommon=function(e,t,r,n,a,i,o,u){var s=this,c=e?this.serverContents:this.editedContents,l=c.values,d=c.formats,f=c.formulae,h=c.dirty,v=void 0===n&&void 0!==a||void 0!==(null==n?void 0:n.compiledFmla),p=n;void 0!==n&&(pR(t,(function(e){return f=NN(f,e),!0})),yN(n.fmla,void 0!==n.compiledFmla)&&(p=void 0));var m=void 0!==p&&void 0===r?n:void 0,g=void 0!==p&&void 0!==r?n:void 0,S=a;void 0!==a&&RN(a,i)&&(pR(t,(function(e){return l.forEachLe(e,(function(e,t){return RN(t.oper,t.failure)||(l=l.setValue(e,CN)),!0})),!0})),h=v?VC(h,t):KC(h,t),S=void 0);var y=void 0!==S?{oper:S,failure:i}:void 0,b=o;void 0!==o&&pN(o)&&(pR(t,(function(e){return d.forEachLe(e,(function(e,t){return pN(t)||(d=d.setValue(e,0)),!0})),!0})),b=void 0);var E=b===bR.Weak?void 0:b,F=b===bR.Weak?b:void 0,C=t;if(!e){var R=HC(t,lR);C=VC(UC(HC(this.editedAvailability,R),"row","col"),HC(t,void 0!==u?oR(u):dC))}if(void 0===m&&void 0===E&&void 0===y||(mR(C,(function(e){return void 0!==m&&(f=kN(f,e,m)),void 0!==E&&(d=d.setValue(e,E)),void 0!==y&&(l=l.setValue(e,y)),!0})),void 0===m&&void 0===y||(h=v?VC(h,C):KC(h,C))),void 0!==g){f=kN(f,r,g);var k=oR(r);h=v?VC(h,k):KC(h,k)}void 0!==F&&(d=AN(d,C,e?this.serverAvailability:this.editedAvailability,bR.Unavailable));var N=void 0===a?dC:C,A=void 0===n?dC:C,T=void 0===o?dC:C,I=void 0===a&&void 0===o?dC:C;e||(pR(N,(function(e){return s.setClientValue(e,EN),!0})),void 0!==n&&(void 0!==r?this.setClientFormula(r,r,n):pR(A,(function(e){return s.setClientFormula(e,void 0,n),!0}))),o===bR.Weak?this.clientContents=te(te({},this.clientContents),{formats:AN(this.clientContents.formats,T,this.editedAvailability,bR.ClientValueUnknown)}):pR(T,(function(e){return s.setClientFormat(e,bR.ClientValueUnknown),!0}))),this.setContents(e,{values:l,formats:d,formulae:f,dirty:h}),this.unionAvailability(e,HC(N,fR)),e||(this.editedAvailability=KC(this.editedAvailability,KC(t,C))),this.unionTaint(e,I),this.unionUsed(e,uR(t))},e.prototype.getDirtyEditedCells=function(){return HC(this.recalcDirty,this.editedTaint)},e.prototype.getNonDirtyEditedCells=function(){return KC(this.editedTaint,this.recalcDirty)},e.prototype.getDirtyDependentCells=function(){return KC(this.recalcDirty,this.editedTaint)},e.prototype.onCellModified=function(e){var t=e?this.serverContents:this.editedContents;this.setContents(e,t),this.unionAvailability(e,dC),this.unionTaint(e,dC),this.unionUsed(e,void 0)},e.prototype.clearCompiledFormulas=function(){for(var e=0,t=[this.serverContents.formulae,this.editedContents.formulae];e<t.length;e++){t[e].forEach((function(e,t){return void 0!==t.compiledFmla&&t.compiledFmla.reset(),!0}))}},e.prototype.getStatistics=function(){return{serverFormulaeNodeCount:this.serverContents.formulae.getCount(),serverFormatsNodeCount:this.serverContents.formats.getCount(),serverValuesNodeCount:this.serverContents.values.getCount(),serverDirtySetSubspaceCount:JC(this.serverContents.dirty),editedFormulaeNodeCount:this.editedContents.formulae.getCount(),editedFormatsNodeCount:this.editedContents.formats.getCount(),editedValuesNodeCount:this.editedContents.values.getCount(),editedDirtySetSubspaceCount:JC(this.editedContents.dirty),clientFormulaeNodeCount:this.clientContents.formulae.getCount(),clientFormatsNodeCount:this.clientContents.formats.getCount(),clientValuesNodeCount:this.clientContents.values.getCount(),recalcValuesNodeCount:this.recalcValues.getCount(),recalcDirtySetSubspaceCount:JC(this.recalcDirty),recalcFailuresSetSubspaceCount:JC(this.recalcFailures),recalcTaintSetSubspaceCount:JC(this.recalcTaint),availabilityHistorySize:this.availabilityHistorySize,availabilitySetSubspaceCount:JC(this.editedAvailability),hiddenRowsNodeCount:mC(this.hiddenRows)+mC(this.hiddenAvailability)}},e.prototype.collectGarbage=function(e){var t=dC;for(var r in this.oldAvailabilities)if(this.oldAvailabilities.hasOwnProperty(r)){var n=Number(r);if(n>=e){t=VC(t,this.oldAvailabilities[n]);continue}delete this.oldAvailabilities[n],this.availabilityHistorySize-=1}function a(e){return zC(HC(oR(e),lR),t)}function i(e,t){return!yN(t.fmla,void 0!==t.compiledFmla)&&a(e)}function o(e,t){return!pN(t)&&a(e)}function u(e,t){return!(!FN(t.oper)&&RN(t.oper,t.failure))&&a(e)}var s=UC(t,"row","col");this.serverContents={formulae:this.serverContents.formulae.filter(i),formats:this.serverContents.formats.filter(o),values:this.serverContents.values.filter(u),dirty:HC(this.serverContents.dirty,s)},this.editedContents={formulae:this.editedContents.formulae.filter(i),formats:this.editedContents.formats.filter(o),values:this.editedContents.values.filter(u),dirty:HC(this.editedContents.dirty,s)},this.clientContents={formulae:this.clientContents.formulae.filter(i),formats:this.clientContents.formats.filter(o),values:this.clientContents.values.filter(u)},this.recalcValues=this.recalcValues.filter(u),this.recalcDirty=HC(this.recalcDirty,s)},e}(),wN=function(e){return{kind:"NamedValue",value:e}};var DN=function(e){return{kind:"NamedFormula",fmla:e}},_N=function(e,t){return{kind:"NamedFailure",failureReason:e,objectKind:t}},LN={namesCount:0,tablesCount:0,recalcFailuresCount:0,scopes:0,allAvailableScopes:0};var UN,xN=function(){function e(e,t){this.names=e,this.allAvailable=t}return e.create=function(t){return new e(Ds.create(t),!1)},e.prototype.update=function(t,r){return t!==this.names||r!==this.allAvailable?new e(t,r):this},e.prototype.getEntry=function(e,t,r){var n=this.names.getEntry(t);return void 0===n?this.allAvailable?q(void 0):Q({kind:AO.NameLoc,name:Hn(e,t),source:r}):q(!1!==n.value?n:void 0)},e.prototype.setValue=function(e,t){return this.update(this.names.setValue(e,t),this.allAvailable)},e.prototype.remove=function(e){return this.update(this.allAvailable?this.names.remove(e):this.names.setValue(e,!1),this.allAvailable)},e.prototype.findContainingTable=function(e){var t,r=0;return this.names.forEach((function(n,a){if(r>50)return!1;if(r+=1,!1!==a){if("NamedTable"!==a.obj.kind)return!0;var i=a.obj.specialRefRanges[gt.All];return!Nr(e.sheet,i.sheet)||(!Fr(e.range,i.range)||(t=n,!1))}return!0})),void 0!==t?q(Hn(Vn(e.sheet.document),t)):this.allAvailable?q(void 0):Q({kind:AO.ContainingTable,range:e})},e.prototype.setUndefined=function(){return this.update(this.names,!0)},e.prototype.getStatistics=function(e){var t=0;return this.names.forEach((function(e,r){return!1!==r&&"NamedTable"===r.obj.kind&&(t+=1),!0})),{namesCount:this.names.getCount(),tablesCount:t,recalcFailuresCount:e,scopes:1,allAvailableScopes:this.allAvailable?1:0}},e.prototype.collectGarbage=function(){return this.allAvailable?this.update(this.names.filter((function(e,t){return!1!==t})),!0):this},e.prototype.clearCompiledFormulas=function(){this.names.forEach((function(e,t){return!1!==t&&t.compiledFmla.reset(),!0}))},e}(),BN=function(){function e(e,t){this.stringCompareCI=e,this.scope=t,this.isCurrent=!1,this.isChanged=!1,this.oldContents=this.contents=this.emptyContents=xN.create(e),this.emptyRecalcFailures=this.recalcFailures=$i.create(e)}return e.prototype.clone=function(){var t=new e(this.stringCompareCI,this.scope);return t.contents=this.contents,t},e.prototype.advanceState=function(e){this.oldContents=this.contents,this.oldStateId=this.isCurrent?e:void 0,this.contents=this.emptyContents,this.isCurrent=this.isChanged=!1,this.recalcFailures=this.emptyRecalcFailures},e.prototype.getStatistics=function(){return this.contents.getStatistics(this.recalcFailures.getCount())},e.prototype.collectGarbage=function(e){void 0===this.oldStateId||this.oldStateId<e?(this.oldContents=this.emptyContents,this.oldStateId=void 0):this.oldContents=this.oldContents.collectGarbage(),this.contents=this.contents.collectGarbage()},e.prototype.getNameLoc=function(e,t){var r=this.contents.getEntry(this.scope,e,t);return X(r)?q(void 0!==r.value?Hn(this.scope,r.value.key):void 0):r},e.prototype.getNameFormula=function(e,t){var r=this.contents.getEntry(this.scope,e,t);return X(r)?q(void 0!==r.value?r.value.value:void 0):r},e.prototype.hasRecalcFailure=function(e){return this.recalcFailures.contains(e)},e.prototype.setRecalcFailure=function(e){this.recalcFailures=this.recalcFailures.setValue(e,!0)},e.prototype.onCellModified=function(e){this.recalcFailures=this.emptyRecalcFailures},e.prototype.clearCompiledFormulas=function(){this.contents.clearCompiledFormulas(),this.oldContents!==this.contents&&this.oldContents.clearCompiledFormulas()},e.prototype.setNamedObject=function(e,t,r){this.contents=void 0===r?this.contents.remove(t):this.contents.setValue(t,r),this.isCurrent=this.isChanged=!0},e.prototype.setUndefinedNames=function(){this.contents=this.contents.setUndefined(),this.isCurrent=this.isChanged=!0},e.prototype.promoteNamedObjects=function(e){return!this.isChanged&&e===this.oldStateId&&(this.contents=this.oldContents,this.isCurrent=!0,!0)},e.prototype.findContainingTable=function(e){return this.contents.findContainingTable(e)},e}(),WN=function(){function e(e,t,r,n,a,i){this.document=e,this.stringCompareCI=t,this.formats=r,this.sheets=n,this.oldSheets=a,this.globalNames=null!=i?i:new BN(t,Vn(e))}return e.prototype.clone=function(t){var r;if(void 0===t&&(t=wO.Server),this.sheets){for(var n=this.sheets,a=n.data,i=n.sheetPosToId,o=n.sheetNameToId,u=Object.create(null),s=0,c=i;s<c.length;s++){var l=c[s],d=a[l];u[l]=te(te({},d),{grid:d.grid.clone(t)})}r={data:u,sheetPosToId:i,sheetNameToId:o}}return new e(this.document,this.stringCompareCI,this.formats.clone(),r,void 0,this.globalNames.clone())},e.prototype.setClientValue=function(e,t){var r=this.getSheetById(e.sheet.index);return r.kind===H.Failure?r:q(r.value.grid.setClientValue(e.range,t))},e.prototype.setClientFormula=function(e,t){var r=this.getSheetById(e.sheet.index);return r.kind===H.Failure?r:q(r.value.grid.setClientFormula(e.range,e.range,t))},e.prototype.setRecalcFailure=function(e,t){var r=this.getSheetById(e);return r.kind===H.Failure?r:q(r.value.grid.setRecalcFailure(t))},e.prototype.setRecalcEditTaint=function(e,t){var r=this.getSheetById(e);return r.kind===H.Failure?r:q(r.value.grid.setRecalcEditTaint(t))},e.prototype.setRecalcValue=function(e,t){var r=this.getSheetById(e.sheet.index);return r.kind===H.Failure?r:q(r.value.grid.setRecalcValue(e.range,t))},e.prototype.setEditedFormat=function(e,t){var r=this.getSheetById(e.sheet.index);return r.kind===H.Failure?r:q(r.value.grid.setEditedFormat(e.range,t))},e.prototype.setClientFormat=function(e,t){var r=this.getSheetById(e.sheet.index);return r.kind===H.Failure?r:q(r.value.grid.setClientFormat(e.range,t))},e.prototype.setHiddenRows=function(e,t,r){var n=this.getSheetById(e);return n.kind===H.Failure?n:q(n.value.grid.setHiddenRows(t,r))},e.prototype.setInFilterMode=function(e,t){var r=this.getSheetById(e);return r.kind===H.Failure?r:q(r.value.grid.setInFilterMode(t))},e.prototype.setCellContents=function(e,t,r,n,a,i,o){var u=this.getSheetById(t.sheet.index);if(u.kind===H.Failure)return u;var s=void 0!==o&&Nr(t.sheet,o.sheet)?o.range:void 0;return q(u.value.grid.setCellContents(e,t.set,r,n,a,i,s))},e.prototype.setRangeFormula=function(e,t,r,n,a,i){var o=this.getSheetById(t.sheet.index);if(o.kind===H.Failure)return o;var u=void 0!==i&&Nr(t.sheet,i.sheet)?i.range:void 0;return q(o.value.grid.setRangeFormula(e,t.range,r,n,a,u))},e.prototype.getDirtyEditedCells=function(){var e=[];return this.forEachSheet((function(t){e.push(gR(t.grid.sheet,t.grid.getDirtyEditedCells()))})),e},e.prototype.getNonDirtyEditedCells=function(){var e=[];return this.forEachSheet((function(t){e.push(gR(t.grid.sheet,t.grid.getNonDirtyEditedCells()))})),e},e.prototype.getDirtyDependentCells=function(){var e=[];return this.forEachSheet((function(t){e.push(gR(t.grid.sheet,t.grid.getDirtyDependentCells()))})),e},e.prototype.setNamedObject=function(e,t,r){var n=this.getNameManager(t.scope.index);return n.kind===H.Failure?n:q(n.value.setNamedObject(e,t.name,r))},e.prototype.setUndefinedNames=function(e){var t=this.getNameManager(e.index);return t.kind===H.Failure?t:q(t.value.setUndefinedNames())},e.prototype.promoteNamedObjects=function(e,t){var r=this.getNameManager(e.index);return r.kind===H.Failure?r:q(r.value.promoteNamedObjects(t))},e.prototype.setSheetNames=function(t){for(var r,n,a=null===(n=null!==(r=this.sheets)&&void 0!==r?r:this.oldSheets)||void 0===n?void 0:n.data,i=Object.create(null),o=[],u=[],s=0;s<t.length;s+=1){var c=t[s],l=c.sheetName,d=c.sheetId;o[s]=d,u.push([l,d]);var f=null==a?void 0:a[d];if(void 0===f){var h=Tn(this.document,d);i[d]={grid:MN.create(h),names:new BN(this.stringCompareCI,h),pos:s,name:l}}else i[d]=te(te({},f),{pos:s,name:l})}var v=$i.create(this.stringCompareCI).setValues(u);return new e(this.document,this.stringCompareCI,this.formats,{data:i,sheetPosToId:o,sheetNameToId:v},void 0,this.globalNames)},e.prototype.extendServerUnused=function(e,t){var r=this.getSheetById(e);return r.kind===H.Failure?r:q(r.value.grid.extendServerUnused(t))},e.prototype.promoteServerAvailability=function(e,t,r){var n=this.getSheetById(e);return n.kind===H.Failure?n:q(n.value.grid.promoteServerAvailability(t,r))},e.prototype.getNameLoc=function(e,t,r){var n=this.getNameManager(e);if(n.kind===H.Failure)return n;var a=n.value.getNameLoc(t,r);return a.kind,H.Failure,a},e.prototype.getNameFormula=function(e,t){var r=this.getNameManager(e.scope.index);return r.kind===H.Failure?r:r.value.getNameFormula(e.name,t)},e.prototype.hasRecalcNameFailure=function(e){var t=this.getNameManager(e.scope.index);return t.kind===H.Failure?t:q(t.value.hasRecalcFailure(e.name))},e.prototype.setRecalcNameFailure=function(e){var t=this.getNameManager(e.scope.index);return t.kind===H.Failure?t:q(t.value.setRecalcFailure(e.name))},e.prototype.getNameManager=function(e){if(void 0===e)return q(this.globalNames);var t=this.getSheetById(e);return t.kind===H.Failure?t:q(t.value.names)},e.prototype.findContainingTable=function(e){return this.globalNames.findContainingTable(e)},e.prototype.getEditedFormula=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===H.Failure?t:q(t.value.grid.getEditedFormula(e.range))},e.prototype.getEditedFormat=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===H.Failure?t:q(t.value.grid.getEditedFormat(e.range))},e.prototype.isInFilterMode=function(e){var t=this.getSheetById(e);return t.kind===H.Failure?t:t.value.grid.isInFilterMode()},e.prototype.getHiddenRows=function(e,t,r){var n=this.getSheetById(e);return n.kind===H.Failure?n:n.value.grid.getHiddenRows(t,r)},e.prototype.getServerFormat=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===H.Failure?t:q(t.value.grid.getServerFormat(e.range))},e.prototype.getClientFormat=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===H.Failure?t:q(t.value.grid.getClientFormat(e.range))},e.prototype.getClientValue=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===H.Failure?t:q(t.value.grid.getClientValue(e.range))},e.prototype.getRecalcValues=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===H.Failure?t:q(t.value.grid.getRecalcValues(e.range))},e.prototype.getServerValue=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===H.Failure?t:q(t.value.grid.getServerValue(e.range))},e.prototype.getServerFormula=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===H.Failure?t:q(t.value.grid.getServerFormula(e.range))},e.prototype.getClientFormula=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===H.Failure?t:q(t.value.grid.getClientFormula(e.range))},e.prototype.getServerUsedRange=function(e){var t=this.getSheetById(e);return t.kind===H.Failure?t:q(t.value.grid.getServerUsedRange())},e.prototype.allServerAvailable=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===H.Failure?t:q(t.value.grid.allServerAvailable(e.range))},e.prototype.allEditedAvailable=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===H.Failure?t:q(t.value.grid.allEditedAvailable(e.range))},e.prototype.forEachRecalcDirty=function(e,t){var r=this.getSheetById(e.sheet.index);return r.kind===H.Failure?r:q(r.value.grid.forEachRecalcDirty(e.range,t))},e.prototype.hasRecalcDirty=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===H.Failure?t:q(t.value.grid.hasRecalcDirty(e.range))},e.prototype.hasRecalcFailure=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===H.Failure?t:q(t.value.grid.hasRecalcFailure(e.range))},e.prototype.hasEditedEditTaint=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===H.Failure?t:q(t.value.grid.hasEditedEditTaint(e.range))},e.prototype.hasRecalcEditTaint=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===H.Failure?t:q(t.value.grid.hasRecalcEditTaint(e.range))},e.prototype.forEachEditedNonBlankCellInSet=function(e,t,r){var n=this.getSheetById(e);return n.kind===H.Failure?n:q(n.value.grid.forEachEditedNonBlankCellInSet(t,r))},e.prototype.forEachServerNonBlankCellInSet=function(e,t,r){var n=this.getSheetById(e);return n.kind===H.Failure?n:q(n.value.grid.forEachServerNonBlankCellInSet(t,r))},e.prototype.forEachEditedCellInSet=function(e,t,r){var n=this.getSheetById(e);return n.kind===H.Failure?n:q(n.value.grid.forEachEditedCellInSet(t,r))},e.prototype.getSheetIndex=function(e){var t=this.getSheetByName(e);return t.kind===H.Failure||void 0===t.value?t:q(t.value.grid.sheet)},e.prototype.getSheetName=function(e){var t=this.getSheetById(e);return t.kind===H.Failure?t:q(t.value.name)},e.prototype.getEditedUsedRange=function(e){var t=this.getSheetById(e);return t.kind===H.Failure?t:q(t.value.grid.getEditedUsedRange())},e.prototype.getSheetRangeIds=function(e){var t,r,n,a=null===(t=this.sheets)||void 0===t?void 0:t.sheetPosToId;if(!a)return this.unavailableFailure({kind:AO.SheetNames});if(void 0===e.index)r=0,n=a.length;else{var i=this.getSheetById(e.index);if(!X(i))return i;var o=this.getSheetById(e.index2);if(!X(o))return o;r=Se(i.value.pos,o.value.pos),n=ye(i.value.pos,o.value.pos)+1}for(var u=[],s=r;s<n;s+=1)u.push(a[s]);return q(On(u,r))},e.prototype.getIformat=function(e){return this.formats.getIformat(e)},e.prototype.getKnownFormat=function(e){return this.formats.getKnownFormat(e)},e.prototype.getFormatString=function(e){return this.formats.getFormatString(e)},e.prototype.setNumberFormats=function(e,t){this.formats.setNumberFormats(e,t)},e.prototype.onCellModified=function(e){this.forEachSheet((function(t){t.grid.onCellModified(e),t.names.onCellModified(e)})),this.globalNames.onCellModified(e)},e.prototype.collectGarbage=function(e){this.forEachSheet((function(t){t.grid.collectGarbage(e),t.names.collectGarbage(e)})),this.globalNames.collectGarbage(e)},e.prototype.advanceState=function(e){this.forEachSheet((function(t){t.grid.advanceState(e),t.names.advanceState(e)})),this.globalNames.advanceState(e),this.oldSheets=this.sheets,this.sheets=void 0},e.prototype.clearCompiledFormulas=function(){this.forEachSheet((function(e){e.grid.clearCompiledFormulas(),e.names.clearCompiledFormulas()})),this.globalNames.clearCompiledFormulas()},e.prototype.clearCompiledNumberFormats=function(){this.formats.clearCompiledNumberFormats()},e.prototype.getGridStatistics=function(){var e=IN;return this.forEachSheet((function(t){return r=e,n=t.grid.getStatistics(),e={serverFormulaeNodeCount:r.serverFormulaeNodeCount+n.serverFormulaeNodeCount,serverFormatsNodeCount:r.serverFormatsNodeCount+n.serverFormatsNodeCount,serverValuesNodeCount:r.serverValuesNodeCount+n.serverValuesNodeCount,serverDirtySetSubspaceCount:r.serverDirtySetSubspaceCount+n.serverDirtySetSubspaceCount,editedFormulaeNodeCount:r.editedFormulaeNodeCount+n.editedFormulaeNodeCount,editedFormatsNodeCount:r.editedFormatsNodeCount+n.editedFormatsNodeCount,editedValuesNodeCount:r.editedValuesNodeCount+n.editedValuesNodeCount,editedDirtySetSubspaceCount:r.editedDirtySetSubspaceCount+n.editedDirtySetSubspaceCount,clientFormulaeNodeCount:r.clientFormulaeNodeCount+n.clientFormulaeNodeCount,clientFormatsNodeCount:r.clientFormatsNodeCount+n.clientFormatsNodeCount,clientValuesNodeCount:r.clientValuesNodeCount+n.clientValuesNodeCount,recalcValuesNodeCount:r.recalcValuesNodeCount+n.recalcValuesNodeCount,recalcDirtySetSubspaceCount:r.recalcDirtySetSubspaceCount+n.recalcDirtySetSubspaceCount,recalcFailuresSetSubspaceCount:r.recalcFailuresSetSubspaceCount+n.recalcFailuresSetSubspaceCount,recalcTaintSetSubspaceCount:r.recalcTaintSetSubspaceCount+n.recalcTaintSetSubspaceCount,availabilitySetSubspaceCount:r.availabilitySetSubspaceCount+n.availabilitySetSubspaceCount,availabilityHistorySize:r.availabilityHistorySize+n.availabilityHistorySize,hiddenRowsNodeCount:r.hiddenRowsNodeCount+n.hiddenRowsNodeCount};var r,n})),e},e.prototype.getNameStatistics=function(){var e=this.globalNames.getStatistics();return this.forEachSheet((function(t){return r=e,n=t.names.getStatistics(),e={namesCount:r.namesCount+n.namesCount,tablesCount:r.tablesCount+n.tablesCount,recalcFailuresCount:r.recalcFailuresCount+n.recalcFailuresCount,scopes:r.scopes+n.scopes,allAvailableScopes:r.allAvailableScopes+n.allAvailableScopes};var r,n})),e},e.prototype.getServerAvailableCells=function(){var e=[],t=this.sheets;if(t)for(var r=0,n=t.sheetPosToId;r<n.length;r++){var a=n[r],i=t.data[a],o=Tn(this.document,a);e.push({sheetIdx:o,availableCells:i.grid.getServerAvailability()})}return e},e.prototype.forEachSheet=function(e){var t,r=null===(t=this.sheets)||void 0===t?void 0:t.data;for(var n in r){if(Object.prototype.hasOwnProperty.call(r,n))e(r[n])}},e.prototype.getSheetById=function(e){var t=this.sheets;if(!t)return this.unavailableFailure({kind:AO.SheetNames});var r=t.data[e];return void 0===r?this.unavailableFailure({kind:AO.SheetId,document:this.document,sheetId:e}):q(r)},e.prototype.getSheetByName=function(e){var t,r=null===(t=this.sheets)||void 0===t?void 0:t.sheetNameToId;if(!r)return this.unavailableFailure({kind:AO.SheetNames});var n=r.getValue(e);return void 0===n?q(void 0):this.getSheetById(n)},e.prototype.unavailableFailure=function(e){return Q(e)},e}(),PN=function(){function e(e){this.valueCreationFunc=e,this.value=void 0}return e.prototype.getValue=function(){return void 0===this.value&&(this.value=this.valueCreationFunc()),this.value},e.prototype.reset=function(){this.value=void 0},e}();function VN(e){var t=e.value;if(X(t)){var r=t.value;switch(typeof r){case"object":switch(r.kind){case"Blank":return bt.Blank;case"Error":return bt.Error;case"Rich":return bt.Rich;default:L("calc.calc.extractResultValue",r)}case"boolean":return bt.Boolean;case"number":return bt.Number;case"string":return bt.String;default:return L("calc.calc.extractResultValue",r)}}}function GN(e){var t=e.value;if(!X(t))return t.reason.kind}!function(e){e[e.OP_DOT=-1]="OP_DOT",e[e.OP_DOTSTAR=-2]="OP_DOTSTAR"}(UN||(UN={}));var HN=function(){function e(e,t,r){void 0===r&&(r=!1),this.localeInfo=e,this.source=t,this.appendWildcard=r,this.bytecode=[],this.blocks=[];for(var n="",a=0;a<t.length;a+=1){var i=t.charCodeAt(a);if(126===i&&a+1<t.length){var o=qa(t,a+1);n+=ja(o),a+=za(o)}else 126!==i&&(63!==i&&42!==i?n+=t.charAt(a):(this.pushBlock(n),n="",this.pushMeta(i)))}0===this.bytecode.length&&(this.simplePattern=n),this.pushBlock(n),r&&this.pushMeta(42)}return e.prototype.pushBlock=function(e){if(""!==e){var t=this.blocks.length;this.blocks.push(e),this.bytecode.push(t);for(var r=1;r<e.length;r+=1)this.bytecode.push(UN.OP_DOT)}},e.prototype.pushMeta=function(e){63===e?this.bytecode.push(UN.OP_DOT):this.bytecode.push(UN.OP_DOTSTAR)},e.prototype.test=function(e){if(void 0!==this.simplePattern)return this.testSimple(e,this.simplePattern);var t=Object.create(null);this.addState(t,0);for(var r=0;r<e.length;r+=1){var n=Object.keys(t);if(t=Object.create(null),0===n.length)return!1;for(var a=0;a<n.length;a+=1){var i=Number(n[a]);if(i!==this.bytecode.length){var o=this.bytecode[i];switch(o){case UN.OP_DOT:this.addState(t,i+1);break;case UN.OP_DOTSTAR:this.addState(t,i);break;default:var u=this.blocks[o];r+u.length<=e.length&&0===this.localeInfo.stringCompareCI(u,e.substring(r,r+u.length))&&this.addState(t,i+1)}}}}return this.bytecode.length in t},e.prototype.addState=function(e,t){e[t]=!0;for(var r=this.bytecode,n=t;n<r.length&&r[n]===UN.OP_DOTSTAR;n+=1)e[n+1]=!0},e.prototype.testSimple=function(e,t){return t.length<=e.length&&(t.length===e.length||this.appendWildcard)&&0===this.localeInfo.stringCompareCI(t,e.substring(0,t.length))},e}(),jN={"=":pa.Eq,"<":pa.Lt,">":pa.Gt},KN={"<>":pa.Ne,"<=":pa.Le,">=":pa.Ge};function YN(e,t){if(!Yr(t))return t;var r,n,a=(r=t.value).length>=2&&void 0!==(n=KN[r.substring(0,2)])?[n,r.substring(2)]:r.length>=1&&void 0!==(n=jN[r.substring(0,1)])?[n,r.substring(1)]:[void 0,r];return{kind:"FilterExpression",operator:a[0],operand:function(e,t){var r=e.config.localeInfo;if(0===r.stringCompareCI(t,r.trueName))return ha;if(0===r.stringCompareCI(t,r.falseName))return va;for(var n=1;n<r.errorNames.length;n+=1){var a=r.errorNames[n];if(null!=a&&0===r.stringCompareCI(a,t))return Jn(n)}var i=e.parseGeneral(t,!1);return void 0!==i?i:zn(t)}(e,a[1])}}function qN(e,t,r,n){var a=function(e,t){var r="FilterExpression"===t.kind?t:{kind:"FilterExpression",operator:pa.Eq,operand:t},n=e.config,a=n.mathpack,i=n.localeInfo;if(r.operator===pa.Ne&&Xm(r.operand))return function(e){return!Zr(e)};if(r.operator===pa.Eq&&Xm(r.operand))return Zr;if(void 0!==r.operator&&Xm(r.operand))return function(e){return!1};if(void 0===r.operator&&Xm(r.operand))return function(e){return Zr(e)||Xm(e)};var o,u,s=void 0===r.operator?pa.Eq:r.operator;switch(r.operand.kind){case bt.Number:return o=s,u=r.operand,function(t){var r=$r(t)?t.getFallback():t;if(Kr(r))return ig(a,o,r,u);if(Yr(r)&&o===pa.Eq){var n=e.parseGeneral(r.value,!1);return void 0!==n&&ig(a,o,n,u)}return o===pa.Ne};case bt.Boolean:return function(e,t){return function(r){var n=$r(r)?r.getFallback():r;return qr(n)?ng(e,n,t):e===pa.Ne}}(s,r.operand);case bt.String:return function(e,t){switch(e){case pa.Eq:case pa.Ne:var r=new HN(i,t.value);return function(t){var n=$r(t)?t.getFallback():t;return Yr(n)?r.test(n.value)===(e===pa.Eq):e===pa.Ne};case pa.Lt:case pa.Gt:case pa.Le:case pa.Ge:return function(r){var n=$r(r)?r.getFallback():r;return!!Yr(n)&&ag(i,e,n,t)}}}(s,r.operand);case bt.Error:return function(e,t){return function(r){var n=$r(r)?r.getFallback():r;return zr(n)?rg(e,n.type-t.type):e===pa.Ne}}(s,r.operand);default:return L("calc.funcs.criteria.compileCriteria",r.operand)}}(e,YN(e,r)),i=t,o=void 0===n?i:n;return new Om(o.rows,o.cols,ye(i.denseRows,o.denseRows),ye(i.denseCols,o.denseCols),(function(e,t){var r=i.get(e,t);return a(r)?o.get(e,t):void 0}),(function(){var e=i.getSparse();return a(e)?o.getSparse():void 0}))}var zN=bt.Number|bt.String|bt.Boolean;function JN(e,t,r,n,a){var i=function(n,i,u,s){if((null==i?void 0:i.kind)===bt.Array){for(var c=new Nm(i.rows,i.cols,i.opers),l=n,d=0;d<u;d+=1)l=o(l,c);return l}var f=(s&&void 0!==a?a:r)(e,i);return null==f?n:t(n,f,u)};function o(e,t){for(var r=e,n=0;n<t.rows;n+=1)for(var a=0;a<t.cols;a+=1){var o=t.get(n,a);void 0!==o&&(r=i(r,o,1,!0))}return r}function u(e,t){for(var r=e,n=t.getSparse(),a=t.cols-t.denseCols,o=0;o<t.denseRows;o+=1){for(var u=0;u<t.denseCols;u+=1){var s=t.get(o,u);void 0!==s&&(r=i(r,s,1,!1))}a>0&&void 0!==n&&(r=i(r,n,a,!1))}var c=(t.rows-t.denseRows)*t.cols;return c>0&&void 0!==n&&(r=i(r,n,c,!1)),r}return n.reduce((function(e,t){return gb(t)?t.arrays.reduce(u,e):i(e,t,1,!1)}),void 0)}function QN(e,t){var r=$r(t)?t.getFallback():t;switch(r.kind){case bt.Number:return r;case bt.Boolean:case bt.String:return;case bt.Error:return r;case bt.Missing:case bt.Blank:return;default:return L("calc.funcs.arithmeticOperationCoerce",r)}}function XN(e,t){var r=$r(t)?t.getFallback():t;switch(r.kind){case bt.Boolean:return r.value?e.mathpack.one:e.mathpack.zero;case bt.Number:return r;case bt.String:return e.mathpack.zero;case bt.Error:return r;case bt.Missing:case bt.Blank:return;default:return L("calc.funcs.arithmeticAOperationCoerce",r)}}function ZN(e){return function(t,r,n){if(void 0!==t&&zr(t))return t;if(x("calc.funcs.numberReducer",void 0===t||Kr(t)),zr(r))return r;var a,i;x("calc.funcs.numberReducer",Kr(r)),void 0===t?(a=r,i=n-1):(a=t,i=n);for(var o=0;o<i;o+=1){var u=e(a,r);if(zr(u))return u;a=u}return a}}function $N(e){return function(t,r,n){return e.count+=n,r}}function eA(e,t,r){if(!Kr(r))return r;var n=function(e){for(var t=e.length-1;t>=0;t-=1){var r=e[t];if(void 0!==r&&gb(r))for(var n=r.arrays.length-1;n>=0;n-=1){var a=r.arrays[n];if(a.rows>a.denseRows||a.cols>a.denseCols)if((null==(u=a.getSparse())?void 0:u.kind)===bt.Number)return u;for(var i=a.denseRows-1;i>=0;i-=1)for(var o=a.denseCols-1;o>=0;o-=1){var u;if((null==(u=a.get(i,o))?void 0:u.kind)===bt.Number)return u}}}}(t);return(null==n?void 0:n.kind)!==bt.Number?r:e.mathpack.checkAlmostCancellation(n,r)}function tA(e,t,r){var n=JN(t,ZN(t.mathpack.add),QN,r);return null==n?t.mathpack.zero:(e&&(n=eA(t,r,n)),n)}var rA=tA.bind(void 0,!1),nA=tA.bind(void 0,!0);function aA(e){return Jr(e)&&1!==e.ranges.length}function iA(e,t,r){if(aA(t))return Q(Zn);if(void 0===r){var n=e.dereferenceAllOpers([t])[0];return q({values:n,valuesToFilter:n})}if(aA(r))return Q(Zn);var a=function(e,t){var r=e.ranges[0],n=t.ranges[0],a=Se(r.cols,16384-n.col),i=Se(r.rows,(1<<20)-n.row),o=wn(r.row,r.col,i,a),u=ca(e.sheets,o),s=wn(n.row,n.col,i,a),c=ca(t.sheets,s);return{actualEvalRange:u,actualFilterRange:c}}(t,r),i=a.actualEvalRange,o=a.actualFilterRange,u=i.ranges[0],s=o.ranges[0],c=e.dereferenceAllOpers([i])[0];return u.col===s.col&&u.row===s.row?q({values:c,valuesToFilter:c}):q({values:c,valuesToFilter:e.dereferenceAllOpers([o])[0]})}function oA(e,t){var r=t[0],n=t[1],a=iA(e,r,t[2]);if(!X(a))return a.reason;var i=a.value,o=i.values,u=i.valuesToFilter,s=[mb([qN(e,o.arrays[0],n,u.arrays[0])])];return rA(e,s)}function uA(e,t,r,n){void 0===r&&(r=!1),void 0===n&&(n=!1);var a,i,o=t[0];if(aA(o))return Q(Zn);if(r){var u=t[1],s=e.dereferenceAllOpers([o])[0];a=qN(e,s.arrays[0],u),i=2}else{a=e.dereferenceAllOpers([o])[0].arrays[0],i=1}for(var c=i;c<t.length;c+=2){var l=t[c],d=t[c+1];if(aA(l))return Q(Zn);if(l.ranges[0].cols!==o.ranges[0].cols||l.ranges[0].rows!==o.ranges[0].rows)return Q(Zn);s=e.dereferenceAllOpers([l])[0];a=qN(e,s.arrays[0],d,a)}return n&&(a=a.strict()),q(mb([a]))}function sA(e,t){var r=JN(e,ZN(e.mathpack.mul),QN,t);return null==r?e.mathpack.zero:r}function cA(e,t,r,n,a,i){var o=JN(a,ZN(a.mathpack.add),e,i,t);if(null==o)return n;if(r&&(o=eA(a,i,o)),zr(o))return o;var u={count:0},s=JN(a,$N(u),e,i,t);x("calc.funcs.averageCoerceInner",Kr(o)&&(null==s?void 0:s.kind)===bt.Number&&u.count>0);var c=a.mathpack.div(o,a.mathpack.fromNumber(u.count));return zr(c)?c:[c,u.count]}function lA(e,t,r,n,a){var i=cA(e,t,r,Xn,n,a);return Array.isArray(i)?i[0]:i}var dA=lA.bind(void 0,QN,void 0,!1),fA=lA.bind(void 0,QN,void 0,!0),hA=lA.bind(void 0,XN,(function(e,t){var r=$r(t)?t.getFallback():t;return Yr(r)?e.mathpack.zero:QN(0,r)}),!0);function vA(e,t){var r=t[0],n=t[1],a=iA(e,r,t[2]);if(!X(a))return a.reason;var i=a.value,o=i.values,u=i.valuesToFilter,s=[mb([qN(e,o.arrays[0],n,u.arrays[0]).strict()])];return dA(e,s)}function pA(e,t,r,n,a){for(var i=void 0,o=0,u="",s=function(e,t){return e.coerceOper(t,bt.String)},c=function(e,n,a){if(void 0!==e&&zr(e))return e;for(var s=0;s<a;s+=1){if(void 0!==i&&t.length>0&&(!r||i.value.length>0)){var c=t[o];if(o=(o+1)%t.length,u.length+c.value.length>32767)return Zn;u+=c.value}if(zr(n))return n;if(x("calc.funcs.concatInner: expected string in reducer",Yr(n)),u.length+n.value.length>32767)return Zn;if(u+=n.value,i=n,""===n.value&&(0===t.length||r))break}return n},l=0;l<a.length;l+=1){var d=n[l];if(Jr(d)&&d.ranges.length>1)return Zn;var f=JN(e,c,s,a.slice(l,l+1));if(void 0!==f&&zr(f))return f;x("calc.funcs.concatInner: expected string from reduce",void 0!==f&&Yr(f))}if(r&&void 0!==i&&""===i.value&&t.length>0&&u.length>0){var h=t[(o+t.length-1)%t.length];u=u.substring(0,u.length-h.value.length)}return zn(u)}function mA(e,t,r){var n={count:0};return JN(t,$N(n),e,r),t.mathpack.fromNumber(n.count)}var gA=mA.bind(void 0,(function(e,t){var r=$r(t)?t.getFallback():t;return Kr(r)?r:void 0}));var SA=mA.bind(void 0,(function(e,t){var r=$r(t)?t.getFallback():t;return Zr(r)||Xm(r)?r:void 0}));var yA=mA.bind(void 0,(function(e,t){var r=$r(t)?t.getFallback():t;return tn(r)||zr(r)?r:void 0}));var bA=mA.bind(void 0,(function(e,t){return t}));function EA(e,t){var r=t[0],n=t[1];if(aA(r))return Zn;var a=e.dereferenceAllOpers([r])[0],i=[mb([qN(e,a.arrays[0],n)])];return bA(e,i)}var FA=function(e,t,r){return e.mathpack.cond2(t,r)>0},CA=function(e,t,r){return e.mathpack.cond2(t,r)<0};function RA(e,t,r,n,a){var i=JN(n,(function(t,r,a){return void 0===t?r:zr(t)?t:(x("calc.funcs.minMaxCoerceInner",Kr(t)),zr(r)?r:(x("calc.funcs.minMaxCoerceInner",Kr(r)),e(n,t,r)?t:r))}),t,a,r);return null==i?n.mathpack.zero:i}var kA=RA.bind(void 0,FA,QN,void 0),NA=RA.bind(void 0,CA,QN,void 0),AA=RA.bind(void 0,FA,XN,QN),TA=RA.bind(void 0,CA,XN,QN);function IA(e,t){var r=$r(t)?t.getFallback():t;switch(r.kind){case bt.Boolean:return r;case bt.Number:return qn(0!==e.mathpack.cond(r));case bt.String:return;case bt.Error:return r;case bt.Missing:case bt.Blank:return;default:return L("calc.funcs.aggregationFuncs: booleanOperationCoerce",r)}}function OA(e,t,r){var n=JN(t,(function(t,r,n){return void 0!==t&&zr(t)?t:zr(r)?r:(x("calc.funcs.booleanInner",(void 0===t||qr(t))&&qr(r)),qn(e(null==t?void 0:t.value,r.value,n)))}),IA,r);return null==n?Zn:n}var MA=OA.bind(void 0,(function(e,t){return!1!==e&&t})),wA=OA.bind(void 0,(function(e,t){return!0===e||t})),DA=OA.bind(void 0,(function(e,t,r){return t?((!0===e?1:0)+r)%2==1:!0===e}));function _A(e,t){return function(r,n,a){if(void 0!==r&&zr(r))return r;if(!zr(n))for(var i=t(n),o=0;o<a;o+=1)e.push(i);return n}}function LA(e,t,r,n){var a=[],i=JN(t,_A(a,zm),QN,[r]);if(null==i)return ta;if(zr(i))return i;var o=t.mathpack;if(o.cond2(n,o.one)<0)return ta;if(o.cond2(n,o.fromNumber(a.length))>0)return ta;var u=a.sort(o.cond2);if(e){var s=zm(o.add(zm(o.sub(o.fromNumber(a.length),n)),o.one));return u[o.lfix(s)-1]}return u[o.lfix(n)-1]}var UA=LA.bind(void 0,!0),xA=LA.bind(void 0,!1);function BA(e,t,r,n){var a=e.mathpack,i=[],o=JN(e,_A(i,zm),QN,t);if(null==o)return ta;if(zr(o))return o;if(zr(r))return r;if(a.cond(r)<0)return ta;if(a.cond2(r,a.one)>0)return ta;var u=i.sort(a.cond2),s=zm(a.sub(a.fromNumber(u.length),a.one)),c=zm(a.add(a.fromNumber(u.length),a.one)),l=zm(n?a.mul(s,r):a.sub(zm(a.mul(c,r)),a.one));if(a.cond(l)<0||a.cond2(l,s)>0)return ta;var d=a.lfix(l),f=zm(a.sub(l,a.fromNumber(d)));if(0===a.cond(f))return u[d];var h=a.sub(u[d+1],u[d]);return zr(h)?h:a.add(u[d],zm(a.mul(h,f)))}var WA=function(e,t,r){return BA(e,[t],r,!0)};function PA(e,t){var r=e.dereferenceAllOpers(t),n=r[0],a=r[1];return WA(e,n,a)}var VA=function(e,t,r){return BA(e,[t],r,!1)};function GA(e,t){var r=e.mathpack;if(r.cond(t)<0)return ta;if(r.cond2(t,r.fromNumber(5))>=0)return ta;var n=r.lfix(t);return r.div(r.fromNumber(n),r.fromNumber(4))}var HA=function(e,t,r){return BA(e,[t],GA(e,r),!0)};function jA(e,t){var r=e.dereferenceAllOpers(t),n=r[0],a=r[1];return HA(e,n,a)}var KA=function(e,t,r){return BA(e,[t],GA(e,r),!1)};function YA(e,t){return BA(e,t,e.mathpack.fromNumber(.5),!0)}function qA(e){return function(t,r){var n=e(t,r);return void 0!==n&&Kr(n)?t.mathpack.mul(n,n):n}}function zA(e,t){return function(r,n){var a=e(r,n);if((null==a?void 0:a.kind)!==bt.Number)return a;var i=r.mathpack,o=i.sub(a,t);return zr(o)?o:i.mul(o,o)}}function JA(e,t,r,n){var a={count:0};if(null==JN(r,$N(a),e,n,t))return Xn;x("calc.funcs.varFirstPass: unexpected count type",a.count>=1);var i=ZN(r.mathpack.add),o=JN(r,i,e,n,t),u=JN(r,i,qA(e),n,void 0===t?void 0:qA(t));if(x("calc.funcs.varFirstPass: unexpected sum type",null!=o),zr(o))return o;x("calc.funcs.varFirstPass: unexpected error",Kr(o)&&(null==u?void 0:u.kind)===bt.Number);var s=r.mathpack,c=s.div(o,s.fromNumber(a.count));return zr(c)?c:[a.count,o,u,c]}function QA(e,t,r,n,a){var i=JN(r,ZN(r.mathpack.add),zA(e,a),n,void 0===t?void 0:zA(t,a));return x("calc.funcs.varSecondPass: unexpected error",(null==i?void 0:i.kind)===bt.Number),i}function XA(e,t,r,n){var a=JA(e,t,r,n);if(!Array.isArray(a))return a;var i=r.mathpack,o=a[0],u=a[1],s=a[2],c=a[3];if(o<2)return Xn;var l=i.mul(u,u);if(zr(l))return l;var d=zm(i.div(l,i.fromNumber(o))),f=zm(i.sub(s,d));if(0===i.cond(c))return i.cond(f)<0?i.zero:i.div(f,i.fromNumber(o-1));if(i.cond(f)>=0){var h=zm(i.div(f,i.fromNumber(o-1)));if(i.cond2(h,i.fromNumber(21219957905e-324))>0){var v=i.div(d,s),p=zr(v)?v:i.sub(v,i.one);if(!zr(p)&&i.cond2(i.abs(p),i.fromNumber(.01))>0){var m=i.div(c,h),g=zr(m)?m:i.sub(i.abs(m),i.fromNumber(1e3));if(!zr(g)&&i.cond(g)<0)return h}}}var S=QA(e,t,r,n,c);return i.cond(S)<0?i.zero:i.div(S,i.fromNumber(o-1))}function ZA(e,t,r,n){var a=JA(e,t,r,n);if(!Array.isArray(a))return a;var i=r.mathpack,o=a[0],u=a[1],s=a[2],c=a[3];if(o<1)return Xn;var l=i.mul(u,u);if(zr(l))return l;var d=i.mul(s,i.fromNumber(o));if(zr(d))return d;var f=zm(i.sub(d,l));if(0===i.cond(c))return i.cond(f)<0?i.zero:i.div(f,i.fromNumber(o*o));if(i.cond(f)>=0){var h=zm(i.div(f,i.fromNumber(o*o)));if(i.cond2(h,i.fromNumber(21219957905e-324))>0){var v=i.div(zm(i.div(l,i.fromNumber(o))),s),p=zr(v)?v:i.sub(v,i.one);if(!zr(p)&&i.cond2(i.abs(p),i.fromNumber(.01))>0){var m=i.div(c,h),g=zr(m)?m:i.sub(i.abs(m),i.fromNumber(1e3));if(!zr(g)&&i.cond(g)<0)return h}}}var S=QA(e,t,r,n,c);return i.cond(S)<0?i.zero:i.div(S,i.fromNumber(o))}var $A=XA.bind(void 0,QN,void 0),eT=ZA.bind(void 0,QN,void 0),tT=XA.bind(void 0,XN,QN),rT=ZA.bind(void 0,XN,QN);function nT(e){return function(t,r){var n=e(t,r);return Kr(n)?t.mathpack.sqrt(n):n}}var aT=nT($A),iT=nT(eT),oT=nT(tT),uT=nT(rT);function sT(e,t){var r=e.dereferenceAllOpers(t);return aT(e,r)}function cT(e,t){var r=e.dereferenceAllOpers(t);return iT(e,r)}function lT(e,t){var r=e.dereferenceAllOpers(t);return $A(e,r)}function dT(e,t){var r=e.dereferenceAllOpers(t);return eT(e,r)}var fT=[fA,gA,yA,kA,NA,sA,aT,iT,nA,$A,eT];function hT(e,t){var r,n=[],a=JN(e,(r=n,function(e,t,n){if(void 0!==e&&zr(e))return e;if(Kr(t))for(var a=0;a<n;a+=1)r.push({value:t,index:r.length});return t}),QN,t);if(null==a)return ra;if(zr(a))return a;var i=e.mathpack,o=n.sort((function(e,t){return i.cond2(e.value,t.value)})),u=1,s=0,c=1/0,l=[];function d(e){u=1,c=e.index}var f,h,v,p=function(e){var t=e.value;u>s?(s=u,l.length=0,l.push({value:t,index:c})):u===s&&l.push({value:t,index:c})};d(o[0]);for(var m=1;m<o.length;m+=1)h=o[m-1],v=o[m],0===i.cond2(h.value,v.value)?((f=o[m]).index<c&&(c=f.index),u+=1):(p(o[m-1]),d(o[m]));return p(o[o.length-1]),s<2?ra:(x("calc.funcs.modeInner: unexpected error",0!==l.length),l.sort((function(e,t){return e.index-t.index})))}function vT(e,t){var r=hT(e,t);return Array.isArray(r)?r[0].value:r}function pT(e,t){return vT(e,t)}var mT=ze(te(te({},Ke(!1)),{wsfNode:function(e){return e===la.SUBTOTAL||e===la.AGGREGATE}}),(function(e,t){return e||t}));function gT(e){return gb(e)?mb(e.arrays.map((function(e){return e.map((function(e){var t,r=e[0],n=e[1];return void 0!==n&&(t=n.formula,dt(mT,t))?void 0:r}))}))):e}var ST=ie(fT,[YA,vT]),yT=[UA,xA,WA,HA,VA,KA];function bT(e,t){return ET(e,t,!1)}function ET(e,t,r){var n=t[0],a=t[1],i=t[2],o=(void 0===i?va:i).value?1:-1,u=0,s=0,c=e.mathpack,l=JN(e,(function(e,t,r){if(void 0!==e)return e;if(zr(t))return t;var a=c.cond2(n,zm(t));0===a?u+=r:a===o&&(s+=r)}),QN,e.dereferenceAllOpers([a]));if(void 0!==l)return l;if(0===u)return ra;var d=c.fromNumber(s+1);if(r){var f=c.div(c.fromNumber(u-1),c.fromNumber(2));return c.add(d,zm(f))}return d}function FT(e){return function(t,r){var n=e(t,r);return(null==n?void 0:n.kind)===bt.Number?t.mathpack.abs(n):n}}function CT(e,t,r){var n=cA(QN,void 0,!0,ta,t,r);if(!Array.isArray(n))return n;var a=n[0],i=n[1],o=JN(t,ZN(t.mathpack.add),e(function(e,t){return function(r,n){var a=e(r,n);return(null==a?void 0:a.kind)===bt.Number?r.mathpack.sub(a,t):a}}(QN,a)),r);return x("calc.funcs.sumDevAndCount",void 0!==o),zr(o)?o:[zm(o),i]}function RT(e,t,r){var n=r[0],a=t.datepack,i=t.config,o=a.fromNum(i,n,uo.RoundSec);return!1===o?ta:t.mathpack.fromNumber(e(o))}var kT=RT.bind(void 0,(function(e){return e.yr})),NT=RT.bind(void 0,(function(e){return e.mon})),AT=RT.bind(void 0,(function(e){return e.dom})),TT=RT.bind(void 0,(function(e){return e.hour})),IT=RT.bind(void 0,(function(e){return e.min})),OT=RT.bind(void 0,(function(e){return e.sec}));function MT(e,t,r){var n=t[0],a=t[1];void 0===r&&(r=!1);var i,o=e.config,u=e.mathpack,s=e.datepack.fromNum(te(te({},o),{date1904:o.date1904&&!r}),n,uo.RoundSec);if(!1===s)return ta;switch(void 0!==a?u.sfix(a):1){case 1:case 17:i=s.wdy;break;case 2:case 11:i=1===s.wdy?7:s.wdy-1;break;case 3:i=1===s.wdy?6:s.wdy-2;break;case 12:i=(s.wdy+4)%7+1;break;case 13:i=(s.wdy+3)%7+1;break;case 14:i=(s.wdy+2)%7+1;break;case 15:i=(s.wdy+1)%7+1;break;case 16:i=s.wdy%7+1;break;default:return ta}return u.fromNumber(i)}function wT(e,t,r){if(!t){var n=e.lfix(r);if(0===n||1===n)return e.fromNumber(52)}return ta}function DT(e,t,r){var n=r[0],a=r[1],i=$m(t,n);if(zr(i))return i;var o=function(e,t,r){if(void 0===t||Xr(t))return[r?2:1,r];var n=Zm(e,t);if(!zr(n)){var a=e.mathpack.sfix(n);if(r){if(1===a||2===a)return[a,r]}else{if(1===a||2===a)return[a,r];if(a>=11&&a<=16)return[a-9,r];if(17===a)return[1,r];if(21===a)return[2,!0]}}return[void 0,r]}(t,a,e),u=o[0],s=o[1];if(void 0===u)return ta;var c=t.mathpack,l=t.datepack,d=t.config,f=te(te({},d),{date1904:!1}),h=l.fromNum(f,i,uo.RoundSec);if(!1===h)return wT(c,f.dateCompatibility,i);var v=so(h.yr,1,1,0,0,0,0,0,uo.RoundSec),p=l.toNum(f,v);if(zr(p))return wT(c,f.dateCompatibility,i);var m=MT(t,[p],!0);if(zr(m))return m;var g=zm(c.add(zm(c.sub(m,c.fromNumber(u))),c.fromNumber(7))),S=zm(tg(c,g,c.fromNumber(7))),y=zm(c.add(c.floor(zm(c.div(zm(c.add(zm(c.sub(i,p)),S)),c.fromNumber(7)))),c.one));return s?function(e,t,r,n){var a=e.mathpack,i=e.datepack,o=e.config,u=te({},n),s=(t+6-u.wdy)%7;if(12===u.mon&&u.dom+s>=35)return a.one;u.dom=4,u.mon=1;var c=i.toDays(o,u);if(x("calc.funcs.weeknumISOAmendments",!1!==c),((c=(c-1)%7+1)-t+7)%7<3){var l=zm(a.sub(r,a.one));if(0===a.cond(l)){var d=u.yr-1;return t===c||d%4==0&&(d%100!=0||d%400==0)&&(t-c+7)%7==6?a.fromNumber(53):a.fromNumber(52)}return l}return r}(t,u,y,h):y}var _T=DT.bind(void 0,!0),LT=DT.bind(void 0,!1);var UT;function xT(e,t){var r;if(Yr(t)){var n=t.value.replace(/^\s+/,"");if(zr(r=e.coerceOper(zn(n),bt.Number)))return r}else r=t;return $m(e,r)}function BT(e,t,r){return r?zm(e.sub(t,e.fromNumber(1462))):t}function WT(e,t){return 0!=(e>>t%7&1)}function PT(e){switch(e){case 1:return UT.Saturday|UT.Sunday;case 2:return UT.Sunday|UT.Monday;case 3:return UT.Monday|UT.Tuesday;case 4:return UT.Tuesday|UT.Wednesday;case 5:return UT.Wednesday|UT.Thursday;case 6:return UT.Thursday|UT.Friday;case 7:return UT.Friday|UT.Saturday;case 11:return UT.Sunday;case 12:return UT.Monday;case 13:return UT.Tuesday;case 14:return UT.Wednesday;case 15:return UT.Thursday;case 16:return UT.Friday;case 17:return UT.Saturday;default:return!1}}function VT(e){if(7!==e.length)return!1;for(var t=UT.None,r=0;r<e.length;r+=1)if("1"===e[r])t|=1<<(r+2)%7;else if("0"!==e[r])return!1;return t}function GT(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=UT.Saturday|UT.Sunday,u=$m(e,r);if(zr(u))return u;var s=Zm(e,n);if(zr(s))return s;var c=e.mathpack,l=e.config;s=c.floor(s);var d=c.cond(s)>0?c.one:c.fromNumber(-1),f=c.abs(s);if(!eg(e,zm(c.add(u,s))))return ta;if(0===c.cond(f))return BT(c,u,l.date1904);var h=null,v=[];if(a){if(!Xr(a)){if(Kr(a)){var p=PT(c.lfix(a));if(!1===p)return ta;o=p}else{if(!Yr(a))return ta;var m=VT(a.value);if(!1===m)return Zn;o=m}if(127===o)return Zn}if(i&&!Xr(i)){var g=function e(t,r){switch(r.kind){case bt.Number:return q(new Tm(1,1,1,1,[[r]],fa));case bt.String:var n=t.coerceOper(r,bt.Number);return zr(n)?Q(Zn):q(new Tm(1,1,1,1,[[n]],fa));case bt.Blank:return q(new Tm(1,1,1,1,[[t.mathpack.zero]],fa));case bt.Missing:return Q(ra);case bt.Error:return Q(r);case bt.Range:return e(t,Gm(t,r,!1));case bt.Array:return q(new Tm(r.rows,r.cols,r.rows,r.cols,r.opers,fa));default:return Q(Zn)}}(e,i);if(!X(g))return g.reason;h=g.value}}for(var S=null==h?[]:function(e){for(var t=[],r=e.getSparse(),n=e.cols-e.denseCols,a=0;a<e.denseRows;a+=1){for(var i=0;i<e.denseCols;i+=1){var o=e.get(a,i);void 0!==o&&t.push(o)}if(n>0&&void 0!==r)for(var u=0;u<n;u+=1)t.push(r)}var s=(e.rows-e.denseRows)*e.cols;if(s>0&&void 0!==r)for(a=0;a<s;a+=1)t.push(r);return t}(h),y=S.length-1;y>=0;y-=1){var b=S[y];switch(b.kind){case bt.Number:case bt.String:case bt.Blank:var E=$m(e,b);if(zr(E))return E;v[y]=E;break;case bt.Error:return b;default:return Zn}}for(;c.cond(f)>0;){if(u=zm(c.add(u,d)),!WT(o,c.lfix(u))){var F=!0;for(y=0;y<S.length;y+=1)if(0===c.cond2(v[y],u)){F=!1;break}F&&(f=zm(c.sub(f,c.one)))}}return eg(e,u=BT(c,u,l.date1904))?u:ta}!function(e){e[e.None=0]="None",e[e.Saturday=1]="Saturday",e[e.Sunday=2]="Sunday",e[e.Monday=4]="Monday",e[e.Tuesday=8]="Tuesday",e[e.Wednesday=16]="Wednesday",e[e.Thursday=32]="Thursday",e[e.Friday=64]="Friday"}(UT||(UT={}));function HT(e,t,r,n){var a=e.mathpack,i=e.datepack,o=e.config,u=te(te({},o),{date1904:!1}),s=i.fromNum(u,t,uo.RoundSec);if(!1===s)return s;var c=a.fromNumber(s.dom),l=a.fromNumber(s.mon),d=a.fromNumber(12),f=a.fromNumber(s.yr);if(a.cond(r)>=0){f=zm(a.add(a.floor(zm(a.div(r,d))),f));var h=zm(tg(a,r,d)),v=zm(a.add(h,l));1===a.cond2(v,d)&&(f=zm(a.add(f,a.one))),l=zm(tg(a,v,d))}else{var p=a.neg(r),m=a.floor(zm(a.div(p,d)));f=zm(a.sub(f,m));h=zm(tg(a,p,d));if(a.cond2(h,l)>=0)f=zm(a.sub(f,a.one)),l=zm(a.add(zm(a.sub(l,h)),d));else{var g=zm(a.sub(l,h));l=zm(tg(a,g,d))}}0===a.cond(l)&&(l=d);var S=a.lfix(l);switch(S){case 4:case 6:case 9:case 11:var y=a.fromNumber(30);a.cond2(c,y)>0&&(c=y);break;case 2:a.cond2(c,a.fromNumber(28))>0&&(c=a.fromNumber(i.daysPerMonth(2,a.toNumber(f),!1)))}if(n&&(c=a.fromNumber(i.daysPerMonth(S,a.toNumber(f),!1))),a.lfix(f)<(u.dateCompatibility?1900:-9999))return!1;var b=function(e,t,r,n,a,i){var o=e.lfix(n),u=e.lfix(a),s=e.lfix(i);return t.toNum(r,so(s,u,o,0,0,0,0,0,uo.RoundSec))}(a,i,u,c,l,f);return!zr(b)&&b}function jT(e,t,r){var n=r[0],a=r[1],i=$m(t,n);if(zr(i))return i;var o=Zm(t,a);if(zr(o))return o;var u=t.mathpack,s=t.config,c=HT(t,i,o=u.cond(o)>0?u.floor(o):u.ceil(o),!e);return!1===c?ta:BT(u,c,s.date1904)}var KT,YT=jT.bind(void 0,!0),qT=jT.bind(void 0,!1);function zT(e,t){var r,n=t[0],a=t[1],i=t[2],o=t[3],u=e.mathpack,s=UT.Saturday|UT.Sunday,c=5;function l(e){c=7;for(var t=s=e;0!==t;)1==(1&t)&&(c-=1),t>>=1}if(void 0!==i&&!Xr(i))if(Yr(i)){var d=VT(i.value);if(!1===d)return Zn;l(d)}else{var f=Zm(e,i);if(zr(f))return Zn;var h=PT(u.lfix(f));if(!1===h)return ta;l(h)}var v=null!=o?o:da,p=$m(e,n);if(zr(p))return p;var m=$m(e,a);if(zr(m))return m;var g,S=u.lfix(p),y=u.lfix(m);S>y?(g=S,S=y,y=g,r=-1):r=1,g=S%7,g=y%7;for(var b=0,E=S<y?S:y,F=S<y?y:S;E%7!=0&&E!==F;)WT(s,E)||(b+=1),E+=1;for(;F%7!=6&&E!==F;)WT(s,F)||(b+=1),F-=1;if(F===E&&1!=(s>>E%7&1)&&(b+=1),S>y){var C=E;E=F,F=C}var R=u.fromNumber(c*Math.floor((F+1-E)/7)+b);switch(v.kind){case bt.Number:case bt.String:var k=$m(e,v);if(zr(k))return k;(g=u.lfix(k))>=S&&g<=y&&g%7>=2&&(R=zm(u.sub(R,u.one)));break;case bt.Range:case bt.Array:var N=function(e,t,r,n,a,i){var o,u=e.mathpack;if(void 0===i||Xr(i))o=UT.Saturday|UT.Sunday;else if(Yr(i)){var s=VT(i.value);if(!1===s)return Zn;o=s}else{var c=Zm(e,i);if(zr(c))return Zn;var l=PT(u.lfix(c));if(!1===l)return ta;o=l}var d=u.fromNumber(r),f=u.fromNumber(n),h=e.dereferenceOper(a,bt.Array);if(!Qr(h))return Zn;var v=[];function p(e){if(u.cond2(e,d)>=0&&u.cond2(e,f)<=0){var t=u.lfix(e);WT(o,t)||v.push(e)}}for(var m=0;m<h.rows;m+=1)for(var g=0;g<h.cols;g+=1){var S=h.opers[m][g];switch(S.kind){case bt.Number:case bt.String:var y=$m(e,S);if(zr(y))return y;p(y);break;case bt.Blank:break;case bt.Error:return S;default:return Zn}}var b=t;if(0!==v.length){var E=v.sort((function(e,t){return u.cond2(e,t)})),F=E[0];b=zm(u.sub(b,u.one));for(m=0;m<E.length;m+=1){var C=E[m];0!==u.cond2(C,F)&&(F=C,b=zm(u.sub(b,u.one)))}}return b}(e,R,S,y,v,i);if(zr(N))return N;R=N;break;case bt.Error:return v;case bt.Missing:break;default:return Zn}return u.mul(u.fromNumber(r),R)}function JT(e,t,r,n,a,i,o){var u=360*(r-t),s=30*(a-n);return e.mathpack.fromNumber(o-i+s+u)}function QT(e,t,r,n){var a=e.datepack,i=e.config;return t===a.daysPerMonth(r,n,i.dateCompatibility)}function XT(e,t,r,n,a){var i=e.mathpack;switch(i.cond2(t,r)){case 1:break;case 0:return i.zero;case-1:switch(n){case KT.Basis30360:return function(e,t,r,n,a){var i=e.datepack,o=e.config,u=i.fromNum(o,t,uo.RoundSec);if(!1===u)return!1;var s=u.dom,c=u.mon,l=u.yr,d=i.fromNum(o,r,uo.RoundSec);if(!1===d)return!1;var f=d.dom,h=d.mon,v=d.yr;return 2===f&&QT(e,f,h,v)&&(2===s&&QT(e,s,c,l)||3===n)&&(f=30),31===f&&(s>=30||3===n)&&(f=30),31===s&&(s=30),a&&2===c&&QT(e,s,c,l)&&(s=30),JT(e,l,v,c,h,s,f)}(e,t,r,a,!0);case KT.BasisActual360:case KT.BasisActual365:case KT.BasisActual:return zm(i.sub(r,t));case KT.BasisE30360:return function(e,t,r){var n=e.datepack,a=e.config,i=n.fromNum(a,t,uo.RoundSec);if(!1===i)return!1;var o=i.dom,u=i.mon,s=i.yr,c=n.fromNum(a,r,uo.RoundSec);if(!1===c)return!1;var l=c.dom,d=c.mon;return 31===o&&(o=30),31===l&&(l=30),JT(e,s,c.yr,u,d,o,l)}(e,t,r)}}return!1}function ZT(e,t){var r=t[0],n=t[1],a=void 0===n||Xr(n)?e.mathpack.zero:Zm(e,n);if(zr(a))return a;var i=Zm(e,r);return zr(i)?i:[i,a]}function $T(e,t){if(Jr(t)){if(hr(t.sheets)){var r=sa(t.sheets,[Mr(t.ranges[0])]);return e.dereferenceOper(r,Wm)}return Zn}return t}function eI(e,t,r){var n=Gm(e,t,!0);return n instanceof Nb?void 0!==r&&n.arity!==r?ra:n:zr(n)?n:$n}function tI(e,t){var r=t[0],n=t.slice(1),a=eI(e,r,n.length);return zr(a)?a:e.applyLambda(a,n)}function rI(e,t){var r=t[0],n=t[1],a=t[2],i=eI(e,a,2);if(zr(i))return i;var o=e.mathpack,u=o.fix(r),s=o.fix(n);if(u<1||s<1)return Zn;if(u*s>1e6)return Jy(un(["ARRAY.MAKE with very large size"]));var c=[va,va];return _m(new Um(e,u,s,(function(t,r){var n=e.mathpack;return c[0]=n.fromNumber(t+1),c[1]=n.fromNumber(r+1),e.applyLambda(i,c)})))}function nI(e,t){var r=Gm(e,t[0],!0);return r instanceof Nb?e.mathpack.fromNumber(r.arity):ra}!function(e){e[e.DefaultBasis=0]="DefaultBasis",e[e.Basis30360=0]="Basis30360",e[e.BasisActual=1]="BasisActual",e[e.BasisActual360=2]="BasisActual360",e[e.BasisActual365=3]="BasisActual365",e[e.BasisE30360=4]="BasisE30360"}(KT||(KT={}));var aI=Hm(Da(la.IFS)),iI=Hm(Da(la.SWITCH));function oI(e,t,r,n){var a=n.slice();return e.dereferenceOpers(a,t),Km(e,t,(function(n){for(var a=[],i=0;i<n.length;i+=1){var o=Gr(t,i,n.length);a[i]=e.coerceOper(n[i],o)}return r(e,a)}),a)}var uI=function(e){return e<0?pa.Lt:e>0?pa.Gt:pa.Eq};function sI(e,t,r){void 0===r&&(r=!1);var n,a=e.config,i=a.localeInfo,o=a.mathpack;switch(t.kind){case bt.Number:n=function(e){return{correctType:!0,sgnT:(r=o,n=e,a=t,uI(r.cond2(n,a)))};var r,n,a};break;case bt.String:if(r){var u=new HN(i,t.value);n=function(e){return{correctType:!0,sgnT:u.test(e.value)?pa.Eq:pa.Ne}}}else n=function(e){return{correctType:!0,sgnT:uI(i.stringCompareCI(e.value,t.value))}};break;case bt.Boolean:n=function(e){return{correctType:!0,sgnT:(r=e.value,n=t.value,uI(r-n))};var r,n};break;case bt.Rich:return Jy(un(["lookup with rich value condition"]));default:return L("calc.funcs.makeLookupComparer",t)}return function(e){var r=$r(e)?e.getFallback():e;return t.kind!==r.kind?{correctType:!1,sgnT:pa.Ne}:n(r)}}function cI(e,t,r){for(var n=!1,a=r.length-1,i=Math.floor((0+a)/2),o=0,u=a,s=sI(e,t);;){var c=s(r.get(i)).sgnT;if(c===pa.Ne){if(i<u)for(var l=i+1;l<=u;l+=1)if((c=s(r.get(l)).sgnT)!==pa.Ne){i=l;break}c===pa.Ne&&(i=Math.floor((o+u)/2),c=pa.Gt)}if(c===pa.Eq){if(i<a){n=!0,o=i+=1,u=i;continue}return i}if(c===pa.Lt?o=i+1:u=i-1,!(o<=u)){if(n)i-=1;else if(c===pa.Gt&&(i-=1)>=0){o=i,u=i;continue}return i}i=Math.floor((o+u)/2)}}function lI(e,t,r,n){for(var a=-1,i=sI(e,t,n===pa.Eq),o=0;o<r.length;o+=1){var u=i(r.get(o)),s=u.correctType,c=u.sgnT;if(s){if(c===pa.Eq)return o;if(c!==pa.Ne&&c===n)return a;a=o}o===r.denseLength&&(o=ye(o,r.length-2))}return n!==pa.Eq?a:r.length}function dI(e){switch(e.kind){case bt.Number:return ra;case bt.Range:return hr(e.sheets)?e.ranges.length>1?ra:e:Zn;case bt.Array:return e}}function fI(e,t){var r;switch(t.kind){case bt.Number:return t;case vb.RangeValues:r=t.arrays[0].get(0,0);break;case bt.Array:r=t.opers[0][0];break;default:return L("calc.funcs.lookupFuncs.getNumFromRef",t)}return zr(r=e.coerceOper(r,bt.Number))?$n:r}function hI(e){switch(e.kind){case bt.Number:case bt.Rich:return ra;case bt.Range:if(!hr(e.sheets))return Zn;if(e.ranges.length>1)return ra;var t=e.ranges[0];return 1!==t.rows&&1!==t.cols?ra:e;case bt.Array:return 1!==e.rows&&1!==e.cols?ra:e}}function vI(e){switch(e.kind){case vb.RangeValues:return e.arrays[0];case bt.Array:return new Tm(e.rows,e.cols,e.rows,e.cols,e.opers,fa)}}function pI(e,t){switch(t.kind){case bt.Range:var r=t.sheets,n=t.ranges[0];return new Om(n.rows,n.cols,n.rows,n.cols,(function(t,a){var i=Dn(n.row+t,n.col+a);return e.dereferenceAllOpers([sa(r,[i])])[0].arrays[0].get(0,0)}),(function(){return U("calc.funcs.lookupFuncs: rangeOrArrayOperToLazyArray2D")}));case bt.Array:return new Tm(t.rows,t.cols,t.rows,t.cols,t.opers,fa)}}function mI(e){if(Jr(e)){var t=e.ranges[0];return t.cols>t.rows}return e.cols>e.rows}function gI(e,t,r){var n=t[0],a=t[1],i=t[2],o=t[3],u=void 0===o?ha:o,s=dI(a);if(zr(s))return s;var c=yI(s,r),l=SI(vI(e.dereferenceAllOpers([c])[0]),r),d=!u.value?lI(e,n,l,pa.Eq):cI(e,n,l);if(d<0||d>=l.length)return ra;var f=function(e,t){switch(t.kind){case bt.Number:return t;case bt.Range:if(!hr(t.sheets))return Zn;if(t.ranges.length>1)return $n;var r=t.ranges;return e.calcingArray?Jy(un(["HLOOKUP/VLOOKUP ref argument 3 in array formula"])):r[0].rows>1||r[0].cols>1?Jy(un(["HLOOKUP/VLOOKUP non-singleton ref argument 3"])):t;case bt.Array:return Jy(un(["HLOOKUP/VLOOKUP array argument 3"]))}}(e,i);if(zr(f))return f;var h=e.dereferenceAllOpers([f])[0],v=fI(e,h);if(zr(v))return v;var p=e.mathpack.sfix(v)-1,m=pI(e,s);return p<0?Zn:p>=(r?m.rows:m.cols)?$n:r?m.get(p,d):m.get(d,p)}function SI(e,t){var r=e.getSparse.bind(e);return t?{length:e.cols,denseLength:e.denseCols,get:function(t){return e.get(0,t)},getSparse:r}:{length:e.rows,denseLength:e.denseRows,get:function(t){return e.get(t,0)},getSparse:r}}function yI(e,t){if(Jr(e)){var r=e.ranges[0],n=wn(r.row,r.col,t?1:r.rows,t?r.cols:1);return sa(e.sheets,[n])}return e}var bI=Ym((function(e){return e.mathpack.sqrt})),EI=Ym((function(e){return e.mathpack.exp})),FI=qm((function(e){return e.mathpack.power})),CI=Ym((function(e){return e.mathpack.ln})),RI=Ym((function(e){return e.mathpack.log}));var kI=Ym((function(e){return e.mathpack.sin})),NI=Ym((function(e){return e.mathpack.cos})),AI=Ym((function(e){return e.mathpack.tan})),TI=Ym((function(e){return e.mathpack.asin})),II=Ym((function(e){return e.mathpack.acos})),OI=Ym((function(e){return e.mathpack.atan})),MI=qm((function(e){return e.mathpack.atan2}));var wI=qm((function(e){return e.mathpack.round}));var DI=qm((function(e){return e.mathpack.roundUp})),_I=qm((function(e){return e.mathpack.roundDown}));function LI(e,t,r){var n=e.cond(t),a=e.cond(r);if(n>0&&a<0)return ta;if(0===n||0===a)return e.zero;var i=e.div(t,r);return zr(i)?i:e.mul(e.ceil(e.viewRound(i)),r)}function UI(e,t,r){var n=e.cond(t),a=e.cond(r);if(n>0&&a<0)return ta;if(0===n&&0===a)return t;var i=e.div(t,r);return zr(i)?i:e.mul(e.floor(e.viewRound(i)),r)}function xI(e,t){var r=t[0],n=t[1];return LI(e.mathpack,r,n)}function BI(e,t){var r=t[0],n=t[1],a=e.mathpack,i=void 0===n||Xr(n)?a.one:a.abs(n);return 0===a.cond(i)?a.zero:LI(a,r,i)}function WI(e,t,r){var n=r[0],a=t.mathpack;if(a.cond(n)>=0){var i=a.ceil(n);return 0===a.cond2(zm(tg(a,i,a.fromNumber(2))),a.one)===e?a.add(i,a.one):i}var o=a.floor(n);return 0===a.cond2(zm(tg(a,o,a.fromNumber(2))),a.one)===e?a.sub(o,a.one):o}var PI=WI.bind(void 0,!0),VI=WI.bind(void 0,!1),GI=Ym((function(e){return e.mathpack.abs}));function HI(e,t,r,n){if(void 0===r||Xr(r))return{formatValue:t,formatDecimals:null!=n?n:2};var a=e.config.mathpack;if(a.cond(r)<0){var i=wI(e,[t,r]);return x("calc.funcs.fixedDollarRound",Kr(i)||zr(i)),{formatValue:i,formatDecimals:0}}var o=a.sfix(r);return o<0||o>127?{formatValue:Zn,formatDecimals:0}:{formatValue:t,formatDecimals:o}}function jI(e){for(var t=0;t<e.length&&32===e.charCodeAt(t);)t+=1;return e.substring(t)}function KI(e,t){var r;return Yr(t)?t.value.length>255?Zn:null!==(r=e.parseDate(jI(t.value)))&&void 0!==r?r:Zn:Zn}function YI(e,t){return qn(Gm(e,t[0],!0)instanceof Nb)}function qI(e,t){var r=Zm(e,t[0]);if(zr(r))return r;var n=e.mathpack,a=zm(n.add(n.abs(r),n.fromNumber(1.0000000000000003e-10))),i=zm(n.div(n.floor(a),n.fromNumber(2)));return qn(0===n.cond2(i,n.floor(i)))}function zI(e,t,r){if(!hr(t.sheets))return Zn;var n=t.ranges[0];if(e.calcingArray||!pr(n)){var a=t.sheets;return ua(n.rows,n.cols,Mm(n.rows,n.cols,(function(t,i){var o=Wn(a,Dn(n.row+t,n.col+i));return r(e.getCellFormula(o),o)})))}var i=wr(Bn(t.sheets,n));return r(e.getCellFormula(i),i)}function JI(e,t){if(!t)return[e.reflectionGridCell,!e.calcingArray];if(!hr(t.sheets))return Zn;if(t.ranges.length>1)return $n;var r=t.ranges[0];return[r,pr(r)]}function QI(e,t){var r=t[0],n=t[1].value;if($r(r)){var a=r.getField(n);if(void 0!==a)return a}return aa}function XI(e,t){for(var r=t[0],n=e.config.localeInfo,a=Ds.create(n.stringCompareCI),i=1;i<t.length;i+=2){var o=t[i].value,u=t[i+1];a=a.setValue(o,u)}return new kb(a,r)}function ZI(e,t){return void 0===t?1:e.cond(t)<0?Zn:e.sfix(t)}function $I(e){return e>=65&&e<=90||e>=97&&e<=122}function eO(e,t,r){return""===e?e:function(e){for(var t=0;t<e.length;t+=1)if(e.charCodeAt(t)>=128)return!1;return!0}(e)?r():Jy(un([t+" for non-ASCII input"]))}var tO={};tO[la.SUM]=function(e,t){var r=e.dereferenceAllOpers(t);return nA(e,r)},tO[la.PRODUCT]=function(e,t){var r=e.dereferenceAllOpers(t);return sA(e,r)},tO[la.AVERAGE]=function(e,t){var r=e.dereferenceAllOpers(t);return fA(e,r)},tO[la.COUNTBLANK]=function(e,t){var r=t[0];if(!hr(r.sheets)||1!==r.ranges.length)return Zn;var n=e.dereferenceAllOpers(t);return SA(e,n)},tO[la.MAX]=function(e,t){var r=e.dereferenceAllOpers(t);return kA(e,r)},tO[la.MIN]=function(e,t){var r=e.dereferenceAllOpers(t);return NA(e,r)},tO[la.AND]=function(e,t){var r=e.dereferenceAllOpers(t);return MA(e,r)},tO[la.COUNTA]=function(e,t){var r=e.dereferenceAllOpers(t);return yA(e,r)},tO[la.OR]=function(e,t){var r=e.dereferenceAllOpers(t);return wA(e,r)},tO[la.CONCAT]=function(e,t){var r=e.dereferenceAllOpers(t);return pA(e,[],!0,t,r)},tO[la.AVERAGEIF]=vA,tO[la.AVERAGEIFS]=function(e,t){if(3===t.length)return vA(e,[t[1],t[2],t[0]]);var r=uA(e,t,void 0,!0);return X(r)?dA(e,[r.value]):r.reason},tO[la.COUNT]=function(e,t){var r=e.dereferenceAllOpers(t);return gA(e,r)},tO[la.COUNTIF]=EA,tO[la.COUNTIFS]=function(e,t){if(2===t.length)return EA(e,t);var r=uA(e,t,!0);return X(r)?bA(e,[r.value]):r.reason},tO[la.MEDIAN]=function(e,t){var r=e.dereferenceAllOpers(t);return YA(e,r)},tO[la.SUMSQ]=function(e,t){var r=e.dereferenceAllOpers(t),n=qA(QN),a=JN(e,ZN(e.mathpack.add),n,r);return null==a?e.mathpack.zero:a},tO[la.SUMIF]=oA,tO[la.SUMIFS]=function(e,t){if(3===t.length)return oA(e,[t[1],t[2],t[0]]);var r=uA(e,t);return X(r)?rA(e,[r.value]):r.reason},tO[la.LARGE]=function(e,t){var r=e.dereferenceAllOpers(t),n=r[0],a=r[1];return UA(e,n,a)},tO[la.SMALL]=function(e,t){var r=e.dereferenceAllOpers(t),n=r[0],a=r[1];return xA(e,n,a)},tO[la.RANK]=bT,tO[la.RANK_EQ]=bT,tO[la.RANK_AVG]=function(e,t){return ET(e,t,!0)},tO[la.PERCENTILE]=PA,tO[la.PERCENTILE_INC]=PA,tO[la.PERCENTILE_EXC]=function(e,t){var r=e.dereferenceAllOpers(t),n=r[0],a=r[1];return VA(e,n,a)},tO[la.QUARTILE]=jA,tO[la.QUARTILE_INC]=jA,tO[la.QUARTILE_EXC]=function(e,t){var r=e.dereferenceAllOpers(t),n=r[0],a=r[1];return KA(e,n,a)},tO[la.TRIMMEAN]=function(e,t){var r=e.dereferenceAllOpers(t),n=r[0],a=r[1],i=[],o=JN(e,_A(i,zm),QN,[n]);if(null==o)return ta;if(zr(o))return o;var u=e.mathpack;if(u.cond(a)<0)return ta;if(u.cond2(a,u.one)>=0)return ta;i=i.sort(u.cond2);var s=u.lfix(zm(u.div(zm(u.mul(u.fromNumber(i.length),a)),u.fromNumber(2))));x("calc.funcs.trimmean",s+s<i.length);var c=i[s],l=i[i.length-1-s],d=0,f=0,h=JN(e,ZN(e.mathpack.add),(function(e,t){var r=QN(0,t);if(void 0===r)return r;x("calc.funcs.trimmean: unexpected error",Kr(r));var n=e.mathpack;if(n.cond2(r,c)<0)d+=1;else{if(!(n.cond2(r,l)>0))return r;f+=1}}),[n]);x("calc.funcs.trimmean: found no elements",void 0!==h&&Kr(h)),x("calc.funcs.trimmean: trimmed too many",d<=s&&f<=s);for(var v=h;d<s;d+=1){if(zr(p=u.sub(v,c)))return p;v=p}for(;f<s;f+=1){var p;if(zr(p=u.sub(v,l)))return p;v=p}return u.div(v,u.fromNumber(i.length-s-s))},tO[la.AVERAGEA]=function(e,t){var r=e.dereferenceAllOpers(t);return hA(e,r)},tO[la.MAXA]=function(e,t){var r=e.dereferenceAllOpers(t);return AA(e,r)},tO[la.MINA]=function(e,t){var r=e.dereferenceAllOpers(t);return TA(e,r)},tO[la.MAXIFS]=function(e,t){var r=uA(e,t);return X(r)?kA(e,[r.value]):r.reason},tO[la.MINIFS]=function(e,t){var r=uA(e,t);return X(r)?NA(e,[r.value]):r.reason},tO[la.XOR]=function(e,t){var r=e.dereferenceAllOpers(t);return DA(e,r)},tO[la.AGGREGATE]=function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=t.slice(4),u=e.mathpack,s=u.sfix(r),c=u.sfix(n);if(!(s>=1&&s<=ST.length+yT.length&&c>=0&&c<=7))return Zn;var l=1==(1&c),d=2==(2&c),f=!(4==(4&c));function h(t){var r=f?e.dereferenceAllOpersAndFormulae(t,l).map(gT):e.dereferenceAllOpers(t,l);return d&&(r=r.map((function(e){if(function(e){var t=e.kind;return"number"==typeof t&&0!=(t&zN)}(e))return e;if(gb(e))return mb(e.arrays.map((function(e){return e.map((function(e){return void 0===e||zr(e)?void 0:e}))})));if(function(e){return e.kind===bt.Array}(e)){var t=e.opers.map((function(e){return e.map((function(e){return void 0===e||zr(e)?void 0:e}))}));return function(e,t,r){return W("calc.runtime.coercedArrayOper",e),W("calc.runtime.coercedArrayOper",t),r.length!==e?U("calc.runtime.coercedArrayOper: Inconsistent row number"):{kind:bt.Array,rows:e,cols:t,opers:r}}(e.rows,e.cols,t)}return e}))),r}if(s>ST.length){if(void 0===i||o.length>0)return Zn;var v=bt.Number,p=e.coerceOper(e.dereferenceOper(i,v),v);if(zr(p))return Zn;if(Jr(a)&&!hr(a.sheets))return Zn;var m=h([a])[0],g=ST.length;return(0,yT[s-g-1])(e,m,p)}for(var S=2;S<t.length;S+=1){var y=t[S];if(!y||!Jr(y)||!hr(y.sheets))return Zn}var b=h(t.slice(2));return x("calc.funcs.aggregate: requested non-array function with unexpected number",s>=1&&s<=ST.length),(0,ST[s-1])(e,b)},tO[la.SUBTOTAL]=function(e,t){var r=t[0],n=t.slice(1),a=e.mathpack.sfix(r),i=fT.length;if(!(a>=1&&a<=i||a>=101&&a<=i+100))return Zn;var o=a>100||e.isInFilterMode(n),u=e.dereferenceAllOpersAndFormulae(n,o).map(gT);return(0,fT[a%100-1])(e,u)},tO[la.VAR]=lT,tO[la.VAR_S]=lT,tO[la.VARP]=dT,tO[la.VAR_P]=dT,tO[la.STDEV]=sT,tO[la.STDEV_S]=sT,tO[la.STDEVP]=cT,tO[la.STDEV_P]=cT,tO[la.VARA]=function(e,t){var r=e.dereferenceAllOpers(t);return tT(e,r)},tO[la.VARPA]=function(e,t){var r=e.dereferenceAllOpers(t);return rT(e,r)},tO[la.STDEVA]=function(e,t){var r=e.dereferenceAllOpers(t);return oT(e,r)},tO[la.STDEVPA]=function(e,t){var r=e.dereferenceAllOpers(t);return uT(e,r)},tO[la.AVEDEV]=function(e,t){var r=e.dereferenceAllOpers(t),n=CT(FT,e,r);if(!Array.isArray(n))return n;var a=n[0],i=n[1];return e.mathpack.div(a,e.mathpack.fromNumber(i))},tO[la.DEVSQ]=function(e,t){var r=e.dereferenceAllOpers(t),n=CT(qA,e,r);return Array.isArray(n)?n[0]:n},tO[la.MODE]=pT,tO[la.MODE_SNGL]=pT,tO[la.MODE_MULT]=function(e,t){var r=hT(e,t);return Array.isArray(r)?ua(r.length,1,r.map((function(e){return[e.value]}))):r},tO[la.TEXTJOIN]=function(e,t){var r=t[0],n=t[1],a=t.slice(2),i=[];if(!Xr(r)){if(Jr(r)&&r.ranges.length>1)return Zn;var o=JN(e,_A(i,Jm),(function(e,t){return e.coerceOper(t,bt.String)}),e.dereferenceAllOpers([r]));if(void 0!==o&&zr(o))return o;x("calc.funcs.textjoin: expected string from reduce",void 0!==o&&Yr(o))}return pA(e,i,Xr(n)||n.value,a,e.dereferenceAllOpers(a))},tO[la.YEAR]=kT,tO[la.MONTH]=NT,tO[la.DAY]=AT,tO[la.HOUR]=TT,tO[la.MINUTE]=IT,tO[la.SECOND]=OT,tO[la.WEEKNUM]=LT,tO[la.ISOWEEKNUM]=_T,tO[la.WEEKDAY]=function(e,t){return MT(e,t)},tO[la.DATE]=function(e,t){var r=t[0],n=t[1],a=t[2],i=e.mathpack,o=e.datepack,u=e.config,s=i.sfix(r);if(s>9999)return ta;var c=i.sfix(n);if(c>32767||c<-32768)return ta;var l=i.sfix(a);(l>32767||l<-32768)&&(l=32767),u.dateCompatibility?s<1900&&(s+=1900):s<1900&&!(1899===s&&12===c&&l>=30)&&(s+=1900);var d=so(s,c,l,0,0,0,0,0,uo.RoundSec);return o.toNum(u,d)},tO[la.TIME]=function(e,t){var r=t[0],n=t[1],a=t[2],i=e.mathpack,o=e.datepack,u=e.config,s=i.sfix(r);if(s>32767)return ta;var c=i.sfix(n);if(c>32767)return ta;var l,d,f,h=i.sfix(a);if(h>32767)return ta;u.dateCompatibility?(l=u.date1904?1904:1900,d=1,f=u.date1904?1:0):(l=1899,d=12,f=30);var v=so(l,d,f,s,c,h,0,0,uo.RoundSec),p=o.toNum(u,v);return zr(p)?p:i.cond(p)<0?ta:i.sub(p,i.trunc(p))},tO[la.DAYS360]=function(e,t){var r,n=t[0],a=t[1],i=t[2],o=e.mathpack,u=e.datepack,s=e.config,c=null!==(r=null==i?void 0:i.value)&&void 0!==r&&r,l=u.fromNum(s,n,uo.RoundSec);if(!1===l)return ra;var d=31===l.dom||!c&&2===l.mon&&l.dom===u.daysPerMonth(2,l.yr,s.dateCompatibility)?30:l.dom,f=o.fromNumber(360*(l.yr-1900)+30*l.mon+d),h=u.fromNum(s,a,uo.RoundSec);if(!1===h)return ra;var v=31!==h.dom||!c&&30!==l.dom?h.dom:30,p=o.fromNumber(360*(h.yr-1900)+30*h.mon+v);return o.sub(p,f)},tO[la.DAYS]=function(e,t){var r=t[0],n=t[1];if(Yr(r)&&r.value.length>255||Yr(n)&&n.value.length>255)return Zn;var a=xT(e,r);if(zr(a))return a;var i=xT(e,n);return zr(i)?i:e.mathpack.sub(a,i)},tO[la.DATEDIF]=function(e,t){var r=t[0],n=t[1],a=t[2].value;if(a.length>2||0===a.length)return ta;var i=e.mathpack,o=e.datepack,u=e.config,s=i.lfix(r),c=o.fromNum(u,r,uo.RoundSec);if(!1===c)return ta;var l=e.mathpack.lfix(n),d=o.fromNum(u,n,uo.RoundSec);if(!1===d)return ta;if(s>l)return ta;var f=d.dom,h=d.mon,v=d.yr;c.dom>f&&(0===(h-=1)&&(h=12,v-=1),f+=o.daysPerMonth(h,v,u.dateCompatibility)),c.mon>h&&(h+=12,v-=1);var p=function(e,t){return 0===u.localeInfo.stringCompareCI(e,t)};if(p(a,"Y"))return i.fromNumber(v-c.yr);if(p(a,"M"))return i.fromNumber(12*(v-c.yr)+(h-c.mon));if(p(a,"D"))return i.fromNumber(l-s);if(p(a,"MD"))return i.fromNumber(f-c.dom);if(p(a,"YM"))return i.fromNumber(h-c.mon);if(p(a,"YD")){for(var m=0,g=c.mon;g<h;g+=1)m+=o.daysPerMonth(g,c.yr,u.dateCompatibility);return i.fromNumber(m+(f-c.dom))}return ta},tO[la.WORKDAY]=function(e,t){var r=t[0],n=t[1],a=t[2];return GT(e,a?[r,n,da,a]:[r,n])},tO[la.WORKDAY_INTL]=GT,tO[la.EDATE]=YT,tO[la.EOMONTH]=qT,tO[la.NETWORKDAYS]=function(e,t){var r=t[0],n=t[1],a=t[2];return zT(e,a?[r,n,da,a]:[r,n])},tO[la.NETWORKDAYS_INTL]=zT,tO[la.YEARFRAC]=function(e,t){var r=t[0],n=t[1],a=t[2],i=KT.DefaultBasis;if(void 0!==a){var o=function(e,t){var r=KT.DefaultBasis;if(void 0===t||Xr(t))return r;var n=Zm(e,t);if(zr(n))return n;var a=e.mathpack;switch(r=a.lfix(a.floor(n))){case KT.Basis30360:case KT.BasisActual:case KT.BasisActual360:case KT.BasisActual365:case KT.BasisE30360:return r;default:return ta}}(e,a);if("number"!=typeof o)return o;i=o}var u=$m(e,r);if(zr(u))return u;var s=$m(e,n);if(zr(s))return s;var c=e.mathpack;if(c.cond2(u,s)>0){var l=u;u=s,s=l}var d=XT(e,u,s,i,0);if(!1===d)return ta;var f=function(e,t,r,n){var a=e.mathpack,i=e.datepack,o=e.config,u=a.fromNumber(360),s=a.fromNumber(365),c=a.fromNumber(366);switch(t){case KT.BasisActual:var l=i.fromNum(o,r,uo.RoundSec);if(!1===l)return!1;var d=l.dom,f=l.mon,h=l.yr,v=i.fromNum(o,n,uo.RoundSec);if(!1===v)return!1;var p,m=v.dom,g=v.mon,S=v.yr,y=S-1;if(h===S)return 29===i.daysPerMonth(2,h,o.dateCompatibility)?c:s;if(y===h&&(f>g||f===g&&d>=m))return 29===i.daysPerMonth(2,h,o.dateCompatibility)?!zr(p=i.toNum(o,so(h,2,29,0,0,0,0,0,uo.RoundSec)))&&(a.cond2(p,r)>=0?c:s):29===i.daysPerMonth(2,S,o.dateCompatibility)?!zr(p=i.toNum(o,so(h,2,29,0,0,0,0,0,uo.RoundSec)))&&(a.cond2(p,n)<=0?c:s):s;for(var b=0,E=h;E<=S;E+=1)29===i.daysPerMonth(2,E,o.dateCompatibility)?b+=366:b+=365;var F=a.fromNumber(S-h+1);return zm(a.div(a.fromNumber(b),F));case KT.Basis30360:case KT.BasisActual360:case KT.BasisE30360:return u;case KT.BasisActual365:return s;default:return u}}(e,i,u,s);return!1===f?ta:c.div(d,f)},tO[la.DELTA]=function(e,t){var r=ZT(e,t);if(!Array.isArray(r))return r;var n=r[0],a=r[1],i=e.mathpack;return 0===i.cond2(n,a)?i.one:i.zero},tO[la.GESTEP]=function(e,t){var r=ZT(e,t);if(!Array.isArray(r))return r;var n=r[0],a=r[1],i=e.mathpack;return i.cond2(n,a)>=0?i.one:i.zero},tO[la.NA]=function(e,t){return ra},tO[la.T]=function(e,t){var r=$T(e,t[0]);return Yr(r)||zr(r)?r:Qm},tO[la.N]=function(e,t){var r=$T(e,t[0]);if(Kr(r)||zr(r))return r;var n=e.mathpack;return qr(r)&&r.value?n.one:n.zero},tO[la.TYPE]=function(e,t){var r=t[0],n=e.mathpack;switch(r.kind){case bt.Number:return n.fromNumber(1);case bt.String:return n.fromNumber(2);case bt.Boolean:return n.fromNumber(4);case bt.Error:return n.fromNumber(16);case bt.Array:return n.fromNumber(64);case bt.Rich:return n.fromNumber(128);default:return L("calc.funcs.type",r)}},tO[la.ERROR_TYPE]=function(e,t){var r=t[0];return zr(r)?e.mathpack.fromNumber(r.type):ra},tO[la.INFO]=function(e,t){return Zn},tO[la.IF]=function(e,t){var r=t[0];x("calc.funcs.if: condition is not a boolean",qr(r));var n=t[r.value?1:2];return x("calc.funcs.if: result is undefined",void 0!==n),n},tO[la.IFS]=function e(t,r){for(var n=0;n<r.length;n+=2){var a=r[n];if(Qr(a)){var i=r.slice(n);return oI(t,aI,e,i)}if(zr(a))return a;if(x("calc.funcs.ifs",qr(a)),a.value)return r[n+1]}return ra},tO[la.SWITCH]=function e(t,r){var n=r[0];if(Qr(n))return oI(t,iI,e,r);if(zr(n))return n;for(var a=function(e,t){var r=e.mathpack,n=e.localeInfo;switch(t.kind){case bt.Number:return function(e){return $r(e)?Jy(un(["SWITCH with a rich value case"])):Kr(e)&&0===r.compare(t,e)};case bt.String:return function(e){return $r(e)?Jy(un(["SWITCH with a rich value case"])):Yr(e)&&0===n.stringCompareCI(t.value,e.value)};case bt.Boolean:return function(e){return $r(e)?Jy(un(["SWITCH with a rich value case"])):qr(e)&&t.value===e.value};case bt.Rich:return Jy(un(["SWITCH with a rich value condition"]));default:return L("calc.funcs.makeSwitchComparer",t)}}(t.config,n),i=1;i<r.length-1;i+=2){var o=bt.Error|bt.Rich|bt.Number|bt.Boolean|bt.String|bt.Array,u=t.coerceOper(t.dereferenceOper(r[i],o),o);if(Qr(u))return oI(t,iI,e,r);if(zr(u))return u;if(a(u))return r[i+1]}return r.length%2==0?r[r.length-1]:ra},tO[la.TRUE]=function(e,t){return ha},tO[la.FALSE]=function(e,t){return va},tO[la.NOT]=function(e,t){return qn(!t[0].value)},tO[la.CHOOSE]=function(e,t){var r=t[0];x("calc.funcs.choose",Kr(r));var n=e.mathpack.fix(r);return n<1||n>t.length-1?Zn:t[n]},tO[la.INDEX]=function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=e.mathpack,u=o.sfix(n);if(u<0)return Zn;var s=void 0===a?void 0:o.sfix(a);if(void 0!==s&&s<0)return Zn;var c,l,d=void 0===i?0:o.sfix(i)-1;if(d<0)return Zn;switch(r.kind){case bt.Range:if(!hr(r.sheets))return Zn;if(d>=r.ranges.length)return $n;var f=r.ranges[d];if(void 0===s)if(1===f.rows)c=0,l=u-1;else{if(1!==f.cols)return $n;c=u-1,l=-1}else c=u-1,l=s-1;if(c>=f.rows||l>=f.cols)return $n;var h=wn(f.row+ye(c,0),f.col+ye(l,0),-1===c?f.rows:1,-1===l?f.cols:1);return sa(r.sheets,[h]);case bt.Array:return d>0?$n:(void 0===s?1===r.rows?(c=0,l=u-1):(c=u-1,l=-1):(c=u-1,l=s-1),c>=r.rows||l>=r.cols?$n:-1===c&&-1===l?r:-1===c?ua(r.rows,1,r.opers.map((function(e){return[e[l]]}))):-1===l?ua(1,r.cols,[r.opers[c]]):r.opers[c][l]);default:return L("calc.funcs.lookupFuncs: INDEX",r)}},tO[la.MATCH]=function(e,t){var r=t[0],n=t[1],a=t[2],i=void 0===a?e.mathpack.one:a,o=e.mathpack,u=function(e){switch(e.kind){case bt.Number:return e;case bt.Range:if(!hr(e.sheets))return Zn;if(e.ranges.length>1)return $n;var t=e.ranges[0];return 1!==t.rows||1!==t.cols?$n:e}}(i);if(zr(u))return u;var s=e.dereferenceAllOpers([u])[0],c=fI(e,s);if(zr(c))return c;var l=hI(n);if(zr(l))return l;var d=vI(e.dereferenceAllOpers([l])[0]),f=SI(d,1===d.rows),h=-1;return(h=o.cond(c)>0?cI(e,r,f):0===o.cond(c)?lI(e,r,f,pa.Eq):lI(e,r,f,pa.Lt))<0||h>=f.length?ra:e.mathpack.fromNumber(h+1)},tO[la.LOOKUP]=function(e,t){var r=t[0],n=t[1],a=t[2],i=dI(n);if(zr(i))return i;var o=mI(i),u=yI(i,o),s=SI(vI(e.dereferenceAllOpers([u])[0]),o),c=cI(e,r,s);if(c<0)return ra;if(void 0!==a){var l=hI(a);if(zr(l))return l;var d=mI(l),f=SI(pI(e,function(e,t,r){if(Jr(r)){var n=r.ranges[0],a=wn(n.row,n.col,Se(t?1:e,(1<<20)-n.row),Se(t?e:1,16384-n.col));return ca(r.sheets,a)}return r}(s.length,d,l)),d);return c>=f.length?Qr(l)?ra:fa:f.get(c)}var h=pI(e,i);return o?h.get(h.rows-1,c):h.get(c,h.cols-1)},tO[la.HLOOKUP]=function(e,t){return gI(e,t,!0)},tO[la.VLOOKUP]=function(e,t){return gI(e,t,!1)},tO[la.ABS]=GI,tO[la.CEILING]=xI,tO[la.ECMA_CEILING]=xI,tO[la.DEGREES]=function(e,t){var r=t[0],n=e.mathpack,a=zm(n.div(n.fromNumber(180),n.pi));return n.mul(r,a)},tO[la.FLOOR]=function(e,t){var r=t[0],n=t[1];return UI(e.mathpack,r,n)},tO[la.RADIANS]=function(e,t){var r=t[0],n=e.mathpack,a=zm(n.div(n.pi,n.fromNumber(180)));return n.mul(r,a)},tO[la.ROUND]=wI,tO[la.ROUNDUP]=DI,tO[la.ROUNDDOWN]=_I,tO[la.EVEN]=PI,tO[la.SIGN]=function(e,t){var r=t[0],n=e.mathpack;return n.fromNumber(n.cond(r))},tO[la.PI]=function(e,t){return e.mathpack.pi},tO[la.SQRT]=bI,tO[la.EXP]=EI,tO[la.POWER]=FI,tO[la.LN]=CI,tO[la.LOG10]=RI,tO[la.LOG]=function(e,t){var r=t[0],n=t[1],a=e.mathpack;if(void 0===n)return a.log(r);var i=a.ln(r);if(zr(i))return i;var o=a.ln(n);return zr(o)?o:a.div(i,o)},tO[la.SIN]=kI,tO[la.COS]=NI,tO[la.TAN]=AI,tO[la.ASIN]=TI,tO[la.ACOS]=II,tO[la.ATAN]=OI,tO[la.ATAN2]=MI,tO[la.FACT]=function(e,t){var r=t[0],n=e.mathpack,a=n.sfix(r);if(n.cond(r)<0||a>170)return ta;for(var i=n.one,o=a;o>0;o-=1){if(zr(i))return i;i=n.mul(n.fromNumber(o),i)}return i},tO[la.SQRTPI]=function(e,t){var r=Zm(e,t[0]);if(zr(r))return r;var n=e.mathpack;if(n.cond(r)<0)return ta;var a=n.mul(n.pi,r);return zr(a)?a:n.sqrt(a)},tO[la.FACTDOUBLE]=function(e,t){var r=Zm(e,t[0]);if(zr(r))return r;var n=e.mathpack,a=n.floor(r);if(n.cond2(a,n.fromNumber(-1))<0||n.cond2(a,n.fromNumber(300))>0)return ta;for(var i=n.one,o=n.toNumber(a);o>1;o-=2){if(zr(i))return i;i=n.mul(n.fromNumber(o),i)}return i},tO[la.INT]=function(e,t){var r=t[0],n=e.mathpack;return n.cond2(n.abs(r),n.fromNumber(1e15))<0&&(r=n.viewRound(r)),n.floor(r)},tO[la.TRUNC]=function(e,t){var r=t[0],n=t[1],a=void 0===n?e.mathpack.zero:n;return e.mathpack.roundDown(r,a)},tO[la.ODD]=VI,tO[la.MROUND]=function(e,t){var r=t[0],n=t[1],a=Zm(e,r);if(zr(a))return a;var i=Zm(e,n);if(zr(i))return i;var o=e.mathpack;if(0===o.cond(i))return o.zero;if(0!==o.cond(a)&&o.cond(a)<0!=o.cond(i)<0)return ta;var u=o.div(a,i);if(zr(u))return ta;var s=o.floor(u),c=zm(o.sub(u,s)),l=o.fromNumber(.5-5e-15);if(o.cond2(c,l)<0)return o.mul(s,i);var d=o.add(s,o.one);return zr(d)?d:o.mul(d,i)},tO[la.QUOTIENT]=function(e,t){var r=t[0],n=t[1],a=Zm(e,r);if(zr(a))return a;var i=Zm(e,n);if(zr(i))return i;var o=e.mathpack;if(0===o.cond(i))return Xn;var u=o.div(a,i);return zr(u)?ta:o.cond(u)>0?o.floor(u):o.ceil(u)},tO[la.FLOOR_MATH]=function(e,t){var r=t[0],n=t[1],a=t[2],i=e.mathpack,o=void 0===n||Xr(n)?i.one:i.abs(n),u=void 0===a||Xr(a)?i.zero:a;return 0!==i.cond(u)&&i.cond(r)<0&&(o=i.neg(o)),0===i.cond(o)?i.zero:UI(i,r,o)},tO[la.FLOOR_PRECISE]=function(e,t){var r=t[0],n=t[1],a=e.mathpack,i=void 0===n||Xr(n)?a.one:a.abs(n);return 0===a.cond(i)?a.zero:UI(a,r,i)},tO[la.CEILING_MATH]=function(e,t){var r=t[0],n=t[1],a=t[2],i=e.mathpack,o=void 0===n||Xr(n)?i.one:i.abs(n),u=void 0===a||Xr(a)?i.zero:a;return 0!==i.cond(u)&&i.cond(r)<0&&(o=i.neg(o)),0===i.cond(o)?i.zero:LI(i,r,o)},tO[la.CEILING_PRECISE]=BI,tO[la.ISO_CEILING]=BI,tO[la.TEXT]=function(e,t){var r,n=t[0],a=t[1].value,i=$r(n)?n.getFallback():n;if(Yr(i)&&i.value.length>255||a.length>255)return Zn;switch(i.kind){case bt.String:r=Kr(o=e.coerceOper(i,bt.Number))?o:i;break;case bt.Number:r=i;break;case bt.Boolean:var o;x("calc.funcs.text",Yr(o=e.coerceOper(i,bt.String))),r=o;break;case bt.Error:return Zn}var u=e.applyFormat(e.originSheet.document,a,r);return void 0!==u?zn(u):Zn},tO[la.FIXED]=function(e,t){var r,n,a=t[0],i=t[1],o=t[2],u=HI(e,a,i,void 0),s=u.formatValue,c=u.formatDecimals;if(zr(s))return s;n=null!==(r=null==o?void 0:o.value)&&void 0!==r&&r?0===c?Wa.NoComFixed0:2===c?Wa.NoComFixed:Tp(e.config.localeInfo,!1,1,c):0===c?Wa.Fixed0:2===c?Wa.Fixed:Tp(e.config.localeInfo,!0,4,c);var l=e.applyFormat(e.originSheet.document,n,s);return void 0!==l?zn(l):Zn},tO[la.DOLLAR]=function(e,t){var r=t[0],n=t[1],a=e.config.localeInfo,i=HI(e,r,n,a.isEastAsia?a.currencyDecimals:void 0),o=i.formatValue,u=i.formatDecimals;if(zr(o))return o;var s=0===u?Wa.Currency:2===u?Wa.CurrencyDec:Dp(a,!1,u,!0,!1),c=e.applyFormat(e.originSheet.document,s,o);return void 0!==c&&c.length>0&&32===c.charCodeAt(c.length-1)?zn(c.substring(0,c.length-1)):void 0!==c?zn(c):Zn},tO[la.VALUE]=function(e,t){var r=t[0];switch(r.kind){case bt.Boolean:return Zn;case bt.Number:return r;case bt.String:return r.value.length>255?Zn:e.coerceOper(zn(jI(r.value)),bt.Number)}},tO[la.DATEVALUE]=function(e,t){var r=KI(e,t[0]);return zr(r)?r:e.mathpack.trunc(r)},tO[la.TIMEVALUE]=function(e,t){var r=KI(e,t[0]);return zr(r)?r:e.mathpack.sub(r,e.mathpack.trunc(r))},tO[la.ISERROR]=function(e,t){return qn(zr(t[0]))},tO[la.ISERR]=function(e,t){var r=t[0];return qn(zr(r)&&r.type!==Kn.NA)},tO[la.ISBLANK]=function(e,t){return qn(Zr(t[0]))},tO[la.ISLOGICAL]=function(e,t){return qn(qr(t[0]))},tO[la.ISNA]=function(e,t){var r=t[0];return qn(zr(r)&&r.type===Kn.NA)},tO[la.ISNONTEXT]=function(e,t){return qn(!Yr(t[0]))},tO[la.ISTEXT]=function(e,t){return qn(Yr(t[0]))},tO[la.ISNUMBER]=function(e,t){return qn(Kr(t[0]))},tO[la.ISREF]=function(e,t){return qn(Jr(t[0]))},tO[la.ISEVEN]=qI,tO[la.ISODD]=function(e,t){var r=qI(e,t);return qr(r)?qn(!r.value):r},tO[la.ISFORMULA]=function(e,t){return zI(e,t[0],(function(e){return qn(void 0!==e)}))},tO[la.FORMULATEXT]=function(e,t){var r=t[0];return zI(e,r,(function(t,r){if(void 0===t)return ra;var n=e.formatFormula(t,r.range);return t.source.kind===vn.Cell?zn(n):zn("{"+n+"}")}))},tO[la.ROWS]=function(e,t){var r=t[0],n=e.mathpack;return Qr(r)?n.fromNumber(r.rows):hr(r.sheets)?r.ranges.length>1?$n:n.fromNumber(r.ranges[0].rows):Zn},tO[la.COLUMNS]=function(e,t){var r=t[0],n=e.mathpack;return Qr(r)?n.fromNumber(r.cols):hr(r.sheets)?r.ranges.length>1?$n:n.fromNumber(r.ranges[0].cols):Zn},tO[la.AREAS]=function(e,t){var r=t[0];return hr(r.sheets)?e.mathpack.fromNumber(r.ranges.length):Zn},tO[la.SHEETS]=function(e,t){var r=t[0],n=e.mathpack;return r?Qr(r)?ra:n.fromNumber(e.getSheetRangeIndexes(r.sheets).length):n.fromNumber(e.getSheetRangeIndexes(In(e.reflectionSheet.document)).length)},tO[la.ROW]=function(e,t){var r=JI(e,t[0]);if(!Array.isArray(r))return r;var n=r[0],a=r[1],i=e.mathpack;return a?i.fromNumber(n.row+1):ua(n.rows,1,Mm(n.rows,1,(function(e){return i.fromNumber(n.row+e+1)})))},tO[la.COLUMN]=function(e,t){var r=JI(e,t[0]);if(!Array.isArray(r))return r;var n=r[0],a=r[1],i=e.mathpack;return a?i.fromNumber(n.col+1):ua(1,n.cols,Mm(1,n.cols,(function(e,t){return i.fromNumber(n.col+t+1)})))},tO[la.SHEET]=function(e,t){var r=t[0],n=e.mathpack;if(!r){var a=e.reflectionSheet;return void 0===a.index?ra:n.fromNumber(e.getSheetRangePosition(a)+1)}if(Yr(r)){var i=e.getSheetIndex(e.reflectionSheet.document,r.value);return void 0===i?ra:n.fromNumber(e.getSheetRangePosition(i)+1)}return Jr(r)?n.fromNumber(e.getSheetRangePosition(r.sheets)+1):Qr(r)?ra:L("calc.funcs.sheet",r)},tO[la.OFFSET]=function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=t[4];if(!hr(r.sheets))return Zn;if(1!==r.ranges.length)return Zn;var u=e.mathpack,s=r.ranges[0],c=s.row,l=s.col,d=s.rows,f=s.cols,h=c;Kr(n)&&(h+=u.lfix(n));var v=l;Kr(a)&&(v+=u.lfix(a));var p=h+d-1;if(void 0!==i&&Kr(i)){if(0===(g=u.cond(i)))return $n;p=h+u.lfix(i)-(g>0?1:-1)}var m=v+f-1;if(void 0!==o&&Kr(o)){var g;if(0===(g=u.cond(o)))return $n;m=v+u.lfix(o)-(g>0?1:-1)}var S=Se(h,p),y=Se(v,m),b=ye(h,p)-S+1,E=ye(v,m)-y+1;return S<0||y<0||S+b>1<<20||y+E>16384?$n:sa(r.sheets,[wn(S,y,b,E)])},tO[la.TRANSPOSE]=function(e,t){var r=t[0];return Qr(r)?ua(r.cols,r.rows,Mm(r.cols,r.rows,(function(e,t){return r.opers[t][e]}))):r},tO[la.SINGLE]=function(e,t){var r=t[0];if(tn(r)||Xr(r)||$r(r))return r;if(Qr(r))return r.opers[0][0];if(!hr(r.sheets))return $n;if(1!==r.ranges.length)return Zn;var n=Cr(e.originGridCell,r.ranges[0]);return void 0===n?Zn:sa(r.sheets,[n])},tO[la.ADDRESS]=function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=t[4],u=e.mathpack,s=(null==a?void 0:a.kind)===bt.Number?u.sfix(a)-1:0;if(s<0||s>3)return Zn;var c=0!=(1&s),l=0!=(2&s),d=(null==i?void 0:i.kind)!==bt.Boolean||i.value?it.A1:it.R1C1,f=function(e,t,r){return d===it.R1C1&&e?-t<r&&r<t:1<=r&&r<=t},h=u.sfix(r);if(!f(l,1<<20,h))return Zn;if(!Kr(n))return Zn;var v=u.sfix(n);if(!f(c,16384,v))return Zn;var p=Dn(h<0?1048575:0,v<0?16383:0),m=wt(l?st.Rel:st.Abs,d===it.R1C1&&l?h:h-1),g=wt(c?st.Rel:st.Abs,d===it.R1C1&&c?v:v-1),S=Ui(e.config.localeInfo,d,p,m,g,!1);return x("calc.funcs.address: cell wrapped",void 0!==S),(null==o?void 0:o.kind)===bt.String?""===o.value?zn("!"+S):o.value.length>255?Zn:zn(Hi(e.config.localeInfo,e.config.refStyle,o.value)+"!"+S):zn(S)},tO[la.INDIRECT]=function(e,t){var r,n=t[0].value,a=t[1],i=null===(r=null==a?void 0:a.value)||void 0===r||r?it.A1:it.R1C1;if(n.length>255||F(n," "))return Zn;var o=Pn(e.originSheet,e.originGridCell),u={lexicalKind:vn.Indirect,originGridCell:q(o.range),originSheet:q(o.sheet),allowRelativeQualifier:!1,allowUnqualifiedCell:!0,allowImplicitTable:!1,wrapCellReferences:!0},s=e.parseFormula(i,o.range,u,"="+n);if(!X(s))return $n;for(var c=s.value.node,l=!1,d=!1;;){if(!l&&c.kind===pt.App&&xr(c.head)&&c.head.id===pa.Pound&&1===c.args.length&&(l=!0,c=c.args[0]),d||c.kind!==pt.Name){if(c.kind===pt.CellRef){var f=e.getCellRef(c.qualifier,c.ref,o,!0);return void 0===f?$n:hr(f.sheets)?l?ug(e,pa.Pound,[f]):f:$n}return $n}var h=e.getNameFormula(c.qualifier,c.whole,pn.Indirect);if(void 0===h)return $n;o=Pn(o.sheet,Dn(0,0)),c=h[1],d=!0}},tO[la.LEFT]=function(e,t){var r,n=t[0].value,a=t[1];if(void 0!==a&&zr(a))return a;var i=ZI(e.mathpack,a);if("number"!=typeof i&&zr(i))return Zn;var o=null!==(r=Ka(n,0,i))&&void 0!==r?r:n.length;return zn(n.substring(0,o))},tO[la.RIGHT]=function(e,t){var r,n=t[0].value,a=t[1];if(void 0!==a&&zr(a))return a;var i=ZI(e.mathpack,a);if("number"!=typeof i&&zr(i))return Zn;var o=null!==(r=function(e,t,r){for(var n=t,a=0;a<r;a+=1){if(n-1<0)return;Va(e.charCodeAt(n-1))&&n-2>=0&&Pa(e.charCodeAt(n-2))?n-=2:n-=1}return n}(n,n.length,i))&&void 0!==r?r:0;return zn(n.substring(o))},tO[la.MID]=function(e,t){var r,n,a=t[0].value,i=t[1],o=t[2],u=e.mathpack,s=u.fix(i)-1,c=u.fix(o);if(u.cond(i)<0||s<0||u.cond(o)<0||c<0)return Zn;var l=null!==(r=Ka(a,0,s))&&void 0!==r?r:a.length,d=null!==(n=Ka(a,l,c))&&void 0!==n?n:a.length;return zn(a.substring(l,d))},tO[la.LEN]=function(e,t){var r=t[0].value;return e.mathpack.fromNumber(Ya(r,0,r.length))},tO[la.CONCATENATE]=function(e,t){for(var r="",n=0;n<t.length;n+=1){var a=t[n].value;if(r.length+a.length>32767){r+=a.substring(0,32767-r.length);break}r+=a}return zn(r)},tO[la.EXACT]=function(e,t){var r=t[0],n=t[1];return($r(r)||$r(n))&&Jy(un(["EXACT rich argument"])),qn(r.value===n.value)},tO[la.REPT]=function(e,t){var r=t[0].value,n=t[1],a=e.mathpack,i=a.fix(n);return a.cond(n)<0||i>2147483647?Zn:""===r?Qm:i*r.length>32767?Zn:zn(C(r,i))},tO[la.TRIM]=function(e,t){for(var r=t[0].value,n="",a=0;a<r.length;){for(;a<r.length&&32===r.charCodeAt(a);)a+=1;for(var i=a;a<r.length;){var o=32===r.charCodeAt(a);if(a+=1,o)break}n+=r.substring(i,a)}return n.length>0&&32===n.charCodeAt(n.length-1)&&(n=n.substring(0,n.length-1)),zn(n)},tO[la.CLEAN]=function(e,t){for(var r=t[0].value,n="",a=0;a<r.length;a+=1){var i=r.charCodeAt(a);(i>=256||(127&i)>=32)&&(n+=r.charAt(a))}return zn(n)},tO[la.CHAR]=function(e,t){var r=t[0],n=e.mathpack.sfix(r);return n<1||n>255?Zn:zn(String.fromCharCode(n))},tO[la.UNICHAR]=function(e,t){var r=t[0],n=e.mathpack,a=n.lfix(n.trunc(r));return n.cond2(r,n.one)<0||a>=1114112?Zn:a<=65535&&Ga(a)||a>=64976&&a<=65007||(65535&a)>=65534?ra:zn(ja(a))},tO[la.CODE]=function(e,t){var r=t[0].value;if(0===r.length)return Zn;var n=r.charCodeAt(0);return n>255?Jy(un(["CODE for codepoints > 255"])):e.mathpack.fromNumber(n)},tO[la.UNICODE]=function(e,t){var r=t[0].value;if(0===r.length)return Zn;var n=r.charCodeAt(0),a=e.mathpack;if(!Ga(n))return a.fromNumber(n);if(1===r.length)return Zn;var i=Ha(n,r.charCodeAt(1));return void 0===i?Zn:a.fromNumber(i)},tO[la.LOWER]=function(e,t){var r=t[0].value;return zn(eO(r,"LOWER",r.toLowerCase.bind(r)))},tO[la.UPPER]=function(e,t){var r=t[0].value;return zn(eO(r,"UPPER",r.toUpperCase.bind(r)))},tO[la.PROPER]=function(e,t){var r=t[0].value;return zn(eO(r,"PROPER",(function(){for(var e=r.toLowerCase(),t="",n=0;;){for(var a=n;n<e.length&&!$I(e.charCodeAt(n));)n+=1;if(t+=e.substring(a,n),n===e.length)break;var i=n,o=qa(e,n);for(t+=ja(o).toUpperCase(),n+=za(o);n<e.length&&$I(e.charCodeAt(n));)n+=1;t+=e.substring(i+1,n)}return t})))},tO[la.FIND]=function(e,t){var r,n=t[0].value,a=t[1].value,i=t[2],o=void 0!==i?e.mathpack.sfix(i)-1:0;if(o<0||o>=2147483647)return Zn;var u=null!==(r=Ka(a,0,o))&&void 0!==r?r:a.length,s=a.indexOf(n,u);return s>=0?e.mathpack.fromNumber(Ya(a,0,s)+1):Zn},tO[la.REPLACE]=function(e,t){var r,n,a=t[0].value,i=t[1],o=t[2],u=t[3].value,s=e.mathpack.sfix(i)-1;if(s<0||s>=32767)return Zn;var c=e.mathpack.sfix(o);if(c<0||c>32767)return Zn;var l=null!==(r=Ka(a,0,s))&&void 0!==r?r:a.length,d=null!==(n=Ka(a,l,c))&&void 0!==n?n:a.length,f=a.slice(0,l),h=a.slice(d);return f.length+u.length+h.length>32767?Zn:zn(f+u+h)},tO[la.SEARCH]=function(e,t){var r,n=t[0].value,a=t[1].value,i=t[2],o=void 0!==i?e.mathpack.sfix(i)-1:0;if(o<0||o>=2147483647)return Zn;for(var u=null!==(r=Ka(a,0,o))&&void 0!==r?r:a.length,s=new HN(e.config.localeInfo,n,!0);u<a.length;u+=1)if(s.test(a.slice(u)))return e.mathpack.fromNumber(Ya(a,0,u)+1);return Zn},tO[la.SUBSTITUTE]=function(e,t){var r=t[0],n=t[1].value,a=t[2].value,i=t[3],o=r.value,u=1/0;if(void 0!==i){var s=e.coerceOper(i,bt.Number);if(zr(s))return s;if((u=e.mathpack.sfix(s))<1||u>2147483646)return Zn}var c=n.length;if(c>0){for(var l="",d=0,f=0;u>=0&&-1!==(f=o.indexOf(n,f));)if((u-=1)===1/0||0===u){var h=o.slice(d,f);if(l.length+h.length+a.length>32767)return Zn;l+=h,l+=a,d=f+=c}else f+=1;var v=o.slice(d);return l.length+v.length>32767?Zn:zn(l+=v)}return r},tO[la.RAND]=function(e,t){return e.getRandom()},tO[la.RANDBETWEEN]=function(e,t){var r=t[0],n=t[1],a=Zm(e,r),i=Zm(e,n);if(zr(a))return a;if(zr(i))return i;var o=e.mathpack;if(o.cond2(a,i)>0)return ta;var u=e.getRandom(),s=o.ceil(a),c=o.floor(i),l=o.sub(c,s);return zr(l)?l:o.add(o.floor(zm(o.mul(zm(o.add(l,o.one)),u))),s)},tO[la.NOW]=function(e,t){return e.getTime(no.Instant)},tO[la.TODAY]=function(e,t){return e.getTime(no.Day)},tO[la.HYPERLINK]=function(e,t){var r=t[0],n=t[1];return e.followHyperlinks?r:null!=n?n:r};var rO=!1;function nO(e){return rO||(rO=!0,Y(w.CalcFieldValueFunction)&&(tO[la.FIELDVALUE]=QI,tO[la._FV]=QI),Y(w.CalcRecordFunctions)&&(tO[la.RECORD]=XI),Y(w.CalcNestedRecordFunction)&&(tO[la.NESTEDRECORD]=XI),Y(w.CalcLambdaFunctions)&&(tO[la.ARITY]=nI,tO[la.APPLY]=tI,tO[la.ARRAYMAKE]=rI,tO[la.ISLAMBDA]=YI)),tO[e]}var aO=function(e,t){return(e<<t|e>>>32-t)>>>0},iO=function(){function e(e){this.x=new Uint32Array([4058668781,e,e,e]);for(var t=0;t<20;t+=1)this.nextU32()}return e.prototype.next=function(){return this.nextU32()*(1/4294967296)},e.prototype.nextU32=function(){var e=this.x[0]-aO(this.x[1],27)>>>0;return this.x[0]=(this.x[1]^aO(this.x[2],17))>>>0,this.x[1]=this.x[2]+this.x[3]>>>0,this.x[2]=this.x[3]+e>>>0,this.x[3]=e+this.x[0]>>>0},e}(),oO=function(){function e(e){this.iformats=[],this.formatStrings=ce(),this.knownFormats=e}return e.prototype.clone=function(){var t=this,r=new e(this.knownFormats);return Object.keys(this.iformats).map(Number).forEach((function(e){r.iformats[e]=t.iformats[e]})),Object.keys(this.formatStrings).forEach((function(e){r.formatStrings[e]=t.formatStrings[e]})),r},e.prototype.clearCompiledNumberFormats=function(){var e=this;this.iformats.forEach((function(e){e.compiledFormat.reset()})),Object.keys(this.knownFormats).map((function(e){return Number(e)})).forEach((function(t){e.knownFormats[t].reset()})),this.formatStrings=ce(),Object.keys(this.iformats).map(Number).forEach((function(t){var r=e.iformats[t];e.formatStrings[r.formatString]=t}))},e.prototype.getIformat=function(e){var t=this.iformats[e];return void 0===t?Q({kind:AO.NumberFormat,iformat:e}):q(t.compiledFormat)},e.prototype.getKnownFormat=function(e){return q(this.knownFormats[e])},e.prototype.getFormatString=function(e){return q(this.formatStrings[e])},e.prototype.setNumberFormats=function(e,t){var r=this;t||(this.iformats=[],this.formatStrings=ce()),Object.keys(e).map(Number).forEach((function(t){var n=r.iformats[t];void 0!==n&&delete r.formatStrings[n.formatString];var a=e[t];r.iformats[t]=a,r.formatStrings[a.formatString]=t}))},e}(),uO=Dn(0,0),sO=function(e){function t(){var t=e.call(this,void 0)||this;return t.fns=[],t}return ee(t,e),t.prototype.wsfNode=function(e){this.fns.push(su(e))},t.prototype.operatorNode=function(e){this.fns.push(cu(e))},t}(je);var cO,lO=Yn([],[],Ft.None,Un.Exact);!function(e){e.GroundTruth="GroundTruth",e.Estimation="Estimation",e.PrecisionTest="PrecisionTest"}(cO||(cO={}));var dO={onNameFailure:function(){},onRangeFailure:function(){},onNumberFormatFailure:function(){},onInferFormatFailure:function(){},onUnavailableObject:function(){},onSetCellValue:function(){},onSetCellValues:function(){},onReturnCellValue:function(){}},fO=function(){function e(e,t,r,n,a){this.cb=t,this.schedulerConfig=r,this.limits=n,this.maxDereferenceCells=a,this.random=new iO(4294967296*Math.random()),this.worksheetFuncOverrides={},this.userDefinedFuncOverrides={},this.interruptToken=[YS.Continue],this.getCellValue=this.makeGetCellValues(this.tryGetCellValue.bind(this)),this.getCellValues=this.makeGetCellValues(this.tryGetCellValues.bind(this)),this.config=e,this.parser=zh(this),this.analyzer=Uv(this),this.formatter=PS(this),this.compiler=Yy(this),this.evaluator=Zb(this)}return e.prototype.clone=function(t,r){var n;void 0===t&&(t=dO),void 0===r&&(r=wO.Server);var a=new e(this.config,t,this.schedulerConfig,this.limits,this.maxDereferenceCells);return a.documentLoc=this.documentLoc,a.document=null===(n=this.document)||void 0===n?void 0:n.clone(r),a.worksheetFuncOverrides=this.worksheetFuncOverrides,a.userDefinedFuncOverrides=this.userDefinedFuncOverrides,a},e.prototype.reconfigure=function(e,t,r){this.schedulerConfig=e,this.limits=t,this.maxDereferenceCells=r},e.prototype.setConfig=function(e){this.config=e},e.prototype.forEachDocument=function(e){void 0!==this.document&&e(this.document)},e.prototype.getDocumentLoc=function(e,t){var r=this.documentLoc;return void 0===r||void 0!==e&&e!==r.path||0!==this.config.localeInfo.stringCompareCI(t,r.name)?Q(DO([{kind:AO.DocumentLoc,document:kn(e,t)}])):q(r)},e.prototype.getNameLoc=function(e,t,r){var n=this.getDocument(e.document);if(n.kind===H.Failure)return Q(DO([n.reason]));var a=n.value.getNameLoc(e.index,t,r);return a.kind===H.Failure?Q(DO([a.reason])):a},e.prototype.getUserDefinedFuncLoc=function(e,t){return void 0!==this.userDefinedFuncOverrides[t]?q([jn(e,t)]):Q(un(["call UDF"]))},e.prototype.getCellFormat=function(e){var t=this.allEditedAvailable(e);if(t.kind===H.Failure)return Q(DO([t.reason]));if(!0!==t.value)return Q(DO([{kind:AO.GridRange,unavailableCells:t.value,range:e}]));var r=this.getEditedFormat(e);return r.kind===H.Failure?Q(DO([r.reason])):r.value===bR.Unavailable?Q(DO([{kind:AO.CellFormat}])):q(r.value)},e.prototype.getIformat=function(e,t){var r=this.getDocument(e);if(r.kind===H.Failure)return Q(DO([r.reason]));var n=r.value.getIformat(t);if(n.kind===H.Failure)return Q(DO([n.reason]));var a=n.value.getValue();return a.kind===H.Failure?Q(Zv()):a},e.prototype.getKnownFormat=function(e,t){var r=this.getDocument(e);if(r.kind===H.Failure)return Q(DO([r.reason]));var n=r.value.getKnownFormat(t);if(n.kind===H.Failure)return Q(DO([n.reason]));var a=n.value.getValue();return a.kind===H.Failure?Q(Zv()):a},e.prototype.getFormatString=function(e,t){var r=this.getDocument(e);if(r.kind===H.Failure)return Q(DO([r.reason]));var n=r.value.getFormatString(t);return n.kind===H.Failure?Q(DO([n.reason])):n},e.prototype.getNameFormula=function(e,t){var r=this.getDocument(e.scope.document);if(r.kind===H.Failure)return Q(DO([r.reason]));var n=r.value.getNameFormula(e,t);if(n.kind===H.Failure)return Q(DO([n.reason]));if(void 0===n.value)return q(void 0);var a=n.value.compiledFmla.getValue();if(X(a))return a;var i=this.hasRecalcNameFailure(e);return X(i)?i.value||this.setNameFailure(e,a.reason):this.cb.onUnavailableObject(i.reason),Q(cy(e))},e.prototype.getCellFormula=function(e){var t=this.getEditedFormula(e);if(t.kind===H.Failure)return Q(DO([t.reason]));if(void 0===t.value)return q(void 0);var r=t.value,n=r[0],a=r[1];if(void 0===a.compiledFmla)return q(void 0);var i=Bn(e.sheet,n),o=this.readCompiledFmla(i,a.compiledFmla);return X(o)?q(ZS(Cn(a.lexicalKind,i),o.value)):o},e.prototype.setCellValue=function(e,t,r){var n=this.setRecalcValue(e,t);if(n.kind===H.Failure)return this.cb.onUnavailableObject(n.reason);var a=this.propagateEditTaint(e,r);if(a.kind===H.Failure)return this.cb.onUnavailableObject(a.reason);this.cb.onSetCellValue(e,t,r,a.value,this.evalParams)},e.prototype.setCellValues=function(e,t,r){var n=this.setClientValue(e,t);if(n.kind===H.Failure)return this.cb.onUnavailableObject(n.reason);var a=this.setRecalcValue(e,t);if(a.kind===H.Failure)return this.cb.onUnavailableObject(a.reason);var i=this.propagateEditTaint(e,r);if(i.kind===H.Failure)return this.cb.onUnavailableObject(i.reason);this.cb.onSetCellValues(e,t,r,i.value,this.evalParams)},e.prototype.getWorksheetFunc=function(e){var t;if(0!=(Da(e).staticPrecs&(Ft.Time|Ft.Calc))){var r=!1,n=this.evalParams.volatileMode;switch(e){case la.RAND:case la.RANDBETWEEN:case la.RANDARRAY:case la.NOW:r=n===cO.GroundTruth;break;case la.TODAY:r=n===cO.GroundTruth||n===cO.Estimation;break;default:r=void 0===la[e]}if(!r)return Q(DO([{kind:AO.VolatileFunction,name:su(e)}]))}var a=null!==(t=this.worksheetFuncOverrides[e])&&void 0!==t?t:nO(e);return null!=a?q(a):Q(un([su(e)]))},e.prototype.getUserDefinedFunc=function(e){var t=e.id;return void 0!==this.userDefinedFuncOverrides[t]?q(this.userDefinedFuncOverrides[t]):Q(un(["call UDF"]))},e.prototype.getSheetRangeIndexes=function(e){var t=this.getSheetRangeIds(e);return t.kind===H.Failure?Q(DO([t.reason])):q(t.value)},e.prototype.setCellFailure=function(e,t,r){var n=this.setRecalcFailure(e.sheet,oR(e.range));if(n.kind===H.Failure)return this.cb.onUnavailableObject(n.reason);var a=this.setClientValue(e,EN);if(a.kind===H.Failure)return this.cb.onUnavailableObject(a.reason);var i=this.setRecalcValue(e,fa);if(i.kind===H.Failure)return this.cb.onUnavailableObject(i.reason);var o=this.propagateEditTaint(e,r);if(o.kind===H.Failure)return this.cb.onUnavailableObject(o.reason);this.cb.onRangeFailure(e,t,r,o.value,this.evalParams)},e.prototype.getUsedRange=function(e){var t=this.getEditedUsedRange(e);return t.kind===H.Failure?Q(DO([t.reason])):t},e.prototype.getSheetName=function(e,t){var r=this.getDocument(e);if(r.kind===H.Failure)return Q(DO([r.reason]));var n=r.value.getSheetName(t);return n.kind===H.Failure?Q(DO([n.reason])):void 0===n.value?n:q(n.value)},e.prototype.getSheetIndex=function(e,t){var r=this.getDocument(e);if(r.kind===H.Failure)return Q(DO([r.reason]));var n=r.value.getSheetIndex(t);return n.kind===H.Failure?Q(DO([n.reason])):void 0===n.value?n:q(n.value.index)},e.prototype.getContainingTable=function(e){var t=this.getDocument(e.sheet.document);if(t.kind===H.Failure)return Q(DO([t.reason]));var r=t.value.findContainingTable(e);return X(r)?r:Q(DO([r.reason]))},e.prototype.getStructRefColumn=function(e,t){var r=this.getDocument(e.scope.document);if(r.kind===H.Failure)return Q(DO([r.reason]));var n=r.value.getNameFormula(e,pn.StructRef);if(n.kind===H.Failure)return Q(DO([n.reason]));if(void 0===n.value)return q(void 0);if("NamedTable"!==n.value.obj.kind)return Q(yu(pu.NamedObjectNotTable));var a=n.value.obj,i=a.columnNames.getEntry(t);if(void 0===i)return a.allColumnNamesAvailable?Q(yu(pu.UndefinedColumnName)):Q(DO([{kind:AO.ColumnName,table:e,columnName:t}]));var o=a.specialRefRanges[gt.Data],u=o.sheet,s=o.range,c=Bn(u,wn(s.row,i.value,s.rows,1));return q(Nn(i.key,c,a.hasHeadersRow,a.hasTotalsRow))},e.prototype.getStructRefSpecialRef=function(e,t){var r=this.getDocument(e.scope.document);if(r.kind===H.Failure)return Q(DO([r.reason]));var n=r.value.getNameFormula(e,pn.StructRef);return n.kind===H.Failure?Q(DO([n.reason])):void 0===n.value?q(void 0):"NamedTable"!==n.value.obj.kind?Q(yu(pu.NamedObjectNotTable)):q(n.value.obj.specialRefRanges[t])},e.prototype.getHiddenRows=function(e,t,r){var n=this.getDocument(e.document);if(n.kind===H.Failure)return Q(DO([n.reason]));var a=n.value.getHiddenRows(e.index,t,r);return a.kind===H.Failure?Q(DO([a.reason])):a},e.prototype.isInFilterMode=function(e){var t=this.getDocument(e.document);if(t.kind===H.Failure)return Q(DO([t.reason]));var r=t.value.isInFilterMode(e.index);return r.kind===H.Failure?Q(DO([r.reason])):r},e.prototype.getRandom=function(){return x("calc.calc.PartialWorkbookDocumentCollection: getRandom",this.evalParams.volatileMode===cO.GroundTruth),q(this.config.mathpack.fromNumber(this.random.next()))},e.prototype.getTime=function(e,t){var r=this.evalParams.volatileMode;switch(r){case cO.PrecisionTest:return Q(DO([{kind:AO.GetTimeKind,getTimeKind:t}]));case cO.Estimation:switch(t){case qv.NonVolatile:return Q(DO([{kind:AO.GetTimeKind,getTimeKind:t}]));case qv.ValueCell:case qv.Volatile:}break;case cO.GroundTruth:}var n=this.config,a=n.mathpack,i=n.datepack,o=new Date,u=i.utcToLocal(this.config,so(o.getUTCFullYear(),o.getUTCMonth()+1,o.getUTCDate(),o.getUTCHours(),o.getUTCMinutes(),o.getUTCSeconds(),o.getUTCDay()+1,o.getUTCMilliseconds(),uo.Round1000ths),this.config.timezone);x("calc.calc.PartialWorkbookDocumentCollection: to local",!1!==u);var s=u.yr,c=u.rounding,l=u.mon,d=u.dom,f=u.hour,h=u.min,v=u.sec,p=u.fracSec;e<no.Instant&&(p=0,v=0,h=0,f=0),e<no.Day&&(d=1,l=1);var m=so(s,l,d,f,h,v,1,p,c),g=i.toNum(this.config,m);x("calc.calc.PartialWorkbookDocumentCollection: toNum",!zr(g));var S=a.toNumber(g);if(r===cO.GroundTruth)return q(g);var y=i.toNum(this.config,u);x("calc.calc.PartialWorkbookDocumentCollection: toNum",!zr(y));var b,E=a.toNumber(y);switch(e){case no.Instant:b=E;break;case no.Day:b=S+1;break;case no.Year:var F=so(s+1,l,d,f,h,v,1,p,c),C=i.toNum(this.config,F);x("calc.calc.PartialWorkbookDocumentCollection: toNum",!zr(C)),b=a.toNumber(C)}return E<S+10/1440||E>b-10/1440?Q(DO([{kind:AO.TimeGranularity,granularity:e}])):q(g)},e.prototype.withEvalParams=function(e,t){var r=this,n=this.evalParams;this.evalParams=e;try{var a=t();return Array.isArray(a)?a:dy((function(){return r.withEvalParams(e,a.resume)}))}finally{this.evalParams=n}},e.prototype.withEvalParamsEvalFormula=function(e,t){var r=this,n=this.evalParams;this.evalParams=e;try{var a=t();return a.kind!==H.Paused?a:dy((function(){return r.withEvalParamsEvalFormula(e,a.resume)}))}finally{this.evalParams=n}},e.prototype.evaluate=function(e,t,r){var n=this;return this.withEvalParams({computeKind:e,computeCell:t,volatileMode:r},(function(){return n.evaluator.evalCells([t])}))},e.prototype.evalFormula=function(e,t,r,n){var a=this,i={lexicalKind:vn.Other,originGridCell:q(t.range),originSheet:q(t.sheet),allowRelativeQualifier:!1,allowUnqualifiedCell:!0,allowImplicitTable:!0,wrapCellReferences:!1},o={lexicalSource:{kind:vn.Other},originGridCell:q(t.range),originSheet:q(t.sheet),calcingArray:!1,reflectionGridCell:q(t.range),reflectionSheet:q(t.sheet),implicitIntersect:!1,allowUnqualifiedCell:!0,wrapCellReferences:!1,followHyperlinks:q(!1)},u=function(e,n){if(n.kind===H.Paused)return dy((function(){return u(e,n.resume())}));if(!X(n))return q({value:n});var i=a.evalFormulaFormat(t,e,n.value,r);return q({value:q(n.value),formatted:i})};return this.withEvalParamsEvalFormula({computeKind:sR.EvalFormula,computeCell:t,volatileMode:n},(function(){var t=a.parser.parseFormula(i,e),r=a.checkFormula(i,t,e,"eval-formula"),n=a.compileFormula(i,r);return X(n)?u(n.value,a.evaluator.evalFormula(o,n.value)):q({value:n})}))},e.prototype.evalFormulaFormat=function(e,t,r,n){if(void 0!==n){if(n===bR.Origin){var a=this.allEditedAvailable(e);return X(a)?!0!==a.value?Q(DO([{kind:AO.GridRange,unavailableCells:a.value,range:e}])):this.formatValueCell(e,r):void this.cb.onUnavailableObject(a.reason)}if(n===bR.Inferred){var i={lexicalSource:{kind:vn.Other},originGridCell:q(e.range),originSheet:q(e.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1},o=this.formatter.evalFormat(i,t);return X(o)?void 0===o.value?this.formatValueKnownFormat(e.sheet.document,Wa.General,r):"number"==typeof o.value?this.formatValueIformat(e.sheet.document,o.value,r):this.formatter.applyFormat(o.value,r,!0):o}return this.formatValueIformat(e.sheet.document,n,r)}},e.prototype.evalValue=function(e,t,r){var n,a=this.evalParams;this.evalParams={computeKind:t,computeCell:e,volatileMode:r};try{var i=this.getEditedFormula(e);if(!X(i))return this.cb.onUnavailableObject(i.reason);if(void 0!==(null===(n=i.value)||void 0===n?void 0:n[1].compiledFmla))return;var o=this.hasRecalcDirty(e);if(!X(o))return this.cb.onUnavailableObject(o.reason);if(o.value)return;var u=this.tryGetCellValue(e.range,e.sheet);if(void 0===u)return;x("calc.calc.PartialWorkbookDocumentCollection.evalValue",u.kind===KS.FinalValue),this.cb.onReturnCellValue(e,u.oper,cR.EditedCell)}finally{this.evalParams=a}},e.prototype.setUserDefinedFuncOverrides=function(e){this.userDefinedFuncOverrides=e},e.prototype.setWorksheetFuncOverrides=function(e){this.worksheetFuncOverrides=e},e.prototype.setSheetNames=function(e,t){var r=this.ensureDocument(e);return r.kind===H.Failure?r:(this.document=r.value.setSheetNames(t),q(void 0))},e.prototype.advanceState=function(e){void 0!==this.document&&this.document.advanceState(e)},e.prototype.onCellModified=function(e){if(void 0!==this.document)return this.document.onCellModified(e)},e.prototype.getServerDocument=function(){return this.documentLoc},e.prototype.allServerAvailable=function(e){var t=this.getDocument(e.sheet.document);return t.kind===H.Failure?t:t.value.allServerAvailable(e)},e.prototype.forEachEditedNonBlankCellInSet=function(e,t,r){var n=e.index,a=e.document,i=this.getDocument(a);return i.kind===H.Failure?i:i.value.forEachEditedNonBlankCellInSet(n,t,r)},e.prototype.forEachServerNonBlankCellInSet=function(e,t,r){var n=e.index,a=e.document,i=this.getDocument(a);return i.kind===H.Failure?i:i.value.forEachServerNonBlankCellInSet(n,t,r)},e.prototype.forEachEditedCellInSet=function(e,t,r){var n=e.index,a=e.document,i=this.getDocument(a);return i.kind===H.Failure?i:i.value.forEachEditedCellInSet(n,t,r)},e.prototype.clearCompiledFormulas=function(){if(void 0!==this.document)return this.document.clearCompiledFormulas()},e.prototype.clearCompiledNumberFormats=function(){if(void 0!==this.document)return this.document.clearCompiledNumberFormats()},e.prototype.getGridStatistics=function(){return void 0!==this.document?this.document.getGridStatistics():IN},e.prototype.getNameStatistics=function(){return void 0!==this.document?this.document.getNameStatistics():LN},e.prototype.collectGarbage=function(e){if(void 0!==this.document)return this.document.collectGarbage(e)},e.prototype.getEditedFormula=function(e){var t=this.getDocument(e.sheet.document);return t.kind===H.Failure?t:t.value.getEditedFormula(e)},e.prototype.getEditedFormat=function(e){var t=this.getDocument(e.sheet.document);return t.kind===H.Failure?t:t.value.getEditedFormat(e)},e.prototype.getServerFormat=function(e){var t=this.getDocument(e.sheet.document);return t.kind===H.Failure?t:t.value.getServerFormat(e)},e.prototype.getClientFormat=function(e){var t=this.getDocument(e.sheet.document);return t.kind===H.Failure?t:t.value.getClientFormat(e)},e.prototype.getClientValue=function(e){var t=this.getDocument(e.sheet.document);return t.kind===H.Failure?t:t.value.getClientValue(e)},e.prototype.getRecalcValues=function(e){var t=this.getDocument(e.sheet.document);return t.kind===H.Failure?t:t.value.getRecalcValues(e)},e.prototype.getServerValue=function(e){var t=this.getDocument(e.sheet.document);return t.kind===H.Failure?t:t.value.getServerValue(e)},e.prototype.getServerFormula=function(e){var t=this.getDocument(e.sheet.document);return t.kind===H.Failure?t:t.value.getServerFormula(e)},e.prototype.getClientFormula=function(e){var t=this.getDocument(e.sheet.document);return t.kind===H.Failure?t:t.value.getClientFormula(e)},e.prototype.getServerUsedRange=function(e){var t=this.getDocument(e.document);if(t.kind===H.Failure)return t;var r=t.value.getServerUsedRange(e.index);return r.kind===H.Failure||void 0===r.value?r:q(Bn(e,r.value))},e.prototype.getServerAvailableCells=function(){var e=[];return this.forEachDocument((function(t){he(e,t.getServerAvailableCells())})),e},e.prototype.promoteServerAvailability=function(e,t){var r=e.sheet,n=e.set,a=this.getDocument(r.document);return a.kind===H.Failure?a:a.value.promoteServerAvailability(r.index,n,t)},e.prototype.extendServerUnused=function(e,t){var r=this.getDocument(e.document);return r.kind===H.Failure?r:r.value.extendServerUnused(e.index,t)},e.prototype.setCellContents=function(e,t,r,n,a,i,o,u,s){var c=this.getDocument(t.sheet.document);if(c.kind===H.Failure)return c;var l=void 0===r?void 0:n?this.compileFmla(e,vn.Cell,Wn(t.sheet,a),void 0,r):""===r?gN:{fmla:r,lexicalKind:vn.Cell,origin:a,compiledFmla:void 0,hasHyperlink:vN.ClientValueUnknown};return c.value.setCellContents(e,t,l,i,o,u,s)},e.prototype.setRangeFormula=function(e,t,r,n,a,i,o){var u=this.getDocument(t.sheet.document);if(u.kind===H.Failure)return u;var s=""===r?SN:this.compileFmla(e,vn.Range,Wn(t.sheet,n),Mr(t.range),r);return u.value.setRangeFormula(e,t,s,a,i,o)},e.prototype.getDirtyEditedCells=function(){return this.document?this.document.getDirtyEditedCells():[]},e.prototype.getNonDirtyEditedCells=function(){return this.document?this.document.getNonDirtyEditedCells():[]},e.prototype.getDirtyDependentCells=function(){return this.document?this.document.getDirtyDependentCells():[]},e.prototype.setNamedObject=function(e,t,r){var n=this.getDocument(t.scope.document);if(n.kind===H.Failure)return n;var a,i,o,u=Rn(t),s=n.value.getNameFormula(t,pn.StructRef);if(void 0!==r&&"NamedTable"===r.kind&&X(s)&&void 0!==s.value&&"NamedTable"===s.value.obj.kind&&(i=s.value.obj,o=r,Or(i.specialRefRanges[gt.Data],o.specialRefRanges[gt.Data])&&i.hasHeadersRow===o.hasHeadersRow&&i.hasTotalsRow===o.hasTotalsRow)){var c=function(e,t){var r=e.columnNames;t.columnNames.forEach((function(e,t){return r=r.setValue(e,t),!0}));var n=t.columnNames.getCount()===t.value.ranges[0].cols;return te(te({},t),{columnNames:r,allColumnNamesAvailable:n})}(s.value.obj,r);a=this.compileNamedObject(e,u,c)}else a=void 0===r?void 0:this.compileNamedObject(e,u,r);return n.value.setNamedObject(e,t,a)},e.prototype.setUndefinedNames=function(e){var t=this.getDocument(e.document);return t.kind===H.Failure?t:t.value.setUndefinedNames(e)},e.prototype.promoteNamedObjects=function(e,t){var r=this.getDocument(e.document);return r.kind===H.Failure?r:r.value.promoteNamedObjects(e,t)},e.prototype.setNumberFormats=function(e,t,r){var n=this,a=this.ensureDocument(e);if(a.kind===H.Failure)return a;var i=[];return t.forEach((function(e){var t=e.iformat,r=e.formatString,a=e.builtIn,o=n.compileNumberFormat(r,a);i[t]={formatString:r,compiledFormat:o}})),q(a.value.setNumberFormats(i,r))},e.prototype.writeHiddenRows=function(e,t,r){var n=this.getDocument(e.document);return n.kind===H.Failure?n:n.value.setHiddenRows(e.index,t,r)},e.prototype.writeInFilterMode=function(e,t){var r=this.getDocument(e.document);return r.kind===H.Failure?r:r.value.setInFilterMode(e.index,t)},e.prototype.resolveCellFormat=function(e,t){if("number"!=typeof t)return q(t);var r=this.getDocument(e);if(!X(r))return Q(DO([r.reason]));var n=r.value.getIformat(t);return X(n)?n.value.getValue():Q(DO([n.reason]))},e.prototype.resolveValueFormat=function(e,t){var r;if("string"==typeof t)return this.resolveStringFormat(e,t);var n=this.getKnownFormat(e,t);if(!X(n))return n;var a=this.getFormatString(e,n.value.formatString);return X(a)?q(null!==(r=a.value)&&void 0!==r?r:n.value):a},e.prototype.resolveStringFormat=function(e,t){var r=this.getFormatString(e,t);return X(r)?void 0!==r.value?q(r.value):this.formatter.createFormat(t,!1):r},e.prototype.resolveEditFormat=function(e,t){return"number"==typeof t?q(t):this.resolveStringFormat(e,t)},e.prototype.parseInferredEdit=function(e,t,r){var n=this.allEditedAvailable(e);if(!X(n))return Q(DO([n.reason]));if(!0!==n.value)return Q(DO([{kind:AO.GridRange,unavailableCells:n.value,range:e}]));var a=this.getEditedFormat(e);if(!X(a))return Q(DO([a.reason]));if(a.value===bR.Unavailable)return Q(DO([{kind:AO.CellFormat}]));var i=this.resolveCellFormat(e.sheet.document,a.value);if(!X(i))return i;var o=this.evalParams;this.evalParams={computeKind:sR.ParseEdit,computeCell:e,volatileMode:r};try{return this.formatter.parseEdit(t,i.value)}finally{this.evalParams=o}},e.prototype.inferFormulaFormat=function(e){var t=this.getEditedFormula(e);if(!X(t))return q(void this.cb.onUnavailableObject(t.reason));if(void 0===t.value||void 0===t.value[1].compiledFmla)return q(void this.cb.onUnavailableObject({kind:AO.CellEvaluatingValue}));var r=t.value[1].compiledFmla.getValue();if(!X(r))return Y(w["OfficeVSO:3852168_CalcCGJanFormatTweaks"])?r:q(bR.Unavailable);var n=Cn(t.value[1].lexicalKind,Bn(e.sheet,t.value[0])),a=r.value;return this.formatter.evalFormat(yp(n),a)},e.prototype.fillInferredFormat=function(e,t){var r=this;mR(e.set,(function(n){var a=Wn(e.sheet,n);if(t===bR.Unavailable&&!Y(w["OfficeVSO:3852168_CalcCGJanFormatTweaks"]))return X(u=r.setEditedFormat(a,bR.Unavailable))||r.cb.onUnavailableObject(u.reason),!0;var i=t===bR.Unavailable?q(void 0):r.resolveCellFormat(e.sheet.document,t);if(!X(i))return r.cb.onInferFormatFailure(a,i.reason),!0;var o=r.getEditedFormat(a);if(!X(o))return r.cb.onUnavailableObject(o.reason),!0;if(o.value===bR.Unavailable)return!0;var u,s=r.resolveCellFormat(e.sheet.document,o.value);if(!X(s))return r.cb.onInferFormatFailure(a,s.reason),!0;km(i.value,s.value)&&(X(u=r.setEditedFormat(a,t))||r.cb.onUnavailableObject(u.reason));return!0}))},e.prototype.anonymizeFormula=function(e,t){var r,n,a,i=null===(r=t.compiledFmla)||void 0===r?void 0:r.getValue();return void 0!==i&&X(i)?[Zs(this.config,i.value,e),(n=i.value,a=new sO,dt(a,n),a.fns)]:[b(t.fmla),[]]},e.prototype.compileFmla=function(e,t,r,n,a){var i=this;return{fmla:a,lexicalKind:t,origin:null!=n?n:r.range,compiledFmla:new PN((function(){var o=i.parser.parseFormula(ec(t,r.range),a),u=e?o:i.autocorrectFormula(uv(t,r),o),s=i.checkFormula(uv(t,r),u,a,e?"server-cell-formula":"edit-cell-formula"),c=i.adjustFormulaOrigin(s,r,n);return i.compileFormula(HS(t,r.range),c)})),hasHyperlink:vN.ClientValueUnknown}},e.prototype.compileFormula=function(e,t){return X(t)?this.compiler.compileFormula(e,t.value):t},e.prototype.compileNamedObject=function(e,t,r){var n=this,a=e?"server-named-formula":"edit-named-formula";switch(r.kind){case"NamedFormula":return{obj:r,compiledFmla:new PN((function(){var t=r.fmla,i=n.parser.parseFormula(ec(vn.NameManager,uO),t);x("calc.calc.PartialWorkbookDocumentCollection.compileNamedObject: isServerUpdate",e);var o=sv(Pn(Vn(n.documentLoc),uO)),u=i,s=n.checkFormula(o,u,t,a);return n.compileFormula(jS(uO),s)}))};case"NamedValue":case"NamedTable":return{obj:r,compiledFmla:new PN((function(){var e,a;if(Jr(r.value)){x("calc.calc.PartialWorkbookDocumentCollection.compileNamedObject: bad range",hr(r.value.sheets)&&1===r.value.ranges.length);var i=r.value.sheets,o=n.getDocument(i.document);if(!X(o))return n.cb.onUnavailableObject(o.reason),Q(DO([o.reason]));var u=o.value.getSheetName(i.index);if(!X(u))return n.cb.onUnavailableObject(u.reason),Q(DO([u.reason]));var s=r.value.ranges[0];e=Bt(tr(Lt(_t(wt(st.Abs,s.row),wt(st.Abs,s.col)),_t(wt(st.Abs,s.row+s.rows-1),wt(st.Abs,s.col+s.cols-1))),It(u.value,Tt(i.document.name,i.document.path))),[],[],1),a=Wn(i,uO)}else e=Bt(Vt(r.value,!0),[],[],1),a=Pn(Vn(n.documentLoc),uO);var c=n.analyzer.checkFormula(sv(a),e);return X(c)&&vr(c.value)?n.compileFormula(jS(uO),q(c.value)):U("calc.calc.PartialWorkbookDocumentCollection.compileNamedObject: constructed ill-formed formula "+Zs(n.config,e,t))}))};case"NamedFailure":return{obj:r,compiledFmla:new PN((function(){return Q(DO([{kind:AO.ClientFailure,reason:r.failureReason}]))}))};default:return L("calc.calc.partialWorkbookDocumentCollection.compileNamedFmla",r)}},e.prototype.checkFormula=function(e,t,r,n){if(!X(t))return t;var a=this.analyzer.checkFormulaWithDiagnostics(e,t.value);return X(a)?vr(a.value[0])?q(a.value[0]):Q(JS("calc.PartialWorkbook.checkFormula: expected well-formed formula; given "+b(r),n,iv(a.value[1]))):a},e.prototype.autocorrectFormula=function(e,t){return X(t)?this.analyzer.autocorrectFormula(e,t.value):t},e.prototype.adjustFormulaOrigin=function(e,t,r){return X(e)&&void 0!==r?Cb(this,{originGridCell:q(t.range),originSheet:q(t.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1},r,e.value):e},e.prototype.compileNumberFormat=function(e,t){var r=this;return new PN((function(){var n=r.formatter.createFormat(e,t);return X(n)||r.cb.onNumberFormatFailure(n.reason),n}))},e.prototype.compileKnownFormats=function(){var e=this;return fe(Wa,(function(t){return e.compileNumberFormat(Vp(e.config.localeInfo,t),!1)}))},e.prototype.printFormulaBarText=function(e,t,r){return this.parser.formatFormula(rc(e,Wn(e.range.sheet,t)),r)},e.prototype.renderValueBarText=function(e,t,r){var n=this.getEditedResolvedFormat(e);return X(n)?this.formatter.renderFormulaBar(e.sheet.document,t,n.value,F(r,"'")):n},e.prototype.formatValueCell=function(e,t){var r=this.getEditedResolvedFormat(e);if(!X(r))return r;return this.formatter.applyFormat(r.value,t,!0)},e.prototype.formatValueIformat=function(e,t,r){var n=this.getIformat(e,t);return X(n)?this.formatter.applyFormat(n.value,r,!0):n},e.prototype.formatValueKnownFormat=function(e,t,r){var n=this.getKnownFormat(e,t);return X(n)?this.formatter.applyFormat(n.value,r,!0):n},e.prototype.getEditedResolvedFormat=function(e){var t=this.getEditedFormat(e);return X(t)?t.value===bR.Unavailable?Q(DO([{kind:AO.CellFormat}])):this.resolveCellFormat(e.sheet.document,t.value):Q(DO([t.reason]))},e.prototype.getDocument=function(e){return void 0!==this.documentLoc&&void 0!==this.document&&kr(this.documentLoc,e)?q(this.document):this.unavailableFailure({kind:AO.DocumentLoc,document:e})},e.prototype.ensureDocument=function(e){return void 0===this.documentLoc&&void 0===this.document&&(this.documentLoc=e,this.document=new WN(e,this.config.localeInfo.stringCompareCI,new oO(this.compileKnownFormats()))),this.getDocument(e)},e.prototype.unavailableFailure=function(e){return Q(e)},e.prototype.tryGetCellValues=function(e,t){var r=this,n=Bn(t,e),a=e.row,i=e.col,o=e.rows,u=e.cols,s=this.getRecalcValues(n);if(s.kind!==H.Failure){for(var c=!1,l=0;l<o;l+=1)for(var d=s.value[l],f=0;f<u;f+=1){var h=d[f].failure;void 0!==h&&(this.setCellFailure(Wn(t,Dn(a+l,i+f)),h,lO),c=!0)}if(!c){var v=function(e){return QS(e.oper)},p=s.value.map((function(e){return e.map(v)})),m=this.forEachRecalcDirty(n,(function(e){var n=Wn(t,e),o=r.getEditedFormula(n);if(o.kind===H.Failure)return r.cb.onUnavailableObject(o.reason),!1;if(void 0===o.value)return r.setCellFailure(n,DO([{kind:AO.CellMissingFormula}]),lO),c=!0,!0;var u=o.value,s=u[0],l=u[1];return void 0===l.compiledFmla?(r.cb.onUnavailableObject({kind:AO.CellEvaluatingValue}),!1):X(r.readCompiledFmla(Bn(t,s),l.compiledFmla))?(p[e.row-a][e.col-i]=XS(Wn(t,Mr(s))),!0):(c=!0,!0)}));if(X(m)){if(m.value&&!c)return p}else this.cb.onUnavailableObject(m.reason)}}else this.cb.onUnavailableObject(s.reason)},e.prototype.tryGetCellValue=function(e,t){var r=this.tryGetCellValues(e,t);return void 0===r?void 0:r[0][0]},e.prototype.makeGetCellValues=function(e){var t=this;return function(r){var n=t.allEditedAvailable(r);if(n.kind===H.Failure)return Q(DO([n.reason]));if(!0!==n.value)return Q(DO([{kind:AO.GridRange,range:r,unavailableCells:n.value}]));var a=t.hasRecalcFailure(r);if(a.kind===H.Failure)return Q(DO([a.reason]));if(a.value)return Q(sy(r));if(Rr(r.range)>t.maxDereferenceCells)return Q(DO([{kind:AO.GridRangeSize,range:r}]));var i=e(r.range,r.sheet);return void 0===i?Q(sy(r)):q(i)}},e.prototype.readCompiledFmla=function(e,t){var r=t.getValue();if(X(r))return r;if(this.setCellFailure(e,r.reason,lO),r.reason.kind===VS.Unavailable){r.reason;return r}return Q(DO([{kind:AO.CellFormula,reason:r.reason}]))},e.prototype.getEditedUsedRange=function(e){var t=this.getDocument(e.document);if(t.kind===H.Failure)return t;var r=t.value.getEditedUsedRange(e.index);return r.kind===H.Failure||void 0===r.value?r:q(Bn(e,r.value))},e.prototype.getSheetRangeIds=function(e){var t=this.getDocument(e.document);return t.kind===H.Failure?t:t.value.getSheetRangeIds(e)},e.prototype.allEditedAvailable=function(e){var t=this.getDocument(e.sheet.document);return t.kind===H.Failure?t:t.value.allEditedAvailable(e)},e.prototype.forEachRecalcDirty=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===H.Failure?r:r.value.forEachRecalcDirty(e,t)},e.prototype.hasRecalcDirty=function(e){var t=this.getDocument(e.sheet.document);return t.kind===H.Failure?t:t.value.hasRecalcDirty(e)},e.prototype.hasRecalcFailure=function(e){var t=this.getDocument(e.sheet.document);return t.kind===H.Failure?t:t.value.hasRecalcFailure(e)},e.prototype.hasEditedEditTaint=function(e){var t=this.getDocument(e.sheet.document);return t.kind===H.Failure?t:t.value.hasEditedEditTaint(e)},e.prototype.hasRecalcEditTaint=function(e){var t=this.getDocument(e.sheet.document);return t.kind===H.Failure?t:t.value.hasRecalcEditTaint(e)},e.prototype.setEditedFormat=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===H.Failure?r:r.value.setEditedFormat(e,t)},e.prototype.setClientFormat=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===H.Failure?r:r.value.setClientFormat(e,t)},e.prototype.setRecalcFailure=function(e,t){var r=this.getDocument(e.document);return r.kind===H.Failure?r:r.value.setRecalcFailure(e.index,t)},e.prototype.testAndSetClientValue=function(e,t){var r=this.getClientValue(e);if(r.kind===H.Failure)return r;var n=FN(r.value.oper)||!an(this.config.mathpack,r.value.oper,t,!0);if(n){var a=this.setClientValue(e,t);if(a.kind===H.Failure)return a}return q(n)},e.prototype.testAndSetClientFormat=function(e,t){var r=this.getClientFormat(e);if(r.kind===H.Failure)return r;var n=t!==r.value;if(n){var a=this.setClientFormat(e,t);if(a.kind===H.Failure)return a}return q(n)},e.prototype.testAndSetClientFormula=function(e,t,r){var n,a=this.getClientFormula(wr(e));if(a.kind===H.Failure)return a;var i=null!==(n=a.value)&&void 0!==n?n:[e.range,bN],o=i[0],u=i[1],s=Mr(e.range),c=void 0!==t&&t!==u.fmla||void 0!==u.compiledFmla&&!Ar(s,u.origin),l=void 0!==r&&r!==u.hasHyperlink;if(c||l){var d=u.compiledFmla,f=this.setClientFormula(Bn(e.sheet,o),{fmla:null!=t?t:u.fmla,compiledFmla:d,origin:void 0!==t?s:u.origin,hasHyperlink:null!=r?r:u.hasHyperlink});if(f.kind===H.Failure)return f}return q({hasFmlaChanged:c,hasHyperlinkChanged:l})},e.prototype.setRecalcEditTaint=function(e,t){var r=this.getDocument(e.document);return r.kind===H.Failure?r:r.value.setRecalcEditTaint(e.index,t)},e.prototype.propagateEditTaint=function(e,t){var r=this.hasEditedEditTaint(e);if(r.kind===H.Failure)return r;if(r.value)return q(cR.EditedCell);for(var n=0,a=t.cells;n<a.length;n++){var i,o=a[n],u=this.hasRecalcEditTaint(o);if(u.kind===H.Failure)return u;if(u.value)return(i=this.setRecalcEditTaint(e.sheet,oR(e.range))).kind===H.Failure?i:q(cR.DependentCell)}return 0!=(t.special&(Ft.Calc|Ft.Time))?(i=this.setRecalcEditTaint(e.sheet,oR(e.range))).kind===H.Failure?i:q(cR.DependentCell):t.bound===Un.Exact||void 0!==this.evalParams&&this.evalParams.computeKind===sR.EditedCell?q(cR.IndependentCell):q(cR.UnknownNonEditedCell)},e.prototype.setClientValue=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===H.Failure?r:r.value.setClientValue(e,t)},e.prototype.setRecalcValue=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===H.Failure?r:r.value.setRecalcValue(e,t)},e.prototype.setClientFormula=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===H.Failure?r:r.value.setClientFormula(e,t)},e.prototype.hasRecalcNameFailure=function(e){var t=this.getDocument(e.scope.document);return t.kind===H.Failure?t:t.value.hasRecalcNameFailure(e)},e.prototype.setRecalcNameFailure=function(e){var t=this.getDocument(e.scope.document);return t.kind===H.Failure?t:t.value.setRecalcNameFailure(e)},e.prototype.setNameFailure=function(e,t){var r=this.setRecalcNameFailure(e);if(r.kind===H.Failure)return this.cb.onUnavailableObject(r.reason);this.cb.onNameFailure(e,t,this.evalParams)},e}();function hO(e,t){return e&t-1}var vO,pO=function(){function e(){this.front=0,this.count=0,this.values=[void 0]}return e.prototype.getCount=function(){return this.count},e.prototype.maybeResize=function(){var e=this.values.length;if(this.count>=e){this.values.length=e<<1;for(var t=0;t<this.front;t+=1)this.values[e+t]=this.values[t],this.values[t]=void 0}else{var r=e>>4;if(r>=1&&this.count<r){for(t=0;t<this.count;t+=1)this.values[hO(this.front+t,r)]=this.values[hO(this.front+t,e)];this.values.length=r,this.front=hO(this.front,r)}}},e.prototype.pushBack=function(e){this.maybeResize(),this.values[hO(this.front+this.count,this.values.length)]=e,this.count+=1},e.prototype.pushFront=function(e){this.maybeResize();var t=hO(this.front-1,this.values.length);this.values[t]=e,this.front=t,this.count+=1},e.prototype.peekBack=function(){return this.values[hO(this.front+this.count-1,this.values.length)]},e.prototype.peekFront=function(){return this.values[this.front]},e.prototype.popBack=function(){var e=hO(this.front+this.count-1,this.values.length),t=this.values[e];return void 0!==t&&(this.values[e]=void 0,this.count-=1),t},e.prototype.popFront=function(){var e=this.values[this.front];return void 0!==e&&(this.values[this.front]=void 0,this.front=hO(this.front+1,this.values.length),this.count-=1),e},e.prototype.forEach=function(e){for(var t=this.values.length,r=0;r<this.count;r+=1){if(!e(this.values[hO(this.front+r,t)]))return!1}return!0},e}();!function(e){e[e.Back=0]="Back",e[e.Front=1]="Front"}(vO||(vO={}));var mO,gO,SO,yO,bO=function(){function e(){this.minPriority=0,this.taskDeqs=[]}return e.prototype.deleteTasks=function(e,t){var r=this.taskDeqs[e];if(r)for(var n;n=r.popFront();)"function"!=typeof n&&n.onDeleted&&n.onDeleted(t)},e.prototype.addTask=function(e,t,r){var n,a=null!==(n=this.taskDeqs[e])&&void 0!==n?n:this.taskDeqs[e]=new pO;t===vO.Back?a.pushBack(r):a.pushFront(r),e<this.minPriority&&(this.minPriority=e)},e.prototype.runTask=function(){for(var e,t=this.minPriority;t<this.taskDeqs.length;t+=1){this.minPriority=t;var r=null===(e=this.taskDeqs[t])||void 0===e?void 0:e.popFront();if(r)return"function"==typeof r?r():r.onRun(),!0}return!1},e.prototype.getCount=function(e){var t,r;return void 0!==e?null!==(r=null===(t=this.taskDeqs[e])||void 0===t?void 0:t.getCount())&&void 0!==r?r:0:this.taskDeqs.reduce((function(e,t){return t?e+t.getCount():e}),0)},e}();function EO(e,t){switch(t.kind){case bt.Number:return{kind:"n",magnitude:p(e.toNumber(t))};case bt.String:return{kind:"s"};case bt.Boolean:return{kind:"b"};case bt.Error:return{kind:"e",type:(r=t.type,n=tu[r],void 0===n?"error.type:"+r:n)};case bt.Rich:return{kind:"r"};case bt.Array:return{kind:"a"};case bt.Blank:return{kind:"z"};default:return L("calc.calc.precisionValue",t)}var r,n}function FO(e,t){var r=e[t.sheet.index];return void 0!==r&&zC(r,oR(t.range))}function CO(e,t){var r,n=null!==(r=e[t.sheet.index])&&void 0!==r?r:dC;e[t.sheet.index]=VC(n,oR(t.range))}!function(e){e.EvalStatistics="EvalStatistics",e.PrintFormulaStatistics="PrintFormulaStatistics",e.UnhandledFailure="UnhandledFailure"}(SO||(SO={})),function(e){e.Success="Success",e.Timeout="Timeout"}(yO||(yO={}));var RO=((mO={})[pa.Add]=.05,mO[pa.Sub]=.069,mO[pa.Eq]=.097,mO[pa.Mul]=.1,mO[pa.Div]=.11,mO[pa.Concat]=.36,mO[pa.Gt]=.65,mO[pa.Ne]=.79,mO[pa.Lt]=.89,mO[pa.Le]=1.6,mO[pa.Ge]=1.9,mO[pa.Percent]=2.9,mO[pa.At]=6.2,mO[pa.Pow]=13,mO[pa.Range]=67,mO),kO=((gO={})[la.IF]=.076,gO[la.SUM]=.11,gO[la.IFERROR]=.5,gO[la.COUNTIF]=.77,gO[la.AND]=.82,gO[la.VLOOKUP]=1.5,gO[la.AVERAGE]=1.5,gO[la.HOUR]=1.9,gO[la.MINUTE]=1.9,gO[la.TEXT]=2,gO[la.OR]=2,gO[la.NOW]=2.1,gO[la.ISBLANK]=2.3,gO[la.CONCATENATE]=2.6,gO[la.SUMIF]=2.7,gO[la.COUNTIFS]=3.3,gO[la.LEFT]=3.4,gO[la.ISNUMBER]=3.7,gO[la.MID]=3.9,gO[la.COUNTA]=4,gO[la.MONTH]=4.2,gO[la.SECOND]=4.3,gO[la.LEN]=4.9,gO[la.WEEKNUM]=5,gO[la.DAY]=5.2,gO[la.ROUND]=5.4,gO[la.FIND]=5.8,gO[la.NETWORKDAYS]=6.2,gO[la.COUNT]=6.2,gO[la.YEAR]=6.3,gO[la.INT]=6.4,gO[la.RIGHT]=6.7,gO[la.ABS]=7,gO[la.CONCAT]=7.2,gO[la.CHAR]=7.4,gO[la.MAX]=8,gO[la.ROW]=8.1,gO[la.WEEKDAY]=9.1,gO[la.DAYS]=9.2,gO[la.MIN]=9.8,gO[la.SEARCH]=9.8,gO[la.WORKDAY]=11,gO[la.DATEDIF]=12,gO[la.TIME]=13,gO[la.HYPERLINK]=13,gO[la.IFS]=13,gO[la.ISERROR]=13,gO[la.COUNTBLANK]=14,gO[la.TODAY]=14,gO[la.VALUE]=18,gO[la.ROUNDUP]=18,gO[la.MATCH]=19,gO[la.DATE]=20,gO[la.SUBSTITUTE]=20,gO[la.INDIRECT]=22,gO[la.INDEX]=23,gO[la.TRIM]=24,gO[la.UPPER]=25,gO[la.SUMIFS]=28,gO[la.EXACT]=29,gO[la.NOT]=32,gO[la.PRODUCT]=35,gO[la.ROUNDDOWN]=37,gO[la.AVERAGEIF]=38,gO[la.ISTEXT]=40,gO[la.ISOWEEKNUM]=41,gO[la.EOMONTH]=42,gO[la.MROUND]=45,gO[la.COLUMN]=45,gO[la.ROWS]=46,gO[la.TIMEVALUE]=52,gO[la.TRUNC]=53,gO[la.LOOKUP]=59,gO[la.NA]=59,gO[la.DAYS360]=61,gO[la.RANK]=67,gO[la.EDATE]=72,gO[la.MOD]=82,gO[la.OFFSET]=83,gO[la.STDEV]=87,gO[la.SUBTOTAL]=91,gO),NO=ze(te(te({},Ke(.01)),{nameNode:function(){return 1},operatorNode:function(e){var t;return null!==(t=RO[e])&&void 0!==t?t:100},wsfNode:function(e){var t;return null!==(t=kO[e])&&void 0!==t?t:100}}),ye);var AO,TO=function(){function e(e){var t,r,n,a=this;this.sampledSets={},this.precisionWrongSets={},this.log=[],this.result=void 0,this.testEval=function(e){var t=e.cell,r=e.p;return a.resumeToPledge((function(){return a.docs.evaluate(sR.EditedCell,t,cO.PrecisionTest)}),r)},this.testPrint=function(e){var t=e.cell,r=e.p;return _e.try((function(){var e=a.getFormula(t);if(!X(e))return a.onUnavailableObject(e.reason);var n,i=e.value,o=i[0],u=i[1];if(void 0===u.compiledFmla){var s=a.docs.getServerValue(t);if(!X(s))return a.onUnavailableObject(s.reason);n=a.docs.renderValueBarText(t,s.value.oper,u.fmla)}else{var c=u.compiledFmla.getValue();n=X(c)?a.docs.printFormulaBarText(o,u.origin,c.value):c}if(X(n)){var l=b(u.fmla),d=n.value===u.fmla?{expected:l,p:r}:{expected:l,sampled:b(n.value),p:r};a.log.push({kind:SO.PrintFormulaStatistics,stats:{samples:[d],failures:[]}})}else a.log.push({kind:SO.PrintFormulaStatistics,stats:{samples:[],failures:[n.reason]}})}))},this.config={samplePrecisionEvalRate:null!==(t=e.samplePrecisionEvalRate)&&void 0!==t?t:0,samplePrecisionPrintFormulaRate:null!==(r=e.samplePrecisionPrintFormulaRate)&&void 0!==r?r:0,rngSeed:null!==(n=e.rngSeed)&&void 0!==n?n:0|Re()},this.rng=new iO(this.config.rngSeed)}return Object.defineProperty(e.prototype,"done",{get:function(){return void 0!==this.result},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"resultLogMessage",{get:function(){return this.createResultLogMessage(yO.Success)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"failedLogMessage",{get:function(){return this.createResultLogMessage(yO.Timeout)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"readonlyDebugLog",{get:function(){return this.log},enumerable:!0,configurable:!0}),e.prototype.setContext=function(e){var t=this;this.stateId=e.stateId,this.docs=e.documents,this.docs.reconfigure({yieldIntervalMs:e.stepBudget/2,totalTimeMs:e.totalBudget},this.docs.limits,this.docs.maxDereferenceCells),this.runtime=new we(this.sampleCells().bind((function(e){var r=e.evalCells,n=e.printCells;return _e.all(ie(r.map(t.testEval),n.map(t.testPrint)))})).catch((function(e){t.log.push({kind:SO.UnhandledFailure,reason:e})})))},e.prototype.step=function(){this.result||(this.result=this.runtime.step())},e.prototype.sampleCells=function(){var e=this,t=[],r=[],n=[];return this.docs.getServerAvailableCells().forEach((function(a){var i=a.sheetIdx;return n.push(_e.try((function(){e.docs.forEachServerNonBlankCellInSet(i,lC,(function(n){var a=Wn(i,n),o=e.config,u=o.samplePrecisionEvalRate,s=o.samplePrecisionPrintFormulaRate;if(u>0){var c=e.getWeight(a);void 0!==(l=void 0===c?void 0:u>=1?1:Se(1,u*c))&&e.rng.next()<l&&(CO(e.sampledSets,a),t.push({cell:a,p:l}))}if(s>0){var l=s;e.rng.next()<l&&r.push({cell:a,p:l})}return!0}))}))),!0})),_e.all(n).bind((function(){return{evalCells:t,printCells:r}}))},e.prototype.getWeight=function(e){var t=this.getFormula(e);if(!X(t))return this.onUnavailableObject(t.reason);var r=t.value[1];return void 0!==r.compiledFmla?function(e){return X(e)?dt(NO,e.value):1}(r.compiledFmla.getValue()):void 0},e.prototype.resumeToPledge=function(e,t){var r=this;return _e.try((function(){try{r.p=t;var n=e();return Array.isArray(n)?n:r.resumeToPledge(n.resume,t)}finally{r.p=void 0}}))},e.prototype.getFormula=function(e){var t,r=this.docs.getEditedFormula(e);if(!X(r))return r;var n=null!==(t=r.value)&&void 0!==t?t:[e.range,gN],a=n[0],i=n[1];return q([Cn(i.lexicalKind,Bn(e.sheet,a)),i])},e.prototype.onRangeFailure=function(e,t,r,n,a){var i={samples:[],failures:[t]};this.log.push({kind:SO.EvalStatistics,stats:i})},e.prototype.onNameFailure=function(){},e.prototype.onNumberFormatFailure=function(){},e.prototype.onInferFormatFailure=function(){},e.prototype.onReturnCellValue=function(){},e.prototype.onUnavailableObject=function(e){var t=DO([e]);this.log.push({kind:SO.UnhandledFailure,reason:t})},e.prototype.hasWrongPrecedent=function(e){var t=this;return e.cells.some((function(e){return FO(t.precisionWrongSets,e)}))},e.prototype.onSetCellValue=function(e,t,r,n,a){var i=this.getFormula(e);if(!X(i))return this.onUnavailableObject(i.reason);var o=i.value,u=o[0],s=o[1],c=this.hasWrongPrecedent(r);return this.logPrecisionResult(e,t,u,s,c)},e.prototype.onSetCellValues=function(e,t,r,n,a){var i=this,o=this.getFormula(wr(e));if(!X(o))return this.onUnavailableObject(o.reason);var u=o.value,s=u[0],c=u[1],l=this.hasWrongPrecedent(r);Sr(e.range,(function(r,n,a){return i.logPrecisionResult(Wn(e.sheet,r),t[n][a],s,c,l),!0}))},e.prototype.logPrecisionResult=function(e,t,r,n,a){var i=this.docs.allServerAvailable(e);if(!X(i))return this.onUnavailableObject(i.reason);if(!0===i.value){var o=this.docs.getServerValue(e);if(!X(o))return this.onUnavailableObject(o.reason);var u=FO(this.sampledSets,e),s=this.precisionResult(t,o.value.oper,r,n,u,a);(function(e){return void 0===e.sampled})(s)||CO(this.precisionWrongSets,e);var c={samples:[s],failures:[]};this.log.push({kind:SO.EvalStatistics,stats:c})}},e.prototype.precisionResult=function(e,t,r,n,a,i){var o=this.p,u=this.docs.config.mathpack,s=EO(u,t),c=this.docs.anonymizeFormula(r,n),l=c[0],d=c[1];if(an(u,e,t,!0))return{expected:s,formula:l,functions:d,root:a,cascaded:i,p:o};var f=EO(u,e);if(Kr(t)&&Kr(e)){var h=u.toNumber(t),v=u.toNumber(e);return{expected:s,sampled:f,relMagnitude:p(0===h?v:(v-h)/h),formula:l,functions:d,root:a,cascaded:i,p:o}}return{expected:s,sampled:f,formula:l,functions:d,root:a,cascaded:i,p:o}},e.prototype.createResultLogMessage=function(e){var t,r;if(0!==this.log.length||e!==yO.Success){for(var n={samples:[],failures:{}},a={samples:[],failures:{}},i={},o=0,u=this.log;o<u.length;o++){var s=u[o];switch(s.kind){case SO.EvalStatistics:(t=n.samples).push.apply(t,s.stats.samples);for(var c=0,l=s.stats.failures;c<l.length;c++){var d=l[c];sD(n.failures,d)}break;case SO.PrintFormulaStatistics:(r=a.samples).push.apply(r,s.stats.samples);for(var f=0,h=s.stats.failures;f<h.length;f++){d=h[f];sD(a.failures,d)}break;case SO.UnhandledFailure:sD(i,s.reason);break;default:L("calc.calc.PrecisionExperiment.createResultMessage",s)}}return["PrecisionExperiment",e,"stateId = "+this.stateId,"evalStats = "+JSON.stringify(n),"printStats = "+JSON.stringify(a),"unhandledFailures = "+JSON.stringify(i)].join(", ")}},e}(),IO=wn(0,0,1<<20,16384);!function(e){e.DocumentLoc="DocumentLoc",e.SheetId="SheetId",e.SheetNames="SheetNames",e.GridRange="GridRange",e.GridRangeSize="GridRangeSize",e.CellFormat="CellFormat",e.HiddenRows="HiddenRows",e.InFilterMode="InFilterMode",e.CellFormula="CellFormula",e.CellMissingFormula="CellMissingFormula",e.CellEvaluatingValue="CellEvaluatingValue",e.ClientFailure="ClientFailure",e.NumberFormat="NumberFormat",e.NameLoc="NameLoc",e.VolatileFunction="VolatileFunction",e.TimeGranularity="TimeGranularity",e.GetTimeKind="GetTimeKind",e.ColumnName="ColumnName",e.ContainingTable="ContainingTable"}(AO||(AO={}));var OO,MO,wO,DO=sn,_O=ze(te(te({},Ke(!1)),{wsfNode:function(e){return e===la.HYPERLINK}}),(function(e,t){return e||t}));!function(e){e.EvalFinished="EvalFinished",e.EvalTimedOut="EvalTimedOut",e.StateIdAdvanced="StateIdAdvanced",e.EditReceived="EditReceived",e.SetSheetNames="SetSheetNames",e.SetRefStyle="SetRefStyle",e.SetLocaleInfo="SetLocaleInfo"}(OO||(OO={})),function(e){e[e.ServerUpdate=0]="ServerUpdate",e[e.ClientEdit=1]="ClientEdit",e[e.EvalFormula=2]="EvalFormula",e[e.BeforeCompute=3]="BeforeCompute",e[e.ComputeCellValue=4]="ComputeCellValue",e[e.AfterCompute=5]="AfterCompute",e[e.ComputeEvalFormula=6]="ComputeEvalFormula",e[e.RecalcFinished=7]="RecalcFinished",e[e.CompleteDataQuery=8]="CompleteDataQuery",e[e.MaybeCollectGarbage=9]="MaybeCollectGarbage",e[e.RunExperiment=10]="RunExperiment",e[e.TestAdvanceState=11]="TestAdvanceState"}(MO||(MO={})),function(e){e[e.Server=0]="Server",e[e.Client=1]="Client"}(wO||(wO={}));var LO=function(){function e(e,t,r,n,a){var i,o=this,u=n.date1904,s=n.dateCompatibility,c=n.timezone;void 0===a&&(a={}),this.scheduler=new bO,this.outputMessageLog=[],this.stateId=-1/0,this.stateChangesSinceLastGC=0,this.stateChanges=0,this.stateEvalTime=0,this.printFormulaProperties=function(e){var t=wr(e),r=o.getAvailableFormula(t);if(X(r)){var n=r.value,a=n[0],i=n[1],u=i.compiledFmla.getValue(),s=X(u)?o.docs.printFormulaBarText(a,t.range,u.value):u;return{formulaBarText:s.kind===H.Success?s.value:void o.outputMessageLog.push({kind:ER.PrintFormulaFailure,stateId:o.stateId,range:e,reason:s.reason}),hasHyperlink:o.formulaHasHyperlink(i),isFormula:!0}}o.onUnavailableObject(r.reason)},this.printValueProperties=function(e,t){var r,n,a=o.docs.getEditedFormula(e);if(X(a)){var i=null!==(n=null===(r=a.value)||void 0===r?void 0:r[1].fmla)&&void 0!==n?n:"",u=o.docs.renderValueBarText(e,t,i);return{formulaBarText:X(u)?u.value:void o.outputMessageLog.push({kind:ER.PrintFormulaFailure,stateId:o.stateId,range:e,reason:u.reason}),hasHyperlink:!1,isFormula:!1}}o.onUnavailableObject(a.reason)},this.scheduleAvailableFormulas=function(e,t){var r=o.docs.forEachEditedNonBlankCellInSet(e.sheet,e.set,(function(r){var n=Wn(e.sheet,r),a=o.docs.getEditedFormula(n);return a.kind===H.Failure?(o.onUnavailableObject(a.reason),!0):(void 0!==a.value&&void 0!==a.value[1].compiledFmla&&o.enqueueComputeCellValue(n,t),!0)}));X(r)||o.onUnavailableObject(r.reason)},this.scheduleAvailableValues=function(e,t){var r=o.docs.forEachEditedCellInSet(e.sheet,e.set,(function(r){var n=Wn(e.sheet,r),a=o.docs.getEditedFormula(n);return a.kind===H.Failure?(o.onUnavailableObject(a.reason),!0):(void 0!==a.value&&void 0!==a.value[1].compiledFmla||o.enqueueReturnCellValue(n,t),!0)}));X(r)||o.onUnavailableObject(r.reason)},this.docs=new fO(Lo(e,r,t,u,s,c),this,a,a,null!==(i=a.maxDereferenceCells)&&void 0!==i?i:32768),this.reconfigure(a)}return e.prototype.reconfigure=function(e){var t;this.config=e,this.rng=new iO(void 0!==e.rngSeed?e.rngSeed:0),this.docs.reconfigure(e,e,null!==(t=e.maxDereferenceCells)&&void 0!==t?t:32768)},e.prototype.setWorksheetFuncOverrides=function(e){this.docs.setWorksheetFuncOverrides(e)},e.prototype.onNameFailure=function(e,t,r){r.computeKind!==sR.EvalFormula&&this.outputMessageLog.push({kind:ER.NameFailure,stateId:this.stateId,name:e,reason:t})},e.prototype.onRangeFailure=function(e,t,r,n,a){a.computeKind!==sR.EvalFormula&&this.outputMessageLog.push({kind:ER.RangeFailure,stateId:this.stateId,cellKind:n,range:e,reason:t})},e.prototype.onNumberFormatFailure=function(e){this.outputMessageLog.push({kind:ER.NumberFormatFailure,stateId:this.stateId,reason:e})},e.prototype.onInferFormatFailure=function(e,t){this.outputMessageLog.push({kind:ER.InferFormatFailure,stateId:this.stateId,range:e,reason:t})},e.prototype.onUnavailableObject=function(e){var t=DO([e]);this.outputMessageLog.push({kind:ER.UnhandledFailure,stateId:this.stateId,reason:t})},e.prototype.onSetCellValue=function(e,t,r,n,a){if(a.computeKind!==sR.EvalFormula){var i=this.outputCell(e,t,n,this.printFormulaProperties);void 0!==i?(this.outputMessageLog.push({kind:ER.RecalcStatistics,message:SR.ChangedCell,stateId:this.stateId,cellKind:n}),n!==cR.EditedCell&&n!==cR.DependentCell||this.outputMessageLog.push(te(te({kind:ER.CellWrite,stateId:this.stateId,cellKind:n,cell:e},i),{formatted:this.formatValue(n,e,t)}))):this.outputMessageLog.push({kind:ER.RecalcStatistics,message:SR.UnchangedCell,stateId:this.stateId,cellKind:n})}},e.prototype.onSetCellValues=function(e,t,r,n,a){var i=this;if(a.computeKind!==sR.EvalFormula){var o=this.outputRange(e,t,n);void 0!==o&&(n!==cR.EditedCell&&n!==cR.DependentCell||this.outputMessageLog.push(te(te({kind:ER.RangeWrite,stateId:this.stateId,cellKind:n,range:e},o),{formatted:t.map((function(t,r){return t.map((function(t,a){return i.formatValue(n,Wn(e.sheet,Dn(e.range.row+r,e.range.col+a)),t)}))}))})))}},e.prototype.onReturnCellValue=function(e,t,r){var n=this,a=this.outputCell(e,t,r,(function(){return n.printValueProperties(e,t)}));void 0!==a?(this.outputMessageLog.push({kind:ER.RecalcStatistics,message:SR.ChangedCell,stateId:this.stateId,cellKind:cR.EditedCell}),r===cR.EditedCell&&this.outputMessageLog.push(te(te({kind:ER.CellWrite,stateId:this.stateId,cellKind:cR.EditedCell,cell:e},a),{formatted:this.formatValue(r,e,t)}))):this.outputMessageLog.push({kind:ER.RecalcStatistics,message:SR.UnchangedCell,stateId:this.stateId,cellKind:cR.EditedCell})},e.prototype.createSnapshot=function(e){var t=this;return void 0===e&&(e=wO.Client),new Promise((function(r){t.scheduler.addTask(MO.CompleteDataQuery,vO.Back,{onRun:function(){r(t.docs.clone(dO,e))},onDeleted:function(){r(void 0)}})}))},e.prototype.outputCell=function(e,t,r,n){var a;if(r===cR.EditedCell||r===cR.DependentCell){var i=this.docs.testAndSetClientValue(e,t);a=X(i)?i.value?t:void 0:void this.onUnavailableObject(i.reason)}var o=this.outputFormat(e,r),u=this.outputFormulaProperties(e,r,n);return void 0!==a||void 0!==o||void 0!==u?{value:t,format:o,formulaBarText:null==u?void 0:u.formulaBarText,hasHyperlink:null==u?void 0:u.hasHyperlink}:void 0},e.prototype.outputRange=function(e,t,r){var n=this;if(r===cR.EditedCell||r===cR.DependentCell){var a=this.docs.setClientValue(e,t);X(a)||this.onUnavailableObject(a.reason)}var i=t.map((function(t,a){return t.map((function(t,i){return n.outputFormat(Wn(e.sheet,Dn(e.range.row+a,e.range.col+i)),r)}))})),o=this.outputFormulaProperties(e,r,this.printFormulaProperties);return{values:t,formats:i,formulaBarText:null==o?void 0:o.formulaBarText}},e.prototype.outputFormat=function(e,t){if(t===cR.EditedCell){var r=this.docs.getEditedFormat(e);if(X(r)){var n=this.docs.testAndSetClientFormat(e,r.value);if(X(n)){if(n.value){var a=r.value;if(a===bR.Unavailable)return{format:DO([{kind:AO.CellFormat}]),valueType:Gv.Custom,decimals:0};var i=this.docs.resolveCellFormat(e.sheet.document,a);return X(i)?{format:"number"==typeof a?a:a.formatString,valueType:i.value.valueType,decimals:i.value.decimals}:void 0}}else this.onUnavailableObject(n.reason)}else this.onUnavailableObject(r.reason)}},e.prototype.outputFormulaProperties=function(e,t,r){if(t===cR.EditedCell){var n=r(e);if(void 0!==n){var a=n.formulaBarText,i=n.hasHyperlink,o=n.isFormula,u=this.docs.testAndSetClientFormula(e,a,i);if(X(u)){var s=u.value,c=s.hasFmlaChanged,l=s.hasHyperlinkChanged;return c||l?{formulaBarText:c?a:void 0,hasHyperlink:l?i:void 0,isFormula:o}:void 0}this.onUnavailableObject(u.reason)}}},e.prototype.formatValue=function(e,t,r){var n=this.docs.formatValueCell(t,r);if(X(n))return n.value;this.outputMessageLog.push({kind:ER.FormatValueFailure,stateId:this.stateId,cellKind:e,range:t,reason:n.reason})},e.prototype.getAvailableFormula=function(e){var t=this.docs.getEditedFormula(e);if(!X(t))return t;if(void 0===t.value)return Q({kind:AO.CellMissingFormula});var r=t.value,n=r[0],a=r[1];return void 0===a.compiledFmla?Q({kind:AO.CellEvaluatingValue}):q([Cn(a.lexicalKind,Bn(e.sheet,n)),a])},e.prototype.formulaHasHyperlink=function(e){var t;if(e.lexicalKind!==vn.Cell)return!1;var r=null===(t=null==e?void 0:e.compiledFmla)||void 0===t?void 0:t.getValue();return X(r)?dt(_O,r.value):void 0},e.prototype.handleSetCellContents=function(e,t,r,n,a,i,o,u,s){var c,l,d,f,h=void 0!==u?DO([{kind:AO.ClientFailure,reason:u}]):void 0,v=o;void 0!==n?(l=n,x("calc.calc.PartialWorkbook.handleSetCellContents: formula edit",void 0!==a),d=a):void 0===r?(x("calc.calc.PartialWorkbook.handleSetCellContents: format edit",!e&&void 0===a&&void 0!==o&&void 0===h),l=!1,d=void 0):(x("calc.calc.PartialWorkbook.handleSetCellContents: inferred edit",!e&&void 0===h&&v===bR.Weak),l=(c=this.parseInferredEdit(t,r,i,h,v)).isFormula,d=c.oper,h=c.cellFailure,v=c.cellFormat,f=c.inferredFormat);var p=this.docs.setCellContents(e,t,r,l,i,d,h,v,s);if(p.kind===H.Failure)return this.onUnavailableObject(p.reason);if(this.docs.onCellModified(e),!e){var m=Wn(t.sheet,i),g=void 0===r?q(void 0):l?this.docs.inferFormulaFormat(m):void 0!==f&&f!==Wa.General?this.docs.resolveValueFormat(t.sheet.document,f):q(void 0);g.kind!==H.Success&&(this.onInferFormatFailure(m,g.reason),g=q(bR.Unavailable)),void 0!==g.value&&this.docs.fillInferredFormat(t,g.value),this.enqueueBeforeCompute(s)}},e.prototype.parseInferredEdit=function(e,t,r,n,a){var i=this.docs.parseInferredEdit(Wn(e.sheet,r),t,this.getVolatileMode());if(!X(i))return{isFormula:!1,oper:fa,cellFailure:i.reason,cellFormat:bR.Unavailable};switch(i.value.kind){case lp.Formula:return{isFormula:!0,oper:fa,cellFailure:n,cellFormat:a};case lp.String:case lp.Other:return{isFormula:!1,oper:i.value.value,cellFailure:n,cellFormat:a};case lp.Number:return{isFormula:!1,oper:i.value.value,cellFailure:n,cellFormat:a,inferredFormat:i.value.format}}},e.prototype.handleSetRangeFormula=function(e,t,r,n,a){var i=ZR(r);x("calc.calc.PartialWorkbook: handleSetRangeFormula",""===r&&!e||i);var o=e?void 0:fa,u=e?void 0:bR.Weak,s=this.docs.setRangeFormula(e,t,r,n,o,u,a);if(s.kind===H.Failure)return this.onUnavailableObject(s.reason);this.docs.onCellModified(e),e||this.enqueueBeforeCompute(a)},e.prototype.evalFormula=function(e,t,r,n){var a=this;return new Promise((function(i){var o=function(){return i({value:Q($S)})};a.scheduler.deleteTasks(MO.EvalFormula,void 0),a.scheduler.addTask(MO.EvalFormula,vO.Back,{onRun:function(){if(!a.trySetStateId(MO.EvalFormula,e))return o();a.enqueueComputeEvalFormula(t,r,n,i)},onDeleted:o}),a.enqueueRecalcFinished()}))},e.prototype.enqueueBeforeCompute=function(e){var t=this;this.scheduler.deleteTasks(MO.BeforeCompute,void 0),this.scheduler.addTask(MO.BeforeCompute,vO.Back,(function(){t.enqueueAfterCompute(),t.restrictToViewport(t.docs.getNonDirtyEditedCells(),e,sR.EditedCell,t.scheduleAvailableValues),t.restrictToViewport(t.docs.getDirtyEditedCells(),e,sR.EditedCell,t.scheduleAvailableFormulas),t.restrictToViewport(t.docs.getDirtyDependentCells(),e,sR.DependentCell,t.scheduleAvailableFormulas)}))},e.prototype.withEvalTiming=function(e){var t=this.docs.schedulerConfig.totalTimeMs;if(void 0===t)return e();var r,n=Re();try{r=e()}finally{this.stateEvalTime+=ye(1,Re()-n),this.stateEvalTime>=t&&(this.deleteComputeTasks(OO.EvalTimedOut),this.outputMessageLog.push({kind:ER.RecalcStatistics,stateId:this.stateId,message:SR.StateTimedOut}),r=[])}return r},e.prototype.enqueueComputeCellValue=function(e,t){var r,n=this,a=t===sR.EditedCell&&this.shouldSample(this.config.sampleRecalcEditedStopwatchRate)?zi("calc.calc.PartialWorkbook: recalc edited"):void 0,i=!0,o=function(){return n.docs.evaluate(t,e,n.getVolatileMode())},u=function(){if(i){i=!1,r=n.shouldSample(n.config.sampleCellEvalStopwatchRate)?zi("calc.calc.PartialWorkbook: cell eval"):void 0;var t=n.docs.getEditedFormula(e);if(!X(t))return n.onUnavailableObject(t.reason);if(void 0===t.value)return}else n.outputMessageLog.push({kind:ER.RecalcStatistics,stateId:n.stateId,message:SR.ContinueComputation});var s=n.withEvalTiming(o);if(Array.isArray(s))return null==r||r.stop(),void(null==a||a.stop());o=s.resume,n.scheduler.addTask(MO.ComputeCellValue,vO.Front,u)};this.scheduler.addTask(MO.ComputeCellValue,vO.Back,u)},e.prototype.enqueueComputeEvalFormula=function(e,t,r,n){var a=this,i=this.getVolatileMode(),o=function(){return a.docs.evalFormula(e,t,r,i)},u={onRun:function(){var e=o();e.kind===H.Paused?(o=e.resume,a.scheduler.addTask(MO.ComputeEvalFormula,vO.Front,u)):n(e.value)},onDeleted:function(){return n({value:Q($S)})}};this.scheduler.addTask(MO.ComputeEvalFormula,vO.Back,u)},e.prototype.enqueueReturnCellValue=function(e,t){var r=this,n=this.getVolatileMode();this.scheduler.addTask(MO.ComputeCellValue,vO.Back,(function(){r.docs.evalValue(e,t,n)}))},e.prototype.enqueueAfterCompute=function(){var e=this;this.scheduler.deleteTasks(MO.AfterCompute,OO.EditReceived);var t=this.shouldSample(this.config.sampleRecalcViewportStopwatchRate)?zi("calc.calc.PartialWorkbook: recalc viewport"):void 0;this.scheduler.addTask(MO.AfterCompute,vO.Back,{onRun:function(){null==t||t.stop(OO.EvalFinished),e.outputMessageLog.push({kind:ER.RecalcStatistics,message:SR.EditFinished,stateId:e.stateId})},onDeleted:function(e){null==t||t.stop(e)}})},e.prototype.enqueueRecalcFinished=function(){var e=this;this.scheduler.deleteTasks(MO.RecalcFinished,void 0),this.scheduler.addTask(MO.RecalcFinished,vO.Back,(function(){e.outputMessageLog.push({kind:ER.RecalcStatistics,message:SR.RecalcFinished,stateId:e.stateId})}))},e.prototype.promoteCellContents=function(e,t,r,n){var a=this;this.scheduler.addTask(MO.ServerUpdate,vO.Back,(function(){if(a.trySetStateId(MO.ServerUpdate,e)){var i=a.docs.promoteServerAvailability(r,n);if(i.kind===H.Failure)return a.onUnavailableObject(i.reason);a.docs.onCellModified(!0),i.value||a.outputMessageLog.push({kind:ER.UpdateRequest,stateId:a.stateId,range:t})}}))},e.prototype.writeCellContents=function(e,t,r,n,a,i,o,u){var s=this;this.scheduler.addTask(MO.ServerUpdate,vO.Back,(function(){s.trySetStateId(MO.ServerUpdate,e)&&s.handleSetCellContents(!0,t,r,n,i,a,o,u,void 0)}))},e.prototype.editCellContents=function(e,t,r,n,a,i,o){var u=this;void 0===i&&(i=fa),void 0===o&&(o=Bn(t.sheet,IO)),this.scheduler.addTask(MO.ClientEdit,vO.Back,(function(){u.trySetStateId(MO.ClientEdit,e)&&u.handleSetCellContents(!1,t,r,n,i,a,bR.Weak,void 0,o)})),this.enqueueRecalcFinished()},e.prototype.editCellFormats=function(e,t,r,n){var a=this;void 0===n&&(n=Bn(t.sheet,IO)),this.scheduler.addTask(MO.ClientEdit,vO.Back,(function(){if(a.trySetStateId(MO.ClientEdit,e)){var i=a.docs.resolveEditFormat(t.sheet.document,r);X(i)||pR(t.set,(function(e){return a.onInferFormatFailure(Bn(t.sheet,e),i.reason),!0})),a.handleSetCellContents(!1,t,void 0,void 0,void 0,Dn(0,0),X(i)?i.value:bR.Unavailable,void 0,n)}})),this.enqueueRecalcFinished()},e.prototype.writeArrayFormula=function(e,t,r,n,a){var i=this;void 0===n&&(n=Mr(t.range)),void 0===a&&(a=!1),this.scheduler.addTask(MO.ServerUpdate,vO.Back,(function(){i.trySetStateId(MO.ServerUpdate,e)&&i.handleSetRangeFormula(!0,t,r,n,void 0)}))},e.prototype.editArrayFormula=function(e,t,r,n,a){var i=this;void 0===n&&(n=Mr(t.range)),void 0===a&&(a=Bn(t.sheet,IO)),this.scheduler.addTask(MO.ClientEdit,vO.Back,(function(){i.trySetStateId(MO.ClientEdit,e)&&i.handleSetRangeFormula(!1,t,r,n,a)})),this.enqueueRecalcFinished()},e.prototype.testAdvanceState=function(e){var t=this;this.scheduler.addTask(MO.TestAdvanceState,vO.Back,(function(){t.trySetStateId(MO.TestAdvanceState,e)}))},e.prototype.step=function(){if(!this.scheduler.runTask())return{queueEmpty:!0,messages:[]};var e=this.outputMessageLog;return this.outputMessageLog=[],{queueEmpty:!1,messages:e}},e.prototype.trySetStateId=function(e,t){var r,n,a,i;if(t<this.stateId)return!1;if(e===MO.ClientEdit&&(this.deleteComputeTasks(OO.EditReceived),this.stateEvalTime=0),t>this.stateId){if(this.stateId!==-1/0){var o=this.config.sampleWorkbookStatisticsRate;void 0!==o&&this.shouldSample(o)&&this.outputMessageLog.push({kind:ER.WorkbookStatistics,stateId:this.stateId,stats:this.getStatistics(),p:o})}if(2===this.stateChanges&&void 0!==this.config.experimentDefinitions)for(var u=this.config.experimentDefinitions,s={stateId:this.stateId,documents:this.docs.clone(),stepBudget:u.stepBudget,totalBudget:u.totalBudget},c=0,l=u.experiments;c<l.length;c++){(p=l[c]).setContext(s),this.enqueueRunExperiment(u.stepBudget,u.totalBudget,p)}var d=null!==(r=this.config.samplePrecisionEvalRate)&&void 0!==r?r:0,f=null!==(n=this.config.samplePrecisionPrintFormulaRate)&&void 0!==n?n:0;if(this.stateChanges>=2&&(d>0||f>0)&&0===this.scheduler.getCount(MO.RunExperiment)){var h=null!==(a=null==(u=this.config.experimentDefinitions)?void 0:u.stepBudget)&&void 0!==a?a:10,v=null!==(i=null==u?void 0:u.totalBudget)&&void 0!==i?i:1e4,p=new TO({samplePrecisionEvalRate:d,samplePrecisionPrintFormulaRate:f});s={stateId:this.stateId,documents:this.docs.clone(p),stepBudget:h,totalBudget:v};p.setContext(s),this.enqueueRunExperiment(h,v,p)}this.deleteComputeTasks(OO.StateIdAdvanced);var m=this.stateId;this.stateId=t,this.docs.advanceState(m),this.outputMessageLog.push({kind:ER.StateAdvanced,stateId:this.stateId}),this.stateEvalTime=0,this.stateChangesSinceLastGC+=1,this.stateChanges+=1,this.enqueueMaybeCollectGarbage()}return!0},e.prototype.deleteComputeTasks=function(e){this.scheduler.deleteTasks(MO.BeforeCompute,void 0),this.scheduler.deleteTasks(MO.ComputeCellValue,void 0),this.scheduler.deleteTasks(MO.AfterCompute,e),e!==OO.EvalTimedOut&&this.scheduler.deleteTasks(MO.ComputeEvalFormula,void 0)},e.prototype.enqueueRunExperiment=function(e,t,r){var n=this,a=0,i=function(){var e=r.failedLogMessage;void 0!==e&&n.outputMessageLog.push({kind:ER.ExperimentRunResult,logMessage:e})},o=function(){if(r.done){var u=r.resultLogMessage;void 0!==u&&n.outputMessageLog.push({kind:ER.ExperimentRunResult,logMessage:u})}else{for(var s=Re(),c=s,l=0;l<1e3&&c===s;l+=1){r.step();var d=Re();if(d-c>=e&&!r.done)return void i();c=d}(a+=c>s?c-s:1)>=t&&!r.done?i():n.scheduler.addTask(MO.RunExperiment,vO.Front,o)}};this.scheduler.addTask(MO.RunExperiment,vO.Back,o)},e.prototype.setSheetNames=function(e,t,r){var n=this;this.scheduler.addTask(MO.ServerUpdate,vO.Back,(function(){if(n.trySetStateId(MO.ServerUpdate,r)){var a=n.docs.setSheetNames(e,t);a.kind===H.Failure&&n.onUnavailableObject(a.reason),n.deleteComputeTasks(OO.SetSheetNames)}}))},e.prototype.setRefStyle=function(e,t){var r=this;this.scheduler.addTask(MO.ServerUpdate,vO.Back,(function(){if(r.trySetStateId(MO.ServerUpdate,t)){var n=r.docs.config,a=n.localeInfo,i=n.mathpack,o=n.date1904,u=n.dateCompatibility,s=n.timezone;r.docs.setConfig(Lo(a,e,i,o,u,s)),r.docs.clearCompiledFormulas(),r.deleteComputeTasks(OO.SetRefStyle)}}))},e.prototype.setLocaleInfo=function(e,t){var r=this;this.scheduler.addTask(MO.ServerUpdate,vO.Back,(function(){if(r.trySetStateId(MO.ServerUpdate,t)){var n=r.docs.config,a=n.refStyle,i=n.mathpack,o=n.date1904,u=n.dateCompatibility,s=n.timezone;r.docs.setConfig(Lo(e,a,i,o,u,s)),r.docs.clearCompiledFormulas(),r.docs.clearCompiledNumberFormats(),r.deleteComputeTasks(OO.SetLocaleInfo)}}))},e.prototype.setWorkbookProps=function(e,t){var r=this;this.scheduler.addTask(MO.ServerUpdate,vO.Back,(function(){if(r.trySetStateId(MO.ServerUpdate,t)){var n=r.docs.config,a=n.localeInfo,i=n.refStyle,o=n.mathpack,u=e.date1904,s=e.dateCompatibility,c=e.timezone;r.docs.setConfig(Lo(a,i,o,u,s,c))}}))},e.prototype.setNumberFormats=function(e,t,r,n){var a=this;this.scheduler.addTask(MO.ServerUpdate,vO.Back,(function(){if(a.trySetStateId(MO.ServerUpdate,n)){var i=a.docs.setNumberFormats(e,t,r);return i.kind===H.Failure?a.onUnavailableObject(i.reason):void 0}}))},e.prototype.writeNamedObject=function(e,t,r,n){var a=this;this.scheduler.addTask(MO.ServerUpdate,vO.Back,(function(){if(a.trySetStateId(MO.ServerUpdate,e)){var i=a.docs.setNamedObject(!0,Hn(t,r),n);return i.kind===H.Failure?a.onUnavailableObject(i.reason):void 0}}))},e.prototype.writeUndefinedNames=function(e,t){var r=this;this.scheduler.addTask(MO.ServerUpdate,vO.Back,(function(){if(r.trySetStateId(MO.ServerUpdate,e)){var n=r.docs.setUndefinedNames(t);return n.kind===H.Failure?r.onUnavailableObject(n.reason):void 0}}))},e.prototype.promoteNamedObjects=function(e,t,r){var n=this;this.scheduler.addTask(MO.ServerUpdate,vO.Back,(function(){if(n.trySetStateId(MO.ServerUpdate,e)){var a=n.docs.promoteNamedObjects(t,r);if(a.kind===H.Failure)return n.onUnavailableObject(a.reason);a.value||n.outputMessageLog.push({kind:ER.UpdateNamesRequest,stateId:n.stateId,scope:t})}}))},e.prototype.extendUnusedRange=function(e,t){var r=this;this.scheduler.addTask(MO.ServerUpdate,vO.Back,(function(){if(r.trySetStateId(MO.ServerUpdate,t)){var n=r.docs.extendServerUnused(e.sheet,e.range);if(n.kind===H.Failure)return r.onUnavailableObject(n.reason);r.docs.onCellModified(!0)}}))},e.prototype.writeHiddenRows=function(e,t){var r=this;this.scheduler.addTask(MO.ServerUpdate,vO.Back,(function(){if(r.trySetStateId(MO.ServerUpdate,e)){var n=r.docs.writeHiddenRows(t.sheet,t.range,t.hidden);return n.kind===H.Failure?r.onUnavailableObject(n.reason):void 0}}))},e.prototype.writeInFilterMode=function(e,t){var r=this;this.scheduler.addTask(MO.ServerUpdate,vO.Back,(function(){if(r.trySetStateId(MO.ServerUpdate,e)){var n=r.docs.writeInFilterMode(t.sheet,t.inFilterMode);return n.kind===H.Failure?r.onUnavailableObject(n.reason):void 0}}))},e.prototype.getStatistics=function(){return{queueSize:this.scheduler.getCount(),totalGridStatistics:this.docs.getGridStatistics(),totalNameStatistics:this.docs.getNameStatistics()}},e.prototype.enqueueMaybeCollectGarbage=function(){var e=this;this.scheduler.deleteTasks(MO.MaybeCollectGarbage,void 0),this.scheduler.addTask(MO.MaybeCollectGarbage,vO.Back,(function(){if(!(e.stateChangesSinceLastGC<17)){var t=e.stateId-17;e.docs.collectGarbage(t),e.outputMessageLog.push({kind:ER.GarbageCollected,minStateIdKept:t}),e.stateChangesSinceLastGC=0}}))},e.prototype.shouldSample=function(e){return void 0!==e&&this.rng.next()<=e},e.prototype.restrictToViewport=function(e,t,r,n){if(void 0!==t)for(var a=t.sheet,i=oR(t.range),o=0,u=e;o<u.length;o++){Nr(a,(l=u[o]).sheet)&&n(gR(a,HC(l.set,i)),r)}else for(var s=0,c=e;s<c.length;s++){var l;n(l=c[s],r)}},e.prototype.getVolatileMode=function(){var e;return null!==(e=this.config.volatileMode)&&void 0!==e?e:cO.Estimation},e}();function UO(e){return new Promise((function(t){return setTimeout(t,e)}))}function xO(e,t){var r=t&&t.timeThreshold||10,n=t&&t.costThreshold||1,a=t&&t.macrotaskDelay||0,i={iterations:0,microtaskContinues:0,macrotaskContinues:0,macrotaskTotalDelay:0},o=gF(),u=o[0],s=o[1],c=s[0],l=s[1];var d=!0;var f=UO(a),h=Re();return function t(){if(!d||!function(){try{for(var t=0;t<n;){i.iterations+=1;var r=e();if(void 0===r)return!1;t+=r}return!0}catch(e){return l(e),!1}}())return c();var o=Re();o-h<r?(Promise.resolve().then(t),i.microtaskContinues+=1):(f.then((function(){f=UO(a),h=Re(),i.macrotaskTotalDelay+=h-o,t()})),i.macrotaskContinues+=1)}(),{promise:u,stop:function(){d=!1},stats:i}}var BO=r(11);function WO(e){for(var t=2166136261,r=e.length,n=0;n<r;n+=1)t^=e.charCodeAt(n),t+=(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24);return t>>>0}var PO,VO=function(){function e(e){void 0===e&&(e=75),this.timeLimitMS=e,this.result=void 0}return Object.defineProperty(e.prototype,"done",{get:function(){return!0},enumerable:!0,configurable:!0}),e.prototype.setContext=function(e){var t=e.documents;try{_.ULS.traceTag(578588694,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"calc.calc.RecalcService: ExceLint experiment setContext started");var r=function(e){for(var t,r,n,a,i=e.getServerDocument(),o=[],u=0,s=e.getServerAvailableCells();u<s.length;u++){var c=s[u],l="UndefinedSheet";if(void 0!==i){var d=e.getSheetName(i,c.sheetIdx.index);d.kind===H.Success&&(l=d.value)}var f=e.getServerUsedRange(c.sheetIdx);if(f.kind!==H.Failure&&void 0!==f.value){var h=f.value.sheet,v=te({},f.value.range);v.cols=Math.min(v.cols,75),v.rows=Math.min(v.rows,1e3);for(var p=[],m=[],g=[],S=0,y=v.row,b=v.row+v.rows-1;y<=b;y+=1){for(var E=[],F=[],C=[],R=v.col,k=v.col+v.cols-1;R<=k;R+=1){var N=Wn(h,Dn(y,R)),A=e.getServerValue(N),T=A.kind===H.Success?JSON.stringify(A.value):"";F.push(T);var I=e.getServerFormat(N),O=I.kind===H.Success?WO(JSON.stringify(I.value)).toString():"";C.push(O);var M=e.getServerFormula(N),w=M.kind===H.Success?null===(r=null===(t=M.value)||void 0===t?void 0:t.compiledFmla)||void 0===r?void 0:r.getValue():void 0,D=(null==w?void 0:w.kind)===H.Success&&null!==(a=null===(n=M.value)||void 0===n?void 0:n.fmla)&&void 0!==a?a:"";""!==D&&(S+=1),E.push(D)}p.push(E),m.push(F),g.push(C)}if(0!==S){var _={sheetName:l,usedRangeAddress:ji(e.config.localeInfo,v,l),values:m,formulas:p,styles:g};o.push(_)}}}return{workbookName:"PartialWorkbook",worksheets:o}}(t);this.result=Object(BO.detect_errors)(r,void 0,void 0,this.timeLimitMS)}catch(e){this.result="ExceLint experiment crashed with error: "+e}},e.prototype.step=function(){},Object.defineProperty(e.prototype,"report",{get:function(){var e=this;return void 0===this.result||"string"==typeof this.result?[]:Object.keys(this.result.worksheets).map((function(t){var r=e.result.worksheets[t],n=r.exampleFixes.map((function(e,t){var n=r.proposedFixes[t][0],a=e.rangeSizes,i=a.reduce((function(e,t){return e+t}),0);return{anomalousnessIndex:n,categories:e.bin,sizeOfCellRange:i,sizeOfEachSFRRange:a,redactedFormulaForEachSFR:e.formulas.map(b),stylesDiffer:!e.sameFormat,operatorsDiffer:null,direction:e.direction}})),a=n.map((function(e){return e.sizeOfEachSFRRange.length})).reduce((function(e,t){return e+t}),0);return{totalFormulas:r.numFormulaCells,totalSimilarFormulaRanges:a,numberOfAdjacentSFRs:n.length,numberOfAnomalousRanges:r.suspiciousRanges,numberOfCellsInAnomalousRanges:r.suspiciousCells,anomalies:n,elapsedTimeSeconds:r.elapsedTimeSeconds,proposedFixesTimeSeconds:r.proposedFixesTimeSeconds,adjustProposedFixesTimeSeconds:r.adjustProposedFixesTimeSeconds,adjustFormatProposedFixesTimeSeconds:r.adjustFormatProposedFixesTimeSeconds,exampleFixesTimeSeconds:r.exampleFixesTimeSeconds,numCountingTimeSeconds:r.numCountingTimeSeconds,columns:r.columns,rows:r.rows}})).filter((function(e){return e.totalFormulas>0}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"resultLogMessage",{get:function(){return"string"==typeof this.result?this.result:void 0===this.result?"ExceLint experiment return <undefined>":"ExceLint experiment done. Result: "+JSON.stringify(this.report)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"failedLogMessage",{get:function(){return this.resultLogMessage+" BTW, experiment ran out of time budget"},enumerable:!0,configurable:!0}),e}();function GO(e,t){for(var r in e)if(!t(r,e[r]))return!1;return!0}!function(e){e.Root="calc.exp.gauss",e.Default="uninitialised",e.Initialised="init",e.Failure="fail",e.UnifyBound="unifyBound"}(PO||(PO={}));var HO=function(e,t){return GO(e.consts,t)};function jO(e,t){var r=0;!function(e,t){for(var r in e)t(r,e[r])}(t.vars,(function(){return r+=1})),x(e,void 0===t.name||1===t.varCount),x(e,t.varCount===r)}function KO(e,t,r){var n={varCount:e,vars:t,consts:r,name:void 0};return jO(PO.Root,n),n}function YO(){}function qO(){return new YO}var zO=qO();function JO(){return KO(0,{},qO())}function QO(e){return KO(0,{},e)}function XO(e){var t,r=KO(1,((t={})[e]=1,t),zO);return r.name=e,r}var ZO=function(){return!1};function $O(e){if(0===e.varCount)return!0;if(void 0!==e.name)return!0;if(1===e.varCount&&(e.consts===zO||HO(e,ZO))){var t=function(e,t){for(var r in e.vars)return t===e.vars[r]?r:void 0}(e,1);return void 0!==t&&(e.name=t,!0)}return!1}function eM(e,t){return r=function(e,r){return t.vars[e]===r},GO(e.vars,r)&&HO(e,(function(e,r){return t.consts[e]===r}));var r}function tM(e,t){var r,n,a=JO(),i=e.vars,o=e.consts,u=t.vars,s=t.consts;for(var c in i){0!==(l=i[c]+(null!==(r=u[c])&&void 0!==r?r:0))&&(a.vars[c]=l,a.varCount+=1)}for(var c in o){var l;0!==(l=o[c]+(null!==(n=s[c])&&void 0!==n?n:0))&&(a.consts[c]=l)}for(var c in u)void 0===i[c]&&(a.vars[c]=u[c],a.varCount+=1);for(var c in s)void 0===o[c]&&(a.consts[c]=s[c]);return jO(PO.Root,a),a}function rM(e,t,r){var n=t.vars,a=t.consts,i=n[e];if(void 0===i)return t;var o=0,u=JO(),s=u.vars,c=u.consts;for(var l in n){var d=r.vars[l],f=void 0===d?0:d;0!==(h=(l===e?0:n[l])+f*i)&&(o+=1,s[l]=h)}for(var l in r.vars){void 0===n[l]&&(o+=1,s[l]=i*r.vars[l])}for(var l in a){var h,v=r.consts[l];0!==(h=a[l]+i*(void 0===v?0:v))&&(c[l]=h)}for(var l in r.consts){void 0===a[l]&&(c[l]=i*r.consts[l])}return KO(o,s,c)}var nM=function(){},aM={kind:1,substitution:nM},iM=function(e){return{kind:1,substitution:e}},oM={kind:0},uM=function(e){return e<0?-e:e};function sM(e,t,r){var n={};return r===nM?t:t===nM?r:function(a){var i=n[a];if(void 0!==i)return i;var o=r(a);return n[a]=void 0===o?t(a):e(t,o)}}function cM(e,t){return function(r){return e===r?t:void 0}}var lM=function(e,t,r){return function e(t,r,n){if(t>=100)return U(PO.UnifyBound);if(0===n.varCount)return HO(n,ZO)?aM:oM;if(1===n.varCount){var a;for(var i in n.vars){a=i;break}x(PO.Root,void 0!==a);var o=n.vars[a],u={};for(var s in n.consts){if((p=n.consts[s])%o!=0)return oM;u[s]=-p/o}return iM(cM(a,QO(u)))}var c,l=0,d=void 0,f=n.vars,h=n.consts,v=n.varCount;for(var s in f){var p=f[s],m=uM(p);(void 0===d||m<d)&&(l=p,d=m,c=s)}x(PO.Root,void 0!==c),x(PO.Root,0!==l);var g={},S={};for(var s in f)if(s===c)g[s]=1;else{p=f[s];g[s]=-Math.floor(p/l)}for(var s in h){p=h[s];S[s]=-Math.floor(p/l)}var y=KO(v,g,S),b=e(t+1,r,rM(c,n,y));return 0===b.kind?b:iM(sM(r,b.substitution,cM(c,y)))}(0,e,function(e,t){var r,n,a=JO(),i=e.vars,o=e.consts,u=t.vars,s=t.consts;for(var c in i){0!==(l=i[c]-(null!==(r=u[c])&&void 0!==r?r:0))&&(a.vars[c]=l,a.varCount+=1)}for(var c in o){var l;0!==(l=o[c]-(null!==(n=s[c])&&void 0!==n?n:0))&&(a.consts[c]=l)}for(var c in u)void 0===i[c]&&(a.vars[c]=-u[c],a.varCount+=1);for(var c in s)void 0===o[c]&&(a.consts[c]=-s[c]);return jO(PO.Root,a),a}(t,r))};function dM(e,t){return void 0===t&&(t=void 0),{kind:0,flags:e,unit:t}}function fM(e){return{kind:1,reference:e,resolution:void 0}}function hM(e,t){return{kind:2,elementType:e,dimensions:t}}function vM(e){return{kind:3,flags:e}}function pM(e){var t;switch(e.kind){case 1:var r=null===(t=e.resolution)||void 0===t?void 0:t.range;return void 0!==r&&(!!pr(r)||{rows:r.rows,columns:r.cols,exact:!0});case 2:return e.dimensions;case 0:return!0;case 3:return!1}}function mM(e,t){return function(e,t){if("object"==typeof e)return"object"==typeof t?{rows:Math.max(e.rows,t.rows),columns:Math.max(e.columns,t.columns),exact:e.exact&&t.exact}:te(te({},e),{exact:e.exact&&t});if("object"==typeof t)return te(te({},t),{exact:t.exact&&e});return e&&t}(pM(e),pM(t))}function gM(e,t){return!0===t?e:hM(e,t)}var SM=dM(bt.Boolean),yM=dM(bt.String),bM=dM(bt.Number),EM=QO({}),FM=dM(bt.Number,EM),CM=dM(bt.Error),RM=dM(bt.Missing|bt.Blank),kM=vM(Et.None),NM=vM(Et.All),AM=dM(bt.Number|bt.Boolean|bt.String),TM=function(e){return dM(bt.Number|bt.Boolean|bt.String,e)};var IM,OM=function(){function e(){this.roots=[],this.backlinks=[],this.descriptors=[],this.ranks=[]}return e.prototype.makePoint=function(e){var t=this.roots.length;return this.roots.push(t),this.backlinks.push(t),this.descriptors.push(e),this.ranks.push(0),t},e.prototype.find=function(e){for(var t=this.roots,r=e;t[r]!==r;)t[r]=t[t[r]],r=t[r];return r},e.prototype.findWithDescriptor=function(e){var t=this.find(e);return[t,this.descriptors[t]]},e.prototype.union=function(e,t,r){void 0===r&&(r=!1);var n=this.find(e),a=this.find(t);if(n!==a){var i=this.roots,o=this.backlinks,u=this.ranks;if(r){var s=o[a];return o[a]=o[n],o[n]=s,i[a]=n,void(u[n]<=u[a]&&(u[n]=u[a]+1))}if(u[n]<u[a]){s=o[n];o[n]=o[a],o[a]=s,i[n]=a}else{s=o[a];o[a]=o[n],o[n]=s,i[a]=n,u[n]===u[a]&&(u[n]+=1)}}},e.prototype.forEachInClass=function(e,t){var r=this.backlinks,n=e;for(t(n);r[n]!==e;)t(n=r[n])},e}(),MM={kind:0},wM={kind:1},DM=function(e){return{kind:2,constraint:e}},_M=QO({error:1}),LM=QO({}),UM=QO({currency:1}),xM=QO({percentage:1}),BM=QO({date:1});function WM(e,t,r){var n,a=new OM,i=a.makePoint(_M),o=(n=_M,function(e,t){if(0===t.varCount||e===nM)return t;var r=t;for(var a in t.vars){var i=e(a);if(i===n)return n;void 0!==i&&(r=rM(a,r,i))}return r});return{symbolContext:e,typeContext:t,stats:r,uf:a,errorPoint:i,errorUnit:_M,apply:o}}function PM(e,t){return void 0===t.link&&(t.link=e.uf.makePoint(t.unit)),t.link}function VM(e,t,r,n){return x(PO.Root,0===r.varCount),e.uf.union(void 0===n?e.uf.makePoint(r):n,t,!0),MM}function GM(e,t,r,n,a){return t===e.errorUnit?(x(PO.Root,r===e.errorPoint),void 0!==a&&e.uf.union(e.errorPoint,a,!0),MM):n===e.errorUnit?(x(PO.Root,a===e.errorPoint),void 0!==r&&e.uf.union(e.errorPoint,r,!0),MM):0===t.varCount?0===n.varCount?eM(i=t,o=n)&&eM(o,i)?MM:(void 0!==r&&e.uf.union(e.errorPoint,r,!0),void 0!==a&&e.uf.union(e.errorPoint,a,!0),wM):(x(PO.Root,void 0!==a),VM(e,a,t,r)):1===n.varCount?(x(PO.Root,void 0!==r),x(PO.Root,void 0!==a),e.uf.union(r,a),MM):(x(PO.Root,void 0!==r),VM(e,r,n,a));var i,o}function HM(e,t,r){if(!$O(t))return DM({kind:2,unit:t,target:r});var n=PM(e,r),a=e.uf.findWithDescriptor(n),i=a[0],o=a[1];if(1===t.varCount){x(PO.Root,void 0!==t.name);var u=e.symbolContext.getTable().getValue(t.name);x(PO.Root,void 0!==u);var s=e.uf.findWithDescriptor(PM(e,u)),c=s[0];return GM(e,s[1],c,o,i)}return GM(e,t,void 0,o,i)}function jM(e){return e!==bR.Unavailable&&0!==e&&("object"!=typeof e||e.valueType!==Gv.General)}function KM(e,t,r){var n=e.typeContext.types[t.index];if(void 0===n)return U(PO.Root);var a=n.getValue(r);if(void 0===a){var i=e.typeContext.formats(Wn(t,r));if(X(i)){if(!jM(i.value)){var o=e.symbolContext.freshSymbol().unit;return e.typeContext.types[t.index]=n.setValue(r,TM(o)),o}var u=YM(e,i.value);return void 0===u?u=e.symbolContext.freshSymbol().unit:e.stats.formatCells+=1,e.typeContext.types[t.index]=n.setValue(r,TM(u)),u}var s=e.symbolContext.freshSymbol().unit;return e.typeContext.types[t.index]=n.setValue(r,TM(s)),s}return 0===a.kind?a.unit:void 0}function YM(e,t){var r;if("number"==typeof t){var n=e.typeContext.getIformat(t);if(!X(n))return;r=n.value}else r=t;switch(r.valueType){case Gv.Currency:return UM;case Gv.Percentage:return xM;case Gv.Accounting:return UM;case Gv.Fraction:return LM;case Gv.Date:return BM;default:return}}var qM=((IM={})[2]=function(e,t){return HM(e,t.unit,t.target)},IM[3]=function(e,t){var r=YM(e,t.format);if(void 0===r)return MM;var n=KM(e,t.cell.sheet,t.cell.range);if(void 0===n)return MM;if(!$O(n))return DM(t);if(1===n.varCount){x(PO.Root,void 0!==n.name);var a=e.symbolContext.getTable().getValue(n.name);x(PO.Root,void 0!==a);var i=e.uf.findWithDescriptor(PM(e,a)),o=i[0];return GM(e,i[1],o,r,void 0)}return GM(e,n,void 0,r,void 0)},IM[0]=function(e,t){var r=t.type.resolution;if(!hr(r.sheet))return MM;if(pr(r.range)){var n=KM(e,r.sheet,r.range);return void 0===n?MM:HM(e,n,t.target)}var a=oR(r.range),i=e.typeContext.available[r.sheet.index];if(void 0===i)return MM;var o=HC(a,i.availableCells),u=[];return mR(o,(function(e){return u.push(e),!0})),{kind:3,constraint:{kind:1,cursor:0,index:i.sheetIdx,cells:u,target:t.target},output:void 0}},IM[1]=function(e,t){var r=t.cursor,n=t.cells;if(r>=n.length)return MM;var a=n[r],i=KM(e,t.index,a),o=void 0===i?MM:HM(e,i,t.target);return t.cursor+=1,{kind:3,constraint:t,output:o}},IM);function zM(e){return 1===e.kind?e.constraintCursor===e.constraints.length?function(e){var t,r,n=e.context,a=n.apply,i=n.errorUnit,o={kind:2,context:e.context,stats:e.stats,constraints:e.deferred,constraintCursor:0,unifyNF:function(e,t){var r=a(o.substitution,e);if(r!==i){var n=a(o.substitution,t);if(n!==i){var u=lM(a,r,n);1!==u.kind?o.stats.errorCount+=1:o.substitution=sM(a,u.substitution,o.substitution)}}},substitution:(t=e.context,r=t.symbolContext.getTable(),function(e){var n=r.getValue(e);if(void 0!==n&&void 0!==n.link)return void 0===n.ufSubstitution&&(n.ufSubstitution=t.uf.findWithDescriptor(n.link)[1]),n.ufSubstitution})};return o}(e):function(e){var t=e.constraints,r=e.context,n=e.constraintCursor,a=e.deferred,i=t[n],o=qM[i.kind](r,i);switch(o.kind){case 2:a.push(o.constraint);break;case 1:e.stats.errorCount+=1;break;case 3:if(t[n]=o.constraint,void 0!==o.output)switch(o.output.kind){case 2:a.push(o.output.constraint);break;case 1:e.stats.errorCount+=1}return e}return e.constraintCursor+=1,e}(e):function(e){var t=e.constraints,r=e.context,n=e.constraintCursor,a=e.unifyNF,i=t[n];switch(i.kind){case 2:a(i.unit,i.target.unit);break;case 3:var o=YM(r,i.format);if(void 0===o)break;var u=KM(r,i.cell.sheet,i.cell.range);if(void 0===u)break;a(o,u);break;default:return e.constraintCursor+=1,L(PO.Root,i)}return e.constraintCursor+=1,e}(e)}var JM=function(){function e(){this.isDone=!1}return Object.defineProperty(e.prototype,"done",{get:function(){return this.isDone},enumerable:!0,configurable:!0}),e.prototype.freshCheckingState=function(e){var t=[],r={};e.getServerAvailableCells().forEach((function(e){r[e.sheetIdx.index]=e,t.push(e)}));var n=void 0===e.getServerDocument()?function(){return Q(void 0)}:function(t){return e.getIformat(e.getServerDocument(),t)};return{kind:0,locale:e.config.localeInfo,mathpack:e.config.mathpack,resolver:_u(e),documentTypeContext:{formats:function(t){return e.getServerFormat(t)},types:{},available:r,getIformat:n},constraints:[],stats:{formulaCells:0,formatCells:0,totalCells:0,errorCount:0},sheets:t,mutableState:{symbolContext:QM.init(),cells:void 0,sheetCursor:0,cellCursor:0}}},e.prototype.freshSolvingState=function(e){return{kind:1,stats:e.stats,context:WM(e.mutableState.symbolContext,e.documentTypeContext,e.stats),constraints:e.constraints,constraintCursor:0,deferred:[]}},e.prototype.step=function(){if(!this.isDone){if(void 0===this.documentContext)return this.isDone=!0,L(PO.Root+"."+PO.Initialised,this.documentContext);void 0===this.state&&(this.state=this.freshCheckingState(this.documentContext));try{var e=this.state;switch(e.kind){case 0:return e.mutableState.sheetCursor<e.sheets.length?void(this.state=this.runCheckStep(this.documentContext,e)):void(this.state=this.freshSolvingState(e));case 1:return void(this.state=zM(e));case 2:return e.constraintCursor<e.constraints.length?void(this.state=zM(e)):(this.isDone=!0,void(this.statsMessage=JSON.stringify(e.stats)))}}catch(e){return this.statsMessage=PO.Root+"."+PO.Failure+": "+A(e),void(this.isDone=!0)}}},e.prototype.setContext=function(e){var t=e.documents;this.documentContext=t},e.prototype.initialiseSheetStep=function(e,t){var r=t.mutableState,n=t.stats,a=t.sheets,i=r.sheetCursor,o=[],u=a[i];return e.forEachServerNonBlankCellInSet(u.sheetIdx,u.availableCells,(function(t){var r,a=Wn(u.sheetIdx,t),i=e.getServerFormula(a);return i.kind===H.Success&&void 0!==(null===(r=i.value)||void 0===r?void 0:r.compiledFmla)&&(o.push(i.value),n.formulaCells+=1),n.totalCells+=1,!0})),t.documentTypeContext.types[u.sheetIdx.index]=fN(),r.cells=o,r.cellCursor=0,t},e.prototype.checkCell=function(e,t){var r=t.sheets,n=t.constraints,a=t.stats,i=t.mutableState,o=i.cells,u=i.sheetCursor,s=i.cellCursor,c=r[u],l=o[s],d=l.compiledFmla.getValue();if(d.kind===H.Success){var f=Wn(c.sheetIdx,l.origin),h=function(e,t,r){var n=e.constraints,a=e.locale,i=e.mathpack,o=e.resolver,u=e.documentTypeContext,s=u.types[t.sheet.index],c=e.mutableState.symbolContext.copy(),l={origin:t,locale:a,mathpack:i,resolver:o,symbolContext:c,pushConstraint:function(e){return void 0!==e&&(n.push(e),!0)}},d=function(e,t){return ht(new aw(e),t)}(l,r),f=ew(l,d),h=function e(t,r){switch(r.kind){case 0:if(void 0===r.unit){var n=t.symbolContext.freshSymbol();return dM(r.flags,n.unit)}return r;case 2:for(var a=r,i=[];2===a.kind;)i.push(a.dimensions),a=a.elementType;var o=e(t,a);return i.reduceRight(hM,o);case 1:case 3:return r;default:return L(PO.Root,r)}}(l,void 0===f?NM:f);if(1===h.kind){var v=c.freshSymbol(),p={kind:0,type:h,target:v};h=TM(v.unit),n.push(p)}if(e.mutableState.symbolContext=c,2===h.kind)return s;return s.setValue(t.range,h)}(t,f,d.value);t.documentTypeContext.types[c.sheetIdx.index]=h;var v=e.getServerFormat(f);v.kind===H.Success&&jM(v.value)&&(n.push({kind:3,cell:f,format:v.value}),a.formatCells+=1)}return t.mutableState.cellCursor+=1,t},e.prototype.runCheckStep=function(e,t){if(!function(e){return void 0!==e.mutableState.cells}(t))return this.initialiseSheetStep(e,t);var r=t.mutableState;return r.cellCursor<r.cells.length?this.checkCell(e,t):(r.cells=void 0,r.sheetCursor+=1,t)},Object.defineProperty(e.prototype,"resultLogMessage",{get:function(){var e;return null!==(e=this.statsMessage)&&void 0!==e?e:PO.Root+"."+PO.Default},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"failedLogMessage",{get:function(){return"Units experiment timed out."},enumerable:!0,configurable:!0}),e}(),QM=function(){function e(e,t){this.seed=e,this.table=t}return e.init=function(){return new e(0,Ds.create((function(e,t){return e.localeCompare(t)})))},e.prototype.getTable=function(){return this.table},e.prototype.freshSymbol=function(e){var t=(void 0===e?"gen":e)+"@"+(this.seed+=1),r={unit:XO(t),link:void 0,ufSubstitution:void 0};return this.table=this.table.setValue(t,r),r},e.prototype.copy=function(){return new e(this.seed,this.table)},e}();function XM(e,t,r){switch(e.kind){case 2:if(1===e.elementType.kind)return;return r?XM(e.elementType,t,!1):void 0;case 1:return{kind:0,type:e,target:t};case 0:return void 0===e.unit?void 0:{kind:2,unit:e.unit,target:t};case 3:return;default:return L(PO.Root,e)}}function ZM(e,t,r){switch(t.kind){case 2:if(1===t.elementType.kind)return;return r?ZM(e,t.elementType,!1):void 0;case 1:var n=e.symbolContext.freshSymbol(),a={kind:0,type:t,target:n};return[n.unit,a];case 0:return void 0===t.unit?void 0:[t.unit,void 0];case 3:return;default:return L(PO.Root,t)}}function $M(e){var t=e.length;if(0===t)return NM;for(var r,n,a=kM,i=e[0].length,o=0;o<e.length;o+=1)for(var u=e[o],s=0;s<u.length;s+=1)r=a,n=u[s],a=r===kM?n:n===kM||r===NM?r:n===NM?n:0===r.kind&&0===n.kind&&void 0===r.unit&&void 0===n.unit?dM(r.flags|n.flags):NM;return hM(a,{rows:t,columns:i,exact:!0})}function ew(e,t){if(1===t.kind&&void 0===t.resolution){var r=function(e,t){var r={originGridCell:q(e.origin.range),originSheet:q(e.origin.sheet),wrapCellReferences:!0,allowUnqualifiedCell:!0},n=e.resolver.resolveCellRef(r,t.reference).resolution;return!!X(n)&&(!n.value||n.value)}(e,t);return"object"==typeof r?function(e,t){var r=fM(e);return r.resolution=t,r}(t.reference,r):r?CM:void 0}if(2===t.kind){var n=ew(e,t.elementType);return void 0===n?n:n===t.elementType?t:hM(n,t.dimensions)}return t}function tw(e,t,r,n,a){var i=e.symbolContext.freshSymbol(),o=XM(t,i,n),u=XM(r,i,n);if(void 0!==o&&void 0!==u||a&&(void 0!==o||void 0!==u))return e.pushConstraint(o),e.pushConstraint(u),i}function rw(e,t,r){if(r.length<2)return NM;var n=ew(e,r[0][0]),a=ew(e,r[1][0]);if(void 0===n||void 0===a)return NM;var i=mM(n,a);if(!1===i)return NM;var o="object"==typeof i;switch(t){case pa.Add:case pa.Sub:case pa.Min:case pa.Max:var u=tw(e,n,a,o,!0);return gM(void 0===u?bM:dM(bt.Number,u.unit),i);case pa.Eq:case pa.Ne:case pa.Lt:case pa.Le:case pa.Gt:case pa.Ge:return tw(e,n,a,o,!1),gM(SM,i);case pa.Mul:case pa.Div:var s=e.symbolContext.freshSymbol(),c=e.symbolContext.freshSymbol(),l=XM(n,s,o),d=XM(a,c,o);if(e.pushConstraint(l),e.pushConstraint(d),void 0===l&&void 0===d)return gM(bM,i);var f=t===pa.Mul?tM(s.unit,c.unit):tM(s.unit,function(e){var t=JO(),r=e.vars,n=e.consts;for(var a in r)t.vars[a]=-r[a];for(var a in n)t.consts[a]=-n[a];return t.varCount=e.varCount,jO(PO.Root,t),t}(c.unit));return gM(dM(bt.Number,f),i);case pa.Pow:var h=r[1][1];if(Vr(h)){var v=e.mathpack.toNumber(h.oper);if(E(v)){var p=ZM(e,n,"object"==typeof i);return void 0===p?gM(bM,i):(e.pushConstraint(p[1]),gM(dM(bt.Number,function(e,t,r){if(0===t)return r;var n=JO(),a=e.vars,i=e.consts;for(var o in a)n.vars[o]=a[o]*t;for(var o in i)n.consts[o]=i[o]*t;return n.varCount=e.varCount,jO(PO.Root,n),n}(p[0],v,EM)),i))}}return NM;case pa.Range:case pa.Isect:case pa.Union:return NM;case pa.Concat:return gM(yM,i);case pa.And:case pa.Or:case pa.Xor:return gM(SM,i);default:return L(PO.Root,t)}}function nw(e,t,r){switch(t){case pa.Add:case pa.Sub:case pa.Mul:case pa.Div:case pa.Pow:case pa.Eq:case pa.Ne:case pa.Lt:case pa.Le:case pa.Gt:case pa.Ge:case pa.Range:case pa.Isect:case pa.Union:case pa.Concat:case pa.And:case pa.Or:case pa.Xor:case pa.Min:case pa.Max:return rw(e,t,r);case pa.Percent:case pa.Neg:case pa.Pos:case pa.At:case pa.Pound:return function(e,t,r){if(r.length<1)return NM;var n=ew(e,r[0][0]);if(void 0===n)return NM;var a=pM(n);if(!1===a)return NM;switch(t){case pa.Percent:return gM(FM,a);case pa.Neg:case pa.Pos:var i=ZM(e,n,"object"==typeof a);return void 0===i?gM(bM,a):(e.pushConstraint(i[1]),gM(dM(bt.Number,i[0]),a));case pa.At:case pa.Pound:return NM;default:return L(PO.Root,t)}}(e,t,r);default:return L(PO.Root,t)}}var aw=function(){function e(e){var t=this;this.context=e,this.visitFormulaNode=function(e){return Le(t,e)},this.lazyVisitFormulaNode=function(e){return _e.resolve(e).bind(t.visitFormulaNode)}}return e.prototype.literalNode=function(e){return _e.resolve(function(e){switch(e.kind){case bt.Number:return bM;case bt.String:return yM;case bt.Boolean:return SM;case bt.Error:return CM;default:return RM}}(e))},e.prototype.arrayNode=function(e){var t=this;return _e.all(e.map((function(e){return _e.all(e.map(t.lazyVisitFormulaNode))}))).bind($M)},e.prototype.appNode=function(e,t){var r=this;return e.kind===pt.Operator?_e.all(t.map((function(e){return r.lazyVisitFormulaNode(e).bind((function(t){return[t,e]}))}))).bind((function(t){return nw(r.context,e.id,t)})):e.kind===pt.WSF?_e.all(t.map(this.lazyVisitFormulaNode)).bind((function(t){return function(e,t,r){switch(t){case la.SUM:case la.AVERAGE:case la.MAX:case la.MIN:if(0===r.length)return NM;var n=e.symbolContext.freshSymbol(),a=!0;return r.forEach((function(t){var r=ew(e,t);r&&e.pushConstraint(XM(r,n,!0))&&(a=!1)})),a?bM:dM(bt.Number,n.unit);case la.IF:if(r.length<2)return NM;var i=ew(e,r[0]),o=ew(e,r[1]),u=ew(e,void 0===r[2]?SM:r[2]);if(void 0===i)return void 0!==o&&void 0!==u&&tw(e,o,u,!0,!1),NM;var s=pM(i),c="object"==typeof s;if(void 0===o||void 0===u)return NM;var l=tw(e,o,u,!0,!0),d=l?TM(l.unit):AM;return c?hM(d,s):d;default:return NM}}(r.context,e.id,t)})):_e.resolve(NM)},e.prototype.letNode=function(e,t,r){return _e.resolve(NM)},e.prototype.lambdaNode=function(e,t,r){return _e.resolve(NM)},e.prototype.parenNode=function(e){return this.lazyVisitFormulaNode(e)},e.prototype.nameNode=function(e,t){return _e.resolve(NM)},e.prototype.cellRefNode=function(e,t){return _e.resolve(fM(tr(e,t)))},e.prototype.fieldRefNode=function(e,t){return _e.resolve(NM)},e.prototype.structRefNode=function(e,t){return _e.resolve(NM)},e.prototype.badSequenceNode=function(e,t){return _e.resolve(NM)},e.prototype.badStringNode=function(e,t){return _e.resolve(NM)},e.prototype.operatorNode=function(e,t){return _e.resolve(Yt(e,t))},e.prototype.wsfNode=function(e,t,r){return _e.resolve(qt(e,t,r))},e}();function iw(e,t){var r=be(e)+be(t);return r>0&&r<=2}var ow=[[void 0,void 0,0,void 0,void 0],[void 0,1,2,3,void 0],[4,5,void 0,6,7],[void 0,8,9,10,void 0],[void 0,void 0,11,void 0,void 0]];function uw(e,t){return ow[e+2][t+2]}function sw(e,t){for(var r=e.row,n=e.col,a=-2;a<=2;a+=1){var i=r+a;if(!(i<0||i>=1<<20))for(var o=-2;o<=2;o+=1){var u=n+o;u<0||u>=16384||iw(a,o)&&t(uw(a,o),Dn(i,u))}}for(a=0;a<r&&a<5;a+=1)t(13,Dn(a,n));for(o=0;o<n&&o<5;o+=1)t(12,Dn(r,o))}function cw(e){return{count:0,value:e}}var lw={};function dw(e,t,r){var n,a,i=null!==(n=r.value[e])&&void 0!==n?n:r.value[e]={};i[t]=(null!==(a=i[t])&&void 0!==a?a:0)+1,r.count+=1}function fw(e,t,r){var n,a,i=null!==(a=(null!==(n=r.value[e])&&void 0!==n?n:lw)[t])&&void 0!==a?a:0,o=3*r.count,u=r.count+o;return(i+r.count/1e3)/u}function hw(e,t,r,n){for(var a=[],i=0,o=r;i<o.length;i++){for(var u=o[i].split(t),s=1;s<u.length;s+=2)n.push(e(u[s]));for(s=0;s<u.length;s+=2)a.push(u[s])}return a}var vw=hw.bind(void 0,(function(e){return"%DATE%"}),/(\d{1,4}\/\d{1,4}\/\d{1,4}|\d{1,4}-\d{1,4}-\d{1,4})/),pw=hw.bind(void 0,(function(e){return"%TIME%"}),/(\d{1,2}:\d{1,2}(?::\d{1,2})?(?:\s*(?:AM|PM|am|pm))?)/),mw="[A-Za-z]*[$][A-Za-z]*",gw=new RegExp(mw),Sw=new RegExp("((?:[+-\\s(]|"+mw+")*(?:\\d+(?:[.,]\\d*)?|[.,]\\d+)(?:[eE][+-]?\\d+)?(?:[\\s)%]|"+mw+")*)"),yw=hw.bind(void 0,(function(e){if(gw.test(e))return"%CURRENCY%";if(e.indexOf("%")>=0)return"%PERCENTAGE%";var t=Number(e.replace(/[\s()]/g,"").replace(",","."));return isNaN(t)?"%NUMBER%":Cw(t)}),Sw),bw=hw.bind(void 0,se,/(%)/);var Ew=function(e,t,r,n){for(var a=0,i=r;a<i.length;a++)for(var o=0,u=i[a].split(t).map(e);o<u.length;o++){var s=u[o];void 0!==s&&n.push(s)}}.bind(void 0,(function(e){if(!/^\s*$/.test(e)&&1!==e.length)return e.toLowerCase()}),/[\s!"&'()*+-/:;<=>?@\\\[\]^_`{}|~.,]/);function Fw(e){var t=[],r=[e];return r=vw(r,t),r=pw(r,t),r=yw(r,t),r=bw(r,t),Ew(r,t),t}function Cw(e){return e>=1950&&e<=2050&&E(e)?"%YEAR%":"%NUMBER%"}function Rw(e,t,r){var n;switch(t.kind){case bt.Error:return["%ERROR:"+(null!==(n=gu().errorNames[t.type])&&void 0!==n?n:"???")+"%"];case bt.Array:case bt.Rich:return[];case bt.Blank:case bt.Missing:return[];case bt.Number:switch(r){case Gv.Currency:case Gv.Accounting:return["%CURRENCY%"];case Gv.Date:return["%DATE%"];case Gv.Time:return["%TIME%"];case Gv.Percentage:return["%PERCENTAGE%"]}return[Cw(e.mathpack.toNumber(t))];case bt.String:return Fw(t.value);case bt.Boolean:return["%BOOL:"+(t.value?"TRUE":"FALSE")+"%"];default:return L("calc.calc.experiments.autosuggest.getCellContentType",t)}}var kw=function(e){function t(t,r){var n=e.call(this,void 0)||this;return n.config=t,n.tokens=r,n}return ee(t,e),t.prototype.literalNode=function(e){he(this.tokens,Rw(this.config,e))},t.prototype.letNode=function(e,t){for(var r=0,n=t;r<n.length;r++){var a=n[r][0];he(this.tokens,Fw(a.whole))}},t.prototype.funNode=function(e,t){for(var r=0,n=t;r<n.length;r++){var a=n[r];he(this.tokens,Fw(a.whole))}},t.prototype.nameNode=function(e){},t.prototype.fieldRefNode=function(e,t){},t.prototype.wsfNode=function(e,t,r){this.tokens.push("%WSF:"+su(e)+"%")},t}(je);function Nw(e,t,r,n){var a=e.getServerFormula(t);if(!X(a))return!1;if(void 0===a.value)return!1;var i=a.value,o=t.range.row+r,u=t.range.col+n;if(o<0||u<0)return!1;var s=Wn(t.sheet,Dn(o,u)),c=e.getServerFormula(s);if(!X(c))return!1;if(void 0===c.value)return!1;var l=c.value;return void 0!==l.compiledFmla&&l===i}function Aw(e){return ye(-1e300,Se(e,1e300))}var Tw,Iw=function(){function e(e,t){this.docs=e,this.model=t}return e.prototype.train=function(e){var t,r,n=this;if(!Nw(this.docs,e,-1,0)&&!Nw(this.docs,e,0,-1)){var a=this.docs.getServerFormula(e);if(x("Unexpected Unavailable during training",X(a)),void 0!==a.value&&void 0!==a.value.compiledFmla){var i=a.value.compiledFmla.getValue();if(X(i)){var o,u=i.value.node;switch(u.kind){case pt.App:case pt.Let:case pt.Lambda:if(u.head.kind===pt.WSF){o=u.head.id;break}return;default:return}this.model.priors.value[o]=(null!==(t=this.model.priors.value[o])&&void 0!==t?t:0)+1,this.model.priors.count+=1;var s=e.sheet,c=e.range,l=null!==(r=this.model.evidenceFuncs[o])&&void 0!==r?r:this.model.evidenceFuncs[o]=cw([]);sw(c,(function(e,t){var r=n.getTokens(Wn(s,t));x("Unexpected Unavailable during training",X(r));for(var a=0,i=r.value;a<i.length;a++){var o=i[a];dw(e,o,n.model.evidenceGlobal),dw(e,o,l)}}))}}}},e.prototype.makeSuggestion=function(e,t){for(var r,n=this,a=[],i=[],o=function(t){var a=u.model.priors.value[t]/u.model.priors.count,o=a,s=e.sheet,c=e.range,l=null!==(r=u.model.evidenceFuncs[t])&&void 0!==r?r:cw([]);sw(c,(function(e,t){var r=n.getTokens(Wn(s,t));if(X(r))for(var a=0,i=r.value;a<i.length;a++){var u=i[a],c=fw(e,u,l),d=fw(e,u,n.model.evidenceGlobal),f=Aw(Aw(c*o)/d);0,x("calc.calc.experiments.autosuggest: isFinite",isFinite(f)),o=f}})),i.push({suggestion:u.docs.config.localeInfo.getWorksheetFuncName(t),confidence:o})},u=this,s=0,c=Object.keys(this.model.priors.value).map((function(e){return Number(e)}));s<c.length;s++){o(c[s])}return[i.sort((function(e,t){return t.confidence-e.confidence})).slice(0,3),a.slice(0,10)]},e.prototype.getExpFn=function(e){var t,r=this.docs.getServerFormula(e);if(X(r)&&void 0!==r.value){var n=null===(t=r.value.compiledFmla)||void 0===t?void 0:t.getValue();if((null==n?void 0:n.kind)===H.Success){var a=n.value.node;switch(a.kind){case pt.App:case pt.Let:case pt.Lambda:return a.head.kind===pt.WSF?a.head.id:void 0;default:return}}}},e.prototype.getTokens=function(e){var t,r=this.docs.getServerFormula(e);if(!X(r))return Q(sn([r.reason]));if(void 0!==(null===(t=r.value)||void 0===t?void 0:t.compiledFmla)){var n=r.value.compiledFmla.getValue();return X(n)?q(function(e,t){var r=[];return dt(new kw(e,r),t),r}(this.docs.config,n.value)):q([])}var a=this.docs.getServerValue(e);if(!X(a))return Q(sn([a.reason]));var i=this.docs.getServerFormat(e),o=X(i)&&"string"!=typeof i.value?this.docs.resolveCellFormat(e.sheet.document,i.value):Q(void 0),u=o.kind===H.Success?o.value.valueType:void 0;return q(Rw(this.docs.config,a.value.oper,u))},e}(),Ow=r(32),Mw=wR({sampleAutocompleteRate:MR(HR),model:MR(XR("ml","bayesian","random")),thresholds:MR(LR(GR)),rngSeed:MR(HR),logSamples:MR(zR)});!function(e){e.Statistics="Statistics",e.UnhandledFailure="UnhandledFailure"}(Tw||(Tw={}));var ww,Dw,_w,Lw={nAnalyzed:0,nPredicted:0,nPossible:0,nCorrectFunctions:0,nCorrectRanges:0,nCorrect:0};function Uw(e){_w=e}!function(e){e.Success="Success",e.Timeout="Timeout"}(ww||(ww={})),function(e){e.Number="number",e.Boolean="boolean",e.String="string",e.Empty="empty",e.Date="date",e.Error="error",e.NotCached="not_cached",e.Other="other"}(Dw||(Dw={}));var xw=function(){function e(e,t){this.docs=t,this.modelLocale=gu(),this.modelMathpack=Lo(this.modelLocale).mathpack,this.suggester=e(this.docs.config,this.getCurrentLocation.bind(this),this.getCellContentType.bind(this),this.getCellContent.bind(this),this.getNames.bind(this),_.ULS)}return e.prototype.makeSuggestion=function(e,t){this.currentLocation=e;var r=this.suggester.makeSuggestions(t);return X(r)&&0!==r.value.length?[r.value,void 0]:[void 0,void 0]},e.prototype.getCurrentLocation=function(){return q(this.currentLocation)},e.prototype.getCellContentType=function(e){var t=this.docs.getServerValue(e);if(!X(t))return Q(sn([t.reason]));switch(t.value.oper.kind){case bt.Error:return q(Dw.Error);case bt.Array:case bt.Rich:return q(Dw.Other);case bt.Blank:return q(Dw.Empty);case bt.Number:return q(Dw.Number);case bt.String:return q(Dw.String);case bt.Boolean:return q(Dw.Boolean);default:return L("calc.calc.experiments.autosuggest.getCellContentType",t.value.oper)}},e.prototype.getCellContent=function(e){var t,r,n,a=this.docs.getServerValue(e);if(!X(a))return Q(sn([a.reason]));switch(a.value.oper.kind){case bt.Error:n=null!==(t=this.modelLocale.errorNames[a.value.oper.type])&&void 0!==t?t:"";break;case bt.Blank:n="";break;case bt.Number:var i=this.docs.config.mathpack.toNumber(a.value.oper);n=this.modelMathpack.formatGeneral(this.modelLocale,this.modelMathpack.fromNumber(i),21);break;case bt.String:n=a.value.oper.value;break;case bt.Boolean:n=a.value.oper.value?this.modelLocale.trueName:this.modelLocale.falseName;break;case bt.Array:case bt.Rich:return Q(sn(["OperKind not supported for autosuggest"]));default:return L("calc.calc.experiments.autosuggest.getCellContent",a.value.oper)}var o=this.docs.getServerFormula(e);return q({displayed:n,formula:X(o)&&void 0!==(null===(r=o.value)||void 0===r?void 0:r.compiledFmla)?o.value.fmla:void 0})},e.prototype.getNames=function(e){return q([])},e}(),Bw=function(){function e(e,t,r,n){var a,i,o,u=this;this.modelName=t,this.rng=r,this.factory=n,this.stats={},this.unhandledFailures={},this.result=void 0,this.test=function(e){return _e.try((function(){var t=u.docs.getServerFormula(e);if(X(t)&&void 0!==t.value){var r=t.value;F(r.fmla,"=")&&void 0!==r.compiledFmla&&X(r.compiledFmla.getValue())&&(u.isAdjustEqualFormula(e,r,-1,0)||u.isAdjustEqualFormula(e,r,0,-1)||u.tryAutocomplete(e,r.fmla,0))}}))},this.config={sampleAutocompleteRate:null!==(a=e.sampleAutocompleteRate)&&void 0!==a?a:.2,thresholds:null!==(i=e.thresholds)&&void 0!==i?i:"ml"===t?[-1/0,.8,1,1.5,2,2.5,3,4,6,8]:[-1/0,1,1.5,2,2.5],logSamples:null!==(o=e.logSamples)&&void 0!==o&&o}}return e.create=function(t){var r,n;if("object"==typeof t&&IR(t,Mw,{},"")){var a=new iO(null!==(r=t.rngSeed)&&void 0!==r?r:0|Re()),i=null!==(n=t.model)&&void 0!==n?n:"random",o="random"!==i?i:a.next()<.5?"ml":"bayesian";switch(o){case"bayesian":return new e(t,o,a,(function(e){return new Iw(e,Ow)}));case"ml":if(void 0===_w)return;var u=_w;return new e(t,o,a,(function(e){return new xw(u,e)}));default:return}}else{var c="calc.calc.AutocompleteExperiment: expected config; given "+t;_.ULS.traceTag(576074401,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Warning,c)}},Object.defineProperty(e.prototype,"done",{get:function(){return void 0!==this.result},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"resultLogMessage",{get:function(){return this.createResultLogMessage(ww.Success)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"failedLogMessage",{get:function(){return this.createResultLogMessage(ww.Timeout)},enumerable:!0,configurable:!0}),e.prototype.getStats=function(){return this.stats},e.prototype.getUnhandledFailures=function(){return this.unhandledFailures},e.prototype.setContext=function(e){var t=this;this.stateId=e.stateId,this.docs=e.documents,this.suggester=this.factory(this.docs),this.runtime=new we(this.sampleCells().bind((function(e){return _e.all(e.map(t.test))})).catch((function(e){sD(t.unhandledFailures,e)})))},e.prototype.step=function(){this.result||(this.result=this.runtime.step())},e.prototype.sampleCells=function(){var e=this,t=[],r=[];return this.docs.getServerAvailableCells().forEach((function(n){var a=n.sheetIdx;return r.push(_e.try((function(){e.docs.forEachServerNonBlankCellInSet(a,lC,(function(r){if(e.rng.next()<e.config.sampleAutocompleteRate){var n=Wn(a,r);t.push(n)}return!0}))}))),!0})),_e.all(r).bind((function(e){return t}))},e.prototype.isAdjustEqualFormula=function(e,t,r,n){var a=e.range.row+r,i=e.range.col+n;if(a<0||i<0)return!1;var o=Wn(e.sheet,Dn(a,i)),u=this.docs.getServerFormula(o);if(!X(u))return!1;if(void 0===u.value)return!1;var s=u.value;if(void 0===s.compiledFmla)return!1;if(s===t)return!0;var c=s.compiledFmla.getValue();if(!X(c))return!1;var l=Xs(zs(this.docs.config),Js(En(e),e),c.value);return!!X(l)&&l.value===t.fmla},e.prototype.tryAutocomplete=function(e,t,r){var n,a,i=this;if(!(t.length<r+1))for(var o=this.runPrediction(e,t.substring(0,1+r)),u=o[0],s=o[1],c=function(r){var o=l.config.thresholds[r],c=null!==(n=l.stats[o])&&void 0!==n?n:l.stats[o]=te({},Lw);c.nAnalyzed+=1;var d=t.match(/^=([^()]+)\(([^()]+)\)\s*$/),f=void 0,h=void 0;if(null==d||(f=d[1],h=d[2],c.nPossible+=1),void 0===u||u.length<1)return"continue";var v=u[0];if(o>-1/0&&(void 0===v.confidence||v.confidence<o))return"continue";c.nPredicted+=1;var p=v.suggestion.match(/^(.+)\((.*)\)$/);x("calc.calc.experiments.autosuggest.tryAutocomplete",null!=p);var m=p[1],g=p[2],S=null!=f&&m===f.trim(),y=null!=h&&g===h.trim();if(S&&(c.nCorrectFunctions+=1),y&&(c.nCorrectRanges+=1),S&&y&&(c.nCorrect+=1),l.config.logSamples&&0===r){var b=l.docs.getSheetName(e.sheet.document,e.sheet.index),E=X(b)?b.value:"???",F=ie(new Array(5)).map((function(t,r){return ie(new Array(5)).map((function(t,n){if((2===r?1:0)+(2===n?1:0)==1){var a=e.range.row-(2-r),o=e.range.col-(2-n);if(!(a<0||o<0||a>=1<<20||o>=16384)){var u=Wn(e.sheet,Dn(a,o));return i.getCellContext(u)}}}))}));(null!==(a=c.samples)&&void 0!==a?a:c.samples=[]).push({cell:ji(l.docs.config.localeInfo,e.range,E),fmla:t,prediction:u,fnCorrect:S,rangeCorrect:y,context:F,trace:s})}},l=this,d=0;d<this.config.thresholds.length;d+=1)c(d)},e.prototype.getCellContext=function(e){var t,r=this.docs.getServerValue(e);if(X(r)){var n=this.docs.getServerFormula(e),a=X(n)&&void 0!==(null===(t=n.value)||void 0===t?void 0:t.compiledFmla)?n.value.fmla:void 0;return{value:r.value.oper,formula:a}}},e.prototype.runPrediction=function(e,t){var r=this.suggester.makeSuggestion(e,t),n=r[0],a=r[1];return void 0===n?[void 0,a]:[n.slice(0,3).map((function(e){var t=e.suggestion,r=e.confidence;return{suggestion:t.indexOf("(")>=0?t:t+"()",confidence:r}})),a]},e.prototype.createResultLogMessage=function(e){return["AutocompleteExperiment",e,"stateId = "+this.stateId,"lcid = "+this.docs.config.localeInfo.lcid,"model = "+this.modelName,"stats = "+JSON.stringify(this.stats),"unhandledFailures = "+JSON.stringify(this.unhandledFailures)].join(", ")},e}(),Ww=function(){function e(e){this.stepDelay=e,this.done=!1,this.resultLogMessage="TestExperiment",this.failedLogMessage="TestExperiment exceeded budget",this.iters=0}return e.create=function(t){if("number"==typeof t)return new e(t);var r="calc.calc.TestExperiment: expected number; given "+t;_.ULS.traceTag(591974878,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Warning,r)},e.prototype.setContext=function(){},e.prototype.step=function(){for(var e=Re();Re()<e+this.stepDelay;);this.iters+=1,this.iters>1&&(this.done=!0)},e}();var Pw={TestExperiment:Ww.create.bind(Ww),ExceLintExperiment:function(){return new VO},UnitExperiment:function(){return new JM},AutocompleteExperiment:function(e){return Bw.create(null!=e?e:{})}};var Vw=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]};function Gw(){return(new(function(e){function t(){var t=e.call(this,Vw,Vw,Vw)||this;return t.interval=void 0,t.calcGrid=t,t}return ee(t,e),t.prototype.runTasks=function(){for(;;){if(this.calcGrid.dataModel.step().queueEmpty)break}},t.prototype.startRecalc=function(e){void 0===e&&(e=5),this.stopRecalc(),this.interval=setInterval(this.runTasks.bind(this),e)},t.prototype.stopRecalc=function(){void 0!==this.interval&&clearInterval(this.interval),this.interval=void 0},t}(dD))).calcGrid}function Hw(e,t,r){var n=t-e.range.row,a=r-e.range.col;return e.value[n+a*e.range.rows]}var jw=function(){function e(e){this.calcGrid=e,this.snapshots=[]}return e.prototype.createSnapshot=function(e){return ne(this,void 0,void 0,(function(){var t,r;return ae(this,(function(n){switch(n.label){case 0:return t=this.calcGrid.dataModel.createSnapshot(),this.calcGrid.resumeRecalc(),[4,t];case 1:return void 0===(r=n.sent())?[2,!1]:(this.snapshots[e]=r,[2,!0])}}))}))},e.prototype.discardSnapshot=function(e){return void 0!==this.snapshots[e]&&(delete this.snapshots[e],!0)},e.prototype.getRangeFormats=function(e,t){var r=[],n=this.snapshots[e];if(void 0===n)return Q(sn(["getRangeFormats"]));var a=Tn(this.calcGrid.document,t.sheet.index);return Sr(t.range,(function(e,i,o){var u=n.getEditedFormat(Wn(a,e)),s=X(u)?u.value:sn(["getRangeFormats"]);return r[i+o*t.range.rows]=s,!0}))?q({range:t.range,regions:[{range:t.range,value:r}]}):Q(sn(["getRangeFormats"]))},e.prototype.getRangeValues=function(e,t){var r=[],n=this.snapshots[e];if(void 0===n)return Q(sn(["getRangeValues"]));var a=Tn(this.calcGrid.document,t.sheet.index);return Sr(t.range,(function(e,i,o){var u=n.getClientValue(Wn(a,e)),s=X(u)?u.value:sn(["getRangeValues"]);return r[i+o*t.range.rows]=s,!0}))?q({range:t.range,regions:[{range:t.range,value:r}]}):Q(sn(["getRangeValues"]))},e.prototype.getRangeFormulae=function(e,t){var r=[],n=this.snapshots[e];if(void 0===n)return Q(sn(["getRangeFormulae"]));var a=Tn(this.calcGrid.document,t.sheet.index);return Sr(t.range,(function(e){var t=n.getEditedFormula(Wn(a,e));if(!X(t))return r.push({range:e,value:sn(["getRangeFormula"])}),!0;if(void 0===t.value)return!0;var i=t.value[1],o=i.compiledFmla,u=re(i,["compiledFmla"]);return r.push({range:e,value:te(te({},u),{hasCompiledFmla:void 0!==o})}),!0}))?q({range:t.range,regions:r}):Q(sn(["getRangeFormula"]))},e.prototype.getSheetNames=function(e){if(void 0===this.snapshots[e])return Q(sn(["getSheetNames"]));var t=[],r=this.calcGrid.dataModel.docs.getSheetRangeIndexes(In(this.calcGrid.document));if(!X(r))return r;for(var n=0,a=r.value.sheets;n<a.length;n++){var i=a[n],o=this.calcGrid.dataModel.docs.getSheetName(this.calcGrid.document,i);if(!X(o))return o;t.push({sheetId:i,sheetName:o.value})}return q(t)},e}();function Kw(e,t,r){return e>=r.row&&t>=r.col&&e<r.row+r.rows&&t<r.col+r.cols}var Yw=function(){function e(){this.docs=Gw().dataModel.docs}return e.getInstance=function(){return void 0===this.singleton&&(this.singleton=new e),this.singleton},e.prototype.compile=function(e){var t=e.hasCompiledFmla,r=re(e,["hasCompiledFmla"]);return t?this.docs.compileFmla(!0,r.lexicalKind,Wn({},r.origin),void 0,r.fmla):te(te({},r),{compiledFmla:void 0})},e.singleton=void 0,e}();function qw(e){return e.kind===on.Unavailable}var zw=function(){function e(e,t,r){if(this.formats=void 0,this.values=void 0,this.formulae=void 0,X(e)&&(this.values=e.value),X(t)){var n=Yw.getInstance(),a=t.value.regions.map((function(e){var t=e.range,r=e.value;return{range:t,value:void 0===r||qw(r)?r:n.compile(r)}}));this.formulae={range:t.value.range,regions:a}}X(r)&&(this.formats=r.value)}return e.prototype.getCellValue=function(e,t){if(void 0===this.values||!Kw(e,t,this.values.range))return Q(sn(["getCellValue"]));for(var r=0,n=this.values.regions;r<n.length;r++){var a=n[r];if(Kw(e,t,a.range)){var i=Hw(a,e,t);return qw(i)?Q(i):q(i)}}return q(CN)},e.prototype.getCellFormat=function(e,t){if(void 0===this.formats||!Kw(e,t,this.formats.range))return Q(sn(["getCellFormat"]));for(var r=0,n=this.formats.regions;r<n.length;r++){var a=n[r];if(Kw(e,t,a.range)){var i=Hw(a,e,t);return qw(i)?Q(i):q(i)}}return q(0)},e.prototype.getCellFormula=function(e,t){if(void 0===this.formulae||!Kw(e,t,this.formulae.range))return Q(sn(["getCellFormula"]));for(var r=0,n=this.formulae.regions;r<n.length;r++){var a=n[r];if(Kw(e,t,a.range)){var i=a.value;return qw(i)?Q(i):q(i)}}return q(gN)},e.prototype.foreachNonBlankCellValue=function(e){if(void 0===this.values)return!0;for(var t=0,r=this.values.regions;t<r.length;t++)for(var n=r[t],a=n.range.row,i=0;a<n.range.row+n.range.rows;a+=1)for(var o=n.range.col;o<n.range.col+n.range.cols;o+=1,i+=1){var u=n.value[i];if(!qw(u))if(!e(Dn(a,o),u))return!1}return!0},e.prototype.foreachNonBlankCellFormula=function(e){if(void 0===this.formulae)return!0;for(var t=0,r=this.formulae.regions;t<r.length;t++){var n=r[t],a=n.value;if(!qw(a))if(!e(n.range,a))return!1}return!0},e}(),Jw=0;function Qw(e,t){var r,n,a,i,o,u,s,c,l,d,f,h,v,p,m,g,S,y,b,E,F,C,R,k,N,A,T,I,O,M,w,D,_,L,U=Ee("en-US"),x=function(e,t,r){var n=fu().slice();return OR(t,ek,r,"localeData.worksheetFunctionNames").forEach((function(e){return n[e.functionId]=e.functionName})),hu(e,n)}(U,e.worksheetFunctionNames,t),B=x.getWorksheetFuncId,W=x.getWorksheetFuncName,P=function(e){if(me(e))return function(e){return e>0&&e%3==0};if(0===e.length||0===e[0])return function(){return!1};if(2===e.length&&0===e[1]){var t=e[0];return function(e){return e>0&&e%t==0}}var r=0===e[e.length-1]&&e.length>=2;return function(t){if(t<=0)return!1;for(var n=t,a=0;a<e.length&&!((n-=e[a])<=0);a+=1);return n>0&&r?n%e[e.length-2]==0:0===n}}(e.thousandsData),V=function(e,t){var r=tu.slice();return OR(e,tk,t,"localeData.errorTypeNames").forEach((function(e){return r[e.errorType]=e.errorName})),r}(e.errorTypeNames,t),G=null!==(r=e.lcid)&&void 0!==r?r:xo.USA,H=null!==(n=e.country)&&void 0!==n?n:Uo.USA,j=G===xo.Thailand,K=G===xo.Korea,Y=G===xo.Japan,q=G===xo.ChinaT||G===xo.HongKong,z=G===xo.China,J=K||Y||z||q,Q=G===xo.Hindi||G===xo.Tamil,X=G===xo.Thailand||G===xo.Vietnam||Q,Z=(G&xo.LANG)==(xo.Hebrew&xo.LANG)||(G&xo.LANG)==(xo.Arabic&xo.LANG)||G===xo.Syriac||X;return te(te({},e),{getWorksheetFuncId:B,getWorksheetFuncName:W,isNumeral:Qo,getOrdinal:Xo,getNumberShape:Zo,isThousandsPosition:P,isIdentStart:$o,isIdentContinue:eu,stringCompareCI:U,errorNames:V,specialRefNames:null!==(a=e.specialRefNames)&&void 0!==a?a:ru,thousandsSeparator:null!==(i=e.thousandsSeparator)&&void 0!==i?i:",",lcid:G,country:H,isThai:j,isEastAsia:J,isKorea:K,isJapan:Y,isChinaT:q,isChinaS:z,isComplexScript:Z,numberDecimals:null!==(o=e.numberDecimals)&&void 0!==o?o:2,isExpSepBySpace:null!==(u=e.isExpSepBySpace)&&void 0!==u&&u,fractionSeparator:null!==(s=e.fractionSeparator)&&void 0!==s?s:" ",isPercentSepBySpace:null!==(c=e.isPercentSepBySpace)&&void 0!==c&&c,currencyFormat:null!==(l=e.currencyFormat)&&void 0!==l?l:La.Paren,isCurrencySymbolLead:null===(d=e.isCurrencySymbolLead)||void 0===d||d,isCurrencySepBySpace:null!==(f=e.isCurrencySepBySpace)&&void 0!==f&&f,currencySymbol:null!==(h=e.currencySymbol)&&void 0!==h?h:"$",currencyDecimals:null!==(v=e.currencyDecimals)&&void 0!==v?v:2,dateOrder:null!==(p=e.dateOrder)&&void 0!==p?p:Ua.MDY,dateSeparator:null!==(m=e.dateSeparator)&&void 0!==m?m:"/",dateAltSeparator:null!==(g=e.dateAltSeparator)&&void 0!==g?g:"-",year4Digits:null===(S=e.year4Digits)||void 0===S||S,month2Digits:null!==(y=e.month2Digits)&&void 0!==y&&y,day2Digits:null!==(b=e.day2Digits)&&void 0!==b&&b,longDateFormat:null===(E=e.longDateFormat)||void 0===E||E,timeSeparator:null!==(F=e.timeSeparator)&&void 0!==F?F:":",timeAltSeparator:null!==(C=e.timeAltSeparator)&&void 0!==C?C:void 0,hour2Digits:null!==(R=e.hour2Digits)&&void 0!==R&&R,clock24Hour:null!==(k=e.clock24Hour)&&void 0!==k&&k,isAMPMSepBySpace:null===(N=e.isAMPMSepBySpace)||void 0===N||N,ampmSymbols:null!==(A=e.ampmSymbols)&&void 0!==A?A:["AM","PM"],dayNameShort:null!==(T=e.dayNameShort)&&void 0!==T?T:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNameLong:null!==(I=e.dayNameLong)&&void 0!==I?I:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],monthNameShort:null!==(O=e.monthNameShort)&&void 0!==O?O:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],monthNameLong:null!==(M=e.monthNameLong)&&void 0!==M?M:["January","February","March","April","May","June","July","August","September","October","November","December"],pictureSpecial:null!==(w=e.pictureSpecial)&&void 0!==w?w:nu,pictureSingle:null!==(D=e.pictureSingle)&&void 0!==D?D:au,pictureColor:null!==(_=e.pictureColor)&&void 0!==_?_:iu,pictureDbnum:null!==(L=e.pictureDbnum)&&void 0!==L?L:ou})}function Xw(e){return Qw(e,{})}function Zw(e,t){return me(t)?{index:e,length:1}:{index:e,length:be(t-e)+1}}function $w(e,t){var r=Zw(t.row,t.lastRow),n=r.index,a=r.length,i=Zw(t.column,t.lastColumn),o=i.index,u=i.length;return Bn(Tn(e,t.sheetId),wn(n,o,a,u))}function eD(e,t){var r=t.sheetId,n=t.usedRange;return pe(n)?$w(e,te({sheetId:r},n)):{sheet:Tn(e,r),range:void 0}}function tD(e,t,r){return{sheet:e.sheet,set:function(e,t,r){var n=IC({row:t}),a=IC({col:r}),i=VC(n,a);return KC(oR(e),i)}(e.range,t,r)}}function rD(e,t){return{sheet:e.sheet,range:e.range,hidden:t}}function nD(e){return gr(e)?SE(e.sheet.index,e.range.row,e.range.col):SE(e.sheet.index,e.range.row,e.range.col,e.range.row+e.range.rows-1,e.range.col+e.range.cols-1)}function aD(e,t,r,n){var a=dC;if(me(n))return a;for(var i=0;i<n.length;i+=1){var o=n[i];if(e<=o&&o<e+t){for(var u=1;i+u<n.length&&n[i+u]===o+u;)u+=1;i+=u-1,a=eC(a,r(ge(o,o+u)))}}return a}function iD(e,t){switch(typeof t){case"string":return zn(t);case"boolean":return qn(t);case"number":return e.fromNumber(t)}switch(t.kind){case"Blank":return fa;case"Error":return Jn(t.type);default:return}}function oD(e,t){switch(t.kind){case bt.String:case bt.Boolean:return t.value;case bt.Number:return e.toNumber(t);case bt.Error:return fE(t.type);case bt.Blank:return dE;default:return}}function uD(e,t,r,n){if(!me(n))switch(n.kind){case"NamedValue":switch(typeof n.value){case"string":return wN(zn(n.value));case"boolean":return wN(qn(n.value));case"number":return wN(e.fromNumber(n.value))}return"Error"===n.value.kind?wN(Jn(n.value.type)):L("calc.calc.namedObjectDataToNamedObject: NamedValue",n.value.kind);case"NamedFormula":return DN(n.formulaBarText);case"NamedRange":var a=$w(r,n.range);return wN(ca(a.sheet,a.range));case"NamedTable":return function(e,t,r,n,a){for(var i,o=e.sheet,u=e.range,s=t?wn(u.row-1,u.col,1,u.cols):void 0,c=r?wn(u.row+u.rows,u.col,1,u.cols):void 0,l=Fu(Fu(s,e.range),c),d=Ds.create(a),f=0,h=n;f<h.length;f++){var v=h[f];d=d.setValue(v.name,v.column)}var p=d.getCount()===e.range.cols;return{kind:"NamedTable",value:ca(e.sheet,e.range),specialRefRanges:(i={},i[gt.Data]=e,i[gt.Headers]=s?Bn(o,s):void 0,i[gt.Totals]=c?Bn(o,c):void 0,i[gt.All]=Bn(o,l),i),columnNames:d,allColumnNamesAvailable:p,hasHeadersRow:t,hasTotalsRow:r}}($w(r,n.range),n.hasHeadersRow,n.hasTotalsRow,n.columns,t);case"NamedFailure":return _N(n.failureReason,me(n.objectKind)?void 0:n.objectKind);default:return L("calc.calc.namedObjectDataToNamedObject: kind",n)}}function sD(e,t){var r,n;if(t.kind===VS.NotImplemented)for(var a=0,i=t.features;a<i.length;a++){var o=i[a];NR(e,VS.NotImplemented+" "+o)}else if(t.kind===VS.IllFormedFormula)NR(e,VS.IllFormedFormula+" "+(null!==(r=t.mode)&&void 0!==r?r:"")+" "+JSON.stringify(null!==(n=t.diagnostics)&&void 0!==n?n:{}));else if(t.kind===VS.Unavailable)for(var u=0,s=t.objects;u<s.length;u++){var c=s[u],l=[VS.Unavailable];if("string"==typeof c.kind&&c.kind in AO){var d=c;switch(l.push(d.kind),d.kind){case AO.SheetId:l.push(d.sheetId);break;case AO.NameLoc:l.push(d.source),l.push(void 0===d.name.scope.index?"global":"sheet");break;case AO.ClientFailure:l.push(d.reason);break;case AO.VolatileFunction:l.push(d.name);break;case AO.TimeGranularity:l.push(no[d.granularity]);break;case AO.GetTimeKind:l.push(d.getTimeKind)}}else l.push(JSON.stringify(c));NR(e,l.join(" "))}else t.kind===VS.LimitExceeded?NR(e,t.kind+" "+qS[t.limit]):t.kind===wv.NotFormatString?NR(e,t.kind+" "+t.message):NR(e,t.kind)}var cD=function(){function e(e,t,r){this.onRecalcResults=e,this.onUpdateRequest=t,this.currentOutputStateId=r,this.editedRangeDeltas=[],this.dependentRangeDeltas=[],this.editedRangeFailures=[],this.dependentRangeFailures=[],this.rangeUpdateRequests=[],this.namesUpdateRequests=[],this.recalcFinished=!1}return e.prototype.setOutputStateId=function(e){e<=this.currentOutputStateId||(this.flush(),this.currentOutputStateId=e)},e.prototype.pushCellWrite=function(e,t){(e!==cR.DependentCell?this.editedRangeDeltas:this.dependentRangeDeltas).push(t)},e.prototype.pushRangeWrite=function(e,t){he(e!==cR.DependentCell?this.editedRangeDeltas:this.dependentRangeDeltas,t)},e.prototype.pushRangeFailure=function(e,t){(e!==cR.DependentCell?this.editedRangeFailures:this.dependentRangeFailures).push(t)},e.prototype.pushUpdateRequest=function(e){this.rangeUpdateRequests.push(e)},e.prototype.pushUpdateNameRequest=function(e){this.namesUpdateRequests.push(e.index)},e.prototype.pushRecalcFinished=function(e){this.recalcFinished=this.recalcFinished||e},e.prototype.isRecalcFinished=function(){return this.recalcFinished},e.prototype.flush=function(){(this.rangeUpdateRequests.length>0||this.namesUpdateRequests.length>0)&&(this.onUpdateRequest(fF(this.rangeUpdateRequests,[],this.namesUpdateRequests)),this.rangeUpdateRequests=[],this.namesUpdateRequests=[]),(this.editedRangeDeltas.length>0||this.editedRangeFailures.length>0)&&(this.sendRecalcResults("Edited",this.editedRangeDeltas,[],this.editedRangeFailures),this.editedRangeDeltas=[],this.editedRangeFailures=[]),(this.dependentRangeDeltas.length>0||this.dependentRangeFailures.length>0)&&(this.sendRecalcResults("Dependents",this.dependentRangeDeltas,[],this.dependentRangeFailures),this.dependentRangeDeltas=[],this.dependentRangeFailures=[]),this.recalcFinished&&(this.onRecalcResults(rF(this.currentOutputStateId,"Dependents",!0,[],[],[])),this.recalcFinished=!1)},e.prototype.sendRecalcResults=function(e,t,r,n){for(var a=0;a<ye(ye(t.length,r.length),n.length);a+=10)this.onRecalcResults(rF(this.currentOutputStateId,e,!1,t.slice(a,a+10),r.slice(a,a+10),n.slice(a,a+10)))},e}();function lD(e){return{kind:e.kind}}var dD=function(){function e(e,t,r,n){void 0===n&&(n="Local"),this.onRecalcResults=e,this.onUpdateRequest=t,this.onGC=r,this.createMode=n,this.document=kn(void 0,""),this.localeInfo=gu(),this.mathpack=_o,this.refStyle=it.A1,this.currentInputStateId=-1/0,this.currentOutputStateId=-1/0,this.lastRecalcStatsStateId=-1/0,this.recalcStatistics=CR,this.nameFailures=[],this.rangeFailures=[],this.numberFormatFailures=[],this.printFormulaFailures=[],this.inferFormatFailures=[],this.formatValueFailures=[],this.unhandledFailures=[],this.ignoredInputStats={},this.ignoredOutputStats={},this.setConfig({}),this.setProps({}),this.dataModel=new LO(this.localeInfo,this.mathpack,this.refStyle,this.props,this.config)}return e.prototype.initializeCalc=function(e,t,r){var n;return ne(this,void 0,void 0,(function(){var a,i,o;return ae(this,(function(u){switch(u.label){case 0:if("Thread"===this.createMode&&null!==(n=t[w.CalcAutocompleteExperiment])&&void 0!==n&&n){if(a=!1,i=r.replace(/\/[^/]*?((\.min)?\.js)$/,(function(e,t){return a=!0,"/excelOnlineAutocompleteExperiment"+t})),!a)throw new Error("calcAbsUrl not in expected form");importScripts(i)}return[4,Yi.Endpoint.createOutside(e)];case 1:return o=u.sent(),Ko((s=o.post,c=function(e){return"["+(new Date).toISOString()+"] "+e},{shipAssertTag:function(e,t,r,n){s.shipAssertTag(e,t,r,c(n))},assertTag:function(e,t,r,n){s.assertTag(e,t,r,c(n))},traceTag:function(e,t,r,n){s.traceTag(e,t,r,c(n))},debugTraceTag:function(e,t,r,n){s.debugTraceTag(e,t,r,c(n))}}),(function(e){return!0===t[e]}),r),[2]}var s,c}))}))},e.prototype.ping=function(){},e.prototype.setInputStateId=function(e,t){var r=e-this.currentInputStateId;return r<0?(this.logInputStateIdDecrease(t),!1):(0!==r&&(this.flushInputLogs(),this.currentInputStateId=e),!0)},e.prototype.setOutputStateId=function(e){var t=e-this.currentOutputStateId;return t<0?(this.logOutputStateIdDecrease(),!1):(0!==t&&(this.flushOutputLogs(),this.currentOutputStateId=e),!0)},e.prototype.clearAsyncResumeRecalc=function(){void 0!==this.recalcLoop&&this.recalcLoop.stop()},e.prototype.resumeRecalc=function(){var e=this;return this.flushInputLogs(),this.clearAsyncResumeRecalc(),this.recalcLoop=xO((function(){var t=e.dataModel.step(),r=t.messages,n=t.queueEmpty;return r.length>0&&e.processRecalcResults(r),n?void 0:1}),{costThreshold:1,timeThreshold:this.config.yieldIntervalMs}),mF(this.recalcLoop.promise,(function(){e.recalcLoop=void 0}))},e.prototype.testResumeRecalc=function(e){return ne(this,void 0,void 0,(function(){var t;return ae(this,(function(r){switch(r.label){case 0:return[4,this.resumeRecalc()];case 1:return r.sent(),void 0!==e&&(t="calc.calc.RecalcService: resumeRecalc finished; resumeId = "+e,_.ULS.traceTag(574128980,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,t)),[2]}}))}))},e.prototype.processRecalcResults=function(e){for(var t=new cD(this.onRecalcResults,this.onUpdateRequest,this.currentOutputStateId),r=0,n=e;r<n.length;r++){var a=n[r];if(a.kind!==ER.GarbageCollected)if(a.kind!==ER.ExperimentRunResult){if(this.setOutputStateId(a.stateId))switch(t.setOutputStateId(a.stateId),a.kind){case ER.CellWrite:var i=a.cell,o=a.value,u=a.format,s=a.cellKind,c=a.formulaBarText,l=a.formatted,d=a.hasHyperlink,f=i.sheet,h=i.range,v=this.cellWriteToRangeDelta(f.index,h.row,h.col,o,u,c,l,d,"messages.<index>.value");pe(v)&&t.pushCellWrite(s,v);break;case ER.RangeWrite:var p=a.range,m=a.values,g=(s=a.cellKind,c=a.formulaBarText,l=a.formatted,a.formats);f=p.sheet,h=p.range;t.pushRangeWrite(s,this.rangeWriteToRangeDeltas(f.index,h,m,g,c,l,"messages.<index>.values"));break;case ER.NameFailure:this.nameFailures.push(a);break;case ER.RangeFailure:p=a.range,s=a.cellKind;var S=a.reason;t.pushRangeFailure(s,this.rangeFailure(p,S)),this.rangeFailures.push(a);break;case ER.NumberFormatFailure:this.numberFormatFailures.push(a);break;case ER.PrintFormulaFailure:this.printFormulaFailures.push(a);break;case ER.InferFormatFailure:this.inferFormatFailures.push(a);break;case ER.FormatValueFailure:p=a.range,s=a.cellKind,S=a.reason;t.pushRangeFailure(s,this.rangeFailure(p,S)),this.formatValueFailures.push(a);break;case ER.UnhandledFailure:this.unhandledFailures.push(a);break;case ER.UpdateRequest:t.pushUpdateRequest(nD(a.range));break;case ER.UpdateNamesRequest:t.pushUpdateNameRequest(a.scope);break;case ER.RecalcStatistics:t.pushRecalcFinished(a.message===SR.RecalcFinished),this.recalcStatistics=kR(this.recalcStatistics,a);break;case ER.WorkbookStatistics:this.logWorkbookStats(a.stateId,a.stats,a.p);break;case ER.StateAdvanced:break;default:return L("calc.calc.RecalcServiceImpl.processRecalcResults",a)}}else this.logExperimentRunResult(a.logMessage);else this.onGC(a.minStateIdKept)}t.isRecalcFinished()&&this.flushOutputLogs(),t.flush()},e.prototype.logExperimentRunResult=function(e){_.ULS.traceTag(594409422,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"calc.calc.RecalcService: experiment done; "+e)},e.prototype.logAllFailureStats=function(){var e=this.nameFailures;this.nameFailures=[];var t=this.rangeFailures;this.rangeFailures=[];var r=this.numberFormatFailures;this.numberFormatFailures=[];var n=this.printFormulaFailures;this.printFormulaFailures=[];var a=this.inferFormatFailures;this.inferFormatFailures=[];var i=this.formatValueFailures;this.formatValueFailures=[];var o=this.unhandledFailures;this.unhandledFailures=[],this.logGenFailureStats(e,595194337,"name",s.TraceLevel.Info),this.logCellFailureStats(t,595658722,"range",s.TraceLevel.Info),this.logGenFailureStats(r,590484946,"format",s.TraceLevel.Info),this.logGenFailureStats(n,592730065,"print-formula",s.TraceLevel.Info),this.logGenFailureStats(a,590484947,"infer-format",s.TraceLevel.Info),this.logCellFailureStats(i,590484948,"format-value",s.TraceLevel.Info),this.logGenFailureStats(o,595194338,"unhandled",s.TraceLevel.Warning)},e.prototype.logGenFailureStats=function(e,t,r,n){if(0!==e.length){for(var a={},i=0,o=e;i<o.length;i++){sD(a,o[i].reason)}var u="calc.calc.RecalcService: recalc "+r+" failures; stateId = "+this.currentOutputStateId+", stats = "+JSON.stringify(a);_.ULS.traceTag(t,s.LogCategory.msoulscat_ES_EWAJS,n,u),this.logJavaScriptFailures(e,r)}},e.prototype.logCellFailureStats=function(e,t,r,n){var a=this;if(0!==e.length){for(var i={},o=0,u=e;o<u.length;o++){var c=u[o],l=c.reason,d=c.cellKind;sD(i[d]||(i[d]={}),l)}Object.getOwnPropertyNames(i).sort().forEach((function(e){var o=i[e],u="calc.calc.RecalcService: recalc "+r+" failures; stateId = "+a.currentOutputStateId+", cell kind = "+e+", stats = "+JSON.stringify(o);_.ULS.traceTag(t,s.LogCategory.msoulscat_ES_EWAJS,n,u)})),this.logJavaScriptFailures(e,r)}},e.prototype.logJavaScriptFailures=function(e,t){for(var r=0,n=e;r<n.length;r++){var a=n[r].reason;if(a.kind===VS.JavaScriptError){var i="calc.calc.RecalcService: recalc "+t+" JavaScript error: "+A(a.error);_.ULS.traceTag(595658721,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Warning,i)}}},e.prototype.logIgnoredStats=function(e,t,r,n){if(0!==Object.getOwnPropertyNames(n).length){var a="calc.calc.RecalcService: ignored "+r+" data; "+("stateId = "+t+", stats = "+JSON.stringify(n));_.ULS.traceTag(e,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Warning,a)}},e.prototype.logIgnoredInputStats=function(){this.logIgnoredStats(595658723,this.currentInputStateId,"input",this.ignoredInputStats),this.ignoredInputStats={}},e.prototype.logIgnoredOutputStats=function(){this.logIgnoredStats(595658752,this.currentOutputStateId,"output",this.ignoredOutputStats),this.ignoredOutputStats={}},e.prototype.logRecalcStats=function(){if(this.currentOutputStateId!==-1/0&&(this.lastRecalcStatsStateId!==this.currentOutputStateId||this.recalcStatistics!==CR)){var e=this.recalcStatistics;this.recalcStatistics=CR,this.lastRecalcStatsStateId=this.currentOutputStateId;var t=this.config.sampleRecalcStatisticsRate;if(this.dataModel.shouldSample(t)){var r="calc.calc.RecalcService: recalc statistics; "+("stateId = "+this.currentOutputStateId+", stats = "+JSON.stringify(e)+", p = "+JSON.stringify(t));_.ULS.traceTag(595654593,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,r)}}},e.prototype.logUnavailableStats=function(){if(this.currentOutputStateId!==-1/0&&0!==this.rangeFailures.length){var e=function(e){for(var t,r,n,a,i,o,u,s=ce(),c=ce(),l=0,d=e;l<d.length;l++){var f=d[l],h=f.range;if(f.reason.kind===rn.Unavailable)for(var v=0,p=f.reason.objects;v<p.length;v++){var m=p[v];m.kind===AO.GridRange&&(Nr(m.range.sheet,h.sheet)?s[m.range.sheet.index]=VC(null!==(t=s[m.range.sheet.index])&&void 0!==t?t:dC,!0!==m.unavailableCells?m.unavailableCells:dC):c[m.range.sheet.index]=VC(null!==(r=c[m.range.sheet.index])&&void 0!==r?r:dC,!0!==m.unavailableCells?m.unavailableCells:dC))}}var g=0,S=0,y=0,b=ce();for(var E in s){var F=null!==(n=s[E])&&void 0!==n?n:dC;b[E]=VC(null!==(a=b[E])&&void 0!==a?a:dC,F),pR(F,(function(e){return g+=e.rows*e.cols,!0}))}for(var E in c){F=null!==(i=c[E])&&void 0!==i?i:dC;b[E]=VC(null!==(o=b[E])&&void 0!==o?o:dC,F),pR(F,(function(e){return S+=e.rows*e.cols,!0}))}for(var E in b){pR(F=null!==(u=b[E])&&void 0!==u?u:dC,(function(e){return y+=e.rows*e.cols,!0}))}return{numOfUnavailableCellsInTheSameSheet:g,numOfUnavailableCellsInDifferentSheet:S,totalNumOfUnavailableCells:y}}(this.rangeFailures);if(0!==e.numOfUnavailableCellsInTheSameSheet||0!==e.numOfUnavailableCellsInDifferentSheet||0!==e.totalNumOfUnavailableCells){var t="calc.calc.RecalcService: unavailable cells statistics; "+("stateId = "+this.currentOutputStateId+", stats = "+JSON.stringify(e));_.ULS.traceTag(589632004,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,t)}}},e.prototype.logWorkbookStats=function(e,t,r){var n="calc.calc.RecalcService: workbook statistics; "+("stateId = "+e+", stats = "+JSON.stringify(t)+", p = "+JSON.stringify(r));_.ULS.traceTag(595359882,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,n)},e.prototype.logInputStateIdDecrease=function(e){NR(this.ignoredInputStats,e+": input stateId went backwards")},e.prototype.logOutputStateIdDecrease=function(){NR(this.ignoredOutputStats,"output stateId went backwards")},e.prototype.flushInputLogs=function(){this.logIgnoredInputStats()},e.prototype.flushOutputLogs=function(){this.logUnavailableStats(),this.logAllFailureStats(),this.logIgnoredOutputStats(),this.logRecalcStats()},e.prototype.cellWriteToRangeDelta=function(e,t,r,n,a,i,o,u,s){if(IR(n,Xk,this.ignoredOutputStats,s)){var c=oD(this.mathpack,n),l=function(e){var t;if(void 0!==e)return t=e.format,XE("object"==typeof t?lD(e.format):e.format,e.valueType,e.decimals)}(a);return pe(i)||pe(c)||pe(l)||pe(o)||pe(u)?$E(SE(e,t,r),ZE(i,c,l,o,u)):void 0}},e.prototype.rangeWriteToRangeDeltas=function(e,t,r,n,a,i,o){for(var u=o+".<index>.<index>",s=t.row,c=t.col,l=t.rows,d=t.cols,f=[],h=0;h<l;h+=1)for(var v=0;v<d;v+=1){var p=this.cellWriteToRangeDelta(e,s+h,c+v,r[h][v],n[h][v],0===h&&0===v?a:void 0,i[h][v],void 0,u);pe(p)&&f.push(p)}return f},e.prototype.rangeFailure=function(e,t){return tF(nD(e),lD(t))},e.prototype.setA1ReferenceStyle=function(e){this.clearAsyncResumeRecalc(),this.refStyle=e?it.A1:it.R1C1,this.dataModel.setRefStyle(this.refStyle,this.currentInputStateId)},e.prototype.setLocale=function(e){this.clearAsyncResumeRecalc(),IR(e,Kk,this.ignoredInputStats,"localeData")&&(this.localeInfo=Qw(e,this.ignoredInputStats),this.dataModel.setLocaleInfo(this.localeInfo,this.currentInputStateId))},e.prototype.setWorkbookProps=function(e){this.clearAsyncResumeRecalc(),IR(e,zk,this.ignoredInputStats,"workbookProps")&&(this.setProps(e),this.dataModel.setWorkbookProps(this.props,this.currentInputStateId))},e.prototype.setNumberFormats=function(e,t){this.clearAsyncResumeRecalc(),this.dataModel.setNumberFormats(this.document,OR(e,rk,this.ignoredInputStats,"numberFormats"),t,this.currentInputStateId)},e.prototype.updateSheetNames=function(e,t){this.setInputStateId(e,"sheetNames")&&(this.clearAsyncResumeRecalc(),this.dataModel.setSheetNames(this.document,OR(t,ak,this.ignoredInputStats,"sheetNames"),e))},e.prototype.updateNamedObjects=function(e,t){if(this.setInputStateId(e,"namedObjectsUpdates")){this.clearAsyncResumeRecalc();for(var r=0,n=OR(t,Tk,this.ignoredInputStats,"namedObjectsUpdates");r<n.length;r++){var a=n[r],i=a.scope,o=a.objects,u=a.fromStateId,s=Gn(this.document,pe(i)?i:void 0);if(pe(o))for(var c=0,l=OR(o,Ak,this.ignoredInputStats,"namedObjectsUpdates.<index>.objects");c<l.length;c++){var d=l[c],f=d.name,h=d.data;this.dataModel.writeNamedObject(e,s,f,uD(this.mathpack,this.localeInfo.stringCompareCI,this.document,h))}else pe(u)?this.dataModel.promoteNamedObjects(e,s,u):this.dataModel.writeUndefinedNames(e,s)}}},e.prototype.updateUnusedCells=function(e,t){if(this.setInputStateId(e,"unusedCellsUpdates")){this.clearAsyncResumeRecalc();for(var r=0,n=OR(t,yk,this.ignoredInputStats,"unusedCellsUpdates");r<n.length;r++){var a=n[r];this.dataModel.extendUnusedRange(eD(this.document,a),e)}}},e.prototype.updateRanges=function(e,t){var r,n;if(this.setInputStateId(e,"rangeUpdates")){this.clearAsyncResumeRecalc();for(var a=0,i=OR(t,mk,this.ignoredInputStats,"rangeUpdates");a<i.length;a++){var o=i[a],u=o.range,s=o.excludeRows,c=o.excludeColumns,l=o.data,d=o.fromStateId,f=$w(this.document,u),h=f.range,v=aD(h.row,h.rows,iR.row,s),p=tD(f,v,aD(h.col,h.cols,iR.col,c)),m=pe(l)?iD(this.mathpack,l.value):fa;if(void 0!==m){var g=Mr(h);if(pe(l)){var S=l.iformat,y="ArrayFormula"===l.kind?void 0:null!==(r=l.formulaBarText)&&void 0!==r?r:void 0,b=null!==(n=l.failureReason)&&void 0!==n?n:void 0,E="CellFormula"===l.kind;this.dataModel.writeCellContents(e,p,y,E,g,m,S,b)}else me(d)?this.dataModel.writeCellContents(e,p,"",!1,g,fa,0,void 0):this.dataModel.promoteCellContents(e,f,p,d);this.dataModel.writeHiddenRows(e,rD(f,v))}}}},e.prototype.updateArrays=function(e,t){if(this.setInputStateId(e,"arrayUpdates")){this.clearAsyncResumeRecalc();for(var r=0,n=OR(t,Sk,this.ignoredInputStats,"arrayUpdates");r<n.length;r++){var a=n[r],i=a.range,o=a.data,u=a.fromStateId,s=$w(this.document,i);if(pe(o)){var c=o.formulaBarText,l=o.isSpilled,d=Mr(s.range);this.dataModel.writeArrayFormula(e,s,c,d,l)}else pe(u)}}},e.prototype.editRangeFormulas=function(e,t){var r=this;if(this.setInputStateId(e,"rangeFormulaEdits")){this.clearAsyncResumeRecalc();for(var n=OR(t,wk,this.ignoredInputStats,"rangeFormulaEdits"),a=function(t){var n=t.kind,a=t.range,o=t.formulaBarText,u=t.value,s=t.origin,c=t.viewport,l=dC;a.forEach((function(e){l=VC(l,oR($w(r.document,e).range))}));var d=$w(i.document,a[0]),f=pe(s)?Dn(s.row,s.column):Mr(d.range),h=pe(c)?$w(i.document,c):void 0,v=void 0;if(pe(u)){if(void 0===(v=iD(i.mathpack,u)))return"continue"}else v=void 0;var p="CellFormula"===n||"Value"!==n&&void 0;i.dataModel.editCellContents(e,gR(d.sheet,l),o,p,f,v,h)},i=this,o=0,u=n;o<u.length;o++){a(u[o])}}},e.prototype.editRangeFormats=function(e,t){var r=this;if(this.setInputStateId(e,"rangeFormatEdits")){this.clearAsyncResumeRecalc();for(var n=OR(t,_k,this.ignoredInputStats,"rangeFormatEdits"),a=function(t){var n=t.range,a=t.operation,o=(t.origin,t.viewport),u=a.format;if(me(u))return"continue";var s=dC;n.forEach((function(e){s=VC(s,oR($w(r.document,e).range))}));var c=$w(i.document,n[0]),l=pe(o)?$w(i.document,o):void 0;i.dataModel.editCellFormats(e,gR(c.sheet,s),u,l)},i=this,o=0,u=n;o<u.length;o++){a(u[o])}}},e.prototype.editArrayFormulas=function(e,t){if(this.setInputStateId(e,"arrayFormulaEdits")){this.clearAsyncResumeRecalc();for(var r=0,n=OR(t,Lk,this.ignoredInputStats,"arrayFormulaEdits");r<n.length;r++){var a=n[r],i=a.range,o=a.formulaBarText,u=a.origin,s=a.viewport,c=$w(this.document,i),l=pe(u)?Dn(u.row,u.column):Dn(i.row,i.column),d=pe(s)?$w(this.document,s):void 0;this.dataModel.editArrayFormula(e,c,o,l,d)}}},e.prototype.setConfig=function(e){var t,r,n,a,i,o,u,s,c,l,d,f,h=Array.isArray(e.runExperiments)?{stepBudget:null!==(t=e.experimentStepBudget)&&void 0!==t?t:10,totalBudget:null!==(r=e.experimentTotalBudget)&&void 0!==r?r:1e4,experiments:(f=e.runExperiments,f.map((function(e){var t,r=e.name,n=e.param;return null===(t=Pw[r])||void 0===t?void 0:t.call(Pw,n)})).filter((function(e){return void 0!==e})))}:void 0;this.config={yieldIntervalMs:10,totalTimeMs:null!==(n=e.totalEvalTimeMs)&&void 0!==n?n:1e4,maxCellChain:32768,maxNameChain:128,maxLambdaCalls:1e4,maxLambdaDepth:1e3,samplePrecisionEvalRate:null!==(a=e.samplePrecisionEvalRate)&&void 0!==a?a:.02,samplePrecisionPrintFormulaRate:null!==(i=e.samplePrecisionPrintFormulaRate)&&void 0!==i?i:.001,sampleRecalcStatisticsRate:null!==(o=e.sampleRecalcStatisticsRate)&&void 0!==o?o:.2,sampleWorkbookStatisticsRate:null!==(u=e.sampleWorkbookStatisticsRate)&&void 0!==u?u:.1,sampleCellEvalStopwatchRate:null!==(s=e.sampleCellEvalStopwatchRate)&&void 0!==s?s:.003,sampleRecalcEditedStopwatchRate:null!==(c=e.sampleRecalcEditedStopwatchRate)&&void 0!==c?c:1,sampleRecalcViewportStopwatchRate:null!==(l=e.sampleRecalcViewportStopwatchRate)&&void 0!==l?l:1,rngSeed:null!==(d=e.rngSeed)&&void 0!==d?d:1e3*Date.now(),volatileMode:null!=e.volatileMode?cO[e.volatileMode]:cO.Estimation,experimentDefinitions:h}},e.prototype.setProps=function(e){var t,r,n;this.props={date1904:null!==(t=e.date1904)&&void 0!==t&&t,dateCompatibility:null===(r=e.dateCompatibility)||void 0===r||r,timezone:null!==(n=e.timezone)&&void 0!==n?n:oo}},e.prototype.reconfigure=function(e){this.setConfig(e),this.dataModel.reconfigure(this.config)},e.prototype.clearCache=function(){this.clearAsyncResumeRecalc(),this.dataModel=new LO(this.localeInfo,this.mathpack,this.refStyle,this.props,this.config),this.recalcStatistics=CR,this.nameFailures=[],this.rangeFailures=[],this.numberFormatFailures=[],this.unhandledFailures=[],this.ignoredInputStats={},this.ignoredOutputStats={},this.currentInputStateId=this.currentOutputStateId=this.lastRecalcStatsStateId=-1/0},e.prototype.evalFormula=function(e,t,r,n){var a=this;return IR(r,lk,this.ignoredInputStats,"origin")?IR(n,Jk,this.ignoredInputStats,"format")?this.dataModel.evalFormula(e,t,function(e,t){var r=t.row,n=t.column;return Wn(Tn(e,t.sheetId),Dn(r,n))}(this.document,r),function(e){if(null!=e)switch(e.kind){case"Origin":return bR.Origin;case"Iformat":return x("calc.calc.evalFormulaFormatToUnion: iformat","number"==typeof e.iformat),e.iformat;case"Inferred":return bR.Inferred;default:return L("calc.calc.evalFormulaFormatToUnion: kind",e.kind)}}(n)).then((function(e){var t,r=e.value,n=e.formatted;if(X(r)){if(!IR(r.value,Xk,a.ignoredOutputStats,"evalFormula"))throw new Error("ignored output");var i=oD(a.mathpack,r.value);x("calc.calc.RecalcService.evalFormula",void 0!==i),t=q(i)}else t=Q(lD(r.reason));return uF(t,void 0===n?void 0:X(n)?n:Q(lD(n.reason)))})):Promise.reject(new Error("ignored format")):Promise.reject(new Error("ignored input"))},e.prototype.testAdvanceState=function(e){this.setInputStateId(e,"testAdvanceState")&&(this.dataModel.testAdvanceState(e),this.clearAsyncResumeRecalc())},e.prototype.testDelay=function(e){return ne(this,void 0,void 0,(function(){return ae(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t){return setTimeout(t,e)}))];case 1:return t.sent(),[2]}}))}))},e}(),fD=function(e,t,r){for(var n,a=(void 0===(n="___mixinField")&&(n=""),n+(Jw+=1).toString()),i={},o=function(e){i[e]=function(){for(var t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var i=this[a];return(t=i[e]).call.apply(t,ie([i],r))}},u=0,s=r;u<s.length;u++){o(s[u])}return function(e){function n(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];for(var u=e.apply(this,n)||this,s=t(u),c=0,l=r;c<l.length;c++){var d=l[c];Object.defineProperty(u,d,{value:i[d],enumerable:!1,configurable:!1})}return u[a]=s,u}return ee(n,e),n}(e)}(dD,(function(e){return new jw(e)}),["getSheetNames","getRangeValues","getRangeFormats","getRangeFormulae","createSnapshot","discardSnapshot"]);function hD(){return{onError:function(e,t){var r="calc.calc.recalcServiceInsideDef.onError: "+JSON.stringify({kind:t.kind,closing:t.closing,message:A(t.error)});_.ULS.traceTag(595658753,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Warning,r)},onInit:function(e){var t=e.getImports("client",["onRecalcResults","onUpdateRequest","onGC"]),r=t.onRecalcResults,n=t.onUpdateRequest,a=t.onGC,i=e.workerKind===sF.Dedicated?"Thread":"Local";e.setExports("service",new fD(r.notify,n.notify,a.notify,i))},scriptName:"excelOnlineRecalcService.worker"}}var vD=function(e){var t=e.connection;return Yi.Endpoint.createInside(t,(function(e){return new fD((function(){for(var t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return(t=e.post).onRecalcResults.apply(t,r)}),(function(){for(var t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return(t=e.post).onUpdateRequest.apply(t,r)}),(function(){for(var t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return(t=e.post).onGC.apply(t,r)}),t.createMode)}))},pD=r(2);function mD(e){return"function"==typeof e}var gD=!1,SD={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){e&&(new Error).stack;gD=e},get useDeprecatedSynchronousErrorHandling(){return gD}};function yD(e){setTimeout((function(){throw e}),0)}var bD={closed:!0,next:function(e){},error:function(e){if(SD.useDeprecatedSynchronousErrorHandling)throw e;yD(e)},complete:function(){}},ED=function(){return Array.isArray||function(e){return e&&"number"==typeof e.length}}();function FD(e){return null!==e&&"object"==typeof e}var CD=function(){function e(e){return Error.call(this),this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e,this}return e.prototype=Object.create(Error.prototype),e}(),RD=function(){function e(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._ctorUnsubscribe=!0,this._unsubscribe=e)}return e.prototype.unsubscribe=function(){var t;if(!this.closed){var r=this._parentOrParents,n=this._ctorUnsubscribe,a=this._unsubscribe,i=this._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,r instanceof e)r.remove(this);else if(null!==r)for(var o=0;o<r.length;++o){r[o].remove(this)}if(mD(a)){n&&(this._unsubscribe=void 0);try{a.call(this)}catch(e){t=e instanceof CD?kD(e.errors):[e]}}if(ED(i)){o=-1;for(var u=i.length;++o<u;){var s=i[o];if(FD(s))try{s.unsubscribe()}catch(e){t=t||[],e instanceof CD?t=t.concat(kD(e.errors)):t.push(e)}}}if(t)throw new CD(t)}},e.prototype.add=function(t){var r=t;if(!t)return e.EMPTY;switch(typeof t){case"function":r=new e(t);case"object":if(r===this||r.closed||"function"!=typeof r.unsubscribe)return r;if(this.closed)return r.unsubscribe(),r;if(!(r instanceof e)){var n=r;(r=new e)._subscriptions=[n]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}var a=r._parentOrParents;if(null===a)r._parentOrParents=this;else if(a instanceof e){if(a===this)return r;r._parentOrParents=[a,this]}else{if(-1!==a.indexOf(this))return r;a.push(this)}var i=this._subscriptions;return null===i?this._subscriptions=[r]:i.push(r),r},e.prototype.remove=function(e){var t=this._subscriptions;if(t){var r=t.indexOf(e);-1!==r&&t.splice(r,1)}},e.EMPTY=function(e){return e.closed=!0,e}(new e),e}();function kD(e){return e.reduce((function(e,t){return e.concat(t instanceof CD?t.errors:t)}),[])}var ND=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),AD=function(e){function t(r,n,a){var i=e.call(this)||this;switch(i.syncErrorValue=null,i.syncErrorThrown=!1,i.syncErrorThrowable=!1,i.isStopped=!1,arguments.length){case 0:i.destination=bD;break;case 1:if(!r){i.destination=bD;break}if("object"==typeof r){r instanceof t?(i.syncErrorThrowable=r.syncErrorThrowable,i.destination=r,r.add(i)):(i.syncErrorThrowable=!0,i.destination=new TD(i,r));break}default:i.syncErrorThrowable=!0,i.destination=new TD(i,r,n,a)}return i}return pD.b(t,e),t.prototype[ND]=function(){return this},t.create=function(e,r,n){var a=new t(e,r,n);return a.syncErrorThrowable=!1,a},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this))},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},t.prototype._unsubscribeAndRecycle=function(){var e=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this},t}(RD),TD=function(e){function t(t,r,n,a){var i,o=e.call(this)||this;o._parentSubscriber=t;var u=o;return mD(r)?i=r:r&&(i=r.next,n=r.error,a=r.complete,r!==bD&&(mD((u=Object.create(r)).unsubscribe)&&o.add(u.unsubscribe.bind(u)),u.unsubscribe=o.unsubscribe.bind(o))),o._context=u,o._next=i,o._error=n,o._complete=a,o}return pD.b(t,e),t.prototype.next=function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;SD.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}},t.prototype.error=function(e){if(!this.isStopped){var t=this._parentSubscriber,r=SD.useDeprecatedSynchronousErrorHandling;if(this._error)r&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)r?(t.syncErrorValue=e,t.syncErrorThrown=!0):yD(e),this.unsubscribe();else{if(this.unsubscribe(),r)throw e;yD(e)}}},t.prototype.complete=function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var r=function(){return e._complete.call(e._context)};SD.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,r),this.unsubscribe()):(this.__tryOrUnsub(r),this.unsubscribe())}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(e,t){try{e.call(this._context,t)}catch(e){if(this.unsubscribe(),SD.useDeprecatedSynchronousErrorHandling)throw e;yD(e)}},t.prototype.__tryOrSetError=function(e,t,r){if(!SD.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,r)}catch(t){return SD.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=t,e.syncErrorThrown=!0,!0):(yD(t),!0)}return!1},t.prototype._unsubscribe=function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()},t}(AD);var ID=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}();function OD(e){return e}function MD(e){return 0===e.length?OD:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}}var wD=function(){function e(e){this._isScalar=!1,e&&(this._subscribe=e)}return e.prototype.lift=function(t){var r=new e;return r.source=this,r.operator=t,r},e.prototype.subscribe=function(e,t,r){var n=this.operator,a=function(e,t,r){if(e){if(e instanceof AD)return e;if(e[ND])return e[ND]()}return e||t||r?new AD(e,t,r):new AD(bD)}(e,t,r);if(n?a.add(n.call(a,this.source)):a.add(this.source||SD.useDeprecatedSynchronousErrorHandling&&!a.syncErrorThrowable?this._subscribe(a):this._trySubscribe(a)),SD.useDeprecatedSynchronousErrorHandling&&a.syncErrorThrowable&&(a.syncErrorThrowable=!1,a.syncErrorThrown))throw a.syncErrorValue;return a},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){SD.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),!function(e){for(;e;){var t=e,r=t.closed,n=t.destination,a=t.isStopped;if(r||a)return!1;e=n&&n instanceof AD?n:null}return!0}(e)?console.warn(t):e.error(t)}},e.prototype.forEach=function(e,t){var r=this;return new(t=DD(t))((function(t,n){var a;a=r.subscribe((function(t){try{e(t)}catch(e){n(e),a&&a.unsubscribe()}}),n,t)}))},e.prototype._subscribe=function(e){var t=this.source;return t&&t.subscribe(e)},e.prototype[ID]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0===e.length?this:MD(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=DD(e))((function(e,r){var n;t.subscribe((function(e){return n=e}),(function(e){return r(e)}),(function(){return e(n)}))}))},e.create=function(t){return new e(t)},e}();function DD(e){if(e||(e=SD.Promise||Promise),!e)throw new Error("no Promise impl found");return e}var _D=function(){function e(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return e.prototype=Object.create(Error.prototype),e}(),LD=function(e){function t(t,r){var n=e.call(this)||this;return n.subject=t,n.subscriber=r,n.closed=!1,n}return pD.b(t,e),t.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var e=this.subject,t=e.observers;if(this.subject=null,t&&0!==t.length&&!e.isStopped&&!e.closed){var r=t.indexOf(this.subscriber);-1!==r&&t.splice(r,1)}}},t}(RD),UD=function(e){function t(t){var r=e.call(this,t)||this;return r.destination=t,r}return pD.b(t,e),t}(AD),xD=function(e){function t(){var t=e.call(this)||this;return t.observers=[],t.closed=!1,t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return pD.b(t,e),t.prototype[ND]=function(){return new UD(this)},t.prototype.lift=function(e){var t=new BD(this,this);return t.operator=e,t},t.prototype.next=function(e){if(this.closed)throw new _D;if(!this.isStopped)for(var t=this.observers,r=t.length,n=t.slice(),a=0;a<r;a++)n[a].next(e)},t.prototype.error=function(e){if(this.closed)throw new _D;this.hasError=!0,this.thrownError=e,this.isStopped=!0;for(var t=this.observers,r=t.length,n=t.slice(),a=0;a<r;a++)n[a].error(e);this.observers.length=0},t.prototype.complete=function(){if(this.closed)throw new _D;this.isStopped=!0;for(var e=this.observers,t=e.length,r=e.slice(),n=0;n<t;n++)r[n].complete();this.observers.length=0},t.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},t.prototype._trySubscribe=function(t){if(this.closed)throw new _D;return e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){if(this.closed)throw new _D;return this.hasError?(e.error(this.thrownError),RD.EMPTY):this.isStopped?(e.complete(),RD.EMPTY):(this.observers.push(e),new LD(this,e))},t.prototype.asObservable=function(){var e=new wD;return e.source=this,e},t.create=function(e,t){return new BD(e,t)},t}(wD),BD=function(e){function t(t,r){var n=e.call(this)||this;return n.destination=t,n.source=r,n}return pD.b(t,e),t.prototype.next=function(e){var t=this.destination;t&&t.next&&t.next(e)},t.prototype.error=function(e){var t=this.destination;t&&t.error&&this.destination.error(e)},t.prototype.complete=function(){var e=this.destination;e&&e.complete&&this.destination.complete()},t.prototype._subscribe=function(e){return this.source?this.source.subscribe(e):RD.EMPTY},t}(xD),WD=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.scheduler=t,n.work=r,n.pending=!1,n}return pD.b(t,e),t.prototype.schedule=function(e,t){if(void 0===t&&(t=0),this.closed)return this;this.state=e;var r=this.id,n=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(n,r,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(n,this.id,t),this},t.prototype.requestAsyncId=function(e,t,r){return void 0===r&&(r=0),setInterval(e.flush.bind(e,this),r)},t.prototype.recycleAsyncId=function(e,t,r){if(void 0===r&&(r=0),null!==r&&this.delay===r&&!1===this.pending)return t;clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var r=this._execute(e,t);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var r=!1,n=void 0;try{this.work(e)}catch(e){r=!0,n=!!e&&e||new Error(e)}if(r)return this.unsubscribe(),n},t.prototype._unsubscribe=function(){var e=this.id,t=this.scheduler,r=t.actions,n=r.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==n&&r.splice(n,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null},t}(function(e){function t(t,r){return e.call(this)||this}return pD.b(t,e),t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},t}(RD)),PD=function(){function e(t,r){void 0===r&&(r=e.now),this.SchedulerAction=t,this.now=r}return e.prototype.schedule=function(e,t,r){return void 0===t&&(t=0),new this.SchedulerAction(this,e).schedule(r,t)},e.now=function(){return Date.now()},e}(),VD=new(function(e){function t(r,n){void 0===n&&(n=PD.now);var a=e.call(this,r,(function(){return t.delegate&&t.delegate!==a?t.delegate.now():n()}))||this;return a.actions=[],a.active=!1,a.scheduled=void 0,a}return pD.b(t,e),t.prototype.schedule=function(r,n,a){return void 0===n&&(n=0),t.delegate&&t.delegate!==this?t.delegate.schedule(r,n,a):e.prototype.schedule.call(this,r,n,a)},t.prototype.flush=function(e){var t=this.actions;if(this.active)t.push(e);else{var r;this.active=!0;do{if(r=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}},t}(PD))(WD);function GD(e){return!ED(e)&&e-parseFloat(e)+1>=0}function HD(e){return e&&"function"==typeof e.schedule}function jD(e){var t=e.index,r=e.period,n=e.subscriber;if(n.next(t),!n.closed){if(-1===r)return n.complete();e.index=t+1,this.schedule(e,r)}}var KD=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return pD.b(t,e),t.prototype.notifyNext=function(e,t,r,n,a){this.destination.next(t)},t.prototype.notifyError=function(e,t){this.destination.error(e)},t.prototype.notifyComplete=function(e){this.destination.complete()},t}(AD),YD=function(e){function t(t,r,n){var a=e.call(this)||this;return a.parent=t,a.outerValue=r,a.outerIndex=n,a.index=0,a}return pD.b(t,e),t.prototype._next=function(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)},t.prototype._error=function(e){this.parent.notifyError(e,this),this.unsubscribe()},t.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},t}(AD);function qD(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}var zD=qD();var JD=function(e){if(e&&"function"==typeof e[ID])return i=e,function(e){var t=i[ID]();if("function"!=typeof t.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return t.subscribe(e)};if((a=e)&&"number"==typeof a.length&&"function"!=typeof a)return n=e,function(e){for(var t=0,r=n.length;t<r&&!e.closed;t++)e.next(n[t]);e.complete()};if(function(e){return!!e&&"function"!=typeof e.subscribe&&"function"==typeof e.then}(e))return r=e,function(e){return r.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,yD),e};if(e&&"function"==typeof e[zD])return t=e,function(e){for(var r=t[zD]();;){var n=void 0;try{n=r.next()}catch(t){return e.error(t),e}if(n.done){e.complete();break}if(e.next(n.value),e.closed)break}return"function"==typeof r.return&&e.add((function(){r.return&&r.return()})),e};var t,r,n,a,i,o=FD(e)?"an invalid object":"'"+e+"'";throw new TypeError("You provided "+o+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")};var QD,XD,ZD,$D=function(){function e(e){this.delayDurationSelector=e}return e.prototype.call=function(e,t){return t.subscribe(new e_(e,this.delayDurationSelector))},e}(),e_=function(e){function t(t,r){var n=e.call(this,t)||this;return n.delayDurationSelector=r,n.completed=!1,n.delayNotifierSubscriptions=[],n.index=0,n}return pD.b(t,e),t.prototype.notifyNext=function(e,t,r,n,a){this.destination.next(e),this.removeSubscription(a),this.tryComplete()},t.prototype.notifyError=function(e,t){this._error(e)},t.prototype.notifyComplete=function(e){var t=this.removeSubscription(e);t&&this.destination.next(t),this.tryComplete()},t.prototype._next=function(e){var t=this.index++;try{var r=this.delayDurationSelector(e,t);r&&this.tryDelay(r,e)}catch(e){this.destination.error(e)}},t.prototype._complete=function(){this.completed=!0,this.tryComplete(),this.unsubscribe()},t.prototype.removeSubscription=function(e){e.unsubscribe();var t=this.delayNotifierSubscriptions.indexOf(e);return-1!==t&&this.delayNotifierSubscriptions.splice(t,1),e.outerValue},t.prototype.tryDelay=function(e,t){var r=function(e,t,r,n,a){if(void 0===a&&(a=new YD(e,r,n)),!a.closed)return t instanceof wD?t.subscribe(a):JD(t)(a)}(this,e,t);r&&!r.closed&&(this.destination.add(r),this.delayNotifierSubscriptions.push(r))},t.prototype.tryComplete=function(){this.completed&&0===this.delayNotifierSubscriptions.length&&this.destination.complete()},t}(KD),t_=function(e){function t(t,r){var n=e.call(this)||this;return n.source=t,n.subscriptionDelay=r,n}return pD.b(t,e),t.prototype._subscribe=function(e){this.subscriptionDelay.subscribe(new r_(e,this.source))},t}(wD),r_=function(e){function t(t,r){var n=e.call(this)||this;return n.parent=t,n.source=r,n.sourceSubscribed=!1,n}return pD.b(t,e),t.prototype._next=function(e){this.subscribeToSource()},t.prototype._error=function(e){this.unsubscribe(),this.parent.error(e)},t.prototype._complete=function(){this.unsubscribe(),this.subscribeToSource()},t.prototype.subscribeToSource=function(){this.sourceSubscribed||(this.sourceSubscribed=!0,this.unsubscribe(),this.source.subscribe(this.parent))},t}(AD);!function(e){e[e.FunctionMessage=0]="FunctionMessage"}(QD||(QD={})),function(e){e[e.Insert=0]="Insert",e[e.Delete=1]="Delete",e[e.Replace=2]="Replace"}(XD||(XD={})),function(e){e.GetSheetNames="GetSheetNames",e.GetRange="GetRange",e.Delay="Delay",e.CreateSnapshot="CreateSnapshot"}(ZD||(ZD={}));var n_={kind:ZD.GetSheetNames};function a_(e){return{kind:ZD.GetRange,range:e}}var i_,o_={kind:ZD.Delay},u_={kind:ZD.CreateSnapshot},s_=o_,c_=u_;function l_(e){return{kind:ZD.GetRange,localSheetGrid:e}}function d_(e){return{kind:ZD.GetSheetNames,sheetNames:e}}function f_(e,t){return{correlationId:e,kind:i_.FunctionSuggestion,formulas:t}}function h_(e,t,r,n){return{correlationId:e,kind:i_.FormulaHighlighting,tokens:t,colors:r,styles:n}}!function(e){e.FunctionSuggestion="FunctionSuggestion",e.FormulaHighlighting="FormulaHighlighting"}(i_||(i_={}));var v_=ys.OperKind,p_=As.getEnglishLocaleInfo(),m_=As.calcConfig(p_).mathpack,g_=function(){function e(e,t,r){this.localGrid=e,this.activeCell=t,this.config=r}return e.prototype.getConfig=function(){return this.config},e.prototype.getCurrentLocation=function(){return void 0!==this.activeCell?ks.success(this.activeCell):ks.failure(ks.unavailable(["getCurrentLocation"]))},e.prototype.getCellContentType=function(e){var t=ks.failure(ks.unavailable(["getCellContentType"])),r=this.localGrid.getCellValue(e.range.row,e.range.col);if(r.kind!==ks.ResultKind.Success)return t;switch(r.value.oper.kind){case v_.Blank:return ks.success(Dw.Empty);case v_.String:return ks.success(Dw.String);case v_.Number:return ks.success(Dw.Number);case v_.Boolean:return ks.success(Dw.Boolean);case v_.Error:return ks.success(Dw.Error);default:return t}},e.prototype.getCellContent=function(e){var t,r,n=ks.failure(ks.unavailable(["getCellContent"])),a=this.localGrid.getCellValue(e.range.row,e.range.col);if(a.kind!==ks.ResultKind.Success)return n;var i=a.value;switch(i.oper.kind){case v_.String:r=i.oper.value;break;case v_.Number:var o=this.config.mathpack.toNumber(i.oper);r=m_.formatGeneral(p_,m_.fromNumber(o),21);break;case v_.Boolean:r=i.oper.value?p_.trueName:p_.falseName;break;case v_.Blank:r="";break;case v_.Error:r=null!==(t=p_.errorNames[i.oper.type])&&void 0!==t?t:"";break;default:return n}var u=this.localGrid.getCellFormula(e.range.row,e.range.col),s=u.kind===ks.ResultKind.Success&&void 0!==u.value?u.value.fmla:void 0;return ks.success({displayed:r,formula:s})},e.prototype.getNames=function(e){return console.log("names"),ks.failure(ks.unavailable(["getNames"]))},e}();function S_(){return function(e){return function(e){for(var t=function(e){this.obj=e},r=function(e){t.prototype[e]=function(){for(var t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var a=(t=this.obj)[e].apply(t,r);return Promise.resolve(a)}},n=0,a=e;n<a.length;n++){r(a[n])}return t}(e)}}var y_,b_=function(e){function t(){var t=this,r=Gw(),n=new jw(r);return(t=e.call(this,n)||this).calcGrid=r,t}return ee(t,e),t.prototype.setSheet=function(e,t,r){var n=Tn(kn(void 0,""),e);this.calcGrid.updateSheetNames(1,[lE(n.index,t)]);for(var a=[],i=0;i<r.length;i+=1){var o=r[i];if(void 0!==o)for(var u=0;u<o.length;u+=1){var s=o[u];if(void 0!==s){var c=SE(n.index,i,u);a.push(kE(c,CE(s.toString(),s,0)))}}}this.calcGrid.updateRanges(1,ie([kE(SE(n.index,0,0))],a)),this.runTasks()},t.prototype.runTasks=function(){for(;;){if(this.calcGrid.dataModel.step().queueEmpty)break}},t}(S_()(["getRangeFormats","getRangeFormulae","getRangeValues","getSheetNames","createSnapshot","discardSnapshot"])),E_=function(){function e(){this.current=0}return e.prototype.create=function(){return this.current+=1},e}(),F_=function(e){this.requiresImmediateExecution=!1;var t,r,n=new xD;this.begin=n,this.done=n.pipe((t=function(){return function(e,t,r){void 0===e&&(e=0);var n=-1;return GD(t)?n=Number(t)<1?1:Number(t):HD(t)&&(r=t),HD(r)||(r=VD),new wD((function(t){var a=GD(e)?e:+e-r.now();return r.schedule(jD,a,{index:0,period:n,subscriber:t})}))}(e)},r?function(e){return new t_(e,r).lift(new $D(t))}:function(e){return e.lift(new $D(t))}))},C_=function(){this.requiresImmediateExecution=!0;var e=new xD;this.begin=e,this.done=e},R_=function(){function e(e){var t=this;this.pulseProvider=e,this.editorStream=new xD,this.idFactory=new E_,this.uiMessages=new xD,this.pluginMessagesForId=[],this.asyncGrid=void 0,this.callbacksForId=[],this.cachedPluginMessages=[],this.activeCell=void 0,this.config=Gw().dataModel.docs.config,e.done.subscribe((function(e){var r;_.ULS.traceTag(573932624,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"pulseProvider.done() with correlationId: "+e),null===(r=t.asyncGrid)||void 0===r||r.discardSnapshot(e),t.idInFlight=void 0;var n=ie(t.pluginMessagesForId);t.cachedPluginMessages=n;for(var a=0,i=t.callbacksForId;a<i.length;a++){(0,i[a])(t.cachedPluginMessages)}t.callbacksForId.length=0,t.pluginMessagesForId.length=0,t.editorStream.next(n)}))}return e.prototype.subscribe=function(e){me(e)||this.editorStream.subscribe((function(t){e.handleFunctionSuggestion(t.filter((function(e){return e.kind===i_.FunctionSuggestion})).map((function(e){return e.formulas})).reduce((function(e,t){return ie(e,t)}),[]))}))},e.prototype.subscribeHighlighting=function(e){me(e)||this.editorStream.subscribe((function(t){t.filter((function(e){return e.kind===i_.FormulaHighlighting})).map((function(e){return[e.tokens,e.colors,e.styles]})).map((function(t){return e.handleCodeHighlighting.apply(e,t)}))}))},e.prototype.notify=function(e){if(!me(e)){var t=this.idFactory.create();_.ULS.traceTag(573932625,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"pulseProvider.next() with correlationId: "+t+"}"),this.idInFlight=t,this.cachedPluginMessages=void 0,this.uiMessages.next(e),this.pulseProvider.begin.next(t)}},e.prototype.setSelectedCell=function(e){this.setActiveCell(e)},e.prototype.setActiveCell=function(e){me(e)?_.ULS.traceTag(575244386,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Warning,"setSelectedCell early exit, activeCell is None"):me(e.docName)||me(e.docPath)||me(e.sheetIndex)?_.ULS.traceTag(575157659,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Warning,"setSelectedCell early exit, some of the arguments is None"):this.setCurrentCell(Wn(Tn(kn(e.docPath,e.docName),e.sheetIndex),Dn(e.rowIndex,e.colIndex)))},e.prototype.setCurrentCell=function(e){this.activeCell=e},e.prototype.getConfig=function(){return this.config},e.prototype.then=function(e){return void 0===this.cachedPluginMessages?this.callbacksForId.push(e):e(this.cachedPluginMessages),this},e.prototype.getAsyncGrid=function(){return this.asyncGrid},e.prototype.createAndAttachPlugin=function(e){var t=e.create(this);this.registerPlugIn(t)},e.prototype.registerPlugIn=function(e){var t=this;this.uiMessages.subscribe((function(r){if(void 0!==t.idInFlight){var n=t.idInFlight,a=e.run(te(te({},r),{correlationId:n,activeCell:t.activeCell}));if(t.pulseProvider.requiresImmediateExecution){var i=a.next();!0===i.done?t.pluginMessagesForId.push(i.value):setImmediate((function(){return t.runToCompletion(n,a,i)}))}else setImmediate((function(){return t.runToCompletion(n,a)}))}}))},e.prototype.runToCompletion=function(e,t,r){return ne(this,void 0,void 0,(function(){var n,a,i,o,u,s,c,l,d;return ae(this,(function(f){switch(f.label){case 0:n=null!=r?r:t.next(),f.label=1;case 1:if(!0===n.done)return[3,12];switch(a=n.value,a.kind){case ZD.Delay:return[3,2];case ZD.CreateSnapshot:return[3,4];case ZD.GetRange:return[3,6];case ZD.GetSheetNames:return[3,8]}return[3,10];case 2:return n=t.next(s_),[4,Promise.resolve()];case 3:return f.sent(),[3,1];case 4:return[4,this.getAsyncGrid().createSnapshot(e)];case 5:return f.sent(),n=t.next(c_),[3,1];case 6:return i=this.getAsyncGrid(),[4,Promise.all([i.getRangeValues(e,a.range),i.getRangeFormulae(e,a.range),i.getRangeFormats(e,a.range)])];case 7:return o=f.sent(),u=o[0],s=o[1],c=o[2],l=new zw(u,s,c),n=t.next(l_(l)),[3,1];case 8:return[4,this.getAsyncGrid().getSheetNames(e)];case 9:return d=f.sent(),n=t.next(d_(d)),[3,1];case 10:L("PluginRequest unknown: "+a,a),f.label=11;case 11:return[3,1];case 12:return this.idInFlight===n.value.correlationId&&this.pluginMessagesForId.push(n.value),[2]}}))}))},e.prototype.registerAsyncGrid=function(e){this.asyncGrid=e},e}(),k_=ke((function(){return new R_(new F_(30))}));function N_(){var e={};for(var t in w){var r=w[t];null!=r&&(e[r]=Y(r))}return e}!function(e){e.Thread="Thread",e.Local="Local",e.ThreadOrLocal="ThreadOrLocal"}(y_||(y_={}));var A_,T_,I_;function O_(e,t){return Y(w.CalcUseTypedWorkersLib)?function(e,t){return ne(this,void 0,void 0,(function(){function r(e){void 0===e&&(e="Requested"),l=e,u.close()}var n,a,i,o,u,c,l,d,f,h,v,p,m,g,S,y=this;return ae(this,(function(b){switch(b.label){case 0:if(n=!0===t?(new k_).instance():void 0,null==(a=qo()))throw new Error("initCalc was not passed calcAbsUrl");return i=-1/0,o={onRecalcResults:function(e){},onUpdateRequest:function(e){},onGC:function(e){i=e}},[4,Yi.createWorker({id:"RecalcService",createMode:e},{local:vD,thread:{scriptUrl:a,insideInitName:"excelOnlineCalc.calc.recalcServiceInsideInit"}},(function(){return o}))];case 1:u=b.sent(),void 0!==n&&n.registerAsyncGrid(u.call),c=function(){},l="Requested",u.onClose=function(){c();var e="calc.calc.createRecalcService.service.onClose: recalc service closed; reason = "+l;_.ULS.traceTag(574128977,s.LogCategory.msoulscat_ES_EWAJS,"Requested"===l?s.TraceLevel.Info:s.TraceLevel.Warning,e)},b.label=2;case 2:return b.trys.push([2,5,,6]),"Thread"!==u.createMode?[3,4]:(d=new MessageChannel,f={port:d.port1,options:{id:"RecalcServiceLogger"}},h={port:d.port2,options:{id:"RecalcServiceLogger"}},c=function(){return f.port.close()},[4,Promise.all([Yi.Endpoint.createInside(f,(function(){return _.noThrowLogger})),u.call.initializeCalc.transfer([h.port],h,N_(),a)])]);case 3:v=b.sent()[0],c=function(){return v.close()},b.label=4;case 4:return u.call.ping.callTimeout=3e4,p=3,m=0,g=function(){},bF((function(){return ne(y,void 0,void 0,(function(){var e,t,n,a,i,o,c;return ae(this,(function(l){switch(l.label){case 0:return[4,new Promise((function(e){return setTimeout(e,1e3)}))];case 1:if(l.sent(),u.hasBeenClosed())return[2,void 0];e=u.call.ping.callTimeout,t=Re(),l.label=2;case 2:return l.trys.push([2,4,,5]),[4,u.call.ping()];case 3:return l.sent(),[3,5];case 4:if(n=l.sent(),!Yi.WorkerError.isWorkerError(n)||"Timeout"!==n.info.cause)throw n;return a=Re()-t,(m+=1)>=p&&r("Unresponsive"),i=u.hasBeenClosed(),o={timeout:e,waitTime:a,timeoutCount:m,hasBeenClosed:i},c="calc.calc.RecalcService: unresponsive; "+JSON.stringify(o),_.ULS.traceTag(574128978,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Warning,c),g(e,a,m,i),[2,!0];case 5:return m=0,[2,!0]}}))}))}),!0).catch((function(e){var t="calc.calc.RecalcService: ping loop threw an error: "+A(e);_.ULS.traceTag(574128979,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Warning,t)})),u.post.updateRanges.onPostMessageError=Yi.dispatchWorkerError,[2,{setOnRecalcResults:function(e){o.onRecalcResults=e},setOnUpdateRequest:function(e){o.onUpdateRequest=e},setOnUnresponsive:function(e){g=e},setA1ReferenceStyle:function(e){u.post.setA1ReferenceStyle(e)},setLocale:function(e){u.post.setLocale(e)},setWorkbookProps:function(e){u.post.setWorkbookProps(e)},setNumberFormats:function(e,t){u.post.setNumberFormats(e,t)},updateSheetNames:function(e,t){u.post.updateSheetNames(e,t)},updateNamedObjects:function(e,t){u.post.updateNamedObjects(e,t)},updateUnusedCells:function(e,t){u.post.updateUnusedCells(e,t)},updateRanges:function(e,t){u.post.updateRanges(e,t)},updateArrays:u.post.updateArrays,editRangeFormulas:function(e,t){u.post.editRangeFormulas(e,t)},editRangeFormats:function(e,t){u.post.editRangeFormats(e,t)},editArrayFormulas:function(e,t){u.post.editArrayFormulas(e,t)},resumeRecalc:function(){u.post.resumeRecalc()},reconfigure:function(e){var t,r;u.call.ping.callTimeout=null!==(t=e.responsivenessPingTimeout)&&void 0!==t?t:3e4,p=null!==(r=e.responsivenessPingAttempts)&&void 0!==r?r:3,u.post.reconfigure(e)},clearCache:function(){u.post.clearCache(),i=-1/0},testAdvanceState:u.post.testAdvanceState,testResumeRecalc:u.call.testResumeRecalc,testCrash:function(){return r("Error"),u.call.testDelay(100)},close:r,stateIdAvailable:function(e){return e>=i},evalFormula:u.call.evalFormula}];case 5:throw S=b.sent(),r("Error"),S;case 6:return[2]}}))}))}(e,t):function(e,t){return ne(this,void 0,void 0,(function(){var r,n,a,i,o,u,c,l,d,f,h=this;return ae(this,(function(v){switch(v.label){case 0:return r=!1,n=!0===t?(new k_).instance():void 0,a={outside:{onError:function(e,t){var n=A(t.error),a="calc.calc.recalcServiceOutsideDef.onError: "+JSON.stringify({kind:t.kind,closing:t.closing,message:n});_.ULS.traceTag(595658719,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Warning,a),t.closing&&(r=!0)},onClosed:function(e){var t="calc.calc.recalcServiceOutsideDef.onClosed: recalc service closed "+(r?"because of an error":"normally");_.ULS.traceTag(595658720,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Warning,t),r=!0}},inside:hD()},[4,jF(e===y_.Thread||me(e)?[sF.Dedicated]:e===y_.Local?[sF.FunctionCall]:[sF.Dedicated,sF.FunctionCall],a)];case 1:if(null==(i=v.sent()))throw new Error("could not create recalc service worker");return o="calc.calc.createRecalcService: worker created; outside.workerKind = "+i.workerKind,_.ULS.traceTag(595731987,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,o),u=-1/0,c={onRecalcResults:function(e){},onUpdateRequest:function(e){},onGC:function(e){u=e}},i.setExports("client",c),l=i.getImports("service",["setA1ReferenceStyle","setLocale","setWorkbookProps","setNumberFormats","updateSheetNames","updateUnusedCells","updateNamedObjects","updateRanges","updateArrays","editRangeFormulas","editRangeFormats","editArrayFormulas","resumeRecalc","reconfigure","clearCache","testAdvanceState","testResumeRecalc","testDelay","evalFormula","ping","getSheetNames","getRangeValues","getRangeFormats","getRangeFormulae","createSnapshot","discardSnapshot"]),d=function(){function e(){}return e.prototype.getSheetNames=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(e=l.getSheetNames).call.apply(e,t)},e.prototype.getRangeFormats=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(e=l.getRangeFormats).call.apply(e,t)},e.prototype.getRangeFormulae=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(e=l.getRangeFormulae).call.apply(e,t)},e.prototype.getRangeValues=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(e=l.getRangeValues).call.apply(e,t)},e.prototype.createSnapshot=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(e=l.createSnapshot).call.apply(e,t)},e.prototype.discardSnapshot=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(e=l.discardSnapshot).call.apply(e,t)},e}(),void 0!==n&&n.registerAsyncGrid(new d),l.ping.callTimeout=3e4,f=function(){},bF((function(){return ne(h,void 0,void 0,(function(){var e,t,n,a,i;return ae(this,(function(o){switch(o.label){case 0:return[4,new Promise((function(e){return setTimeout(e,1e3)}))];case 1:if(o.sent(),r)return[2,void 0];e=Re(),o.label=2;case 2:return o.trys.push([2,4,,5]),[4,l.ping.call()];case 3:return o.sent(),[3,5];case 4:return o.sent(),t=l.ping.callTimeout,n=Re()-e,a={timeout:t,waitTime:n,timeoutCount:1,hasBeenClosed:!1},i="calc.calc.RecalcService: unresponsive; "+JSON.stringify(a),_.ULS.traceTag(591934810,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Warning,i),f(t,n,1,!1),[3,5];case 5:return[2,!0]}}))}))}),!0).catch((function(e){var t="calc.calc.RecalcService: ping loop threw an error: "+A(e);_.ULS.traceTag(590698012,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Warning,t)})),[2,{setOnRecalcResults:function(e){c.onRecalcResults=function(t){try{e(t)}catch(e){var r="calc.calc.RecalcService: onRecalcResults threw an error: "+A(e);_.ULS.traceTag(589898378,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Warning,r)}}},setOnUpdateRequest:function(e){c.onUpdateRequest=function(t){try{e(t)}catch(e){var r="calc.calc.RecalcService: onUpdateRequest threw an error: "+A(e);_.ULS.traceTag(589898379,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Warning,r)}}},setOnUnresponsive:function(e){f=e},setA1ReferenceStyle:function(e){r||l.setA1ReferenceStyle.notify(e)},setLocale:function(e){r||l.setLocale.notify(e)},setWorkbookProps:function(e){r||l.setWorkbookProps.notify(e)},setNumberFormats:function(e,t){r||l.setNumberFormats.notify(e,t)},updateSheetNames:function(e,t){r||l.updateSheetNames.notify(e,t)},updateNamedObjects:function(e,t){r||l.updateNamedObjects.notify(e,t)},updateUnusedCells:function(e,t){r||l.updateUnusedCells.notify(e,t)},updateRanges:function(e,t){r||l.updateRanges.notify(e,t)},updateArrays:function(e,t){r||l.updateArrays.notify(e,t)},editRangeFormulas:function(e,t){r||l.editRangeFormulas.notify(e,t)},editRangeFormats:function(e,t){r||l.editRangeFormats.notify(e,t)},editArrayFormulas:function(e,t){r||l.editArrayFormulas.notify(e,t)},resumeRecalc:function(){r||l.resumeRecalc.notify()},reconfigure:function(e){var t;r||(l.ping.callTimeout=null!==(t=e.responsivenessPingTimeout)&&void 0!==t?t:3e4,l.reconfigure.notify(e))},clearCache:function(){r||(l.clearCache.notify(),u=-1/0)},testAdvanceState:function(e){r||l.testAdvanceState.notify(e)},testResumeRecalc:function(e){return l.testResumeRecalc.call(e)},testCrash:function(){return l.testDelay.isCritical=!0,l.testDelay.callTimeout=0,l.testDelay.call(100)},close:function(){i.close()},stateIdAvailable:function(e){return e>=u},evalFormula:function(e,t,r,n){return l.evalFormula.call(e,t,r,n)}}]}}))}))}(e,t)}function M_(){setTimeout((function(){try{self.close()}catch(e){}}),100)}function w_(e,t,r,n){var a=t.initTimeout,i=t.callTimeout,o=t.calcAbsUrl,u=t.features;return ne(this,void 0,void 0,(function(){var t,s,c,l,d=this;return ae(this,(function(f){switch(f.label){case 0:return function(){if("undefined"==typeof self||null!=self.document)throw new Error("not in a worker execution context")}(),[4,yF(a,(function(){return new Error("exceeded timeout; initTimeout = "+a+"ms")}),(function(e,t){return ne(d,void 0,void 0,(function(){function s(t,r){return l?null!=n.onError&&(n.onError(t,r),!0):(e(r.error),!0)}function c(e){l&&null!=n.onClosed&&n.onClosed(e)}var l,d,f,h,v,p;return ae(this,(function(e){switch(e.label){case 0:l=!1,e.label=1;case 1:return e.trys.push([1,4,,5]),f=EF(self,M_),d=MF(sF.Dedicated,f,a,i,s,c),h=function(e){var t=e.getImports("",["shipAssertTag","assertTag","traceTag","debugTraceTag"]);function r(e){return"["+(new Date).toISOString()+"] "+e}return{shipAssertTag:function(e,n,a,i){if(t.shipAssertTag.notify(e,n,a,r(i)),!a)throw new Error("shipAssertTag: "+e+" "+n+" "+i)},assertTag:function(e,n,a,i){if(t.assertTag.notify(e,n,a,r(i)),!a)throw new Error("assertTag: "+e+" "+n+" "+i)},traceTag:function(e,n,a,i){t.traceTag.notify(e,n,a,r(i))},debugTraceTag:function(e,n,a,i){t.debugTraceTag.notify(e,n,a,r(i))}}}(d),v=function(e){var t;return null!==(t=u[e])&&void 0!==t&&t},r.config.initCalc(h,v,o),t()||null==n.onInit?[3,3]:[4,n.onInit(d)];case 2:e.sent(),e.label=3;case 3:return l=!0,[3,5];case 4:throw p=e.sent(),null!=d?d.close():M_(),p;case 5:return[2]}}))}))})).then((function(e){return[dF.Fulfilled,e]}),(function(e){return[dF.Rejected,e]}))];case 1:t=f.sent(),s=t[0],c=t[1],l=[lF.Result,e,s,AF(c),!0];try{self.postMessage(l)}catch(e){throw M_(),e}return[2]}}))}))}(T_=A_||(A_={})).worksheetFunctionName=oE,T_.errorTypeName=uE,T_.localeData=sE,T_.numberFormat=cE,T_.sheetName=lE,T_.blankValue=dE,T_.errorValue=fE,T_.richValue=hE,T_.getCellValueKind=vE,T_.getCellFormatKind=pE,T_.cellLocation=mE,T_.rangeLocation=gE,T_.sheetRangeLocation=SE,T_.sheetCellLocation=yE,T_.cellData=bE,T_.cellFormulaCellData=EE,T_.arrayFormulaCellData=FE,T_.valueCellData=CE,T_.rangeUpdate=RE,T_.rangeWrite=kE,T_.rangePromote=NE,T_.arrayData=AE,T_.arrayUpdate=TE,T_.arrayWrite=IE,T_.arrayPromote=OE,T_.unusedCellsUpdate=ME,T_.namedValueData=wE,T_.namedFormulaData=DE,T_.namedRangeData=_E,T_.namedFailureData=xE,T_.namedObject=BE,T_.namedObjectsUpdate=WE,T_.namedObjectsWrite=PE,T_.undefinedNamesWrite=VE,T_.namedObjectsPromote=GE,T_.namedTableData=UE,T_.columnData=LE,T_.rangeFormulaEdit=HE,T_.cellFormulaRangeFormulaEdit=jE,T_.valueRangeFormulaEdit=KE,T_.inferredRangeFormulaEdit=YE,T_.formatEditOperation=qE,T_.formatEditSetFormat=zE,T_.rangeFormatEdit=JE,T_.arrayFormulaEdit=QE,T_.inferredFormat=XE,T_.cellDataDelta=ZE,T_.rangeDelta=$E,T_.arrayDelta=eF,T_.rangeFailure=tF,T_.recalcResults=rF,T_.evalFormulaData=uF,T_.evalFormulaFormat=nF,T_.evalFormulaFormatOrigin=aF,T_.evalFormulaFormatIformat=iF,T_.evalFormulaFormatInferred=oF,T_.updateRequest=fF,T_.runExperiment=hF,T_.recalcServiceConfig=vF,T_.workbookProps=pF,T_.createRecalcService=O_,T_.RecalcServiceCreateMode=y_,T_.localeInfoFromData=Xw,T_.recalcServiceInsideDef=hD,T_.recalcServiceInsideInit=vD,T_.getEvalResultKind=VN,T_.getEvalFailureReason=GN,(I_||(I_={})).getWorksheetFunc=nO;var D_=[{name:"self",test:function(){return"undefined"!=typeof self}},{name:"fetch",test:function(){return"function"==typeof fetch}},{name:"Set",test:function(){return"function"==typeof Set}},{name:"Map",test:function(){return"function"==typeof Map}},{name:"WeakMap",test:function(){return"function"==typeof WeakMap}},{name:"Symbol",test:function(){return"function"==typeof Symbol}},{name:"WebAssembly",test:function(){return"object"==typeof WebAssembly}},{name:"Atomics",test:function(){return"object"==typeof Atomics}},{name:"BigInt",test:function(){return"function"==typeof BigInt}},{name:"String.startsWith",test:function(){return"function"==typeof"".startsWith}},{name:"String.codePointAt",test:function(){return"function"==typeof"".codePointAt}},{name:"Object.assign",test:function(){return"function"==typeof Object.assign}},{name:"Object.setPrototypeOf",test:function(){return"function"==typeof Object.setPrototypeOf}},{name:"Number.EPSILON",test:function(){return"number"==typeof Number.EPSILON}},{name:"Number.isFinite",test:function(){return"function"==typeof Number.isFinite}},{name:"Number.parseInt",test:function(){return"function"==typeof Number.parseInt}},{name:"Math.acosh",test:function(){return"function"==typeof Math.acosh}},{name:"Math.hypot",test:function(){return"function"==typeof Math.hypot}},{name:"Math.log1p",test:function(){return"function"==typeof Math.log1p}},{name:"Math.trunc",test:function(){return"function"==typeof Math.trunc}},{name:"Promise.finally",test:function(){return"function"==typeof Promise.resolve().finally}},{name:"RegExp_flags",test:function(){return new RegExp("x","i")&&!0}},{name:"RegExp.flags",test:function(){return"string"==typeof/x/.flags}},{name:"Array.of",test:function(){return"function"==typeof Array.of}},{name:"Array.entries",test:function(){return"function"==typeof[].entries}},{name:"Array.find",test:function(){return"function"==typeof[].find}},{name:"performance",test:function(){return"object"==typeof performance}},{name:"performance.now",test:function(){return"function"==typeof performance.now}},{name:"performance.timeOrigin",test:function(){return"number"==typeof performance.timeOrigin}},{name:"performance.memory",test:function(){return"object"==typeof performance.memory}}];function __(){return D_.map((function(e){var t=e.name,r=e.test;try{return r()?"":t}catch(e){return t}})).filter((function(e){return e.length>0}))}function L_(){var e="object"==typeof performance?performance.memory:void 0;return null!=e?{jsHeapSizeLimit:e.jsHeapSizeLimit,totalJSHeapSize:e.totalJSHeapSize,usedJSHeapSize:e.usedJSHeapSize}:void 0}var U_=function(e){var t=e.config,r=e.connection;"Thread"===r.createMode&&Yi.setConfig(t);var n=[];return Yi.Endpoint.createInside(r,(function(){return{startMemoryTest:function(e){var t=L_(),r=0;try{for(;r<e;r+=1){var a=new Uint8Array(1024);a[0]=0,a[1023]=255,n.push(a)}}catch(e){}return[t,r,L_()]},endMemorytest:function(){n=[]},ping:function(e){return e+1},getMissingJSFeatures:__}}))},x_=!1,B_=void 0;function W_(){null!=B_&&B_.close(),x_=!1}var P_=Promise.resolve();function V_(e,t,r,n){return void 0===n&&(n=0),Y(w.CalcWebWorkerTest)?(W_(),P_=P_.then((function(r){return function(e,t,r,n){return ne(this,void 0,void 0,(function(){var r,a,i,o,u,c,l,d,f,h,v,p,m,g,S,y,b=this;return ae(this,(function(E){switch(E.label){case 0:x_=!0,E.label=1;case 1:if(E.trys.push([1,8,9,10]),y="calc.twSmokeTest.runSmokeTest: starting; duration = "+e+" ms, pingInterval = "+t+" ms",_.ULS.traceTag(593335264,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,y),null==(r=qo()))throw new Error("initCalc was not passed calcAbsUrl");return[4,Yi.createWorker({id:"SmokeTest",createMode:"ThreadOrLocal"},{local:U_,thread:{scriptUrl:r,insideInitName:"excelOnlineCalc.worker.smokeTestInsideInit"}})];case 2:if(B_=E.sent(),!x_)throw a="smoke test canceled during worker creation",_.ULS.traceTag(593335265,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Warning,a),new Error(a);return y="calc.twSmokeTest.runSmokeTest: worker created; outside.createMode = "+B_.createMode,_.ULS.traceTag(593335266,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,y),[4,B_.call.ping(-1)];case 3:if(0!==(i=E.sent()))throw new Error("expected 0; got "+i);return n>0&&"Thread"===B_.createMode?(o=L_(),[4,B_.call.startMemoryTest(n)]):[3,5];case 4:u=E.sent(),c=u[0],l=u[1],d=u[2],f=L_(),h={startMain:o,startThread:c,kb:l,endThread:d,endMain:f},v="calc.twSmokeTest.runSmokeTest: memory = "+JSON.stringify(h),_.ULS.traceTag(592488325,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,v),B_.post.endMemorytest(),E.label=5;case 5:return m={main:__()},[4,B_.call.getMissingJSFeatures()];case 6:return m.worker=E.sent(),p=m,y="calc.twSmokeTest.runSmokeTest: missing = "+JSON.stringify(p),_.ULS.traceTag(593335267,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,y),g=Date.now(),[4,bF((function(r){return ne(b,void 0,void 0,(function(){var n;return ae(this,(function(a){switch(a.label){case 0:return Date.now()>=g+e||!B_||B_.hasBeenClosed()?[2,void 0]:r%1e3!=0?[3,2]:(n=zi("calc.twSmokeTest.runSmokeTest: ping call roundtrip"),[4,B_.call.ping(r)]);case 1:a.sent(),n.stop(),a.label=2;case 2:return[4,new Promise((function(e){return setTimeout((function(){return e()}),t)}))];case 3:return a.sent(),B_.post.ping(r),[2,r+1]}}))}))}),0)];case 7:return E.sent(),y="calc.twSmokeTest.runSmokeTest: success",_.ULS.traceTag(593335296,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,y),[3,10];case 8:return S=E.sent(),x_&&(y="calc.twSmokeTest.runSmokeTest: failure: "+S.message,_.ULS.traceTag(593335297,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Warning,y)),[3,10];case 9:return W_(),B_=void 0,[7];case 10:return[2]}}))}))}(e,t,0,n)}))):Promise.resolve()}var G_,H_,j_={onError:function(e,t){var r=null!=t.error.stack?t.error.stack:t.error.message,n="calc.worker.smokeTestInsideDef.onError: "+JSON.stringify({kind:t.kind,closing:t.closing,message:r});_.ULS.traceTag(595908699,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Error,n)},onClosed:function(e){},onInit:function(e){var t=e.getImports("talk",["ping"]);e.setExports("location",gs),e.setExports("talk",{start:function(e,r,n){return ne(this,void 0,void 0,(function(){var a,i=this;return ae(this,(function(o){switch(o.label){case 0:return a=Date.now(),[4,bF((function(o){return ne(i,void 0,void 0,(function(){return ae(this,(function(i){switch(i.label){case 0:return Date.now()>=a+e?[2,void 0]:[4,new Promise((function(e){return setTimeout((function(){return e()}),r)}))];case 1:return i.sent(),t.ping.notify(o,n),[2,o+1]}}))}))}),0)];case 1:return o.sent(),[2]}}))}))},memoryTest:function(e){var t=[],r=0;try{for(;r<e;r+=1){var n=new Uint8Array(1024);n[0]=0,n[1023]=255,t.push(n)}}catch(e){}t=[];var a="calc.worker.smokeTestInsideDef.memoryTest: memory allocated = "+r+"KB";_.ULS.traceTag(595906820,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,a)},ping:function(e,t){if(t&&e%1e3==0){var r="calc.worker.smokeTestInsideDef.ping: n = "+e;_.ULS.traceTag(595907656,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,r)}return e+1},logMessage:function(e,t){if(t){var r="calc.worker.smokeTestInsideDef.logMessage: msg = "+e;_.ULS.traceTag(595714188,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,r)}}})},scriptName:"excelOnlineCalcSmokeTest.worker"};(H_=G_||(G_={})).WorkerKind=sF,H_.ErrorKind=cF,H_.isWorkerSupported=VF,H_.createWorker=HF,H_.tryCreateWorker=jF,H_.dedicatedWorkerInsideInit=w_,H_.runSmokeTest=V_,H_.cancelSmokeTest=W_,H_.smokeTestInsideInit=U_,H_.smokeTestInsideDef=j_;var K_=new k_;r.d(t,"packageVersion",(function(){return"23.7.1"})),r.d(t,"PluginSchedulerSingletonGlobal",(function(){return K_})),r.d(t,"location",(function(){return gs})),r.d(t,"formula",(function(){return Es})),r.d(t,"value",(function(){return ys})),r.d(t,"core",(function(){return n})),r.d(t,"signature",(function(){return Cs})),r.d(t,"util",(function(){return ks})),r.d(t,"config",(function(){return As})),r.d(t,"math",(function(){return Is})),r.d(t,"date",(function(){return Ms})),r.d(t,"parse",(function(){return Xh})),r.d(t,"analyze",(function(){return Ov})),r.d(t,"numfmt",(function(){return DS})),r.d(t,"runtime",(function(){return Kb})),r.d(t,"calc",(function(){return A_})),r.d(t,"funcs",(function(){return I_})),r.d(t,"worker",(function(){return G_})),r.d(t,"x10",(function(){return u})),r.d(t,"autosuggestExperiment",(function(){return o}))}]);
//# sourceMappingURL=excelOnlineCalc.min.js.map