typeof IEnumerable=="undefined"&&(IEnumerable=function(){},IEnumerable.registerInterface("IEnumerable"));typeof IEnumerator=="undefined"&&(IEnumerator=function(){},IEnumerator.registerInterface("IEnumerator"));typeof Sys=="undefined"&&Type.registerNamespace("Sys");typeof Sys.IEnumerable$1=="undefined"&&(Sys.IEnumerable$1=function(){},Sys.IEnumerable$1.registerInterface("Sys.IEnumerable$1"));typeof Sys.IEnumerator$1=="undefined"&&(Sys.IEnumerator$1=function(){},Sys.IEnumerator$1.registerInterface("Sys.IEnumerator$1"));Type.registerNamespace("Common.App.Enrichment");Common.App.Enrichment.m=function(){};Common.App.Enrichment.m.registerInterface("Common.App.Enrichment.m");Common.App.Enrichment.l=function(){};Common.App.Enrichment.l.registerInterface("Common.App.Enrichment.l");Common.App.Enrichment.k=function(){};Common.App.Enrichment.k.registerInterface("Common.App.Enrichment.k");Common.App.Enrichment.n=function(){this.requestId=requestId;this.cellId=cellId};Common.App.Enrichment.n.prototype={requestId:null,cellId:null};Common.App.Enrichment.h=function(){this.messageType=type};Common.App.Enrichment.h.prototype={messageType:0};Common.App.Enrichment.b=function(){this.messageContent=this.$$gta["Common.App.Enrichment.b"].T===Number||Type.isEnum(this.$$gta["Common.App.Enrichment.b"].T)?0:this.$$gta["Common.App.Enrichment.b"].T===Boolean?!1:null;Common.App.Enrichment.b.$$(this.$$gta["Common.App.Enrichment.b"].T).initializeBase(this,[type]);this.messageContent=content};Common.App.Enrichment.b.$$=function(n){var u=Common.App.Enrichment.__tc=Common.App.Enrichment.__tc||{},t="b$"+n.getName().replace(/\./g,"_"),i,o,s,f,e,r;if(!u[t]){i=u[t]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];Common.App.Enrichment.b.apply(this,t)};o=Common.App.Enrichment.h;i.registerClass("Common.App.Enrichment.__tc."+t,o);s={"Common.App.Enrichment.b":{T:n},ctor:Common.App.Enrichment.b};i.prototype.$$gta=s;f=Common.App.Enrichment.b.prototype;for(e in f)r={key:e,value:f[e]},"constructor"!==r.key&&(i.prototype[r.key]=r.value)}return u[t]};Common.App.Enrichment.j=function(){};Common.App.Enrichment.j.prototype={Query:null,TelemetryJson:null};Common.App.Enrichment.i=function(n){this.messageType=n};Common.App.Enrichment.i.prototype={messageType:0};Common.App.Enrichment.c=function(n,t){this.messageContent=this.$$gta["Common.App.Enrichment.c"].T===Number||Type.isEnum(this.$$gta["Common.App.Enrichment.c"].T)?0:this.$$gta["Common.App.Enrichment.c"].T===Boolean?!1:null;Common.App.Enrichment.c.$$(this.$$gta["Common.App.Enrichment.c"].T).initializeBase(this,[n]);this.messageContent=t};Common.App.Enrichment.c.$$=function(n){var u=Common.App.Enrichment.__tc=Common.App.Enrichment.__tc||{},t="c$"+n.getName().replace(/\./g,"_"),i,o,s,f,e,r;if(!u[t]){i=u[t]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];Common.App.Enrichment.c.apply(this,t)};o=Common.App.Enrichment.i;i.registerClass("Common.App.Enrichment.__tc."+t,o);s={"Common.App.Enrichment.c":{T:n},ctor:Common.App.Enrichment.c};i.prototype.$$gta=s;f=Common.App.Enrichment.c.prototype;for(e in f)r={key:e,value:f[e]},"constructor"!==r.key&&(i.prototype[r.key]=r.value)}return u[t]};Common.App.Enrichment.d=function(n,t,i){Common.App.Enrichment.d.$$(this.$$gta["Common.App.Enrichment.d"].T).initializeBase(this,[n,t]);this.telemetryJson=i};Common.App.Enrichment.d.$$=function(n){var u=Common.App.Enrichment.__tc=Common.App.Enrichment.__tc||{},t="d$"+n.getName().replace(/\./g,"_"),i,f,e,o,s,h,c,l,r;if(!u[t]){i=u[t]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];Common.App.Enrichment.d.apply(this,t)};f=Common.App.Enrichment.c.$$(n);i.registerClass("Common.App.Enrichment.__tc."+t,f);e={"Common.App.Enrichment.d":{T:n},ctor:Common.App.Enrichment.d};o=f.prototype.$$gta;for(s in o)h={key:s,value:o[s]},e[h.key]=h.value;i.prototype.$$gta=e;c=Common.App.Enrichment.d.prototype;for(l in c)r={key:l,value:c[l]},"constructor"!==r.key&&(i.prototype[r.key]=r.value)}return u[t]};Common.App.Enrichment.d.prototype={telemetryJson:null};Common.App.Enrichment.f=function(){};Common.App.Enrichment.f.prototype={keyCode:0};Common.App.Enrichment.e=function(){};Common.App.Enrichment.e.prototype={applicationName:null,applicationVersion:null,anid:null,sessionId:null,appCorrelationId:null,market:null,themeId:0,featuresBitMask:0,uiLanguage:null,disambiguationJson:null};Common.App.Enrichment.a=function(n,t,i,r,u){this.t=Function.createDelegate(this,this.R);this.r=Function.createDelegate(this,this.O);this.p=Function.createDelegate(this,this.M);this.q=Function.createDelegate(this,this.N);this.y=Function.createDelegate(this,this.J);this.s=Function.createDelegate(this,this.P);this.o=Function.createDelegate(this,this.L);this.h=n;this.k=t;this.z=i;this.j=r;this.u=u;this.i=Common.h.b(27,0)};Common.App.Enrichment.a.a=function(n,t,i,r,u,f,e,o){var h,c,s;return Common.c.h()?(c=String.format("{0} {1} {2}",f?"Shift":"",e?"Control":"",o?"Alt":""),c.trim(),h=document.createEvent("KeyboardEvent"),h.initKeyboardEvent(n,r,u,window.self,t,0,c,!1,"en-US")):(s={},s.keyCode=i,s.ctrlKey=e,s.shiftKey=f,s.altKey=o,s.bubbles=r,s.cancelable=u,h=new KeyboardEvent(n,s)),h};Common.App.Enrichment.a.prototype={h:null,k:null,e:null,d:null,z:null,j:null,u:null,v:null,w:null,l:null,g:null,i:null,x:!1,C:function(){return!0},m:function(){return Common.a.a.b("EnrichmentPaneUrl")},dispose:function(){this.C()&&this.g&&(this.h.b("click",this.g,this.o),this.k.b("keyup",this.g,this.s));this.g=null;this.d&&(this.T(),this.d.parentNode.removeChild(this.d),this.d=null);var n=this.j.a("EnrichmentPaneId");n.b(this.i)},b:function(n,t,i){this.e=n;this.x||(this.l=this.F(),this.B().appendChild(this.l),this.Q(),this.u.a(1520278933,2147483648,this.y),this.S(),this.x=!0);this.d.src=this.m()&&this.m().length?this.m()+"?culture="+t.market+"&appName="+t.applicationName+"&themeId="+t.themeId+"&featuresBitMask="+t.featuresBitMask:"about:blank";this.v=t;this.w=i;this.E()},c:function(n,t){var i=new(Common.App.Enrichment.d.$$(String))(2,n,t);this.n(i)},S:function(){var n=this.j.a("EnrichmentPaneId");n.d="main";this.h.d("EnrichmentPaneId",this.l,!1);n.c(this.i,1520278933)},R:function(){if(this.d){Common.o.b(this.d.contentWindow);var n=new(Common.App.Enrichment.d.$$(String))(4,null,null);this.n(n)}},L:function(){return this.A(),!0},P:function(n){var t=n.a.keyCode;return t===13||t===32?(this.A(),!0):!1},A:function(){this.a();this.e&&this.e.a()},F:function(){var n=CommonUI.a.a("div","EnrichmentPaneId","EnrichmentPane");return this.C()&&n.appendChild(this.G()),this.K(n),n},G:function(){var t=CommonUI.a.b("div","EnrichmentPaneHeaderId","EnrichmentPaneHeader"),i=CommonUI.a.b("div","EnrichmentPaneTitleId","cui-taskPaneTitle EnrichmentPaneTitle"),n;return i.innerText=$a.bl,i.title=$a.bl,n=CommonUI.e.a("CloseEnrichmentPane","EnrichmentPaneCloseButton",$a.c,"ClosePaneGlyph_16x16x32",!1),this.h.a("click",n,this.o),this.k.a("keyup",n,this.s),t.appendChild(i),t.appendChild(n),this.g=n,t},K:function(n){this.d=CommonUI.a.b("iframe","","EnrichmentFrame");n.appendChild(this.d);this.d.id="EnrichmentContentFrame"},Q:function(){Common.j.a(this.d,"load",this.q);Common.j.a(this.d,"error",this.p);$addHandler(window,"message",this.r)},T:function(){Common.j.c(this.d,"load",this.q);Common.j.c(this.d,"error",this.p);$removeHandler(window,"message",this.r)},H:function(){this.d.src="about:blank"},a:function(){this.D();this.H()},J:function(n,t,i){return i!==1&&(this.a(),this.e&&this.e.a()),32},N:function(){},M:function(){},O:function(n){var r=n.rawEvent,t,u,f,e,o,i,s,h,c,l,a,v;if(!this.d||this.d.src.indexOf(r.origin)!==-1){try{t=JSON.parse(r.data)}catch(b){return}if(!CommandUI.a.a(t.messageType)){u=window.g_badCastCallback;window.g_badCastCallback=null;switch(t.messageType){case 2:this.n(new(Common.App.Enrichment.d.$$(String))(1,JSON.stringify(this.v),this.w));break;case 1:this.n(new(Common.App.Enrichment.c.$$(String))(0,this.I()));break;case 3:f=t;this.e&&this.e.i(f.messageContent);break;case 5:e=t;this.e&&this.e.f(e.messageContent);break;case 8:o=t;this.e&&(i=JSON.parse(o.messageContent),this.e.g(i.Query,i.TelemetryJson));break;case 6:this.e&&this.e.c();break;case 11:var y=t,p=JSON.parse(y.messageContent),w=Common.App.Enrichment.a.a("keydown","f6",117,!0,!1,p,!0,!1,!1);this.d&&this.d.dispatchEvent(w);break;case 12:s=t;h=JSON.parse(s.messageContent);h.keyCode===27&&(c=Common.App.Enrichment.a.a("keydown","esc",27,!0,!1,!1,!1,!1,!1),this.d&&(this.d.dispatchEvent(c),this.a(),this.e&&this.e.a()));break;case 13:l=t;this.e&&this.e.h(l.messageContent);break;case 14:a=t;this.e&&this.e.j(a.messageContent);break;case 15:v=t;this.e&&this.e.k(v.messageContent)}window.g_badCastCallback=u}}},I:function(){return JSON.stringify([2,1,3,5,8,6])},n:function(n){var t=JSON.stringify(n);this.d.contentWindow.postMessage(t,Common.l.h(this.m()))}};Common.App.Enrichment.g=function(n){this.m=n};Common.App.Enrichment.g.prototype={m:null,l:null,e:function(n,t,i){this.l=n;this.m&&this.m.b(this,t,i)},b:function(n,t){this.m&&this.m.c(n,t)},d:function(){this.m&&this.m.a()},dispose:function(){this.m&&(this.m.dispose(),this.m=null)},i:function(n){return this.l?this.l.q(n):!1},g:function(n,t){this.l&&this.l.o(n,t)},f:function(n){return this.l?this.l.m(n):!1},a:function(){this.l&&this.l.n()},c:function(){this.l&&this.l.l()},h:function(n){this.l&&this.l.p(n)},j:function(n){this.l&&this.l.r(n)},k:function(n){this.l&&this.l.s(n)}};Common.App.Enrichment.h.registerClass("Common.App.Enrichment.h");Common.App.Enrichment.i.registerClass("Common.App.Enrichment.i");Common.App.Enrichment.e.registerClass("Common.App.Enrichment.e");Common.App.Enrichment.a.registerClass("Common.App.Enrichment.a",null,Common.App.Enrichment.l,Sys.IDisposable);Common.App.Enrichment.g.registerClass("Common.App.Enrichment.g",null,Common.App.Enrichment.k,Sys.IDisposable);Type.registerNamespace("_Ewa");_Ewa.bbU=function(){};_Ewa.bbV=function(){};_Ewa.bbV.registerInterface("_Ewa.bbV");_Ewa.GI=function(n,t){this.b=t;this.a=n};_Ewa.GI.prototype={b:null,a:null,y:function(n,t){switch(t){case-1203788282:case 48568533:case-1662108744:var i=_Ewa.b.a(this.b),r=this.a.z()||7e3;return i&&i.a()&&i.a().a().b().H()>r?!0:!1;default:return!1}},w:function(n,t,i){var r=$$sc.a.a(Boolean,!0),u=t.a;switch(u){case-1203788282:this.a.v(i.MenuItemId.toString());break;case 311599363:this.a.t();break;case 439914789:_Ewa.c.a("OfficeVSO:4804581_FRefreshDomainsOfSelectedLinkedEntitiesOnline")?this.a.d():this.a.K();break;case 2127195269:this.a.F();break;case-1662108744:this.a.G(i.MenuItemId.toString());break;case 1266950951:this.a.E(!0);break;case 49813714:this.a.w();break;case-1081442996:this.b.a(1037)&&this.a.x();break;case 1702917262:this.b.a(1037)&&this.a.M("DT_PBI_IMGSEC");break;case-90814711:this.b.a(1037)&&this.a.N();break;case 325814869:this.a.H();break;default:r=_Ewa.V.a(u)}return r},v:function(n,t){switch(t.a){case-1203788282:case 439914789:case 2127195269:case 49813714:return this.b.a(153);case-1662108744:return this.b.a(715);case-1081442996:case 1702917262:case-90814711:return this.b.a(1037);case 311599363:case 1266950951:return!0;case 325814869:return this.a.c();default:return!1}},x:function(n,t,i){return t==="PopulateConvertToLinkedEntityMenu"&&this.b.a(153)?this.a.J(n,t,i):!1}};_Ewa.uT=function(n){_Ewa.uT.initializeBase(this,[n])};_Ewa.uT.a=function(n){_Ewa.bg.a(273,new _Ewa.uT(n))};_Ewa.uT.prototype={m:function(){var n=this;_Ewa.gd.a(_Ewa.dS,this.h,271,272,this.j,function(t){n.n([new _Ewa.GI(t,n.h)],null)},null)}};_Ewa.GM=function(n){this.campaignId=n;this.commentQuestion=_Ewa.ClientStringManager.a().c(138);this.isZeroBased=!1;this.aditionalDataRequested=["EmailAddress"];this.ratingQuestion=_Ewa.ClientStringManager.a().c(134);this.ratingValuesAscending=[_Ewa.ClientStringManager.a().c(135),_Ewa.ClientStringManager.a().c(136),_Ewa.ClientStringManager.a().c(137)];this.showPrompt=!1;this.showEmailRequest=!0;this.surveyType=4;this.title=_Ewa.ClientStringManager.a().c(133)};_Ewa.GM.prototype={commentQuestion:null,campaignId:null,isZeroBased:!1,aditionalDataRequested:null,ratingQuestion:null,ratingValuesAscending:null,showEmailRequest:!1,showPrompt:!1,surveyType:0,title:null};_Ewa.GJ=function(n,t,i,r,u){this.w=Function.createDelegate(this,this.J);this.l=Function.createDelegate(this,this.S);this.k=Function.createDelegate(this,this.L);this.x=Function.createDelegate(this,this.K);this.y=Function.createDelegate(this,this.N);this.o=Function.createDelegate(this,this.P);this.z=Function.createDelegate(this,this.R);this.n=Function.createDelegate(this,this.M);this.p=Function.createDelegate(this,this.Q);this.a=n;this.b=_Ewa.b.a(this.a);this.b.a().l(this.p);this.b.w(this.n);this.m=r;this.q=u;i.f(_Ewa.qO,t);var f=new _Ewa.GK(t);this.g=new _Ewa.GL(f)};_Ewa.GJ.prototype={a:null,r:!1,c:!1,e:!0,i:!1,h:!1,s:!1,f:null,j:0,m:null,b:null,g:null,q:null,dispose:function(){this.a&&(this.b.a().m(this.p),this.b.y(this.n))},W:function(n){var i=_Ewa.h.c(this.b.a().a().a(),this.a),t=this,r=function(r,u){return _Ewa.dR.p(t.a.d().a(),i,n,_Ewa.p.a(r,t.z),u,null,null)},f=this,u=function(){return new _Ewa.em},e=this;return _Ewa.S.a(this.a.g(),r,function(n){return new _Ewa.J(109,0,n,0,u)},null),!0},U:function(n,t){Diag.a.a(38846755,0,50,"ConvertToLinkedEntityManager:SearchEntity() - Search attempted with TelemetryJSON: {0}",t);var r=_Ewa.h.c(this.b.a().a().a(),this.a),i=this,u=function(t,u){return _Ewa.dR.o(i.a.d().a(),r,n,_Ewa.p.a(t,i.o),u,null,null)},f=this;_Ewa.S.a(this.a.g(),u,function(n){return new _Ewa.J(110,0,n,16,null)},null);return},I:function(n){var t=_Ewa.h.c(this.b.a().a().a(),this.a);!t;this.e=!1;var i=this,r=function(r,u){return _Ewa.dR.k(i.a.d().a(),t,n,_Ewa.p.a(r,i.y),u,null,null)},u=this;return _Ewa.S.a(this.a.g(),r,function(n){return new _Ewa.J(111,0,n,16,null)},null),!0},O:function(){this.c=!1;this.r=!0;this.j=0;_Ewa.c.a("OfficeVSO:4791195_ResolveDisambiguationPaneDismissesOnChange")&&(this.h=!1);return},C:function(){var n=this.v();if(n){var t=this,i=function(i,r){return _Ewa.dR.b(t.a.d().a(),n,_Ewa.p.a(i,t.o),r,null,null)},r=this;_Ewa.S.a(this.a.g(),i,function(n){return new _Ewa.J(112,0,n,16,null)},null);return}},V:function(n){var t,i;if(Diag.a.a(591005634,0,50,"ConvertToLinkedEntityDisambiguationPane:SelectDataType: Calling CloseDisambiguationPane"),this.d(),!n||!n.length){Diag.a.a(593282251,0,10,"Recevied an empty dataTypeJson payload from the Data Type Selector Pane");return}if(t=JSON.parse(n),!t){Diag.a.a(593282250,0,10,"Failed to parse the dataTypeJson from the Data Type Selector Pane");return}if(!(t.domainId!=null)){Diag.a.a(593282249,0,10,"Data Selector Pane invoked SelectDataType without passing a DomainId");return}i={};i.Id=t.domainId;i.StringId=t.stringId;this.q.u(i)},X:function(n){var t=new _Ewa.L(-859308420,_Ewa.G.a,this.a.s(),9,_Ewa.c.a("OfficeVSO:4894065_LaunchHelpPaneWithHelpArticleKey")?null:"Help"),i={CommandValueId:"HelpID="+n,InputMethod:_Ewa.G.a,ShouldCanvasTakeFocus:!0,MenuItemId:_Ewa.c.a("OfficeVSO:4894065_LaunchHelpPaneWithHelpArticleKey")?"HelpArticle":"HelpArticle"};this.a.h().a(t,i,null)},Y:function(n){Fdbk.a.K(new _Ewa.GM(n))},M:function(){(this.e||this.c)&&(this.a.a(715)&&this.j===2||this.h||this.t(!1))},S:function(){Diag.a.a(39081763,0,15,"Session ID changed while ambiguous linked entities are present")},t:function(n){this.H(n)},F:function(){var n,t;if(Diag.a.a(36975685,0,50,"ConvertToLinkedEntityManager:LaunchDisambiguationPaneForSearch() - Launch Disambiguation Pane For Search attempted"),n=this.v(),n){t=null;this.a.a(715)&&(t=1);var i=this,r=function(r,u){return _Ewa.dR.a(i.a.d().a(),n,!0,_Ewa.p.a(r,i.x),u,t,null)},u=this;_Ewa.S.a(this.a.g(),r,function(n){return new _Ewa.J(113,0,n,16,null)},null)}},G:function(n,t){var i=null;this.a.a(715)&&(i=2);var r=this,u=function(u,f){return _Ewa.dR.e(r.a.d().a(),n,t,_Ewa.p.a(u,r.k),f,i,null)},f=this;_Ewa.S.a(this.a.g(),u,function(n){return new _Ewa.J(233,0,n,16,null)},null)},J:function(n){var t,i,u,r;if(_Ewa.j.c(n.Errors)){t=_Ewa.j.a(n.Errors,",");_Ewa.f.c(t,"OperationSucceededWithAlert",!1)?Diag.a.a(38541457,0,50,"Convert to Linked Entity failed with an alert"):Diag.a.a(36975687,0,10,"Failed to Convert to Linked Entity. errors: {0}",t);return}n.Result&&(!n.WorkbookMetadataResult.Metadata&&this.s&&(i=_Ewa.n.b(_Ewa.cM,this.a.b(),5,4,0,null),u=this,_Ewa.g.a(i,function(){i.a().i()},this.a.i(),3,null,null)),this.a.c().i(this.l),this.a.c().h(this.l),r=n.Result,this.f=r.SkydanceFeatureBitmask,this.u(r),this.i=!0)},Q:function(){(this.e||this.c)&&this.t(!1)},L:function(n,t){var i,r;if(_Ewa.j.c(n.Errors)){Diag.a.a(36975688,0,10,"Failed to retrieve disambiguation data for Ambiguous Linked Entity. errors: {0}",_Ewa.j.a(n.Errors,","));return}if(n.Result){if(i=n.Result,!i.DisambiguationJson){Diag.a.a(41552074,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Json is null");return}this.i=!1;this.B(t);this.f=i.SkydanceFeatureBitmask;r=i.DisambiguationJson;Diag.a.a(591005633,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Calling LaunchOrUpdateDisambiguationPane");_Ewa.c.a("OfficeVSO:4791195_ResolveDisambiguationPaneDismissesOnChange")&&(this.h=!1);this.A(r)}return},K:function(n,t){var i,r;if(_Ewa.j.c(n.Errors)){Diag.a.a(36975689,0,10,"Failed to retrieve disambiguation data for search. errors: {0}",_Ewa.j.a(n.Errors,","));return}if(n.Result){if(i=n.Result,!i.DisambiguationJson){Diag.a.a(41552075,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Json is null");return}this.B(t);this.f=i.SkydanceFeatureBitmask;r=i.DisambiguationJson;Diag.a.a(591005632,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Calling LaunchOrUpdateDisambiguationPane");_Ewa.c.a("OfficeVSO:4791195_ResolveDisambiguationPaneDismissesOnChange")&&(this.h=!0);this.A(r)}return},B:function(n){if(n&&this.a.a(715)){var t=n;this.j=t}},A:function(n){var r,t,i;this.a.a(1037)&&(r=new _Ewa.L(-90814711,_Ewa.G.a,0,10,null),this.a.h().a(r,null,null));this.c?this.g.b(n,null):(t=3,this.f!=null?t=this.f:Diag.a.b(40511299,0,!1,"SkydanceFeatureBitmask was not set"),i=this.E(n,t),i||Diag.a.a(577528395,0,15,"LaunchOrUpdateDisambiguationPane: null appProperties"),this.m||Diag.a.a(577528394,0,15,"LaunchOrUpdateDisambiguationPane: null entitymanager"),this.g.e(this.m,i,null),this.c=!0);return},d:function(){this.c&&(Diag.a.a(591005602,0,100,"ConvertToLinkedEntityDisambiguationPane:CloseDisambiguationPane"),this.g.d(),this.c=!1,this.j=0,_Ewa.c.a("OfficeVSO:4791195_ResolveDisambiguationPaneDismissesOnChange")&&(this.h=!1));return},N:function(n){if(_Ewa.j.c(n.Errors)){Diag.a.a(36975690,0,10,"Failed to move to the next ambiguous Linked Entity. errors: {0}",_Ewa.j.a(n.Errors,","));this.e=!0;return}if(n.Result){var t=n.Result;this.f=t.SkydanceFeatureBitmask;this.u(t);this.i=!0}return},u:function(n){var t=n.Row+1,i=n.Column+1,u=n.DisambiguationJson,r;if(t<0||i<0){Diag.a.a(591005601,0,50,"ConvertToLinkedEntityDisambiguationPane:MoveToAmbiguousLinkedEntity: Calling CloseDisambiguationPane");this.d();this.a.c().i(this.l);return}r=new _Ewa.q(t,i,t,i,!0,!1);this.b.a().d(r,r,60,0,!0,"",!1,!0,!0);this.e=!0},E:function(n,t){var i=new Common.App.Enrichment.e,f,r,u;return i.applicationVersion=Common.a.o,i.applicationName="ExcelWac",f="00000000-0000-0000-0000-000000000000",i.anid=f,i.sessionId=Common.a.j,i.appCorrelationId=Common.y.a().a,r=Common.e.b(Common.a.p),u=r?r.a:null,i.uiLanguage=u,i.market=this.D(u),i.themeId=0,i.disambiguationJson=n,t<=2147483647?i.featuresBitMask=t:Diag.a.a(40511300,0,10,"SkydanceFeaturesBitmask is too large for EnrichmentMessageContentAppProperties"),i},D:function(n){var t=n.split("-");return t[t.length-1]},H:function(n){var t=this.b.a().a().a(),r,i;if(!this.v()||!t){this.d();return}if(this.b.e().d(t)){if(this.r&&!n&&!this.i)return;if(_Ewa.c.a("OfficeVSO:4833722_DisambiguationPaneOpenWhileUserIsEditing")&&this.b.m())return;n&&(this.e=!0);r=_Ewa.h.c(t,this.a);i=null;this.a.a(715)&&(i=1);var u=this,f=function(n,t){return _Ewa.dR.a(u.a.d().a(),r,!1,_Ewa.p.a(n,u.k),t,i,null)},e=this;_Ewa.S.a(this.a.g(),f,function(n){return new _Ewa.J(114,0,n,16,null)},null)}else this.d();return},T:function(){var n,i,t;if(this.c){if(n=this.b.a().a().a(),!n){this.d();return}i=_Ewa.h.c(n,this.a);t=null;this.a.a(715)&&(t=1);var r=this,u=function(n,u){return _Ewa.dR.a(r.a.d().a(),i,!1,_Ewa.p.a(n,r.k),u,t,null)},f=this;_Ewa.S.a(this.a.g(),u,function(n){return new _Ewa.J(114,0,n,16,null)},null)}},R:function(n){if(_Ewa.j.c(n.Errors)&&Diag.a.a(36975691,0,10,"Failed to select Linked Entity for Disambiguation.. errors: {0}",_Ewa.j.a(n.Errors,",")),n.Result){var t=n.Result;this.u(t);this.i=!0}else this.d();return},P:function(n){if(_Ewa.j.c(n.Errors)){Diag.a.a(36975692,0,15,"Failed to retrieve data for searching in Disambiguation Pane.  Error id names: {0}",_Ewa.j.a(n.Errors,","));return}if(n.Result){var t=n.Result;this.g.b(t,null)}else Diag.a.a(591005598,0,50,"ConvertToLinkedEntityDisambiguationPane:OnSearchLinkedEntitySucceeded: Calling CloseDisambiguationPane"),this.d();return},v:function(){var n=this.b.a().a();return n.i()?_Ewa.h.c(n.a(),this.a):null}};_Ewa.eV=function(n,t,i,r,u,f){this.cv=Function.createDelegate(this,this.de);this.cw=Function.createDelegate(this,this.df);this.cp=Function.createDelegate(this,this.cU);this.cq=Function.createDelegate(this,this.cV);this.bC=Function.createDelegate(this,this.cM);this.cu=Function.createDelegate(this,this.dd);this.bU=Function.createDelegate(this,this.db);this.bV=Function.createDelegate(this,this.dc);this.cx=Function.createDelegate(this,this.dg);this.cr=Function.createDelegate(this,this.cY);this.ct=Function.createDelegate(this,this.da);this.cs=Function.createDelegate(this,this.cZ);this.bT=Function.createDelegate(this,this.cW);this.bD=Function.createDelegate(this,this.cX);this.bW=Function.createDelegate(this,this.dh);this.bX=Function.createDelegate(this,this.di);this.V=new Array(12);this.r=this.M;this.P=this.a;_Ewa.eV.initializeBase(this,[!1]);this.T=n;this.bZ=f;this.cj=i;this.bb=[];this.W=[];this.Y=_Ewa.b.a(this.T);this.bs=-1;this.bn=this.T.a(155);this.bd=this.T.a(604);this.cf=_Ewa.c.a("OfficeVSO:4294127_LongButtonVisibleWhenAnyDomainOverrideShowsInRibbon");this.bQ=this.T.a(156);this.bk=this.T.a(596)&&this.T.a(602)&&this.T.a(351);this.bo=this.T.a(521);this.bp=this.T.a(1092)&&this.bd;this.bB=this.bp&&this.T.a(1108);this.X=new($$sc.v.$$(_Ewa.CD));this.ch=this.T.m()+"Ribbon.Data.LinkedEntity";this.be=new _Ewa.pW(n,t,this);r&&(this.U=new _Ewa.GJ(n,r,u,this,this));this.bn?(this.T.D(this.bX),_Ewa.cp.a(this.T)&&_Ewa.cp.a(this.T).t(this),this.cA()):n.b().b(_Ewa.dS,271,this);(this.bo||this.bk)&&this.T.c().s(this.bW);this.T.a(153)&&this.T.a(166)&&(this.cJ()||this.Y.w(this.bD));this.bd&&this.T.S(this.bT);this.T.a(1037)&&this.N();this.bB&&(this.bP=new _Ewa.GN(this.T,this))};_Ewa.eV.b=function(n,t,i,r,u){var f=u?'<div class="cui-row-onerow"><p class="cui-ctl-mediumlabel leg-gallerybuttonlabel-70" align="middle">{0}<\/p><\/div>':'<div class="cui-row-onerow"><p class="cui-ctl-mediumlabel leg-gallerybuttonlabel" align="middle">{0}<\/p><\/div>',e=String.format('<span class="cui-img-32by32 cui-img-cont-float"><IMG class="{0}" src="{1}" alt="{2}" align="middle"><\/span>',n,t,r),o=String.format(f,i);return String.format('<div mscui:controltype="GalleryButton" class="leg-gallerybutton">{0}{1}<\/div>',e,o)};_Ewa.eV.a=function(n){return n.StringId?n.Id.toString()+"."+n.StringId:n.Id.toString()};_Ewa.eV.prototype={T:null,bZ:null,be:null,cj:null,br:!1,bw:!1,cf:!1,bQ:!1,bo:!1,bk:!1,bA:null,bn:!1,bt:null,bu:null,bN:null,bM:null,cg:!1,bJ:0,bv:0,bd:!1,ba:null,W:null,bK:!1,bp:!1,bP:null,bB:!1,bb:null,U:null,bI:null,bj:null,Z:0,Y:null,bi:null,bF:null,bs:0,bc:8,ch:null,ce:!1,bl:null,bm:null,cQ:function(){return _Ewa.f.a(this.bF)&&(this.bF=_Ewa.ClientStringManager.a().a(1615)),this.bF},X:null,bh:null,bE:0,cy:5,bx:3e4,ck:!1,bf:null,by:null,bS:!1,cm:!1,dispose:function(){(this.bo||this.bk)&&this.T.c().u(this.bW);!this.bf&&this.T.a(153)&&this.T.a(166)&&this.Y.y(this.bD);this.U&&this.U.dispose();this.bd&&this.T.U(this.bT);this.bn&&(this.T.E(this.bX),this.bk&&(this.bA=null));System.a.a(this.bh)},e:function(n){this.dW("LinkedEntityConverted",n)},L:function(n){this.dX("LinkedEntityConverted",n)},Q:function(){return 5},k:function(){return this.W},S:function(n){return this.W=n,n},q:function(n){return this.U?this.U.W(n):!1},o:function(n,t){this.U&&this.U.U(n,t)},m:function(n){return this.U?this.U.I(n):!1},n:function(){this.U&&this.U.O()},l:function(){this.U&&this.U.C()},p:function(n){this.U&&this.U.V(n)},M:function(n){this.U&&this.U.X(n)},s:function(n){this.U&&this.U.Y(n)},dh:function(){this.bo&&this.dt();this.bk&&this.cl(!0)},x:function(){var n=this,t=function(t,i){return _Ewa.dR.i(n.T.d().a(),_Ewa.p.a(t,n.cs),i,null,null)};this.T.g().a(new _Ewa.be(589,0,t,16,null),null)},cZ:function(){this.bS=!0;this.U&&this.U.T()},N:function(){this.bS||this.cm||this.dl()},dl:function(){var n=this,t=function(t,i){return _Ewa.dR.f(n.T.d().a(),_Ewa.p.a(t,n.ct),i,null,null)};this.T.g().a(new _Ewa.be(588,0,t,16,null),null)},da:function(n){if(n&&!_Ewa.O.a(n))try{var t=n.Result.HasUntrustedImageUrl;t&&(this.bZ.a(47,null,null),this.cm=!0)}catch(i){Diag.a.a(574718945,0,10,"ConvertToLinkedEntityManager.OnGetHasUntrustedImageUrlsFromServerSuccess: GetHasUntrustedImageUrls encountered exception {0}.",i)}},cl:function(n){var r,t,i;this.bk&&this.bA==null&&(r=this.bu==null?!1:this.bu,r)&&(!n||this.T.l().Options&262144)&&(t=_Ewa.n.b(_Ewa.jC,this.T.b(),274,275,0,null),i=this,_Ewa.g.a(t,function(){i.bA=_Ewa.c.a("OfficeVSO:4910567_DecoupleAutoPolicyManagerAndAugloop")?t.a().f(1):t.a().g(1)},this.T.i(),3,null,null))},y:function(){return this.V.length},bY:null,z:function(){return this.bY},v:function(n){var t=this.cP(n);if(!t){Diag.a.a(593241931,0,10,"Could not convert key into domain ID");return}this.u(t)},u:function(n){var f,e,o,r,s,h,t,c,l,i,a,v,u;if(Diag.a.a(34415004,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - conversion attempted  [ServiceEndpoint: {0}].",n.Id),!this.Y){Diag.a.b(34415005,0,!1,"grid view should not be null");return}_Ewa.c.a("OfficeVSO:4682276_ShowFinanceBusinessBarWithDisambiguousResultOnly")||this.dm(n);var y=this.Y.a().a().b(),w=this.Y.X(),p=y.l(w);if(this.bp&&this.bK&&this.cL(n),p){if(f=this.Y.e().C(p),_Ewa.c.a("OfficeVSO:4704377_ShowDSPForOrganizationButton")){if(!this.cd(n)&&n.Id===268435968&&this.T.a(603)){if(Diag.a.a(588001754,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert to organization data type without curated data"),_Ewa.E.a().h()){if(e=this.bz(),!e){Diag.a.a(588001753,0,50,"CalloutAnchorElement is null for blankCellConvert");return}if(o=this.bq(),!o){Diag.a.a(588001752,0,50,"RibbonCommandInfo is null for blankCellConvert");return}r={InputMethod:_Ewa.G.a};r.CalloutName=3;r.Target=e;r.RibbonButtonLabel=_Ewa.c.a("OfficeVSO:4244626_BlankCellCalloutRibbonButtonLabel")?this.bO(n):this.g(n.Id.toString());r.ExampleEntities=this.bH(n);this.T.h().a(o,r,null);return}Diag.a.a(588001751,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert to organization data without curated data, teaching callout not enabled")}if(this.bQ&&n.Id===268435968&&!n.StringId){this.G(_Ewa.eV.a(n));return}if(f){if(Diag.a.a(42467672,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert an empty range"),_Ewa.E.a().h()){if(s=this.bz(),!s){Diag.a.a(588001756,0,50,"CalloutAnchorElement is null for blankCellConvert");return}if(h=this.bq(),!h){Diag.a.a(588001755,0,50,"RibbonCommandInfo is null for blankCellConvert");return}t={InputMethod:_Ewa.G.a};t.CalloutName=2;t.Target=s;t.RibbonButtonLabel=this.bO(n);t.ExampleEntities=this.bH(n);t.BlankCellResourceId=this.cz(n);t.HasBlankCellWalkthrough=this.cD(n);t.ServiceDomain=n.Id;this.T.h().a(h,t,null);return}Diag.a.a(42764317,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert a blank range, teaching callout not enabled")}}else{if(f){if(Diag.a.a(575231696,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert an empty range"),_Ewa.E.a().h()){if(c=this.bz(),!c){Diag.a.a(575231695,0,50,"CalloutAnchorElement is null for blankCellConvert");return}if(l=this.bq(),!l){Diag.a.a(575231694,0,50,"RibbonCommandInfo is null for blankCellConvert");return}i={InputMethod:_Ewa.G.a};i.CalloutName=2;i.Target=c;i.RibbonButtonLabel=this.bO(n);i.ExampleEntities=this.bH(n);i.BlankCellResourceId=this.cz(n);i.HasBlankCellWalkthrough=this.cD(n);i.ServiceDomain=n.Id;this.T.h().a(l,i,null);return}Diag.a.a(575231693,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert a blank range, teaching callout not enabled")}else if(!this.cd(n)&&n.Id===268435968&&this.T.a(603)){if(Diag.a.a(575231692,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert to organization data type without curated data"),_Ewa.E.a().h()){if(a=this.bz(),!a){Diag.a.a(575231691,0,50,"CalloutAnchorElement is null for blankCellConvert");return}if(v=this.bq(),!v){Diag.a.a(575231690,0,50,"RibbonCommandInfo is null for blankCellConvert");return}u={InputMethod:_Ewa.G.a};u.CalloutName=3;u.Target=a;u.RibbonButtonLabel=_Ewa.c.a("OfficeVSO:4244626_BlankCellCalloutRibbonButtonLabel")?this.bO(n):this.g(n.Id.toString());u.ExampleEntities=this.bH(n);this.T.h().a(v,u,null);return}Diag.a.a(575231689,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert to organization data without curated data, teaching callout not enabled")}if(this.bQ&&n.Id===268435968&&!n.StringId){this.G(_Ewa.eV.a(n));return}}this.f(n,!1,y)}},c:function(){return this.cg},H:function(){var n,t;if(this.cg){if(!_Ewa.E.a().h()){Diag.a.a(574681243,0,50,"ConvertToLinkedEntityManager:LaunchLinkedEntityWolframUpsellCallout() - Attempted to launch wolfram upsell callout but callout not enabled");return}n={InputMethod:_Ewa.G.a};n.CalloutName=4;n.Target=_Ewa.k.a()?"[data-unique-id=Ribbon-ConvertToLinkedEntityGallery-previewExpandButton]":document.getElementById(this.T.m()+"Data.LinkedEntity.Flyout-Thin");t=this.bq();this.T.h().a(t,n,null);return}},w:function(){this.bf&&this.bf.A()},I:function(){var n=this,t=function(t,i){return _Ewa.dR.l(n.T.d().a(),t,i,null,null)},i=this;_Ewa.S.a(this.T.g(),t,function(n){return new _Ewa.be(230,0,n,16,null)},null)},f:function(n,t,i){var u=_Ewa.h.e(i,this.T),r=this,f=function(i,f){return _Ewa.dR.d(r.T.d().a(),u,n,t,_Ewa.p.a(i,r.cr,r.cx,r.U.w),f,null,null)},o=this,e=function(){return new _Ewa.em},s=this;_Ewa.S.a(this.T.g(),f,function(n){return new _Ewa.J(115,0,n,0,e)},null)},cL:function(n){var t,r,i;if(this.bp&&this.bK&&(t={},t.Id=n.Id,n.StringId&&(t.StringId=n.StringId),!(this.W.length>0)||this.W[0].Id!==t.Id||this.W[0].StringId!==t.StringId)){for(r=!1,Array.insert(this.W,0,t),i=1;i<this.W.length;++i)if(this.W[i].Id===t.Id&&this.W[i].StringId===t.StringId){Array.removeAt(this.W,i);r=!0;break}while(this.W.length>5)Array.removeAt(this.W,this.W.length-1);this.ba.Categories[0].DomainIds=this.W;this.R();this.bB&&!r&&this.bP.h(this.W)}},cY:function(n){if(!_Ewa.j.c(n.Errors))if(this.cl(!1),_Ewa.c.a("OfficeVSO:4744180_LinkedEntityCreateEventForOOUI"))this.dU("LinkedEntityConverted",null,null);else{var t=_Ewa.n.b(_Ewa.iw,this.T.b(),261,262,0,null),i=this;_Ewa.g.a(t,function(){i.dU("LinkedEntityConverted",null,null)},this.T.i(),3,null,null)}},dg:function(){var n=this;this.T.b().c(_Ewa.cu,211,function(n){n.a(_Ewa.ClientStringManager.a().a(1633))},null)},t:function(){if(Diag.a.a(34719501,0,50,"ConvertToLinkedEntityManager:ConvertLinkedEntityToText() - conversion attempted"),!this.Y){Diag.a.b(34719502,0,!1,"grid view should not be null");return}var n=_Ewa.h.e(this.Y.a().a().b(),this.T),t=this,i=function(i,r){return _Ewa.dR.c(t.T.d().a(),n,i,r,null,null)},r=this;_Ewa.S.a(this.T.g(),i,function(n){return new _Ewa.J(116,0,n,0,null)},null)},K:function(){var n;if(Diag.a.a(36234048,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntities() - refresh attempted"),n=_Ewa.b.a(this.T),!n){Diag.a.b(36234049,0,!1,"grid view should not be null");return}this.T.k()||Diag.a.a(591528644,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntities(): Refreshing selection during view mode");var t=_Ewa.h.c(n.a().a().a(),this.T),i=this,r=function(n,r){return _Ewa.dR.m(i.T.d().a(),t,n,r,null,null)},u=this;_Ewa.S.a(this.T.g(),r,function(n){return new _Ewa.J(117,0,n,0,null)},null)},d:function(){var n;if(Diag.a.a(572555984,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange() - refresh attempted"),n=_Ewa.b.a(this.T),!n){Diag.a.b(572555983,0,!1,"grid view should not be null");return}this.T.k()||Diag.a.a(572555982,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange(): Refreshing selection during view mode");var t=_Ewa.h.d(this.Y.a().a().c(),this.T),i=this,r=function(n,r){return _Ewa.dR.n(i.T.d().a(),t,n,r,null,null)},u=this;_Ewa.S.a(this.T.g(),r,function(n){return new _Ewa.J(248,0,n,0,null)},null)},dr:function(){return this.cI(this.bl)},dq:function(){return this.cI(this.bm)},cI:function(n){try{if(this.Z===2&&n){var t=this.cb(parseInt(n));return!t||!t.ShowInRibbon}}catch(i){Diag.a.a(595068756,0,10,"ConvertToLinkedEntityManager:ShouldHideRibbonDOMElement - Unable to parse domain ID: "+n)}return!0},i:function(n){var t=this.a(n.DomainId),i,r;if(!t||t.DomainBlocked||_Ewa.c.a("OfficeVSO:4465309_NoCuratedDataNoLongButton")&&!t.HasCuratedData)return!1;if(this.cf){for(i=this.X.$$ge();i.$$mn();)if(r=i.$$cu(),r.a.DomainId.Id===t.DomainId.Id&&r.a.ShowInRibbon)return!0;return!1}return t.ShowInRibbon},dn:function(n){return this.Z!==2||!this.V[n]},dp:function(){var n,t,i;if(this.bd)return Diag.a.a(592213150,0,10,"Unexpectedly calling ShouldHideFlyout for new gallery design"),!1;if(!this.X)return!0;if(this.by!=null)return this.by;for(n=0,t=this.X.$$ge();t.$$mn();)i=t.$$cu(),i.a.DomainBlocked||++n;return this.by=n<=2,this.by},F:function(){this.U&&this.U.F()},J:function(n,t,i){if(t!=="PopulateConvertToLinkedEntityMenu")return!1;if(this.bI=i.MenuId,!this.Z||this.Z===3)return this.dj(),!0;if(this.bd)if(this.ba){if(this.X)return _Ewa.k.a()?(this.bi=this.bi||this.be.e(this.ba,i.MenuId,this.T.a(715)),i.MenuItems=this.bi,this.bK=!0,!0):(this.bj=this.bj||this.be.c(this.ba,i.MenuId,this.T.a(715)),i.PopulationXML=this.bj,!0);Diag.a.a(593264904,0,10,"PopulateMenu: Encountered null domain collection")}else Diag.a.a(593264905,0,10,"PopulateMenu: Encountered null ribbon section info");return _Ewa.k.a()?(this.bi=this.bi||this.be.d(this.bb,i.MenuId),i.MenuItems=this.bi):(this.bj=this.bj||this.be.b(this.bb,i.MenuId),i.PopulationXML=this.bj),!0},dj:function(){if(this.bs===-1){this.h();var n=this;this.bs=window.setInterval(function(){n.h()},2e3)}},h:function(){if(this.T.c().a()&&this.Z!==2){this.bc--;Diag.a.a(34415006,0,50,"ConvertToLinkedEntityManager:PopulateDomainData() - populating domains attempted.");this.Z=1;this.bd?_Ewa.dR.g(this.T.d().a(),this.bV,this.bU,null,null):_Ewa.dR.h(this.T.d().a(),this.bV,this.bU,null,null);return}},cG:function(){return this.T.k()&&this.Z!==2&&this.bc>=0},co:function(n){if(Common.a.g){Diag.a.a(587530655,0,50,"UpdatePreviewGalleryVisibility bailed out on shutting down.");return}if(!_Ewa.cp.a(this.T)){Diag.a.a(587530654,0,50,"UpdatePreviewGalleryVisibility bailed out on null RibbonManager.");return}this.cn();n&&this.T.v()},dk:function(){this.bv=0;this.bc=8;this.bs=0;this.Z=0;this.ba=null;this.bb=null;this.bG();for(var n=0;n<this.V.length;++n)this.V[n]=null;_Ewa.k.q(this.T)&&this.bL()&&this.co(!0)},di:function(n,t){if(Diag.a.a(575948507,0,50,"ConvertToLinkedEntityManager.OnWorkbookOpened called"),t.a){Diag.a.a(575948506,0,15,"ConvertToLinkedEntityManager.OnWorkbookOpened called while rendering cached content");return}this.T.k()?this.cA():this.dk();this.T.a(1037)&&this.bS&&this.x()},bG:function(){this.bi=null;this.bj=null},bL:function(){var t=_Ewa.k.a()?"Data":this.T.m()+"Ribbon.Data",n=_Ewa.cp.a(this.T);return!!n&&n.a().a()===t},dc:function(n){var h,f,c,i,r,u,e,l,a,t,s;if(this.bG(),n.Result){if(this.bd?(r=n.Result,i=r.DomainDataArray,this.ba=r.Ribbon,this.bp&&(u={},u.Name=_Ewa.ClientStringManager.a().a(1618),u.DomainIds=this.W,Array.insert(this.ba.Categories,0,u)),r.MaximumCellsToConvert>0&&(this.bY=r.MaximumCellsToConvert)):i=n.Result,this.Z=2,e=!1,i){Diag.a.a(39949271,0,50,"OnGetLinkedEntityServiceDomainsSuccess: Received {0} domains",i.length);this.bb||(this.bb=[]);l=_Ewa.ClientStringManager.a().a(1615);a=_Ewa.ClientStringManager.a().a(1617);for(var v=i,y=v.length,o=0;o<y;++o){if(t=v[o],!t.DomainId){Diag.a.a(593291469,0,10,"OnGetLinkedEntityServiceDomainsSuccess: DomainId is null.");continue}if(this.bb.push(t),t.DomainBlocked){s=!!t.DomainId.StringId;Diag.a.a(595068755,0,50,"Domain: {0} is telemetry only, do not show in menu (Has String ID: {1})",s?t.DomainId.Id.toString():t.Name,s);continue}this.X.b(_Ewa.eV.a(t.DomainId),t);t.Name===l||t.DomainId.Id===268435456?this.bl=t.DomainId.Id.toString():(t.Name===a||t.DomainId.Id===536870912)&&(this.bm=t.DomainId.Id.toString());e=!0}}e||(this.bb=null);this.cK();this.bB&&this.bP.i()}else this.bb=null,this.Z=3,h=this.bn?-1:0,this.bc>h&&(f=0,this.bn&&(f=100*(8-this.bc)),c=this,window.setTimeout(function(){c.h()},f)),Diag.a.a(39949272,0,50,"OnGetLinkedEntityServiceDomainsSuccess: Received no result");this.ci();_Ewa.c.a("OfficeVSO:4759044_LinkedEntityFirstOrganizationDataTeachingCallout2")&&this.cB();this.ck||(this.ds(),this.ck=!0);this.bk&&this.cl(!0)},db:function(n){var t=_Ewa.Y.a(n.b);Diag.a.a(34415007,0,15,"OnGetLinkedEntityServiceDomainsFailure [Errors: {0}].",_Ewa.j.a(t,","));this.bb=null;this.Z=3;this.bn&&(this.bc=-1);this.ci()},cK:function(){var n,k,h,r,it,p,u,f,e,i;if(this.ba){if(n=0,this.bp){for(var t=-1,c=-1,l=0,a=0,g=0,v=0,nt=[null,null,null,null,null],tt=this.ba.Categories,et=tt.length,y=0;y<et;++y){it=tt[y];p=!1;for(var rt=it.DomainIds,ot=rt.length,w=0;w<ot;++w)u=rt[w],f=this.a(u),f&&!f.DomainBlocked&&f.ShowInRibbon&&(n<this.V.length?(this.V[n]=u,a||(t===-1&&(t=n),c=n,v=c-t+1),++n):n===this.V.length&&l<v&&a&&(nt[l]=u,++l),p=!0);p&&++g;++a}if(t>-1&&g<=2){for(e=c;e>=t;--e)Array.removeAt(this.V,e);for(i=0;i<v;++i)Array.insert(this.V,n+i,nt[i])}}else for(var b=this.ba.Categories,ut=b.length,o=0;o<ut;++o){k=b[o];for(var d=k.DomainIds,ft=d.length,s=0;s<ft;++s)if(h=d[s],r=this.a(h),r&&!r.DomainBlocked&&r.ShowInRibbon&&(this.V[n]=h,++n,n>=this.V.length))break;if(n>=this.V.length)break}while(n<this.V.length)this.V[n]=null,++n}},cX:function(){this.cJ()&&this.Y.y(this.bD)},dm:function(n){if(this.U){var t=this.a(n).Name===this.cQ();this.U.s=t}},cJ:function(){var n=$$as(_Ewa.gJ,_Ewa.b.a(this.T).b()),i=!!n&&n.H(),r=this.Y.a().c(),t;return i&&r===1&&this.Y.a().a().a()?(t=_Ewa.n.a(_Ewa.dg,this.T.b(),12,this.T.i(),1,null),this.bf=new _Ewa.tH(this.T,this.cj,t.a(),this),!0):!1},E:function(n){this.U&&this.U.t(n)},G:function(n){var t,i;if(this.U){if(t=this.cc(n),!t){Diag.a.a(593097799,0,10,"Unknown domain used when launching Data Type Selector pane");return}if(t.DomainId.StringId){Diag.a.a(593097798,0,10,"Domain with a string ID used when launching Data Type Selector pane");return}i=_Ewa.h.d(this.Y.a().a().c(),this.T);this.U.G(i,t.DomainId.Id)}},cO:function(){return this.ca(this.bl)},cN:function(){return this.ca(this.bm)},ca:function(n){var t=this.cT(n),i=Common.d.b(this.g(n)),r=Common.d.b(this.j(n));return _Ewa.eV.b(t,_Ewa.u.a(11),i,r,!1)},j:function(n){try{return this.cb(parseInt(n)).Description}catch(t){}return _Ewa.ClientStringManager.a().a(1612)},g:function(n){try{return this.cb(parseInt(n)).Name}catch(t){}return _Ewa.ClientStringManager.a().a(1598)},bO:function(n){try{return this.a(n).Name}catch(t){}return this.g(n.Id.toString())},cz:function(n){try{return this.a(n).BlankCellResourceId}catch(t){}return null},cD:function(n){try{return this.a(n).HasBlankCellWalkthrough}catch(t){}return!1},cd:function(n){try{if(_Ewa.c.a("OfficeVSO:4735570_LinkedEntityHasCuratedDataAssert")){var t=_Ewa.eV.a(n);return this.X.c(t)?this.X.a(t).HasCuratedData:!1}return this.a(n).HasCuratedData}catch(i){}return!1},bz:function(){var n;return _Ewa.k.a()?n=_Ewa.cp.a(this.T).j()===2?"[data-unique-id=LinkedEntity_MLR]":"[data-unique-id=LinkedEntity]":(n=document.getElementById(this.ch),n||Diag.a.b(588001750,0,!1,"Could not get multi-line ribbon anchor DOM element for the linked entity teaching callout.")),n},bq:function(){return new _Ewa.L(-847286761,_Ewa.G.a,this.T.s(),0,"Help")},cB:function(){var t,i,r,n;if(this.bL()&&!this.cG()&&!this.ce&&this.T.a(596)&&(t={},t.Id=268435968,t.StringId=null,this.cd(t)&&this.T.a(603)))if(Diag.a.a(574997530,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - tried to launch first org data teaching callout"),_Ewa.E.a().h()){if(i=this.bz(),!i){Diag.a.a(574997529,0,10,"CalloutAnchorElement is null for firstOrgData");return}if(r=this.bq(),!r){Diag.a.a(574997528,0,10,"RibbonCommandInfo is null for firstOrgData");return}n={InputMethod:_Ewa.G.a};n.CalloutName=7;n.Target=i;n.ShouldCanvasTakeFocus=!0;this.T.h().a(r,n,null);this.ce=!0}else Diag.a.a(574997527,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - Attempted to launch firstOrgData callout, teaching callout not enabled")},C:function(n){var t=this.cc(n);return t?this.be.a(t.SubdomainFontLocator):(Diag.a.a(576057797,0,10,"ConvertToLinkedEntityManager.IconFromDomainFontLocator: Requested domain that doesn't exist in collection"),null)},D:function(n){return this.bf?this.bf.M(n,!1):!1},A:function(){return this.bf?this.bf.O():""},cR:function(n,t){var u=this.cE(n),r,i;if(u<0){Diag.a.a(592843911,0,10,"Unexpected menuItemKey for dynamic preview gallery button: {0}",n);return}(r=this.cC(n),i=r?this.a(r):null,i)&&(_Ewa.k.a()?t[CommandUI.Controls.a.GalleryButtonProps]=this.be.g(u,i):t[CommandUI.Controls.a.InnerHTML]=this.be.f(i),t.Alt=this.be.h(i))},R:function(){this.cK();_Ewa.k.q(this.T)&&this.bL()&&this.co(!0);this.bG()},cT:function(n){return n===this.bl?"ewadata_StockLinkedEntity32":n===this.bm?"ewadata_GeographyLinkedEntity32":"ewadata_ConvertToEntityIcon32"},bH:function(n){try{return this.a(n).ExampleEntities}catch(t){}return _Ewa.ClientStringManager.a().a(1620)},ci:function(){this.bc<0&&Diag.a.a(37089859,0,15,"RefreshFullGalleryIfOpened: Out of GetLinkedEntityServiceDomain retries");(this.Z===2||this.bc<0)&&window.clearInterval(this.bs);_Ewa.k.q(this.T)&&!this.cG()?this.co(this.bL()):this.bI&&this.T.r().u(this.bI)},bg:function(n){return this.T.m()+n},cn:function(){var h="Data.LinkedEntity.Stock-Large",c="Data.LinkedEntity.Geography-Large",e="Ribbon.Data.LinkedEntity",l="ConvertToLinkedEntityGallery",n=_Ewa.k.a(),t,r,s,f;if(this.bd){n||(_Ewa.i.i(this.bg(h)),_Ewa.i.i(this.bg(c)));var u=!0,i=new Array(this.V.length),o=_Ewa.cp.a(this.T)?_Ewa.cp.a(this.T).a():null;if(n&&!o){Diag.a.a(587530653,0,15,"UpdateLinkedEntityGalleryButtonsVisibility: ribbonUser should not be null");return}for(t=0;t<i.length;++t)this.dn(t)?i[t]=!0:(i[t]=!1,u=!1);if(n?o.d([l],u):u?_Ewa.i.i(this.bg(e)):_Ewa.i.J(this.bg(e),""),!u)for(r=0;r<i.length;++r)i[r]&&(s=this.B(r,n),n?o.d([s],!0):_Ewa.i.i(s))}else{var a=this.dr(),v=this.dq(),y=a&&v;if(!n||this.br||this.bw||appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(l,y?!0:!1)),y){n||_Ewa.i.i(this.bg(e));this.bw=!0;this.br=!0;return}if(a?(n?appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ConvertToStockLinkedEntity",!0)):_Ewa.i.i(this.bg(h)),this.bw=!0):v&&(n?appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ConvertToGeographyLinkedEntity",!0)):_Ewa.i.i(this.bg(c)),this.br=!0),!n)for(f=0;f<this.V.length;++f)_Ewa.i.i(this.bg("Data.LinkedEntityPreview."+f.toString()+"-Large"));this.dp()&&_Ewa.i.i(n?"ConvertToLinkedEntityGallery-previewExpandButton":this.bg("Data.LinkedEntity.Flyout-Thin"))}},a:function(n){var t=_Ewa.eV.a(n);return this.X.c(t)?this.X.a(t):(Diag.a.a(592729218,0,15,"No domain data for domain ID {0} (Has String ID: {1})",n.Id,!!n.StringId),null)},B:function(n,t){var i,r;return t?(i="ConvertToLinkedEntityPreview",i+n.toString()):(r="Data.LinkedEntityPreview.",this.T.m()+r+n.toString()+"-Large")},O:function(){var n,t;(_Ewa.c.a("OfficeVSO:4759044_LinkedEntityFirstOrganizationDataTeachingCallout2")&&(n=this,Common.App.AppLifecycleManager.get_instance().a(10,function(){n.cB()},3)),!_Ewa.k.q(this.T)&&_Ewa.k.a())&&(t=this,Common.App.AppLifecycleManager.get_instance().a(10,function(){t.cn()},3))},b:function(n,t){var f;switch(n){case"QueryLinkedEntityGalleryButtons":if(!t.val[CommandUI.Controls.a.InnerHTML]){_Ewa.k.q(this.T)&&_Ewa.k.a()||this.cn();var i=t.val.MenuItemId.toString(),r=_Ewa.f.b(i,_Ewa.ClientStringManager.a().a(1615),!0)||_Ewa.f.b(i,_Ewa.ClientStringManager.a().a(1616),!0),u=_Ewa.f.b(i,_Ewa.ClientStringManager.a().a(1617),!0);this.T.a(604)?r||u||this.cR(i,t.val):!this.bw&&r?(this.bw=!0,t.val[CommandUI.Controls.a.InnerHTML]=this.cO()):!this.br&&u&&(this.br=!0,t.val[CommandUI.Controls.a.InnerHTML]=this.cN())}break;case"QueryLinkedEntityMenuGalleryButtons":t.val[CommandUI.Controls.a.InnerHTML]||(f=t.val.MenuItemId,t.val[CommandUI.Controls.a.InnerHTML]=this.ca(f))}},cP:function(n){var t,i,r;return this.T.a(604)&&(t=this.cC(n),t)?t:(i=this.cc(n),i)?i.DomainId:this.T.a(604)?(Diag.a.a(592843910,0,10,"Could not convert key into domain: {0}",n),null):(r=this.cS(n),!r)?(Diag.a.a(593241929,0,10,"Could not convert key into domain using fallback logic, Key: {0}",n),null):(t={},t.Id=r,t.StringId=null,t)},cS:function(n){var t=parseInt(n),i,r;return t>0?t:(Diag.a.a(593241928,0,50,"Checking for specific domains, Key: {0}",n),i=_Ewa.ClientStringManager.a().a(1616),r=_Ewa.ClientStringManager.a().a(1617),n===this.bm||n===this.bl)?parseInt(n):this.cH(n,i,"Stock")?parseInt(this.bl):this.cH(n,r,"Geography")?parseInt(this.bm):t},cb:function(n){var t={};return t.Id=n,this.a(t)},cc:function(n){return this.X.c(n)?this.X.a(n):null},cE:function(n){if(!n.startsWith("PreviewGalleryButtonIndex."))return-1;var t=parseInt(n.substr(26));return isNaN(t)?(Diag.a.a(592843909,0,10,"Unexpected index in preview gallery button key: {0}",n),-1):t},cC:function(n){var t=this.cE(n);return t<0?null:this.V[t]},cW:function(){this.bG()},cF:function(n,t,i){if(this.bo&&this.X&&this.X.e){Diag.a.a(51659660,0,50,"ConvertToLinkedEntityManager.InvokeLinkedEntityTryAutoRefresh. ({0})",n);var r=this.T.d().a().b(!1);this.T.c().a()&&_Ewa.dR.j(this.T.d().a(),_Ewa.p.a(this.cu,t),i,r,null)}},dd:function(n){if(_Ewa.O.a(n)){Diag.a.a(591147843,0,15,"ConvertToLinkedEntityManager.OnLinkedEntityTryAutoRefreshSuccessCore. LinkedEntityTryAutoRefresh returned with errors [Errors: {0}].",_Ewa.j.a(n.Errors,","));this.T.c().t(n.Errors);return}},ds:function(){this.cF("Auto-refresh on load",null,null)},dt:function(){if(this.bo&&this.X&&this.X.e){if(this.bh){Diag.a.a(51659661,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. A periodic auto-refresh check context already exists. No need to create another one");return}var n=this.T.c().l().HasAutoRefreshableLinkedEntityDomainsEver;if(!n){Diag.a.a(51659662,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book doesn't have any auto-refreshable domains. Periodic auto refresh check context will NOT be created");return}Diag.a.a(51659663,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book has auto-refreshable domains. Creating periodic auto refresh check context");this.bh=_Ewa.A.a().a(this.bC,this.bx,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck",!0,!1)}},cM:function(){Diag.a.a(51659664,0,50,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck. Checking after a {0} millisecond interval",this.bx);this.cF("Periodic auto-refresh check",this.cq,this.cp)},cV:function(n){if(_Ewa.O.a(n)?(Diag.a.a(51659665,0,15,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. LinkedEntityTryAutoRefresh returned with errors [Errors: {0}].",_Ewa.j.a(n.Errors,",")),++this.bE):this.bE=0,System.a.a(this.bh),this.bE>=this.cy){Diag.a.a(51659666,0,10,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Failed too many consecutive times. Will stop trying to auto-refresh");this.bh=null;return}Diag.a.a(51659667,0,50,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Re-creating periodicAutoRefreshCheckContext");this.bh=_Ewa.A.a().a(this.bC,this.bx,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck",!0,!1)},cU:function(n){var t=_Ewa.Y.a(n.b);!t||!t.length?Diag.a.a(51659669,0,15,"OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed with an HTTP error"):Diag.a.a(51659668,0,15,"OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed [Errors: {0}].",_Ewa.j.a(t,","));System.a.a(this.bh);this.bh=_Ewa.A.a().a(this.bC,this.bx,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck",!0,!1)},cH:function(n,t,i){return _Ewa.f.c(n,t,!0)||_Ewa.f.c(n,i,!0)},df:function(n){var t=!!n.Result&&n.Result,i;Diag.a.a(591958236,0,50,"OnNotifyFeatureLicensingStatusSuccess- operationSucceeded? = {0}",t.toString());t?(i=_Ewa.v.a().b().m-this.bJ,Diag.a.a(589947468,0,50,"OnNotifyFeatureLicensingStatusSuccess- successful handshake duration = {0} ms, retry count = {1}",i,this.bv),this.h()):this.bR()},de:function(){Diag.a.a(591958235,0,15,"OnNotifyFeatureLicensingStatusFailed");this.bR()},bR:function(){var n;if(this.T.c().a()&&this.bt!=null&&this.bu!=null&&this.bN!=null&&this.bM!=null)if(++this.bv,this.bv<=12){this.bv===1&&(this.bJ=_Ewa.v.a().b().m,Diag.a.a(589947467,0,50,"StartLinkedEntityDelayedHandshake - starting handshake."));var t=this.T.d().a().b(!1),i=[this.bt||this.bu,this.bN,this.bM];_Ewa.l.P(this.T.d().a(),["ExcelAdvancedAnalytics","ExcelWolframAlpha","StockHistory"],i,this.cw,this.cv,t)}else n=_Ewa.v.a().b().m-this.bJ,Diag.a.a(591958231,0,15,"StartLinkedEntityDelayedHandshake - Retry count expired - failed handshake duration {0} ms",n),this.bc=-1,this.ci()},cA:function(){if(this.T.k()){if(this.bt!=null){this.bR();return}var t=_Ewa.v.a().b().m,n=this;Common.Utils.a.a().c(Common.App.ApplicationFeatureHelper.a,null).a(function(i){i.a("ExcelAdvancedAnalytics",!1).then(function(i){var r=_Ewa.v.a().b().m;return Diag.a.a(591958230,0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.","ExcelAdvancedAnalytics",r-t),Diag.a.a(591958229,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]","ExcelAdvancedAnalytics",i),n.bt=!i&&n.T.a(601)?!0:i,i}).then(function(){i.a("ExcelPowerBiPro",!1).then(function(i){var r=_Ewa.v.a().b().m;return Diag.a.a(590747350,0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.","ExcelPowerBiPro",r-t),Diag.a.a(590747349,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]","ExcelPowerBiPro",i),n.bu=i,i})}).then(function(){i.a("ExcelWolframAlpha",!1).then(function(i){var r=_Ewa.v.a().b().m;return Diag.a.a(590960588,0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.","ExcelWolframAlpha",r-t),Diag.a.a(590960587,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]","ExcelWolframAlpha",i),n.bN=i,i})}).then(function(){i.a("StockHistory",!1).then(function(i){var r=_Ewa.v.a().b().m;return Diag.a.a(579081472,0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.","StockHistory",r-t),Diag.a.a(579081443,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]","StockHistory",i),n.bM=i,n.bR(),i})})})}}};_Ewa.uU=function(n){_Ewa.uU.initializeBase(this);this.h=n;this.l()};_Ewa.uU.a=function(n){n.b().b(_Ewa.bgS.$$(_Ewa.dS),272,new _Ewa.uU(n))};_Ewa.uU.prototype={h:null,b:function(){var n=_Ewa.n.a(_Ewa.dQ,this.h.b(),102,this.h.i(),this.j,null),t=_Ewa.n.b(_Ewa.cM,this.h.b(),5,4,this.j,null),i=_Ewa.n.b(_Ewa.hK,this.h.b(),388,387,this.j,null),r;if(this.h.B())r=this,_Ewa.g.a(_Ewa.g.b([n,t,i],this.i(),3),function(){r.k(r.h.b().a(_Ewa.dS,271,!1,null)||new _Ewa.eV(r.h,n.a(),i.a(),null,null,t.a()))},this.h.i(),3,null,null);else{var f=_Ewa.n.b(_Ewa.qO,this.h.b(),257,258,this.j,null),e=_Ewa.cn.a(this.h),u=this;_Ewa.g.a(_Ewa.g.b([n,f,e,t,i],this.i(),3),function(){u.k(u.h.b().a(_Ewa.dS,271,!1,null)||new _Ewa.eV(u.h,n.a(),i.a(),f.a(),e.a(),t.a()))},this.h.i(),3,null,null)}}};_Ewa.pW=function(n,t,i){this.m=n;this.k=t;this.i=i;this.o=this.m.a(1092)&&this.m.a(604)};_Ewa.pW.a=function(n){return n.replace(new RegExp("\\n","g"),"&#010;")};_Ewa.pW.prototype={l:2,j:"Size64by48",o:!1,k:null,i:null,m:null,d:function(n,t){var i=this.x(n,t);return i.b()},x:function(n,t){var r=this.k.c(t),u,f,i;if(n&&n.length>0){u=this.k.b();r.a().push(u);f=this.k.e("ConvertToLinkedEntitySeeMore",this.l,this.j,null);for(var o=n,h=o.length,e=0;e<h;++e)if((i=o[e],!i.DomainId.StringId)&&!i.DomainBlocked&&i.ShowInRibbon){var s=i.DomainId.Id.toString(),c=this.A(i.Name),l=i.Name;f.c(0,"Data.ConvertToLinkedEntityMenuItem_"+s,-1203788282,"QueryLinkedEntityGalleryIcon",i.Description,s,c,null,null,null)}Array.add(u.a(),f)}return r.a().length||Diag.a.a(34415008,0,15,"No domain data available"),r},e:function(n,t,i){var v,o,h;this.r(!0);for(var w=this.k.c(t),r=w.b(),f=0,c=0,l=!1,a=n.Categories,b=a.length,e=0;e<b;++e)v=a[e],o=this.y(v,f),o&&(this.o&&!c&&(l=!0),Array.add(r.MenuSectionList,o),++f),++c;if(this.o&&l&&f<=2&&Array.removeAt(r.MenuSectionList,0),i){for(var k=this.k.b(),u=k.d(),y=_Ewa.u.a(11),p=n.LongButtons,d=p.length,s=0;s<d;++s)h=p[s],this.i.i(h)&&this.s(u,h,y);this.t(u,y);u.ControlList.length>0&&Array.add(r.MenuSectionList,u)}return r},s:function(n,t,i){var u,f,r,e;t&&(u="Data.ConvertToLinkedEntityMenuItem_"+t.Name,f=this.i.a(t.DomainId),f)&&(e=(r=new Common.bL,r.Id=u,r.ExternalId=u,r.Command="-1662108744",r.LabelText=t.Name,r.Alt=t.SuperTip,r.Visible=!0,r.MenuItemId=_Ewa.eV.a(t.DomainId),r.Image16by16=i,r.Image16by16Class=this.n(f.FontLocator,!0),r),Array.add(n.ControlList,e))},t:function(n,t){if(this.i.c()){Diag.a.a(573087815,0,50,"ConvertToLinkedEntityMenuRenderer::AddWolframUpsellButtonToControlList() - Generating wolfram upsell button");var r="Data.LinkedEntityWolframUpsell",i,u=(i=new Common.bL,i.Id=r,i.ExternalId=r,i.Command="325814869",i.LabelText=_Ewa.ClientStringManager.a().b(622),i.Visible=!0,i.MenuItemId=r,i.Image16by16=t,i.Image16by16Class="ewadata_UpgradeProductExcel16",i);Array.add(n.ControlList,u)}},f:function(n){var t=this.n(n.FontLocator,!1),i=Common.d.b(n.Name),r=Common.d.b(n.Description);return _Ewa.eV.b(t,_Ewa.u.a(11),i,r,!0)},g:function(n,t){var r=24,u={width:r,"min-width":r,height:r},i;return i=new Common.dz,i.Id="ConvertToLinkedEntityPreview"+n.toString(),i.ExternalId="ConvertToLinkedEntityPreview"+n.toString(),i.MenuItemId="PreviewGalleryButtonIndex."+n.toString(),i.Command="-1203788282",i.QueryCommand="QueryLinkedEntityGalleryButtons",i.Icon=this.q(t.FontLocator),i.LabelText=t.Name,i.PreviewIconStyle={root:u},i.Alt=this.h(t),i},b:function(n,t){var u=[],i,e,o,s,h;if(n)for(var f=n,c=f.length,r=0;r<c;++r)(i=f[r],i.DomainId.StringId)||i.DomainBlocked||i.ShowInRibbon&&(e=i.DomainId.Id.toString(),o=i.Name,Array.add(u,this.u(o,"-1203788282","QueryLinkedEntityMenuGalleryButtons",e)));return s=this.w(t,[Common.x.h("ConvertToLinkedEntitySeeMore",this.j,this.l.toString(),u)],!1),h=[s],Common.x.c(h)},c:function(n,t,i){var e,u,y,s,f,h,r,l,a,w,b,k,d;this.r(!1);e=[];u=0;for(var v=n.Categories,g=v.length,o=0;o<g;++o)y=v[o],s=this.z(t,u,y),s&&(e.push(s),++u);if(i){f=[];h=_Ewa.u.a(11);for(var p=n.LongButtons,nt=p.length,c=0;c<nt;++c)if(r=p[c],this.i.i(r)){if(l=_Ewa.eV.a(r.DomainId),a=this.i.a(r.DomainId),!a)continue;w=this.p("Data.ConvertToLinkedEntityMenuItem_"+l,"-1662108744","QueryLinkedEntityMenuGalleryButtonsRedesign",l,r.Name,h,this.n(a.FontLocator,!0),r.SuperTip);Array.add(f,w)}this.i.c()&&(Diag.a.a(573087814,0,50,"ConvertToLinkedEntityMenuRenderer::GenerateLinkedEntityGalleryXmlRedesign() - Generating wolfram upsell button"),b=this.p("Data.LinkedEntityWolframUpsell","325814869","QueryLinkedEntityMenuGalleryButtonsRedesign","Data.LinkedEntityWolframUpsell",_Ewa.ClientStringManager.a().b(622),h,"ewadata_UpgradeProductExcel16",""),Array.add(f,b));f.length>0&&(k=Common.x.d("ConvertToLinkedEntitySection_"+u.toString(),f),d=Common.x.b(t+u.toString(),k,null,null,null,null,null),e.push(d))}return Common.x.c(e)},a:function(n){switch(n){case"Animal":return"AnimalExcelDataTypes_16";case"Apple":return"AppleExcelDataTypes_16";case"Atom":return"AtomExcelDataTypes_16";case"Beaker":return"BeakerExcelDataTypes_16";case"Bridge":return"BridgeExcelDataTypes_16";case"Cat":return"CatExcelDataTypes_16";case"City":return"CityExcelDataTypes_16";case"Constellation":return"ConstellationExcelDataTypes_16";case"Dog":return"DogExcelDataTypes_16";case"Finance":return"Bank_16";case"GradCap":return"GradCapExcelDataTypes_16";case"HumanAnatomy":return"HumanAnatomyExcelDataTypes_16";case"LocationPointer":return"LocationPointerExcelDataTypes_16";case"Map":return"OpenMap_16";case"MedicineNeedle":return"MedicineNeedleExcelDataTypes_16";case"Mountain":return"MountainExcelDataTypes_16";case"Movie":return"MovieExcelDataTypes_16";case"Music":return"MusicExcelDataTypes_16";case"OuterSpace":return"OuterSpaceExcelDataTypes_16";case"Planet":return"PlanetExcelDataTypes_16";case"Satellite":return"SatelliteExcelDataTypes_16";case"WolframGeneric":return"RichDataWolfram_16";default:return"ConvertToEntity_16"}},n:function(n,t){if(t&&n!=="PowerBIRibbon")return"ewadata_ConvertToEntityIcon16";switch(n){case"AnimalRibbon":return"ewadata_Animal32";case"AppleRibbon":return"ewadata_Apple32";case"AtomRibbon":return"ewadata_Atom32";case"BeakerRibbon":return"ewadata_Beaker32";case"CenterMapRibbon":return"ewadata_CenterMap32";case"CityRibbon":return"ewadata_City32";case"CurrencyRibbon":return"ewadata_Currency32";case"ExerciseRibbon":return"ewadata_Exercise32";case"FinanceRibbon":return"ewadata_StockLinkedEntity32";case"FirstAidRibbon":return"ewadata_FirstAid32";case"GradCapRibbon":return"ewadata_GradCap32";case"HumanAnatomyRibbon":return"ewadata_HumanAnatomy32";case"LeafRibbon":return"ewadata_Leaf32";case"LocationPointerRibbon":return"ewadata_LocationPointer32";case"MapRibbon":return"ewadata_GeographyLinkedEntity32";case"MountainRibbon":return"ewadata_Mountain32";case"MovieRibbon":return"ewadata_Movie32";case"MusicRibbon":return"ewadata_Music32";case"NotablePeopleRibbon":return"ewadata_NotablePeople32";case"OuterSpaceRibbon":return"ewadata_OuterSpace32";case"PartlySunnyWeatherRibbon":return"ewadata_PartlySunnyWeather32";case"PowerBIRibbon":return t?"ewadata_OrganizationData16":"ewadata_OrganizationData32";case"SatelliteRibbon":return"ewadata_Satellite32";case"WolframGenericRibbon":return"ewadata_Lightning32";case"YogaRibbon":return"ewadata_Yoga32";default:return"ewadata_ConvertToEntityIcon32"}},q:function(n){switch(n){case"AnimalRibbon":return"AnimalExcelDataTypes_24";case"AppleRibbon":return"AppleExcelDataTypes_24";case"AtomRibbon":return"AtomExcelDataTypes_24";case"BeakerRibbon":return"BeakerExcelDataTypes_24";case"CenterMapRibbon":return"CenterMapExcelDataTypes_24";case"CityRibbon":return"CityExcelDataTypes_24";case"CurrencyRibbon":return"CurrencyExcelDataTypes_24";case"ExerciseRibbon":return"ExerciseExcelDataTypes_24";case"FinanceRibbon":return"Bank_32";case"FirstAidRibbon":return"FirstAidExcelDataTypes_24";case"GradCapRibbon":return"GradCapExcelDataTypes_24";case"HumanAnatomyRibbon":return"HumanAnatomyExcelDataTypes_24";case"LeafRibbon":return"LeafExcelDataTypes_24";case"LocationPointerRibbon":return"LocationPointerExcelDataTypes_24";case"MapRibbon":return"OpenMap_24";case"MountainRibbon":return"MountainExcelDataTypes_24";case"MovieRibbon":return"MovieExcelDataTypes_24";case"MusicRibbon":return"MusicExcelDataTypes_24";case"NotablePeopleRibbon":return"NotablePeopleExcelDataTypes_24";case"OuterSpaceRibbon":return"OuterSpaceExcelDataTypes_24";case"PartlySunnyWeatherRibbon":return"PartlySunnyWeatherExcelDataTypes_24";case"PowerBIRibbon":return"DataProtectionExcelDataTypes_24";case"SatelliteRibbon":return"SatelliteExcelDataTypes_24";case"WolframGenericRibbon":return"Lightning_24";case"YogaRibbon":return"YogaExcelDataTypes_24";default:return"ConvertToEntity_20"}},y:function(n,t){for(var u,i,l,f,a,e,o,s=this.k.e("ConvertToLinkedEntitySection_"+t,this.l,this.j,null),h=!1,c=n.DomainIds,v=c.length,r=0;r<v;++r)(u=c[r],i=this.i.a(u),i&&!i.DomainBlocked&&i.ShowInRibbon)&&(l=i.Name,f=_Ewa.eV.a(u),s.a("Data.ConvertToLinkedEntityMenuItem_"+f,-1203788282,"QueryLinkedEntityGalleryIcon",0,f,this.q(i.FontLocator),null,null,this.h(i),l),h=!0);return h?(a=s.b(!0),e=this.k.b(),e.c(n.Name),o=e.d(),Array.add(o.ControlList,a),o):null},A:function(n){return n==="Stocks"?"Bank_32":n==="Geography"?"OpenMap_32":"ConvertToEntity_32"},v:function(n,t,i,r,u,f,e,o){var h=Common.d.b(o),s=_Ewa.pW.a(h),c=Common.d.b(u),l=Common.d.c(_Ewa.eV.b(e,f,c,s,!0)),a=Common.d.c(n),v=Common.d.c(r);return String.format('<GalleryButton InnerHTML="{0}" Id="{1}" Command="{2}" QueryCommand="{3}" MenuItemId="{4}" ElementDimensions="{5}" Alt="{6}"/>',l,a,t,i,v,this.j,s)},z:function(n,t,i){for(var e,r,o,h,c,l,u=[],a=_Ewa.u.a(11),s=i.DomainIds,v=s.length,f=0;f<v;++f)(e=s[f],r=this.i.a(e),r&&!r.DomainBlocked&&r.ShowInRibbon)&&(o=_Ewa.eV.a(e),h=this.v("Data.ConvertToLinkedEntityMenuItem_"+o,"-1203788282","QueryLinkedEntityMenuGalleryButtonsRedesign",o,r.Name,a,this.n(r.FontLocator,!1),this.h(r)),Array.add(u,h));return u.length?(c=Common.x.h("ConvertToLinkedEntitySection_"+t.toString(),this.j,this.l.toString(),u),l=Common.x.b(n+t.toString(),c,null,i.Name,null,null,null),l):null},p:function(n,t,i,r,u,f,e,o){var s=Common.d.c(o),h=_Ewa.pW.a(s),c=Common.d.c(u),l=Common.d.c(n),a=Common.d.c(r);return Common.x.e(l,t,c,f,e,a,null,h,null,null,i,null,null,null,!0,null,null,null,null,null,null,null)},w:function(n,t,i){return Common.x.b(n,i?Common.x.d(null,t):t[0],null,null,null,null,null)},u:function(n,t,i,r){return String.format('<GalleryButton InnerHTML="" Id="{0}" Command="{1}" QueryCommand="{2}" MenuItemId="{3}" ElementDimensions="{4}"/>',n,t,i,r,this.j)},r:function(n){var i,t,r;if(n)this.l=5;else{for(i=this.i.y(),t=i-1;t>=5;--t)if(r=this.i.B(t,n),_Ewa.i.bb(r))break;this.l=t+1}this.j=n?"Size112by64":"Size70by48"},h:function(n){return!n.RibbonTooltipHeader||!n.RibbonTooltipHeader.length?n.RibbonTooltip:n.RibbonTooltipHeader+"\n\n"+n.RibbonTooltip}};_Ewa.dR=function(){};_Ewa.dR.d=function(n,t,i,r,u,f,e,o){var s=n.a(1,o);return s.selectedRanges=t,s.domainId=i,s.autodetect=r,_Ewa.l.a(n,"ConvertToLinkedEntity",s,u,f,e,4,null,null)};_Ewa.dR.l=function(n,t,i,r,u){var f=n.a(1,u);return _Ewa.l.a(n,"OnAutoDetectUIShown",f,t,i,r,4,null,null)};_Ewa.dR.h=function(n,t,i,r,u){var f=n.a(1,u);return _Ewa.l.a(n,"GetLinkedEntityServiceDomains",f,t,i,r,4,null,null)};_Ewa.dR.g=function(n,t,i,r,u){var f=n.a(1,u);return _Ewa.l.a(n,"GetLinkedEntityMetadata",f,t,i,r,4,null,null)};_Ewa.dR.c=function(n,t,i,r,u,f){var e=n.a(1,f);return e.selectedRanges=t,_Ewa.l.a(n,"ConvertLinkedEntityToText",e,i,r,u,4,null,null)};_Ewa.dR.m=function(n,t,i,r,u,f){var e=n.a(1,f);return e.activeCell=t,_Ewa.l.a(n,"RefreshLinkedEntities",e,i,r,u,4,null,null)};_Ewa.dR.n=function(n,t,i,r,u,f){var e=n.a(1,f);return e.selectedRanges=t,_Ewa.l.a(n,"RefreshLinkedEntitiesInRange",e,i,r,u,4,null,null)};_Ewa.dR.a=function(n,t,i,r,u,f,e){var o=n.a(1,e);return o.activeCell=t,o.isChangeObject=i,_Ewa.l.a(n,"GetLinkedEntityDisambiguationData",o,r,u,f,4,null,null)};_Ewa.dR.p=function(n,t,i,r,u,f,e){var o=n.a(9,e);return o.activeCell=t,o.selectionIndex=i,_Ewa.l.a(n,"SelectLinkedEntityForDisambiguation",o,r,u,f,4,null,null)};_Ewa.dR.o=function(n,t,i,r,u,f,e){var o=n.a(1,e);return o.activeCell=t,o.searchQuery=i,_Ewa.l.a(n,"SearchLinkedEntity",o,r,u,f,4,null,null)};_Ewa.dR.k=function(n,t,i,r,u,f,e){var o=n.a(1,e);return o.activeCell=t,o.isBackward=i,_Ewa.l.a(n,"MoveToNextAmbiguousLinkedEntity",o,r,u,f,4,null,null)};_Ewa.dR.b=function(n,t,i,r,u,f){var e=n.a(9,f);return e.activeCell=t,_Ewa.l.a(n,"CancelSearchLinkedEntity",e,i,r,u,4,null,null)};_Ewa.dR.e=function(n,t,i,r,u,f,e){var o=n.a(1,e);return o.selectedRanges=t,o.letyDomainId=i,_Ewa.l.a(n,"GetDataTypeSelectorData",o,r,u,f,4,null,null)};_Ewa.dR.f=function(n,t,i,r,u){var f=n.a(1,u);return _Ewa.l.a(n,"GetHasUntrustedImageUrls",f,t,i,r,4,null,null)};_Ewa.dR.i=function(n,t,i,r,u){var f=n.a(1,u);return _Ewa.l.a(n,"LinkedEntitiesEnableUntrustedImages",f,t,i,r,0,null,null)};_Ewa.dR.j=function(n,t,i,r,u){var f=n.a(1,u);return _Ewa.l.a(n,"LinkedEntityTryAutoRefresh",f,t,i,r,0,null,null)};_Ewa.GN=function(n,t){this.g=Function.createDelegate(this,this.m);this.e=Function.createDelegate(this,this.l);this.f=Function.createDelegate(this,this.k);this.b=n;this.a=t};_Ewa.GN.prototype={b:null,a:null,d:!1,c:!1,i:function(){this.d||(Diag.a.a(571274630,0,50,"GetRecentlyUsedLinkedDataTypesFromRoamingService - Invoking the GetRecentlyUsedDataTypes operation."),_Ewa.l.R(this.b.d().a(),0,this.f,this.e,null))},h:function(n){if(!n||!n.length){Diag.a.a(571274629,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Tried writing an empty list of data types.");return}if(!this.d){this.c=!0;return}var t=this.o(n);if(!t||!t.length){Diag.a.a(571274628,0,15,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Created an empty serialized string.");return}Diag.a.a(571274627,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Invoking the WriteRecentlyUsedDataTypes operation.");_Ewa.l.bb(this.b.d().a(),0,t,this.g,this.e,null)},o:function(n){var u,i,r,t,e;if(!n||!n.length)return Diag.a.a(571274626,0,15,"SerializeRecentlyUsedLinkedDataTypes - Received an empty list of data types."),null;u=[];for(var o=n,s=o.length,f=0;f<s;++f)i=o[f],r={},r.Id=i.Id,i.StringId&&(r.StringId=i.StringId),u.push(r);return(t=new Sys.StringBuilder,t.append("<DataTypes>"),t.append(_Ewa.D.a(u)),t.append("<\/DataTypes>"),e=t.toString(),e.length>1906)?(Diag.a.a(571274625,0,15,"SerializeRecentlyUsedLinkedDataTypes - Exceeded the MaxSize for ridExcelRecentlyUsedLinkedDataTypes."),null):e},n:function(n){var t,i;if(!n||!n.length)return Diag.a.a(571274624,0,15,"ParseRecentlyUsedLinkedDataTypes - Received an empty roamingXml."),null;if(!n.startsWith("<DataTypes>")||!n.endsWith("<\/DataTypes>"))return Diag.a.a(571274595,0,15,"ParseRecentlyUsedLinkedDataTypes - Received a string without a prefix/postfix."),null;if(t=n.substring(11,n.length-12),!t||!t.length)return Diag.a.a(571274594,0,15,"ParseRecentlyUsedLinkedDataTypes - Created an empty substring."),null;i=[];try{i=_Ewa.D.b(t)}catch(r){return Diag.a.a(571274593,0,10,"ParseRecentlyUsedLinkedDataTypes - Encountered an exception. Message: {0}",r.message),null}return Diag.a.a(571274592,0,50,"ParseRecentlyUsedLinkedDataTypes returned {0} data types.",i.length),i},j:function(n){var t=this.a.k(),u=this.a.Q(),i,r;if(t.length!==u){for(i=0;i<n.length&&t.length<u;++i)(r=n[i],this.a.P(r)&&!Array.contains(t,r))&&t.push(r);this.a.S(t)}},k:function(n){var t,i;if(Diag.a.a(571274591,0,50,"OnReadRoamingStringSuccess called."),this.d=!0,_Ewa.j.c(n.Errors)){Diag.a.a(571274590,0,10,"OnReadRoamingStringSuccess encountered an error. Errors: {0}",_Ewa.j.a(n.Errors,","));return}if(n.Result){if(t=n.Result,!t||!t.length){Diag.a.a(571274589,0,50,"OnReadRoamingStringSuccess - Received an empty roamingXml.");return}(i=this.n(t),i&&i.length)&&(this.j(i),this.a.R(),this.c&&(this.h(this.a.k()),this.c=!1))}},m:function(n){if(Diag.a.a(571274588,0,50,"OnWriteRoamingStringSuccess called."),_Ewa.j.c(n.Errors)){Diag.a.a(571274587,0,10,"OnWriteRoamingStringSuccess encountered an error. Errors: {0}",_Ewa.j.a(n.Errors,","));return}if(n.Result){var t=n.Result;if(!t){Diag.a.a(571274586,0,15,"OnWriteRoamingStringSuccess - Failed to write to the roaming service.");return}}},l:function(n,t,i){var r=_Ewa.Y.a(n.b);Diag.a.a(571274585,0,10,"OnRoamingOperationFailure: Encountered errors for {0}. Errors: {1}.",i,_Ewa.j.a(r,","))}};_Ewa.GL=function(n){_Ewa.GL.initializeBase(this,[n])};_Ewa.GL.prototype={dispose:function(){Common.App.Enrichment.g.prototype.dispose.call(this)}};_Ewa.lM=function(n,t,i){this.m=Function.createDelegate(this,this.p);this.b=this.cx;this.d=this.cw;_Ewa.lM.initializeBase(this,[n,null]);this.j=t;this.l=i;_Ewa.bm.a(t).a(this);this.j.G(this.m)};_Ewa.lM.a=function(n,t){var u=n.m(),i=document.getElementById(u+"m_enrichmentTaskPane"),f,r,e;return i||(i=CommonUI.a.a("div",n.m()+"m_enrichmentTaskPane","cui-taskpane"),n.a(1029)||(f=document.getElementById(u+"novTaskpaneBody"),f.appendChild(i))),r=n.b(),e=r.a(_Ewa.lM,257,!1,null)||r.b(_Ewa.lM,257,new _Ewa.lM(i,n,t)),e};_Ewa.lM.prototype={l:null,t:function(n){this.get_events().addHandler("EnrichmentTaskPaneRemoved",n)},y:function(n){this.get_events().removeHandler("EnrichmentTaskPaneRemoved",n)},e:function(n){this.cy("EnrichmentTaskPaneOnFocus",n)},f:function(n){this.cC("EnrichmentTaskPaneOnFocus",n)},cx:function(){return _Ewa.bau.prototype.cx.call(this)},cw:function(n){return _Ewa.bau.prototype.cw.call(this,n),this.ct("EnrichmentTaskPaneVilibilityChanged",null),n},bB:function(){return this.cx()},bl:function(){return"ETP"},a:function(){return 10},u:function(){return"ewanov_linkedrecordPane"},v:function(){return"Enrichment"},V:function(){return"Enrichment"},i:function(){return 300},o:0,w:function(){return this.o},X:function(n){return this.o=n,n},U:function(){return!1},B:function(){return this.cr()},k:!1,j:null,n:function(){},T:function(){},g:function(){return this.k},h:function(){return this.k},x:function(){},dispose:function(){this.j&&this.j.H(this.m);this.j=null;this.l=null;_Ewa.bau.prototype.dispose.call(this)},K:function(n,t){return t||this.ct("EnrichmentTaskPaneOnFocus",null),!t},dR:function(n){return _Ewa.a.f(this.B(),n)},cJ:function(){},bL:function(){},c:function(n){this.k=n;var t=this.l;this.cw(n);n&&t.d().length>0&&(!t.a()||t.a().a().a()!==10||t.e())&&t.c(_Ewa.lM,this,!0);t.b();n||(_Ewa.b.a(this.j).K(!0,!1),this.j.v())},W:function(){return!1},p:function(){this.c(!1)}};_Ewa.uV=function(n){_Ewa.uV.initializeBase(this);this.h=n;this.l()};_Ewa.uV.a=function(n){n.b().b(_Ewa.bgS.$$(_Ewa.qO),258,new _Ewa.uV(n))};_Ewa.uV.prototype={m:null,n:null,p:function(){if(!this.m){var n=this;this.m=_Ewa.g.a(_Ewa.cn.a(this.h),function(t){n.n=_Ewa.lM.a(n.h,t.a())},this.i(),3,null,null)}return this.m},h:null,b:function(){var t=_Ewa.n.a(Sys.IDisposable,this.h.b(),203,this.i(),this.j,null),i=_Ewa.n.a(Object,this.h.b(),155,this.i(),this.j,null),r=this,n=this;_Ewa.g.a(_Ewa.g.ts(_Ewa.g.b([t,i],this.i(),3),function(){return r.p()},this.i(),3,null),function(){n.k(n.n)},this.i(),3,null,null)},dispose:function(){this.h=null;this.m=null;this.n=null;_Ewa.rR.prototype.dispose.call(this)}};_Ewa.GK=function(n){_Ewa.GK.initializeBase(this,[Common.a.b().d(),Common.a.b().f(),Common.a.b().k(),Common.a.b().b(),Common.a.c()]);this.f=n;this.f.e(this.t)};_Ewa.GK.prototype={f:null,B:function(){return this.f.B()},E:function(){this.f.b()||this.f.c(!0)},D:function(){this.f.c(!1)},dispose:function(){this.f&&(this.f.f(this.t),this.f=null);Common.App.Enrichment.a.prototype.dispose.call(this)}};_Ewa.DP=function(n,t,i,r,u){_Ewa.DP.initializeBase(this,[!1]);this.c=n;this.a=r.c(n,t,i,"",_Ewa.u.a(11),u,"AutoDetectPointerDown",_Ewa.ClientStringManager.a().a(1629)+"...")};_Ewa.DP.prototype={c:null,a:null,b:function(){return this.a.c()},dispose:function(){this.a.dispose();this.c=null;_Ewa.bdj.prototype.dispose.call(this)},f:function(n){return this.a.b(n)},e:function(n){return this.a.d(n,!1)},i:function(n,t,i,r){this.a.l(_Ewa.tH.a(n),t,r,!1);this.a.k(i,t,r,!1)},g:function(n,t){var r=_Ewa.b.a(this.c),u=r.f().d(n),i=r.x(n,u,!1,!1),f=r.n(u).P(),h;if(i&&i.a.a>=0&&i.a.b>=0&&f.c()>i.c()+160){var e=i.b.a+this.b(),o=i.a.b+this.b(),s=!1;if(e+160>f.b.a&&(e=i.a.a-this.b(),s=!0),h=o<f.a.b+this.b(),h){if(r.f().m()){this.d();return}o=f.a.b+this.b()}this.a.g(t,"AutoDetectHover",u);this.h(e,o,r.d(),u,s)}else this.d()},h:function(n,t,i,r,u){this.a.a(n,t,i,r,!1,u)},d:function(){this.a.e()}};_Ewa.DQ=function(n,t){this.i=t;this.c=n};_Ewa.DQ.prototype={i:null,c:null,b:null,d:null,a:null,h:null,g:null,f:null,e:null,k:function(){var t=this.l(),n=this;_Ewa.gd.a(_Ewa.gy,this.i,243,242,0,function(i){n.b=i;i.f(n.c,2,t,!1,!0)},null)},j:function(){this.b&&this.b.b(-1,-1,this.c)},l:function(){var n={};return n.layoutId="AutoDetectTooltip",n.description=this.a,n.convertToDomainName=this.d,n.longDescription=this.a,n.urlValue=this.h,n.imageAltText=this.g,n.helpText=this.f,n.helpId=this.e,n}};_Ewa.tH=function(n,t,i,r){this.x=Function.createDelegate(this,this.U);this.w=Function.createDelegate(this,this.T);this.v=Function.createDelegate(this,this.D);this.t=Function.createDelegate(this,this.R);this.y=Function.createDelegate(this,this.W);this.u=Function.createDelegate(this,this.S);this.q=Function.createDelegate(this,this.V);this.E=Function.createDelegate(this,this.Q);this.G=Common.c.d();_Ewa.tH.initializeBase(this,[!1]);this.a=n;this.j=n.a(841);t||Diag.a.a(574681089,0,15,"AutoDetectManager: SVG icons are enabled, but svgIconProvider is null");this.e=r;r.h();this.d=new _Ewa.DP(n,t,this.E,i,"");this.z=new _Ewa.DR(this.a,r);this.b=_Ewa.b.a(this.a);this.b.a().l(this.q);this.b.g().p(this.q);this.b.w(this.u);n.G(this.y);n.S(this.t);this.m=$$as(_Ewa.gJ,this.b.b());this.f=n.r().be;this.r()};_Ewa.tH.a=function(n){return _Ewa.ClientStringManager.a().a(1629)+" "+n};_Ewa.tH.prototype={e:null,z:null,d:null,b:null,m:null,a:null,f:null,i:-1,l:null,g:-1,k:!1,p:!1,s:!1,o:!1,h:!1,c:null,j:!1,N:function(){return this.d.f(1)},F:function(){var n=this.d.f(1);return n?_Ewa.a.d(n):!1},B:function(){if(this.a.k()&&this.a.a(163)&&this.a.a(166)){var n=new _Ewa.bW(this.a.e());if(n.c())return!1}return this.g!==-1},dispose:function(){if(this.b&&this.b.a().m(this.q),this.a){var n=this.a;n.H(this.y);n.U(this.t);_Ewa.b.a(n).y(this.u)}System.a.a(this.d);this.d=null;this.b=null;this.a=null;this.f=null;_Ewa.bdj.prototype.dispose.call(this)},n:function(){this.D(null,!1);this.i=-1;this.d.d();this.Y();this.h=!1},I:function(){this.d.e(1).a();this.h=!1},J:function(){this.d.e(1).b();this.L(this.l);this.h=!0;var n=this;this.a.b().c(_Ewa.cu,211,function(n){n.a(_Ewa.ClientStringManager.a().a(1571))},null)},H:function(){this.B()&&this.i!==-1&&this.e.I()},M:function(n,t){for(var r,f,e=new _Ewa.q(n.a===1?1:n.a-1,n.b,n.d,n.c,!0,!1),o=this.b.E(e),u=o,s=u.length,i=0;i<s;++i)if(r=u[i],_Ewa.iR.isInstanceOfType(r)&&(f=r,this.C(n,t,f)))return!0;return!1},A:function(){if(this.B()&&this.i!==-1){this.d.e(1).b();var n={};n.Id=this.g;n.StringId=null;this.e.f(n,!0,this.l);Diag.a.a(594612633,0,50,"AutoDetectManager.Convert (AssistedAutoConvertMenuConvertClicked)");this.g=-1}},O:function(){var n=new Sys.StringBuilder(_Ewa.ClientStringManager.a().a(1567));if(this.g!==-1){n.append(" ");try{n.append(this.e.g(this.g.toString()))}catch(t){Diag.a.a(593847515,0,10,"AutoDetectManager.GetButtonAccessibilityString: Could not obtain name from domain {0}",this.g)}}return n.append(" "),this.j?n.append(_Ewa.ClientStringManager.a().a(1570)):n.append(_Ewa.ClientStringManager.a().a(this.G?1569:1568)),n.toString()},V:function(){this.B()&&this.b&&this.r()},W:function(){this.n()},Q:function(){this.A();_Ewa.b.a(this.a).K(!0,!1)},D:function(n,t){if(t)this.L(this.l),this.K();else{var i=[29];this.b.l().a(i);this.b.l().b(null,i,!0);this.c&&this.c.j()}},K:function(){if(this.j){this.c||(this.c=new _Ewa.DQ(this.N(),this.a),this.c.d=_Ewa.ClientStringManager.a().a(1572),this.c.h="https://support.content.office.net/en-us/media/758743e7-a2ca-42db-9f43-a45b05b1b077.png",this.c.g=_Ewa.ClientStringManager.a().a(1574),this.c.e="HID_DataTypes_Wolfram",this.c.f=_Ewa.ClientStringManager.a().a(1573));var n=this.i.toString();this.c.a=this.e.j(n);this.c.k()}},R:function(){this.P()&&this.d.d();var n=this.b.a().c();n===1&&this.r()},S:function(){var n=this.b.a().a().a(),t=this.b.a().c();n&&t===1&&this.r()},C:function(n,t,i){var f=new _Ewa.q(i.a,i.b,i.d===1048576?i.d:i.d+1,i.c,!0,!1),r;if(f.i(n)){if(t){if(r=i,r&&r.q!==this.i){this.i=r.q;var u=r.q.toString(),e=this.j?"":this.e.j(u),o=this.e.C(u);this.d.i(this.e.g(u),e,o,1)}this.g=r.q;this.l=i}return!0}return!1},r:function(){var r,t;if(this.e){var s=!!this.m&&this.m.H(),h=this.b.a().a().k(),u=this.b.a().c(),f=this.a.a(654);if(!s||!h&&!f){this.n();return}for(var n=this.b.a().a().a(),c=this.m.h(n,!1),e=_Ewa.c.a("OfficeVSO:4817126_HideAutoDetectOOUIOnRowColHide")&&!c,l=this.b.r(),a=this.b.E(l),o=a,v=o.length,i=0;i<v;++i)if(r=o[i],_Ewa.iR.isInstanceOfType(r))if(t=r,f)switch(t.t){case 3:if(this.C(n,!0,t)){if(u!==1||e){this.n();return}Diag.a.a(593831632,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (AssistedAutoConvertTriggered)");this.X();this.d.g(n,this.v);this.k||(this.k=!0,this.H());return}break;case 2:case 1:(this.a.a(656)||this.a.a(657))&&this.z.f(t);break;default:Diag.a.a(593266063,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (Invalid LinkedEntityClassifierTrigger used)")}else{if(u!==1||e){this.n();return}if(this.C(n,!0,t)){Diag.a.a(594612634,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (AssistedAutoConvertTriggered)");this.d.g(n,this.v);this.k||(this.k=!0,this.H());return}}this.n()}},L:function(n){var t=[29];this.b.l().b(n,t,!0);this.b.l().c(t,null,null)},P:function(){return this.a.c().b()&&_Ewa.C.a(this.a.j())},U:function(n){if(!this.F())return this.p=!1,!1;if(this.p)return!1;var t=n.a.keyCode;return t===17&&this.s?(this.h?(this.K(),this.I()):this.J(),!0):!1},T:function(n){if(!this.F())return this.p=!1,!1;this.s=!1;this.p=n.i();var t=n.a.keyCode;switch(t){case 27:return this.h?(this.D(null,!1),this.I()):this.c&&(this.c.j(),this.J()),!0;case 13:if(this.h)return this.h=!1,this.A(),!0;break;case 17:return this.s=!0,!0}return!1},X:function(){this.j&&!this.o&&this.f&&(this.f.g("keydown",this.a.q(),this.w,!0),this.f.g("keyup",this.a.q(),this.x,!0),this.o=!0)},Y:function(){this.j&&this.o&&this.f&&(this.f.i("keydown",this.a.q(),this.w,!0),this.f.i("keyup",this.a.q(),this.x,!0),this.o=!1)}};_Ewa.tI=function(n,t){this.c=Function.createDelegate(this,this.f);_Ewa.tI.initializeBase(this,[!1]);this.b=n;this.d=t;this.a=document.createElement("div");this.a.className="clip16x16";this.e=String.format('<input type="image" id="{0}" class="{1}" src="{2}" alt="Convert To Linked Entities Column Header Button">',Common.d.b("autodetectid"+this.b.b),"ewadata_ConvertToEntityIcon16",_Ewa.u.a(11));this.a.innerHTML=this.e;var i=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");Common.i.a().a("click",i,this.c)};_Ewa.tI.prototype={e:"",d:null,b:null,a:null,dispose:function(){if(this.a){var n=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");Common.i.a().b("click",n,this.c)}_Ewa.bdj.prototype.dispose.call(this)},f:function(n){if(n.c.id===this.a.firstChild.id){var t=this.b,i={};return i.Id=t.q,this.d.f(i,!0,t),this.a.removeChild(this.a.firstChild),!0}return!1}};_Ewa.DR=function(n,t){_Ewa.DR.initializeBase(this,[!1]);this.d=n;this.b=_Ewa.b.a(n);this.c=t;this.a=new($$sc.r.$$(_Ewa.tI))};_Ewa.DR.prototype={d:null,b:null,c:null,a:null,dispose:function(){_Ewa.bdj.prototype.dispose.call(this)},f:function(n){for(var r=this.b.bn().$$ge(),u,t;r.$$mn();)for(u=r.$$cu(),t=u.$$ge();t.$$mn();){var i=t.$$cu(),e=i.b(),f=_Ewa.qI.a(i.e());this.e(n,f,e);i.l(f)}},e:function(n,t,i){var u,f,r;if(t.length&&(u=i.length,!(i[u-1]<n.b))&&(f=_Ewa.i.f(new _Ewa.dn(i),0,u,n.b,_Ewa.i.h),!(f<0))&&(r=t[f],r)){this.b.d()?Sys.UI.DomElement.addCssClass(r,"ewr-autodetect-column-rtl"):Sys.UI.DomElement.addCssClass(r,"ewr-autodetect-column-ltr");this.a.c(n.b)||this.a.d(n.b,new _Ewa.tI(n,this.c));var e=this.a.a(n.b),o=e.a,s=r.getElementsByClassName("clip16x16");!s.length&&this.g(r)&&r.appendChild(o)}},g:function(n){var u=parseInt(n.style.width),i=this.d.b().a(_Ewa.cU,268,!1,null),r,t;if(!i)return Diag.a.a(593266065,0,15,"AutoDetectColumnHeaderManager.SpaceExistsForAutoDetectButton IInstantaneousSupportInformationManager not initialized in time for rendering Auto Detect Column Header Button"),!0;if(r=i?i.b():null,!r)return Diag.a.a(593266064,0,15,"AutoDetectColumnHeaderManager.SpaceExistsForAutoDetectButton NumberFormattingCalculator not initialized in time for rendering Auto Detect Column Header Button"),!0;t={};t.fontVariant="normal";t.fontStyle="normal";t.fontFamily='"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif';t.fontSize="10pt";t.fontWeight=document.querySelector(".ewrch-col-cellsel")?"bold":"normal";t.lineHeight="normal";t.letterSpacing="0px";var f=r.calculateTextWidth(n.firstChild.innerHTML,t),e=u-(u/2+f/2);return e>16*.9+4?!0:!1}};_Ewa.GI.registerClass("_Ewa.GI",null,_Ewa.kR);_Ewa.uT.registerClass("_Ewa.uT",_Ewa.bg);_Ewa.GM.registerClass("_Ewa.GM");_Ewa.GJ.registerClass("_Ewa.GJ",null,Sys.IDisposable);_Ewa.eV.registerClass("_Ewa.eV",_Ewa.cb,_Ewa.dS,Common.App.Enrichment.m,Sys.IDisposable,_Ewa.bbV);_Ewa.uU.registerClass("_Ewa.uU",_Ewa.rR.$$(_Ewa.dS));_Ewa.GL.registerClass("_Ewa.GL",Common.App.Enrichment.g);_Ewa.lM.registerClass("_Ewa.lM",_Ewa.bau,_Ewa.qO,Sys.IDisposable,_Ewa.LH,_Ewa.oj);_Ewa.uV.registerClass("_Ewa.uV",_Ewa.rR.$$(_Ewa.qO));_Ewa.GK.registerClass("_Ewa.GK",Common.App.Enrichment.a);_Ewa.DP.registerClass("_Ewa.DP",_Ewa.bdj);_Ewa.DQ.registerClass("_Ewa.DQ");_Ewa.tH.registerClass("_Ewa.tH",_Ewa.bdj);_Ewa.tI.registerClass("_Ewa.tI",_Ewa.bdj);_Ewa.DR.registerClass("_Ewa.DR",_Ewa.bdj);Type.registerNamespace("_Ewa");_Ewa.bbS=function(){};_Ewa.bbS.a=function(){_Ewa.m.a(function(n){_Ewa.uV.a(n);_Ewa.uU.a(n);_Ewa.uT.a(n)})};_Ewa.bbS.a();