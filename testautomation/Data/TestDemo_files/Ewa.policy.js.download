Type.registerNamespace("Common.App.Policy.Contracts");Common.App.Policy.Contracts.n=function(){};Common.App.Policy.Contracts.n.registerInterface("Common.App.Policy.Contracts.n");Common.App.Policy.Contracts.a=function(){};Common.App.Policy.Contracts.a.prototype={"default":0,auto:1,recommended:2,manual:3,mandatory:4};Common.App.Policy.Contracts.a.registerEnum("Common.App.Policy.Contracts.a",!1);Common.App.Policy.Contracts.b=function(){};Common.App.Policy.Contracts.b.prototype={standard:0,privileged:1};Common.App.Policy.Contracts.b.registerEnum("Common.App.Policy.Contracts.b",!1);Common.App.Policy.Contracts.i=function(){};Common.App.Policy.Contracts.i.prototype={unknown:0,boot:1,refresh:2,selfSetPolicyLabel:3};Common.App.Policy.Contracts.i.registerEnum("Common.App.Policy.Contracts.i",!1);Common.App.Policy.Contracts.c=function(){};Common.App.Policy.Contracts.c.registerInterface("Common.App.Policy.Contracts.c");Common.App.Policy.Contracts.d=function(){};Common.App.Policy.Contracts.d.prototype={none:0,reasonDefaultLabel:1,reasonManual:2,reasonAutomatic:4,reasonRecommended:8,reasonMandatory:16};Common.App.Policy.Contracts.d.registerEnum("Common.App.Policy.Contracts.d",!1);Common.App.Policy.Contracts.g=function(n,t,i){this.a=n.Id;i||(i="");this.d=t;this.c=i;this.b=n};Common.App.Policy.Contracts.g.prototype={a:null,c:null,d:!1,b:null};Common.App.Policy.Contracts.m=function(){this.AreLabelsAvailable=!1;this.AppliedPolicyId="";this.RequiredDowngradeJustification=!1;this.DefaultLabelId="";this.PolicyLabelAssignmentMethod="";this.PolicyLabelVersionToken="";this.SensitivityLabels=new Array(0);this.MandatoryLabelingEnforced=!1};Common.App.Policy.Contracts.m.prototype={AreLabelsAvailable:!1,AppliedPolicyId:null,RequiredDowngradeJustification:!1,MandatoryLabelingEnforced:!1,DefaultLabelId:null,CustomUrl:null,PolicyLabelAssignmentMethod:null,PolicyLabelVersionToken:null,SensitivityLabels:null};Common.App.Policy.Contracts.v=function(){this.Id="";this.Enabled=!1;this.Name="";this.DisplayName="";this.Order=0;this.Tooltip="";this.IsEndpointProtectionEnabled=!1;this.ParentId="";this.RequiredDowngradeJustification=!1;this.LabelActions=new Array(0);this.AutoLabelingSensitiveTypeIds=new Array(0)};Common.App.Policy.Contracts.v.prototype={Id:null,Enabled:!1,Name:null,DisplayName:null,Order:0,Tooltip:null,IsEndpointProtectionEnabled:!1,ParentId:null,RequiredDowngradeJustification:!1,LabelActions:null,AutoLabelingSensitiveTypeIds:null};Common.App.Policy.Contracts.u=function(){this.Name="";this.Font="";this.FontSize=0;this.FontColor="";this.Text="";this.Margin=0;this.Alignment="";this.Placement=""};Common.App.Policy.Contracts.u.prototype={Name:null,Font:null,FontSize:0,FontColor:null,Text:null,Margin:0,Alignment:null,Placement:null};Common.App.Policy.Contracts.q=function(n,t,i,r){Common.App.Policy.Contracts.q.initializeBase(this);this.d=n;this.c=t;this.a=i;this.b=r};Common.App.Policy.Contracts.q.prototype={c:null,d:null,a:null,b:null};Common.App.Policy.Contracts.j=function(n){Common.App.Policy.Contracts.j.initializeBase(this);this.a=n};Common.App.Policy.Contracts.j.prototype={a:!1};Common.App.Policy.Contracts.h=function(n){Common.App.Policy.Contracts.h.initializeBase(this);this.a=n};Common.App.Policy.Contracts.h.prototype={a:0};Common.App.Policy.Contracts.t=function(n){Common.App.Policy.Contracts.t.initializeBase(this);this.a=n};Common.App.Policy.Contracts.t.prototype={a:0};Common.App.Policy.Contracts.s=function(n,t){Common.App.Policy.Contracts.s.initializeBase(this);this.b=n;this.a=t};Common.App.Policy.Contracts.s.prototype={b:null,a:0};Common.App.Policy.Contracts.f=function(n,t,i,r,u,f){Common.App.Policy.Contracts.f.initializeBase(this);this.f=n;this.e=t;this.d=i;this.a=r;this.b=u;this.c=f};Common.App.Policy.Contracts.f.prototype={f:0,e:null,d:null,a:null,b:null,c:!1};Common.App.Policy.Contracts.k=function(n,t){Common.App.Policy.Contracts.k.initializeBase(this);this.b=n;this.a=t};Common.App.Policy.Contracts.k.prototype={b:0,a:!1};Common.App.Policy.Contracts.l=function(n,t,i,r,u){Common.App.Policy.Contracts.l.initializeBase(this);this.e=n;this.d=t;this.c=i;this.a=r;this.b=u};Common.App.Policy.Contracts.l.prototype={e:0,d:null,c:null,b:null,a:null};Common.App.Policy.Contracts.r=function(){Common.App.Policy.Contracts.r.initializeBase(this)};Common.App.Policy.Contracts.o=function(n,t){Common.App.Policy.Contracts.o.initializeBase(this);this.b=n;this.a=t};Common.App.Policy.Contracts.o.prototype={b:null,a:0};Common.App.Policy.Contracts.e=function(n,t,i){Common.App.Policy.Contracts.e.initializeBase(this);this.a=n;this.c=t;this.b=i};Common.App.Policy.Contracts.e.prototype={a:0,b:!1,c:0};Common.App.Policy.Contracts.p=function(n,t){this.a=n;this.b=t};Common.App.Policy.Contracts.p.prototype={a:0,b:null};Common.App.Policy.Contracts.w=function(){this.IsSuccessful=!1;this.FailureReason=""};Common.App.Policy.Contracts.w.prototype={IsSuccessful:!1,FailureReason:null};Common.App.Policy.Contracts.g.registerClass("Common.App.Policy.Contracts.g");Common.App.Policy.Contracts.m.registerClass("Common.App.Policy.Contracts.m");Common.App.Policy.Contracts.v.registerClass("Common.App.Policy.Contracts.v");Common.App.Policy.Contracts.q.registerClass("Common.App.Policy.Contracts.q",Sys.EventArgs);Common.App.Policy.Contracts.j.registerClass("Common.App.Policy.Contracts.j",Sys.EventArgs);Common.App.Policy.Contracts.h.registerClass("Common.App.Policy.Contracts.h",Sys.EventArgs);Common.App.Policy.Contracts.t.registerClass("Common.App.Policy.Contracts.t",Sys.EventArgs);Common.App.Policy.Contracts.s.registerClass("Common.App.Policy.Contracts.s",Sys.EventArgs);Common.App.Policy.Contracts.f.registerClass("Common.App.Policy.Contracts.f",Sys.EventArgs);Common.App.Policy.Contracts.k.registerClass("Common.App.Policy.Contracts.k",Sys.EventArgs);Common.App.Policy.Contracts.l.registerClass("Common.App.Policy.Contracts.l",Sys.EventArgs);Common.App.Policy.Contracts.r.registerClass("Common.App.Policy.Contracts.r",Sys.EventArgs);Common.App.Policy.Contracts.o.registerClass("Common.App.Policy.Contracts.o",Sys.EventArgs);Common.App.Policy.Contracts.e.registerClass("Common.App.Policy.Contracts.e",Sys.EventArgs);Common.App.Policy.Contracts.p.registerClass("Common.App.Policy.Contracts.p");Type.registerNamespace("Common.App.Policy");Common.App.Policy.j=function(n,t,i){this.IsPolicyTipAvailable=n;this.GeneralText=t;this.NavigateUrl=i};Common.App.Policy.i=function(){};Common.App.Policy.e=function(){};Common.App.Policy.c=function(n,t,i,r){this.X=Function.createDelegate(this,this.bm);this.Y=Function.createDelegate(this,this.bt);this.I=Function.createDelegate(this,this.by);this.J=Function.createDelegate(this,this.bz);this.H=Function.createDelegate(this,this.bx);this.K=Function.createDelegate(this,this.bB);this.E=Function.createDelegate(this,this.bv);this.L=Function.createDelegate(this,this.bD);this.G=Function.createDelegate(this,this.bw);this.D=Function.createDelegate(this,this.bq);this.Z=Function.createDelegate(this,this.bu);this.F=Function.createDelegate(this,this.bc);this.c=n;this.e=t;this.f=i;this.b=r;this.l={};this.A={};this.z={};this.s=i.a("WacApplyManualPolicyLabelIsEnabled");this.v=i.a("ClpKpiIsEnabled");this.b.a().k(this.F);this.b.a().e(this.F);this.b.a().d(this.Z);i.a("SupportsPolicies")&&i.b("AppliedPolicyId")&&(this.y=i.b("IrmPolicyTitle"),this.r=i.b("IrmPolicyDescription"));this.B=i.a("ProtectedFile");this.M=this.f.c("SetPolicyLabelAwaitFileExistsOnHostMaxRetries",6);this.N=this.f.c("SetPolicyLabelAwaitFileExistsOnHostRetryDelayMs",5e3)};Common.App.Policy.c.a=function(n){return n&&n.length?!1:!0};Common.App.Policy.c.prototype={c:null,e:null,f:null,b:null,y:null,r:null,M:0,N:0,O:!1,Q:!1,B:!1,m:!1,x:!1,v:!1,a:null,j:null,d:null,l:null,A:null,z:null,q:null,i:null,h:null,g:null,k:null,t:0,s:!1,S:function(){return Common.a.cO||!!this.w&&this.w()},u:null,w:null,P:null,be:function(){this.c.a(3427834559,2147483648,this.D);this.c.a(497870830,2147483648,this.G);this.c.a(941487903,2147483648,this.L);this.c.a(1145315516,2147483648,this.E);this.c.a(2935633379,2147483648,this.K);this.c.a(3134802707,2147483648,this.H);this.c.a(991261903,2147483648,this.J);this.c.a(2875864574,2147483648,this.I);this.n(941487903)||this.c.f(941487903,4);this.n(1145315516)||this.c.f(1145315516,4);this.n(2935633379)||this.c.f(2935633379,4);this.n(3134802707)||this.c.f(3134802707,4);this.n(991261903)||this.c.f(991261903,4);this.n(2875864574)||this.c.f(2875864574,4);this.e.e(!1)},bE:function(){this.c.e(3427834559,2147483648,this.D);this.c.e(497870830,2147483648,this.G);this.c.e(941487903,2147483648,this.L);this.c.e(1145315516,2147483648,this.E);this.c.e(2935633379,2147483648,this.K);this.c.e(3134802707,2147483648,this.H);this.c.e(991261903,2147483648,this.J);this.c.e(2875864574,2147483648,this.I)},bD:function(){return 32},T:function(n){var t="mandatoryLabelling_"+n.Id;return this.z[t]=n.Id,{type:"AppToggleButtonProps",id:t,label:n.DisplayName,hideLabel:!1,customTooltip:n.Tooltip}},br:function(){var t=[],r=this.j,i,h,c,l;for(i in r){var u={key:i,value:r[i]},f=u.value,n=this.d[u.key];if(n&&n.Enabled)if(f.f.length){for(var e={sections:[],shouldAutoOpen:!1},o={id:"mandatoryLabelling_flyoutMenuSection_"+n.Id,controls:[]},s=f.$$lge();s.$$mn();)h=s.$$cu(),c=this.d[h],Array.add(o.controls,this.T(c));Array.add(e.sections,o);l={type:"AppFlyoutAnchorProps",id:"mandatoryLabelling_"+n.Id,label:n.DisplayName,hideLabel:!1,hideChevron:!1,hideIcon:!1,menuDefinition:e};Array.add(t,this.T(n))}else Array.add(t,this.T(n))}return t},bv:function(n,t,i,r,u){if(i===1||!this.b.a().c())return 32;var f=u,e;return f.MenuItems=(e=new Common.co,e.Id="SensitivityList",e.MenuSectionList=[],e.UpdateDynamically=!0,e),Array.add(f.MenuItems.MenuSectionList,this.bo(!this.o())),this.a.CustomUrl&&Array.add(f.MenuItems.MenuSectionList,this.bn(this.o()?this.a.CustomUrl:Common.d.c(this.a.CustomUrl))),this.o()||(f.PopulationXML=Common.x.f(f.MenuItems)),32},bx:function(n,t,i,r,u){if(i===1||!u||!this.s)return 32;if(this.a=this.b.a().a(),this.b.a().c()){var f=u;f[Common.App.Policy.a.f]=!0;Common.P.a("MipLabelsAvailable",!0,0,null)}return 32},bz:function(n,t,i,r,u){if(i===1||!u)return 32;var f=u,e,o;return f[Common.App.Policy.a.l]=!!(e=f[Common.App.Policy.a.q])&&!!(o=this.l[e])&&o===this.a.AppliedPolicyId,32},by:function(n,t,i,r,u){if(i===1||!u)return 32;var f=u,e,o,s,h=!!(e=f[Common.App.Policy.a.k])&&!!(o=this.l[e])&&!!(s=this.j[o])&&s.c(this.a.AppliedPolicyId);return f[Common.App.Policy.a.m]=h,f[Common.App.Policy.a.l]=h,32},bB:function(n,t,i,r,u){if(i===1||!u)return 32;var f=u,e=f[Common.App.Policy.a.k],o=this.l[e];return this.p(o,f,2)},bj:function(){if(!this.a.MandatoryLabelingEnforced){Diag.a.a(572601945,306,50,"Mandatory labelling not invoked b/c user did not have policy!");return}if(!this.a||!this.a.AreLabelsAvailable){Diag.a.a(572601946,306,50,"Mandatory labelling not invoked b/c there are no sensitivity labels!");return}if(this.a.AppliedPolicyId){Diag.a.a(572601947,306,50,"Mandatory labelling not invoked b/c document already has label!");return}if(this.a.DefaultLabelId&&this.S()){Diag.a.a(572601948,306,50,"Mandatory labelling not invoked b/c default label policy present!");return}if(!Common.a.b()||!Common.a.b().a().e()){Diag.a.a(572641315,306,50,"Mandatory labelling not invoked b/c react dialogs disabled!");return}if(this.Q){Diag.a.a(572601949,306,50,"Mandatory labelling not invoked b/c already attempted in session!");return}this.Q=!0;Common.a.bf=!0;this.b.a().n("",1);var n=this;this.b.a().s(37,$a.gb,$a.bK,$a.gc,function(){n.bs()})},bs:function(){Common.App.Policy.d.b().a(this.br(),this.a.CustomUrl,this.Y)},bt:function(n){this.b.a().F();Common.a.bf=!1;this.b.a().n(this.z[n],2)},ba:function(){return this.f.a("CoAuthForProtectedFilesEnabled")&&this.f.a("SupportsOfficeClientCoauthoring")&&this.f.a("SetPolicyLabelAwaitFileExistsOnHostIsEnabled")&&!!this.P&&this.S()},p:function(n,t,i){var r,u;if(this.v&&this.b.a().v(i),r=i===2||i===8||i===16,this.u&&this.u(n,r))Diag.a.a(42860829,306,15,"SetSensitivity : As app doesn't support changing the label, skipping SetSensitivity call. ApplyLabelFlag : {0}",i),this.e.e(!1);else if(t&&Common.App.Policy.a.c in t&&this.b.a().G(t[Common.App.Policy.a.c]),n)if(this.b.a().m()||this.ba()&&this.x)Diag.a.a(42796168,306,50,"Policy label cannot be set because a set policy label request is already in progress. ApplyLabelFlag: {0}",i),this.e.e(!1),r&&this.C(i,n,!0,$a.iE);else if(this.b.a().t(n))if(r&&this.f.a("WacLabelingJustificationDialogIsEnabled")&&this.a.RequiredDowngradeJustification&&(n===this.a.AppliedPolicyId||this.d[n].RequiredDowngradeJustification)&&!this.q)this.bC(n);else if(this.ba()&&!this.P())this.t<this.M?(Diag.a.a(577356770,306,50,"File does not exist on host, retrying after delay. RetryCount: {0} ApplyLabelFlag: {1}",this.t,i),this.x=!0,this.t++,u=this,$$sc.a.b(this.N).CW(function(){u.x=!1;u.p(n,t,i)})):(Diag.a.a(577356771,306,15,"Policy label cannot be set because maximum retries were reached checking for file existence. ApplyLabelFlag: {0}",i),i!==1&&this.C(i,"",!1,""));else return this.bi(n===this.a.AppliedPolicyId?"":n,this.q,i),32;else Diag.a.a(42796169,306,15,"Policy label cannot be set because the user is in a coauth session. ApplyLabelFlag: {0}",i),this.e.e(!1),r&&this.C(i,n,!0,$a.iD);else Diag.a.a(42796167,306,50,"Policy label cannot be set because the selected policy ID is null. ApplyLabelFlag: {0}",i),this.e.e(!1),r&&this.C(i,"",!1,"");return this.b.a().o(0,i,!1),32},bk:function(n,t,i,r){this.v||Common.m.a().recordKpiUsage("MipAutoClassificationSetLabel",0,"wordclpfc",null);this.f.a("SupportsOfficeClientCoauthoring")&&this.f.a("CoAuthForProtectedFilesIsEnabled")?(this.m=!1,this.a=this.b.a().a(),this.a&&!this.a.AppliedPolicyId?this.m=!0:this.a&&this.a.PolicyLabelAssignmentMethod&&(this.m=this.a.PolicyLabelAssignmentMethod.toUpperCase()===Common.App.Policy.Contracts.b.toString(0).toUpperCase())):this.m=r;var u=Common.App.Policy.c.a(n)?null:this.d[n],f=Common.App.Policy.c.a(t)?null:this.d[t];return f?this.h=new Common.App.Policy.Contracts.g(f,!0,i):(this.b.a().b(29),this.g=null),u?this.i=new Common.App.Policy.Contracts.g(u,!1,null):this.k=null,this.bc(null,null),32},bl:function(n){return this.p(n,null,16)},bg:function(){var t;if(this.d={},this.a=this.b.a().a(),this.a)for(var i=this.a.SensitivityLabels,r=i.length,n=0;n<r;++n)t=i[n],this.d[t.Id]=t},bh:function(){var i,n,e;if(this.j={},this.a=this.b.a().a(),this.a){for(var u=this.a.SensitivityLabels,o=u.length,t=0;t<o;++t)i=u[t],i.ParentId||(this.j[i.Id]=new($$sc.u.$$(String)));for(var f=this.a.SensitivityLabels,s=f.length,r=0;r<s;++r)(n=f[r],n.ParentId&&n.ParentId in this.j)&&(e=this.j[n.ParentId],e.b(n.Id))}},bd:function(){if(!this.s||!this.o()){this.W(!1);return}if(this.a=this.b.a().a(),!this.b.a().c()){this.W(!1);return}this.W(!0);appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("Sensitivity",!1))},W:function(n){n?(Common.cy.d("ribbon","sensitivity",!1),Common.cy.b("ribbon","sensitivity",!1)):Common.cy.c("ribbon","sensitivity",!1)},bf:function(){this.f.a("WacApplyDefaultPolicyLabelIsEnabled")&&(this.O||(this.O=!0,this.a=this.b.a().a(),this.a&&this.a.DefaultLabelId&&!this.a.AppliedPolicyId)&&(Diag.a.a(593774211,306,50,"Default label configured, checking if this is a new file"),this.S()&&(Diag.a.a(593774210,306,50,"Default labeling triggered. DefaultLabel: {0}",this.a.DefaultLabelId),this.p(this.a.DefaultLabelId,null,1))))},bc:function(){var n,t,i,r,u;this.b.a().m()||(n=this.d[this.b.a().a().AppliedPolicyId],this.m&&this.i&&this.k!==this.i.a&&(!n||n.Order<this.i.b.Order)&&(t=this.p(this.i.a,{},4),t!==32?Diag.a.a(50868813,306,10,"ProcessAutoSensitivityLabel: SetSensitivityByPolicyId failed with response: "+t):(this.k=this.i.a,this.g&&(i=this.d[this.g],i&&i.Order<=this.i.b.Order&&(this.b.a().b(29),this.g=null)))),n=this.d[this.b.a().a().AppliedPolicyId],this.h&&this.g!==this.h.a&&(!n||n.Order<this.h.b.Order)&&(r=this.h.a,this.b.a().b(29),u=this,this.b.a().r(29,$a.L,String.format($a.hJ,this.U(this.h.b))+" "+this.h.c,$a.hI,function(){u.p(r,{},8)}),this.g=this.h.a),this.i=null,this.h=null)},bi:function(n,t,i){this.q=t;this.b.a().H(n);this.e.e(!1);var r=this.d[n],u=new Common.App.Policy.Contracts.p(i,this.U(r));this.b.a().I(n,this.q,u)},bm:function(n,t,i){n===1?this.bi(t===this.a.AppliedPolicyId?"":t,i,2):this.e.e(!1)},bC:function(n){var t=new Common.App.Policy.b(n,this.X);t.s()},C:function(n,t,i,r){if(i){var u=new CommonUI.d;u.bm=Common.a.cb;u.C(0);u.D(1,$a.b);u.cg($a.iw,r,null)}this.b.a().o(0,n,!i)},o:function(){return!!this.e&&!!this.e.a()&&this.e.a().f()},V:function(){return!this.e||!this.e.a()?!1:this.e.a().bH()},bq:function(n,t,i){return i===1?32:(i===2,32)},bw:function(n,t,i,r,u){var f,e,s;if(i===1||(this.a=this.b.a().a(),!this.a||!u))return 32;if(f=u,f[Common.App.Policy.a.a]=null,f[Common.App.Policy.a.d]=null,f[Common.App.Policy.a.b]=null,f[Common.App.Policy.a.i]=null,f[Common.App.Policy.a.j]=null,f[Common.App.Policy.a.f]=!1,this.a.AreLabelsAvailable){if(this.a.AppliedPolicyId){e=null;for(var h=this.a.SensitivityLabels,c=h.length,o=0;o<c;++o)if(s=h[o],s.Id.toLowerCase()===this.a.AppliedPolicyId.toLowerCase()){e=s;break}e&&(f[Common.App.Policy.a.a]=f[Common.App.Policy.a.d]=this.U(e),this.V()?f[Common.App.Policy.a.h]=e.Tooltip:f[Common.App.Policy.a.b]=e.Tooltip,this.B=Common.a.t=e.IsEndpointProtectionEnabled)}}else{if(!this.y)return 32;f[Common.App.Policy.a.a]=f[Common.App.Policy.a.d]=this.y;this.r&&(this.V()?f[Common.App.Policy.a.h]=this.r:f[Common.App.Policy.a.b]=this.r)}return f[Common.App.Policy.a.a]&&this.bA(this.B,f),32},U:function(n){return n?this.d?n.ParentId&&this.d[n.ParentId]?this.d[n.ParentId].DisplayName+"\\"+n.DisplayName:n.DisplayName:(Diag.a.a(4282e4,306,15,"Policy ID to Sensitivity label dictionary has not been initialized."),n.DisplayName):""},bA:function(n,t){t[Common.App.Policy.a.i]=Common.a.r;t[Common.App.Policy.a.j]=n?Common.K.b(Common.App.Policy.a.s):Common.K.b(Common.App.Policy.a.u);this.V()&&(t[Common.App.Policy.a.n]=n?Common.App.Policy.a.r:Common.App.Policy.a.t);t[Common.App.Policy.a.f]=!0},bn:function(n){var i=this.R("LearnMoreSection",!0),r="SensitivityLearnMore",t,u=(t=new Common.bL,t.Id=r,t.ExternalId=r,t.MenuItemId=n,t.LabelText=$a.I,t.Command="1959943459",t.Image16by16=Common.a.r,t.Image16by16Class=Common.K.b(Common.App.Policy.a.o),t.Visible=!0,t.Alt=$a.L_LearnMoreTooltip,t.KeyTip="L",t);return Array.add(i.ControlList,u),i},bb:function(n,t,i,r,u,f,e,o){var c="Toggle_"+e+"_"+t,h,s,l;return c="Sensitivity_"+c,h=o?Common.d.c(c):c,l=(s=new Common.dd,s.Id=h,s.ExternalId=h,s.LabelText=o?Common.d.c(i):i,s.Command="2935633379",s.MenuItemId=h,s.QueryCommand="991261903",s.CheckedImage=Common.a.r,s.Visible=!0,s.Alt=o?Common.d.c(r):r,s.IsChecked=u,s.AriaLabel="menuitemradio",s.KeyTip=f,s),this.o()?(l.CheckedImageClass=Common.K.b(Common.App.Policy.a.e),l.ExternalImageId=Common.App.Policy.a.e):l.CheckedImageClass=Common.K.b(Common.App.Policy.a.g),h=c,this.l[h]=n,this.A[n]=h,l},R:function(n,t){var i;return i=new Common.bQ,i.Title="",i.Id=n,i.DisplayMode=Common.App.Policy.a.p,i.ShowMenuSectionSeparator=t,i.ControlsId="Ctrl_"+n,i.ControlList=[],i},bp:function(n,t,i){for(var u=this.R(n+"Sub",!1),f=1,e=t.$$lge(),o,r;e.$$mn();)o=e.$$cu(),r=this.d[o],r&&r.Enabled&&(Array.add(u.ControlList,this.bb(r.Id,r.Name,r.DisplayName,r.Tooltip,r.Id===this.a.AppliedPolicyId,f.toString(),n,i)),f++);return u},bo:function(n){var f=this.R("SensitivitySection",!1),e=1,s=this.j;for(var h in s){var c={key:h,value:s[h]},l=c.value,i=this.d[c.key];if(i&&i.Enabled){if(l.f.length){var o="Sensitivity_"+i.Name,a=n?Common.d.c(o):o,u,t,r=(t=new Common.cH,t.Id=a,t.ExternalId=a,t.LabelText=n?Common.d.c(i.DisplayName):i.DisplayName,t.Command="798637440",t.QueryCommand="2875864574",t.Menu=(u=new Common.co,u.Title="",u.MenuSectionList=[],u.UpdateDynamically=!0,u),t.ImageIsVisible=!1,t.Toggled=!1,t.ImageUsesSpaceWhileInvisible=!0,t.AriaLabel="menuitemradio",t.KeyTip=e.toString(),t);this.o()?r.ExternalImageId=Common.App.Policy.a.e:(r.Image16by16=Common.a.r,r.Image16by16Class=Common.K.b(Common.App.Policy.a.g));Array.add(r.Menu.MenuSectionList,this.bp(o,l,n));Array.add(f.ControlList,r);this.l[r.Id]=i.Id;this.A[i.Id]=r.Id}else Array.add(f.ControlList,this.bb(i.Id,i.Name,i.DisplayName,i.Tooltip,i.Id===this.a.AppliedPolicyId,e.toString(),"",n));e++}}return f},n:function(n){return!!this.c.g(n)&&!!this.c.g(n).a&&!!this.c.g(n).a.length},bu:function(n,t){var i,r;t.a&&this.d&&(i=this.d[this.b.a().a().AppliedPolicyId],i)&&(this.g&&(r=this.d[this.g],r&&r.Order<=i.Order&&(this.b.a().b(29),this.g=null)),this.k&&this.k!==i.Id&&(this.b.a().b(28),this.k=null))}};Common.App.Policy.a=function(){};Common.App.Policy.f=function(n,t,i,r,u,f){this.br=Function.createDelegate(this,this.cf);this.bs=Function.createDelegate(this,this.cg);this.bp=Function.createDelegate(this,this.cc);this.bq=Function.createDelegate(this,this.cd);this.bE=Function.createDelegate(this,this.ca);this.bn=Function.createDelegate(this,this.bZ);this.bo=Function.createDelegate(this,this.cb);this.bF=Function.createDelegate(this,this.ce);this.bQ=Function.createDelegate(this,this.bS);this.J=new Common.ba;this.L=n;this.R=t;this.M=i;this.X=r;this.K=new Common.App.Policy.Contracts.m;this.bk=this.L.b("PolicyHandlerEndpointName")||"PolicyHandler.ashx";this.bg=u;this.bG=f?this.bK(f):this.bK(Common.a.b().a().b());this.bt=n.a("WacApplyManualPolicyLabelIsEnabled");this.ba=n.a("CoAuthForProtectedFilesIsEnabled");this.Q=n.a("SupportsOfficeClientCoauthoring");this.S=n.a("ClpKpiIsEnabled");this.bu=!1;this.bv=3e4;this.by=Common.U.a();n.a("SupportsPolicies")&&Common.P.a("MipSupportsPolicies",!0,0,null);this.ba&&this.Q&&Common.P.a("MipSupportsOfficeClientCoauthoring",!0,0,null)};Common.App.Policy.f.prototype={bk:null,L:null,bw:null,by:null,bi:null,R:null,X:0,W:0,V:0,P:0,O:"",bj:null,N:null,bh:null,bx:null,K:null,bg:null,M:null,bc:null,T:null,U:null,bd:null,bG:null,be:null,ba:!1,S:!1,Y:null,bb:null,bf:!1,h:function(n){this.J.m("PolicyTipEvent",n)},d:function(n){this.J.m("LabelInfoUpdateEvent",n)},k:function(n){this.J.m("SetPolicyLabelEventKey",n)},E:function(n){this.J.n("SetPolicyLabelEventKey",n)},e:function(n){this.J.m("SetPolicyLabelFailureEventKey",n)},D:function(n){this.J.n("SetPolicyLabelFailureEventKey",n)},p:function(n){this.J.m("GetAutoPolicyLabelEventKey",n);this.bf&&(Diag.a.a(51668058,306,15,"GetAutoPolicyLabelHandler was registered after the AutoPolicyLabelHandlerEvent was raised"),this.bN(new Common.App.Policy.Contracts.h(0)))},z:function(n){this.J.n("GetAutoPolicyLabelEventKey",n)},f:function(n){this.J.m("AddAutoPolicyBusinessBarEntryEventKey",n)},x:function(n){this.J.n("AddAutoPolicyBusinessBarEntryEventKey",n)},i:function(n){this.J.m("RemoveAutoPolicyBusinessBarEntryEventKey",n)},B:function(n){this.J.n("RemoveAutoPolicyBusinessBarEntryEventKey",n)},g:function(n){this.J.m("AddMandatoryLabellingBusinessBarEntryEventKey",n)},y:function(n){this.J.n("AddMandatoryLabellingBusinessBarEntryEventKey",n)},j:function(n){this.J.m("RemoveMandatoryLabellingBusinessBarEntryEventKey",n)},C:function(n){this.J.n("RemoveMandatoryLabellingBusinessBarEntryEventKey",n)},q:function(n){this.J.m("MandatoryLabellingAppHandlerEventKey",n)},A:function(n){this.J.n("MandatoryLabellingAppHandlerEventKey",n)},bt:!1,bu:!1,bv:0,Q:!1,bU:function(){var t;if(!this.bw)return!1;for(var i=this.bw.a(),r=i.length,n=0;n<r;++n)if(t=i[n],!t.Capabilities||!t.Capabilities.SupportsClientIsMipTrusted)return!1;return!0},bH:function(){return!!this.be},w:function(n){this.bh=n},bA:function(){return(new Date).getTime()},bS:function(n){if(!this.bH()){var i=n.a(),t=this;i.CW(function(){t.be=i.a();t.be.c(t.bF)})}},ce:function(n,t){t.a===12&&(this.bx?this.bx():this.u(this.O,2,this.N,!0))},l:function(){var n,t,i;this.M&&(this.bc=this.M.a("WebServiceCall","Call Get Policy Endpoint On Server"));n=Common.ch.a(1,1);this.L.a("SendHostAttributionInfoForPolicyLabelEnabled")?(t=new Common.ew(this.Z("datalosspolicy",!1),1,null,null,!0,2,null,null,null,!1,null,null,null,null,!1,null,null,null,null,n),i=this.R.j(t),i.b(this.bo,this.bn)):this.R.a(this.Z("datalosspolicy",!1),1,null,null,!0,2,this.bo,this.bn,null,null,!1,null,null,null,null,!1,null,!1,null);this.W++;Diag.a.a(25565151,306,50,"Policy request is sent to server. The endpoint used is {0}. Policy call times: {1}.",this.bk,this.W)},u:function(n,t,i,r){this.S&&(Common.m.a().recordKpiUsage("MipGetPolicyLabel",0,"officewebclp",this.bB(null,t)),this.Y=this.bA());var u=this.bz(t);this.bm(n,u,i,r,t)},a:function(){return this.K},cb:function(n){this.bL();var t="",i,r;(r=this.bD(n,i={val:t}),t=i.val,r)&&(Diag.a.a(25565153,306,50,"Request to get DataLossPrevention policy succeeded."),this.W=0,this.M&&(this.bd=this.M.a("Task","Parse and Handle Get Policy Response")),this.ch(t),this.bd)&&(this.bd.a(),this.bd=null)},bZ:function(n){if(this.bL(),this.W<=this.X){this.l();return}Diag.a.a(25565154,306,15,"Request to get DataLossPrevention policy failed with error response: {0}.",n?n.b?n.b.k:null:null);this.W=0},m:function(){return this.P>0},H:function(n){this.K.AppliedPolicyId=n},I:function(n,t,i){var r=this.bT(i);this.co(n,t,r,i)},cg:function(n){var t,i,f,e;this.U&&(this.U.a(),this.U=null);this.bJ(n,f={val:t},e={val:i});t=f.val;i=e.val;var r=n.b.f,o=r?r.a:2,u="",s,h;if(!(h=this.bD(n,s={val:u}),u=s.val,h)){this.bC(o,0);return}Diag.a.a(41799707,306,50,"Request to set label policy data succeeded. ApplyLabelFlag: {0}",o);this.P=0;this.cj(u,t,i,r)},v:function(n){this.S&&(Common.m.a().recordKpiUsage("MipSetPolicyLabel",0,"officewebclp",this.bB(n,null)),this.bb=this.bA());Diag.a.a(575947405,306,50,"Raising set policy label triggered event.");this.J.k("SetPolicyLabelTriggeredEventKey",new Common.App.Policy.Contracts.t(n),null)},bY:function(){this.ba&&this.Q&&this.bH()&&this.be.l(12,null,!0)},cf:function(n){var t,i,f,e,r,u;if(this.U&&(this.U.a(),this.U=null),this.bJ(n,f={val:t},e={val:i}),t=f.val,i=e.val,this.P<=this.X){this.I(t,i,null);return}r=n.b.f;u=r?r.a:2;Diag.a.a(41799708,306,15,"Request to set label policy failed with error response: {0}. ApplyLabelFlag: {1}",n?n.b?n.b.k:null:null,u);this.P=0;this.bC(u,0)},t:function(n){var i,r,t;if(!n)return!1;i=null;r=null;for(var f=this.K.SensitivityLabels,e=f.length,u=0;u<e;++u)t=f[u],t.Id===n&&(i=t),t.Id===this.O&&(r=t);if(!i)return!1;if(this.ba&&this.Q){if(this.bh&&this.bh()||this.bU())return!0}else if(Common.a.F&&Common.a.F.a()||this.N&&this.N())return!0;return i.IsEndpointProtectionEnabled===(!!r&&r.IsEndpointProtectionEnabled)},r:function(n,t,i,r,u){n===28?this.bM(new Common.App.Policy.Contracts.f(n,t,i,r,u,!1)):this.bM(new Common.App.Policy.Contracts.f(n,t,i,r,u,!0))},b:function(n){n===28?this.bP(new Common.App.Policy.Contracts.k(n,!1)):this.bP(new Common.App.Policy.Contracts.k(n,!0))},n:function(n,t){var i=t===1?"Reading":"Edit";Diag.a.a(572650527,306,50,"Raising a mandatory labelling"+i+" switch event.");this.J.k("MandatoryLabellingAppHandlerEventKey",new Common.App.Policy.Contracts.o(n,t),null)},s:function(n,t,i,r,u){n===37&&this.ck(new Common.App.Policy.Contracts.l(37,t,i,r,u))},F:function(){this.cm(new Common.App.Policy.Contracts.r)},c:function(){var n=this;return!!this.K&&this.K.AreLabelsAvailable&&!!this.K.SensitivityLabels&&this.K.SensitivityLabels.length>0&&Common.M.a(this.K.SensitivityLabels,function(n){return!!n&&n.Enabled})},cd:function(n){var t,u,f,e,i,r;(this.T&&(this.T.a(),this.T=null),t="",f=this.bD(n,u={val:t}),t=u.val,f)&&(Diag.a.a(34996493,306,50,"Request to get label policy data succeeded."),this.V=0,e=this.ci(t),i=this.bI(n.b),this.S&&(Common.m.a().recordKpiSuccess("MipGetPolicyLabel",this.bl(null,i,this.Y)),this.Y=null),r=new Common.App.Policy.Contracts.h(i),this.cl(r),!this.bf&&e&&this.L.a("WacApplyManualPolicyLabelIsEnabled")&&this.bR()&&(this.bN(r),this.bf=!0))},cc:function(n){var i=this.bI(n.b),t;if(this.S&&(Common.m.a().recordKpiFailure("MipGetPolicyLabel","GetPolicyLabelsFailure",!1,!1,this.bl(null,i,this.Y)),this.Y=null),this.T&&(this.T.a(),this.T=null),this.V<=this.X){if(this.L.a("SendHostAttributionInfoForPolicyLabelEnabled")&&(t=n.b.e.get_headers(),"HostAttributionInfo.ScenarioParamName"in t&&t.hascn&&"HostAttributionInfo.ScenarioTypeParamName"in t&&t.hascnt)){var u=n.b.e.get_headers().hascn,f=n.b.e.get_headers().hascnt,r=this.bz(i);this.bm(this.O,r,this.N,!1,i);return}this.u(this.O,i,this.N,!1);return}Diag.a.a(34996494,306,15,"Request to get label policy failed with error response: {0}.",n?n.b?n.b.k:null:null);this.V=0},bI:function(n){return n.f?n.f:0},Z:function(n,t){var r=this.L.b("PolicyHandlerWebServiceBase")||Common.a.b().a().n(),i=String.format("{0}{1}?action={2}&{3}",r,this.bk,n,Common.a.i);return n==="setpolicylabel"&&Common.a.F&&Common.a.F.c()&&(i=Common.l.a(i,"sl","1",!1)),t&&(i=Common.l.a(i,"cbd","1",!1)),i},bJ:function(n,t,i){t.val=i.val=null;n&&n.a()&&n.a().e&&n.a().e.get_headers()&&(t.val=n.a().e.get_headers()["X-SelectedPolicyLabelId"],i.val=n.a().e.get_headers()["X-SetPolicyLabelJustification"])},bD:function(n,t){return(t.val=n?n.b?n.b.b:null:null,!t.val||!t.val.length||this.bX(t.val))?(Diag.a.a(25565152,306,10,"No response data from policy endpoint."),!1):!0},ch:function(n){var t;try{t=JSON.parse(n)}catch(i){Diag.a.a(37880331,306,10,"Error when deserializing DataLossPrevention response.");return}if(!t){Diag.a.a(25565185,306,10,"policyData is null after deserializing DataLossPrevention response.");return}if(!t.IsPolicyTipAvailable){Diag.a.a(26007260,306,10,"policyData.IsPolicyTipAvailable is null or empty whereas it should be 'true' or 'false'.");return}switch(t.IsPolicyTipAvailable.toLowerCase()){case"false":Diag.a.a(26007261,306,50,"policyData.IsPolicyTipAvailable is false so DLP policy tip is not present.");return;case"true":Diag.a.a(25565186,306,50,"DLP Policy is enabled on this document.");this.bi=t.NavigateUrl;this.cq(t.GeneralText,this.bE);break;default:Diag.a.a(26007262,306,10,"policyData.IsPolicyTipAvailable is expected to be 'true' or 'false' but it is {0}",t.IsPolicyTipAvailable)}},cj:function(n,t,i,r){var u=r?r.a:2,c=0,l="",o="",f,v,y,a,e,p,w,s,h;if(y=Common.bA.a(n,v={val:f}),f=v.val,y)if(f){if(o="Success",a=this.bz(3),f.IsSuccessful){this.S&&(Common.m.a().recordKpiSuccess("MipSetPolicyLabel",this.bl(u,null,this.bb)),this.bb=null);Diag.a.a(51233632,306,50,"setPolicyLabel was successful as seen after deserializing set policy label data response. ApplyLabelFlag: {0}",u);u===2&&this.b(29);this.cp(t,u);this.bY();this.b(28);r&&u===4&&(w=this,this.r(28,$a.L,String.format($a.hH,r.b),$a.z,function(){}));Common.P.a("MipAppliedLabels",!0,0,[(s=new Otel.a,s.name="SetPolicyLabelApplyFlag",s.string=Common.App.Policy.Contracts.d.toString(u),s)]);this.bm(t,a,this.N,!1,3);return}Diag.a.a(51233631,306,10,"setPolicyLabel was unsuccessful as seen after deserializing set policy label data response. ApplyLabelFlag: {0}, FailureReason: {1}",u,f.FailureReason);l=f.FailureReason;l.indexOf("FileTooLarge")>=0&&(f.FailureReason.indexOf("FileTooLarge")>=0?c=1:Common.a.a&&Common.a.a.a("WacClpLabelNotSupportedBusBar")&&f.FailureReason.indexOf("LabelNotSupported")>=0&&(c=2));this.bu&&f.FailureReason.indexOf("InvalidOperationOnZeroByteFile")>=0&&(e=this,p=new Common.X(2,1,this.bv,function(){Diag.a.a(575428443,306,15,"Retring SetPolicyLabelRequestAsync as previous called failed due to zero byte. Attempt number : {0}",e.P);e.P<=e.X&&e.I(t,i,null)},0,null,!1,0),this.by.a(p));this.ba&&this.Q&&this.bm(this.K.AppliedPolicyId,a,this.N,!0,3)}else o="setPolicyLabelData null.",Diag.a.a(42467541,306,10,"setPolicyLabelData is null after deserializing set policy label data response. ApplyLabelFlag: {0}",u);else o="TryDeserialize failed.",Diag.a.a(41799709,306,10,"Error when deserializing set policy label data response. ApplyLabelFlag: {0}",u);this.bC(u,c);this.S&&(h=this.bl(u,null,this.bb),this.bb=null,h.extendedProperties.set("SetPolicyLabelDataFailureReason",l.toString()),h.extendedProperties.set("SetPolicyLabelDataParseStatus",o.toString()),Common.m.a().recordKpiFailure("MipSetPolicyLabel","SetPolicyLabelFailure",!1,!1,h))},bC:function(n,t){this.K.AppliedPolicyId=this.O;this.bO(new Common.App.Policy.Contracts.j(!1));var i=n===2||n===8;this.o(t,n,i)},cp:function(n,t){var i;if(this.K.AppliedPolicyId=this.O=n,n==="")Common.a.bx=!1,Common.a.t=!1,Common.a.a.a("AddInsInSupportedIrmDocsIsEnabled")&&(Common.a.bt=!1);else for(var u=this.K.SensitivityLabels,f=u.length,r=0;r<f;++r)if(i=u[r],i.Id===n){Common.a.bx=i.IsEndpointProtectionEnabled;Common.a.t=i.IsEndpointProtectionEnabled;break}this.cn(new Common.App.Policy.Contracts.s(n,t))},ci:function(n){var t,i,r;return(r=Common.bA.a(n,i={val:t}),t=i.val,r)?t?t.AreLabelsAvailable?(this.K=t,this.O=t.AppliedPolicyId,this.c()&&Diag.a.a(51197846,306,50,"Labels are available for display after GetPolicyLabels call."),this.bO(new Common.App.Policy.Contracts.j(!0)),!0):!1:(Diag.a.a(42467542,306,10,"policyData is null after deserializing label policy data response."),!1):(Diag.a.a(34996495,306,10,"Error when deserializing label policy data response."),!1)},bR:function(){var n;if(!this.c())return!1;for(var i=this.K.SensitivityLabels,r=i.length,t=0;t<r;++t)if(n=i[t],n&&n.AutoLabelingSensitiveTypeIds&&n.AutoLabelingSensitiveTypeIds.length>0)return!0;return!1},bO:function(n){Diag.a.a(35393610,306,50,"Raising label info update event.");this.J.k("LabelInfoUpdateEvent",n,null)},cl:function(n){Diag.a.a(50676305,306,50,"Raising get policy label event.");this.J.k("GetPolicyLabelEventKey",n,null)},bN:function(n){if(this.bg){var t=this;this.bg.a(function(i){var r=[i.a("MsoClpSpTwo",!0),i.a("MsoDrmPremiumSpTwo",!0)];Promise.all(r).then(function(i){var r=Common.M.a(i,function(n){return n});return r&&(Diag.a.a(50944077,306,50,"Raising get auto policy label event."),t.J.k("GetAutoPolicyLabelEventKey",n,null),Common.P.a("MipAutoClassificationEnabled",!0,0,null)),null})})}},bB:function(n,t){var i=new Map;return i.set("ClpCoauth",this.Q.toString()),n!=null&&i.set("ApplyLabelFlags",Common.App.Policy.Contracts.d.toString(n)),t!=null&&i.set("GetPolicyLabelsReason",Common.App.Policy.Contracts.i.toString(t)),i},bl:function(n,t,i){var r=new Common.bg;return r.extendedProperties=this.bB(n,t),i!=null&&(r.durationMs=this.bA()-i),r},cn:function(n){Diag.a.a(41799710,306,50,"Raising set policy label event.");this.J.k("SetPolicyLabelEventKey",n,null)},bM:function(n){Diag.a.a(51128227,306,50,"Raising an add auto policy business bar entry event.");n&&n.c&&Common.P.a("MipRecommendations",!0,0,null);this.J.k("AddAutoPolicyBusinessBarEntryEventKey",n,null)},bP:function(n){Diag.a.a(51128256,306,50,"Raising an remove auto policy business bar entry event.");this.J.k("RemoveAutoPolicyBusinessBarEntryEventKey",n,null)},ck:function(n){Diag.a.a(573842331,306,50,"Raising an add mandatory labelling business bar entry event.");this.J.k("AddMandatoryLabellingBusinessBarEntryEventKey",n,null)},cm:function(n){Diag.a.a(573842332,306,50,"Raising a remove mandatory labelling business bar entry event.");this.J.k("RemoveMandatoryLabellingBusinessBarEntryEventKey",n,null)},cq:function(n,t){Diag.a.a(34996496,306,50,"Showing policy tip to user.");this.J.k("PolicyTipEvent",new Common.App.Policy.Contracts.q($a.L,n,$a.hK,t),null)},o:function(n,t,i){Diag.a.a(42074656,306,50,"Raising set policy label failure event.");this.J.k("SetPolicyLabelFailureEventKey",new Common.App.Policy.Contracts.e(n,t,i),null)},G:function(n){this.bj=n},ca:function(){this.bi?(Diag.a.a(25565187,306,50,"DLP override button was clicked."),Common.g.g(this.bi)):Diag.a.a(25565188,306,10,"Null NavigateUrl got in policy response. Could not navigate to SPO.")},bX:function(n){return!n.startsWith("<")||n.indexOf("Error")===-1&&n.indexOf("Unavailable")===-1?!1:(Diag.a.a(25565189,306,10,"The response from server is not a valid JSON response and it matches the error page keyword. This might be the error response from a non-existing endpoint."),!0)},bL:function(){this.bc&&(this.bc.a(),this.bc=null)},bV:function(n){if(!n)return Common.App.Policy.Contracts.a.toString(3);var t=n.a;switch(t){case 0:return Common.App.Policy.Contracts.a.toString(3);case 4:return Common.App.Policy.Contracts.a.toString(1);case 1:return Common.App.Policy.Contracts.a.toString(0);case 16:return Common.App.Policy.Contracts.a.toString(4);case 2:return Common.App.Policy.Contracts.a.toString(3);case 8:return Common.App.Policy.Contracts.a.toString(2);default:return Common.App.Policy.Contracts.a.toString(3)}},bW:function(n){if(!n)return Common.App.Policy.Contracts.b.toString(1);var t=n.a,i=Common.App.Policy.Contracts.b.toString(1);return(t===4||t===1)&&(i=Common.App.Policy.Contracts.b.toString(0)),i},bK:function(n){switch(n){case 1:return"Excel";case 4:return"OneNote";case 2:return"PowerPoint";case 5:return"Visio";case 3:return"Word";case 0:default:return"Unknown"}},bm:function(n,t,i,r,u){var f,e,o;this.L.a("WacLabelingGetPolicyLabelsIsEnabled")&&(this.O=n,this.N=i,this.M&&(this.T=this.M.a("WebServiceCall","Call Get Policy Endpoint On Server")),f={},f["X-AppliedPolicyId"]=n,this.L.a("SendHostAttributionInfoForPolicyLabelEnabled")?(e=new Common.ew(this.Z("getpolicylabels",r),1,null,f,!0,2,u,null,null,!1,null,null,null,null,!1,null,null,null,null,t),o=this.R.j(e),o.b(this.bq,this.bp)):this.R.a(this.Z("getpolicylabels",r),1,null,f,!0,2,this.bq,this.bp,u,null,!1,null,null,"22",null,!1,null,!1,null),this.V++,Diag.a.a(34996492,306,50,"Policy label request sent to server. Policy call times: {0}",this.V))},co:function(n,t,i,r){var u,f,e;this.bt&&(this.M&&(this.U=this.M.a("WebServiceCall","Call Set Policy Endpoint On Server")),u={},u["X-SelectedPolicyLabelId"]=n,t&&(u["X-SetPolicyLabelJustification"]=encodeURIComponent(t)),this.bj&&(u["X-AppLockId"]=this.bj),r?(u["X-SetPolicyLabelActionSource"]=this.bV(r),u["X-SetPolicyLabelAssignmentMethod"]=this.bW(r)):(u["X-SetPolicyLabelActionSource"]=Common.App.Policy.Contracts.a.toString(3),u["X-SetPolicyLabelAssignmentMethod"]=Common.App.Policy.Contracts.b.toString(1)),this.Q&&this.K&&(u["X-PolicyLabelVersionToken"]=this.K.PolicyLabelVersionToken),this.L.a("SendHostAttributionInfoForPolicyLabelEnabled")?(f=new Common.ew(this.Z("setpolicylabel",!0),1,null,u,!0,2,r,null,null,!1,null,null,null,null,!1,null,null,null,null,i),e=this.R.j(f),e.b(this.bs,this.br)):this.R.a(this.Z("setpolicylabel",!0),1,null,u,!0,2,this.bs,this.br,r,null,!1,null,null,"32",null,!1,null,!1,null),this.P++,Diag.a.a(41799706,306,50,"Set policy label request sent to server. Policy call times: {0}",this.P))},bz:function(n){switch(n){case 1:return Common.ch.a(1,1);case 2:return Common.ch.a(7,1);case 3:return Common.ch.a(8,1);case 0:default:return Common.ch.a(7,0)}},bT:function(n){var t=n.a;switch(t){case 1:case 16:return Common.ch.a(1,1);case 4:case 2:case 8:return Common.ch.a(8,1);case 0:default:return Common.ch.a(8,0)}}};Common.App.Policy.h=function(){this.p=Function.createDelegate(this,this.y);this.l=Function.createDelegate(this,this.u);this.o=Function.createDelegate(this,this.x);this.k=Function.createDelegate(this,this.t);this.m=Function.createDelegate(this,this.v);this.r=Function.createDelegate(this,this.A);this.n=Function.createDelegate(this,this.w);this.q=Function.createDelegate(this,this.z)};Common.App.Policy.h.a=function(){Common.App.a.a().a(new Common.App.Policy.h,0,!1)};Common.App.Policy.h.prototype={a:function(){return"Common.App.Policy"},d:null,g:null,f:null,e:null,i:null,j:null,h:null,b:function(){if(Common.a.a.a("ShouldInitCommonPolicyPackage")){if(Common.a.a.a("IsDataLossPreventionEnabledForUser")&&Common.a.b()){this.d=this.g.a(Common.App.Policy.Contracts.c,null);this.d.h(this.q);Diag.a.a(36537375,306,50,"PolicyManager is created successfully.");var n=this;Common.App.AppLifecycleManager.get_instance().a(6,function(){n.d.l()},3)}Common.a.a.a("WacLabelingPoliciesIsEnabled")&&Common.a.a.a("SupportsPolicies")&&Common.App.AppLifecycleManager.get_instance().a(6,this.n,3)}},c:function(n){var i=this,t;n.b(Common.App.Policy.Contracts.c,null).a().b(function(){return new Common.App.Policy.f(Common.a.a,Common.a.e,Common.a.b().c(),Common.a.a.c("MaxGetPolicyRetries",1),n.c(Common.App.ApplicationFeatureHelper.a,null),Common.a.b().a().b())});t=this;n.b(Common.App.Policy.c,null).c(Common.App.Policy.Contracts.n,null).a().b(function(){return new Common.App.Policy.c(Common.a.c(),Common.a.b(),Common.a.a,n.e(Common.App.Policy.Contracts.c,null))});this.g=n},w:function(){this.f=this.g.a(Common.App.Policy.c,null);this.f.be();this.e=this.g.d(CommonUI.s,null);this.d||(this.d=this.g.a(Common.App.Policy.Contracts.c,null));this.d.d(this.r);Common.a.a.a("WacApplyManualPolicyLabelIsEnabled")&&(this.d.e(this.m),this.d.f(this.k),this.d.i(this.o),this.d.g(this.l),this.d.j(this.p))},A:function(){this.f.bh();this.f.bg();this.f.bd();this.f.bf();Common.a.a.k("Microsoft.Office.SharedOnline.WacApplyMandatoryLabellingIsEnabled",!1)&&this.f.bj();Common.a.b().e(!1)},z:function(n,t){var i=this.s(t.d,t.c,null,t.b,t.a),r=Common.a.b().a();if(!r.C(i,!0)){Diag.a.a(34174784,306,10,"Failed to add entry to business bar. Policy message could not be shown to user.");return}Diag.a.a(34174785,306,50,"Add entry to BusinessBar succeeded. Policy message is shown to user.")},v:function(n,t){var i,r,u;if(t.b){if(i=$a.iy,r=$a.ix,t.a===1&&(i=$a.iA,r=$a.iz),t.a===2&&(i=$a.iC,r=$a.iB),u=this.s(i,r,null,null,null),!Common.a.b().a().C(u,!0)){Diag.a.a(42074654,306,10,"Failed to add entry to business bar. CLP policy message could not be shown to user.");return}Diag.a.a(42074655,306,50,"Add entry to BusinessBar succeeded. CLP policy message is shown to user.")}},x:function(n,t){var i;i=t.a?this.j:this.i;i&&this.e&&this.e.c(t.b)&&this.e.a(i)},t:function(n,t){if(this.e){this.d.b(t.f);var i=new CommonUI.i(t.e,t.d,null);i.d(t.f);i.c(!0);i.f(3);i.e(t.a,t.b,t.a,!0);this.e.b(i,!1,null,null,null);t.c?this.j=i:this.i=i}},u:function(n,t){if(this.e){var i=new CommonUI.i(t.d,t.c,null);i.d(t.e);i.c(!1);i.f(3);this.e.b(i,!1,null,null,null);this.h=i;this.h.e(t.a,t.b,t.a,!1)}},y:function(){var n=this.h;n&&this.e&&this.e.c(n.b())&&this.e.a(n)},s:function(n,t,i,r,u){var f=new CommonUI.i(n,t,i);return f.d(21),f.c(!0),r&&f.l(u,r),f}};Common.App.Policy.b=function(n,t){this.f=Function.createDelegate(this,this.p);this.i=Function.createDelegate(this,this.o);this.j=Function.createDelegate(this,this.t);this.h=Function.createDelegate(this,this.n);this.g=Function.createDelegate(this,this.q);this.a=[$a.cP,$a.cN,$a.cQ];Common.App.Policy.b.initializeBase(this,[!1,!1,Common.App.Policy.b.c(),!1]);this.e=n;this.d=t;this.K=this.m();this.C(1);this.F=Common.App.Policy.b.e;this.D(1,$a.bf);this.bc(1,!1);this.bh=0};Common.App.Policy.b.c=function(){return Common.a.b().a().e()&&Common.a.b().a().bF()};Common.App.Policy.b.prototype={e:null,d:null,c:null,b:!1,s:function(){var n,t;if(Common.App.Policy.b.c())this.A($a.T,this.g,this.k(this.b));else{for(n={},t=0;t<this.a.length;t++)n[Common.App.Policy.b.b+t]=!1;n[Common.App.Policy.b.a]="";this.A($a.T,this.h,n);this.r();Common.j.a($get(Common.App.Policy.b.a),"input",this.j)}},bR:function(){if(Common.App.Policy.b.c())return this.l(this.c);var n=$get(Common.App.Policy.b.a);return n.disabled?!0:this.l(n.value)},l:function(n){var t=n.length<2,i=n.length>500,r=new RegExp("[{|}|;|\\\\]").test(n),u=Common.d.L(n)==="";return!t&&!i&&!r&&!u},n:function(n,t){var r="",i;if(n===1)for(i=0;i<this.a.length;i++)if(t[Common.App.Policy.b.b+i]){r=i===this.a.length-1?t[Common.App.Policy.b.a]:this.a[i];break}this.d(n,this.e,r)},q:function(n){var t="";n===1&&this.c&&(t=this.c);this.d(n,this.e,t)},o:function(n){this.c=n;var t=this.bR();this.b!==t&&(this.b=t,this.dG($a.T,this.g,this.k(this.b)))},k:function(n){return{id:this.F,bodyControls:{choiceGroupProps:{},textAreaProps:{placeholder:$a.cR}},actionButtonProps:{label:$a.bf,disabled:!n},infoMessage:$a.cO,justificationIrrelevantLabel:$a.cP,justificationIncorrectLabel:$a.cN,justificationOtherLabel:$a.cQ,onJustificationUpdated:this.i}},t:function(n){var t=n.target;t&&this.bc(1,this.bR())},m:function(){return CommonUI.b.a(Common.App.Policy.b.f,Common.a.r,Common.K.b(Common.App.Policy.b.d),$a.cO,this.a[0],this.a[1],this.a[2],$a.cR)},r:function(){for(var t=document.getElementsByName(Common.App.Policy.b.g),n=0;n<t.length;n++)Common.j.a(t[n],"focus",this.f),Common.j.a(t[n],"click",this.f)},p:function(n){var i=n.target,t;i&&(i.checked=!0,t=$get(Common.App.Policy.b.a),i.id===Common.App.Policy.b.b+(this.a.length-1)?(t.disabled=!1,Sys.UI.DomElement.setVisible(t,!0),t.focus()):(t.disabled=!0,i.focus()),this.bc(1,this.bR()))}};Common.App.Policy.g=function(n,t,i){var f,u,e;this.b=Function.createDelegate(this,this.d);Common.App.Policy.g.initializeBase(this,[!1,!1,!0,!1]);this.a=i;this.c=t;var r={id:"MandatoryLabellingDialog"},s=this,o=function(){};r.learnMoreLink={type:"AppLinkProps",id:"mandatoryLabellingLearnMoreLink",text:$a.I,handler:o,customTooltip:$a.L_LearnMoreTooltip};f={id:"mandatoryLabellingFlyoutMenuSection",controls:n};u={sections:[],shouldAutoOpen:!1};Array.add(u.sections,f);r.labelFlyout={type:"AppFlyoutAnchorProps",id:"mandatoryLabellingFyout",label:"Pick a label",hideLabel:!1,hideChevron:!1,hideIcon:!0,menuDefinition:u};e={id:"MandatoryLabellingDialog",bodyControls:r};r.initialLabelText=$a.gd;r.descriptionText=$a.bK;this.A($a.ge,this.b,e)};Common.App.Policy.g.prototype={a:null,c:null,d:function(n,t){if(n===1&&t.selectedLabel){var i=t.selectedLabel;i!==""&&this.a(i)}}};Common.App.Policy.d=function(){this.b=!!Common.a.b()&&Common.a.b().a().e()};Common.App.Policy.d.b=function(){return Common.App.Policy.d.a||(Common.App.Policy.d.a=new Common.App.Policy.d)};Common.App.Policy.d.prototype={b:!1,a:function(n,t,i){return this.b?new Common.App.Policy.g(n,t,i):null}};Common.App.Policy.c.registerClass("Common.App.Policy.c",null,Common.App.Policy.Contracts.n);Common.App.Policy.b.registerClass("Common.App.Policy.b",CommonUI.b);Common.App.Policy.g.registerClass("Common.App.Policy.g",CommonUI.b);Common.App.Policy.e.a="<div class='WACDialogRow' id='JustificationMessageBlock'> <div class='WACDialogIcon' id='JustificationIconArea'> <div class='clip32x32' id='JustificationIconClip' unselectable='on' style='z-index: 0; display: inline-block;'> <img id='iconJustification' class='{1}' role='presentation' src={0} /> <\/div> <\/div> <div class='WACDialogTextPanel WACJustificationDialogMessage' id='JustificationMessageArea'> <label id='messageJustification' class='WACDialogLabel' >{2}<\/label> <\/div> <\/div> <br/> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock0'> <input type='radio' id='radiobox0' name='ListRadioBox' class='WACDialogRadio' alt='{3}' title='{3}'><\/input> <label id='JustificationDlgList0' class='WACDialogLabel' for='radiobox0' >{3}<\/label> <\/div> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock1'> <input type='radio' id='radiobox1' name='ListRadioBox' class='WACDialogRadio' alt='{4}' title='{4}'><\/input> <label id='JustificationDlgList1' class='WACDialogLabel' for='radiobox1' >{4}<\/label> <\/div> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock2'> <input type='radio' id='radiobox2' name='ListRadioBox' class='WACDialogRadio' alt='{5}' title='{5}'><\/input> <label id='JustificationDlgList2' class='WACDialogLabel' for='radiobox2' >{5}<\/label> <\/div> <div class='WACDialogTextPanel WACJustificationDialogRow WACJustificationDialogTextAreaRow' id='JustificationTextAreaBlock'> <textarea id='txtJustification' class='JustificationTextArea' placeholder='{6}' style='border:solid 1px grey;resize:none;' autocomplete=\"off\"><\/textarea> <\/div>";Common.App.Policy.a.s="sbProtectForm14";Common.App.Policy.a.u="SBStatusBarMarkAsReadOnly14";Common.App.Policy.a.o="Info_16x16x32";Common.App.Policy.a.g="QuickSearchCompletedToday_16x16x32";Common.App.Policy.a.e="CommonControlCheckboxCheck_16";Common.App.Policy.a.l="On";Common.App.Policy.a.f="Visible";Common.App.Policy.a.m="ImageIsVisible";Common.App.Policy.a.k="SourceControlId";Common.App.Policy.a.q="MenuItemId";Common.App.Policy.a.p="Menu";Common.App.Policy.a.c="AppLockId";Common.App.Policy.a.a="Value";Common.App.Policy.a.d="LabelText";Common.App.Policy.a.b="Alt";Common.App.Policy.a.i="Image16by16";Common.App.Policy.a.j="Image16by16Class";Common.App.Policy.a.r="SBProtectForm_16";Common.App.Policy.a.t="SBStatusBarMarkAsReadOnly_16";Common.App.Policy.a.n="Icon";Common.App.Policy.a.h="CustomTooltip";Common.App.Policy.b.f=Common.App.Policy.e.a;Common.App.Policy.b.g="ListRadioBox";Common.App.Policy.b.b="radiobox";Common.App.Policy.b.a="txtJustification";Common.App.Policy.b.d="Info_32x32x32";Common.App.Policy.b.e="JustificationDialog";Common.App.Policy.d.a=null;Common.App.Policy.h.a();Type.registerNamespace("_Ewa");_Ewa.rD=function(n,t,i,r,u,f){this.w=Function.createDelegate(this,this.P);this.v=Function.createDelegate(this,this.t);this.p=Function.createDelegate(this,this.O);this.q=Function.createDelegate(this,this.S);this.r=Function.createDelegate(this,this.T);this.k=Function.createDelegate(this,this.N);this.j=Function.createDelegate(this,this.M);_Ewa.rD.initializeBase(this,[!1]);this.g=n;this.f=t;this.c=i;this.s=r;this.d=u;_Ewa.c.a("OfficeVSO:4910567_DecoupleAutoPolicyManagerAndAugloop")?this.K():this.b=f;this.R();this.e=!1};_Ewa.rD.prototype={g:null,f:null,c:null,s:null,d:null,e:!1,l:!1,i:!1,h:!1,u:3,b:null,a:null,m:!1,dispose:function(){this.e||(this.e=!0,_Ewa.c.a("OfficeVSO:4910567_DecoupleAutoPolicyManagerAndAugloop")?(this.t(),this.A(),this.b=null,this.f=null,this.g=null,_Ewa.cb.prototype.dispose.call(this)):(this.t(),this.b=null,this.g=null,this.f=null,this.i=!1,this.h=!1))},o:function(n){switch(n){case 0:if(this.h)return;this.b.a(Microsoft.Office.AugLoop.Automatic.Clp.a.a());this.b.b(Microsoft.Office.AugLoop.Automatic.Clp.a.a(),this.j);this.h=!0;break;case 1:if(this.i)return;this.b.a(_Ewa.pk.a());this.b.b(_Ewa.pk.a(),this.k);this.i=!0;break;default:Diag.a.a(577360096,306,10,"AutoPolicyManager::EnsureLabellingSourceAnnotation Received an unknown LabellingSource: {0}",n)}},R:function(){this.f.f(this.r);this.f.i(this.q);_Ewa.c.a("OfficeVSO:4910567_DecoupleAutoPolicyManagerAndAugloop")?this.c.c().H(this.p):(this.b.d(this.v),this.l=!0)},t:function(){(_Ewa.bS.a(this.c,"OfficeVSO:4910567_DecoupleAutoPolicyManagerAndAugloop")||this.l)&&(this.d.b(35),this.d.b(34),this.f.x(this.r),this.f.B(this.q),_Ewa.c.a("OfficeVSO:4910567_DecoupleAutoPolicyManagerAndAugloop")?this.c.c().J(this.p):(this.h&&this.b.c(Microsoft.Office.AugLoop.Automatic.Clp.a.a(),this.j),this.i&&this.b.c(_Ewa.pk.a(),this.k),this.l=!1))},K:function(){var n,t;this.a=new($$sc.p.$$(_Ewa.Sm,_Ewa.rD.a))($$sc.g.a());this.a.d(0,(n=new _Ewa.rD.a,n.c=Microsoft.Office.AugLoop.Automatic.Clp.a.a(),n.d=this.j,n.a=!1,n.b=!1,n));this.a.d(1,(t=new _Ewa.rD.a,t.c=_Ewa.BT.a(),t.d=this.k,t.a=!1,t.b=!1,t))},Q:function(n){return this.a.c(n)?this.a.a(n).a?(Diag.a.a(571479128,306,15,"AutoPolicyManager::RegisterAnnotation - Annotations already registered for LabellingSource {0}.",n),!0):(this.a.a(n).a=!0,Diag.a.a(571479127,306,50,"AutoPolicyManager::RegisterAnnotation - Annotations registered for LabellingSource {0}.",n),!this.c.k())?(Diag.a.a(571479126,306,50,"AutoPolicyManager::RegisterAnnotation - Skipping AugmentationLoop initialization in view mode."),!0):(this.D(),!0):(Diag.a.a(571479129,306,15,"AutoPolicyManager::RegisterAnnotation - AnnotationActivationOptions not available for LabellingSource {0}.",n),!1)},D:function(){for(var n=!1,i=this.a.$$ge(),r,t,u;i.$$mn();)if(r=i.$$cu(),n=!!(n|r.a.a),n)break;if(!n){Diag.a.a(571479125,306,50,"AutoPolicyManager::InitAugmentationLoopIfNecessaryAndActivateAnnotations - no registered annotations.");return}if(this.b){Diag.a.a(571479124,306,50,"AutoPolicyManager::InitAugmentationLoopIfNecessaryAndActivateAnnotations - AugmentationLoop already initialized.");this.x();return}if(this.m){Diag.a.a(571479123,306,50,"AutoPolicyManager::InitAugmentationLoopIfNecessaryAndActivateAnnotations - AugmentationLoop initialization in-progress.");return}this.m=!0;t=this.c.f().FlightingSettings.AutoCLPStartUpDelay;Diag.a.a(571479122,306,50,"AutoPolicyManager::InitAugmentationLoopIfNecessaryAndActivateAnnotations - Initializing AugmentationLoop in {0} milliseconds.",t);u=this;_Ewa.A.a().a(function(){u.L()},t,_Ewa.o.m,!0,!0)},L:function(){var n=this;_Ewa.g.a(_Ewa.n.b(_Ewa.gs,this.c.b(),328,327,1,null),function(t){if(n.b=t.a(),n.m=!1,!n.b){Diag.a.a(571479121,306,10,"AutoPolicyManager::InitAugmentationLoop - Failed to instantiate AugmentationLoopManager.");return}(Diag.a.a(571479120,306,50,"AutoPolicyManager::InitAugmentationLoop - AugmentationLoopManager instantiated."),n.b.d(n.w),n.c.k())&&n.x()},this.dY(),3,null,null)},A:function(){for(var t=this.a.$$ge(),n;t.$$mn();)n=t.$$cu(),n.a.a&&this.G(n.b)},G:function(n){this.a.a(n).b&&this.z(n);this.a.a(n).a=!1;Diag.a.a(571479119,306,50,"AutoPolicyManager::DeregisterAnnotation completed for LabellingSource {0}.",n)},x:function(){for(var t=this.a.$$ge(),n;t.$$mn();)n=t.$$cu(),n.a.a&&!n.a.b&&this.E(n.b)},E:function(n){this.b.a(this.a.a(n).c);this.b.b(this.a.a(n).c,this.a.a(n).d);this.a.a(n).b=!0;Diag.a.a(571479118,306,50,"AutoPolicyManager::ActivateAnnotation completed for LabellingSource {0}.",n)},F:function(){for(var t=this.a.$$ge(),n;t.$$mn();)n=t.$$cu(),n.a.b&&this.z(n.b)},z:function(n){this.b.c(this.a.a(n).c,this.a.a(n).d);this.a.a(n).b=!1;Diag.a.a(571479117,306,50,"AutoPolicyManager::DeactivateAnnotation completed for LabellingSource {0}.",n)},O:function(){Diag.a.a(571479116,306,50,"AutoPolicyManager::OnApplicationModeChanged - isEditMode:{0}.",this.c.k());this.c.k()?this.D():(this.d.b(35),this.d.b(34),this.F())},P:function(){Diag.a.a(571479115,306,50,"AutoPolicyManager::OnAugmentationLoopSessionClose called.");this.A();this.b=null},M:function(n,t){var i;if(Diag.a.a(50935426,306,50,"AutoPolicyManager::LabellingAnnotationHandler called."),t.b===3){Diag.a.a(51512411,306,50,"AutoPolicyManager::LabellingAnnotationHandler Ignoring delete operation.");return}if(i=t.a,!i){Diag.a.a(50974996,306,50,"AutoPolicyManager::LabellingAnnotationHandler LabellingAnnotation is null.");return}var r=null,u=null,f=null;i.automatic&&i.automatic.sensitivityLabel&&i.automatic.sensitivityLabel.id&&(r=i.automatic.sensitivityLabel.id);i.recommended&&i.recommended.sensitivityLabel&&i.recommended.sensitivityLabel.id&&(u=i.recommended.sensitivityLabel.id,i.recommended.sensitivityLabel.policyTip&&(f=i.recommended.sensitivityLabel.policyTip));this.y(r,u,f,0)},N:function(n,t){var i,r;if(Diag.a.a(577360095,306,50,"AutoPolicyManager::LinkedDataTypeLabellingAnnnotationHandler - Handler called."),t.b===3){Diag.a.a(577360094,306,50,"AutoPolicyManager::LinkedDataTypeLabellingAnnnotationHandler - Received delete operation.");return}if(i=t.a,!i){Diag.a.a(577360093,306,50,"AutoPolicyManager::LinkedDataTypeLabellingAnnnotationHandler - Received an empty annotation.");return}r=i.classificationId;this.y(r,r,null,1)},y:function(n,t,i,r){if(this.c.a(727)&&this.s.a("SupportsOfficeClientCoauthoring"))Diag.a.a(572003347,306,50,"AutoPolicyManager::ApplyPolicyLabel - SupportsOfficeClientCoauthoring is enabled."),this.n(n,t,i,r,!1);else if(Diag.a.a(572003346,306,50,"AutoPolicyManager::ApplyPolicyLabel - SupportsOfficeClientCoauthoring is disabled."),_Ewa.c.a("OfficeVSO:4867250_SupportClpForPowerBi")){var f=this,u=function(u){var e=!u||u===1||u===4;f.n(n,t,i,r,e)},e=this;this.B(u,function(){u(2)},this.u,0)}else this.C(n,t,i,r,1)},C:function(n,t,i,r,u){var f=this.c.d().a().b(!1),e=this,o=this;_Ewa.mA.a(this.c.d().a(),this.c.f().DocumentHostInfo.TenantId,function(u){e.U(u,n,t,i,r)},function(){o.H(n,t,i,r,u)},null,f)},U:function(n,t,i,r,u){var f,e;(Diag.a.a(51680789,306,50,"AutoPolicyManager: GetPolicyApplicationMethod web service call was successful."),this.e)||(f=!1,n&&!_Ewa.O.a(n)?(e=n.Result,e===4&&(f=!0)):Diag.a.a(51680790,306,50,"AutoPolicyManager: Result of GetPolicyApplicationMethod is NULL."),this.n(t,i,r,u,f))},H:function(n,t,i,r,u){this.e||(u<=this.u&&(Diag.a.a(51680791,306,15,"AutoPolicyManager: GetPolicyApplicationMethod web service call failed. Trying again"),this.C(n,t,i,r,u+1)),Diag.a.a(51680792,306,15,"AutoPolicyManager: GetPolicyApplicationMethod web service call failed. Max retries exhausted."),this.n(n,t,i,r,!1))},B:function(n,t,i,r){var u=this.c.d().a().b(!1),f=this,e=this;_Ewa.mA.a(this.c.d().a(),this.c.f().DocumentHostInfo.TenantId,function(t){f.J(t,n)},function(){e.I(n,t,i,r)},null,u)},J:function(n,t){if(Diag.a.a(572003338,306,50,"AutoPolicyManager: GetPolicyApplicationMethod web service call was successful."),!this.e){if(!n||_Ewa.O.a(n)){Diag.a.a(572003337,306,15,n?"AutoPolicyManager: GetPolicyApplicationMethod result has non-status message.":"AutoPolicyManager: GetPolicyApplicationMethod result is null");return}var i=n.Result;t(i)}},I:function(n,t,i,r){if(Diag.a.a(572003336,306,15,"AutoPolicyManager: GetPolicyApplicationMethod web service call failed. Trying again"),!this.e){if(r>=i){Diag.a.a(572003335,306,15,"AutoPolicyManager: GetPolicyApplicationMethod max retries exhausted.");t();return}this.B(n,t,i,r+1)}},n:function(n,t,i,r,u){if(Diag.a.a(51680793,306,50,"AutoPolicyManager: Calling ApplyAutoPolicyLabel for LabellingSource {0} with isStandard set to {1}.",r,u),!this.e&&this.g){var f=this.g.bk(n,t,i,u);Diag.a.a(572003334,306,50,"AutoPolicyManager::CallApplyAutoPolicyLabel - policyActor.ApplyAutoPolicyLabel returned {0}.",f)}},S:function(n,t){if(!t){Diag.a.a(51241993,306,15,"RemoveAutoPolicyBusinessBar is called but AddAutoPolicyBusinessBarEntryEventArgs is null.");return}t.a&&this.d.c(35)?(this.d.b(35),Diag.a.a(51241994,306,50,"Remove entry to RecommendedSensitivityLabelBusinessBarEntry succeeded.")):!t.a&&this.d.c(34)&&(this.d.b(34),Diag.a.a(51241995,306,50,"Remove entry to AutomaticSensitivityLabelBusinessBarEntry succeeded."))},T:function(n,t){var i,r;if(!t){Diag.a.a(51241996,306,15,"ShowAutoPolicyBusinessBar is called but AddAutoPolicyBusinessBarEntryEventArgs is null.");return}t.c?(i=this,this.d.n(t.e,t.d,t.a,function(n){t.b(n);i.d.c(35)&&i.d.b(35)}),Diag.a.a(51241997,306,50,"Add entry to RecommendedSensitivityLabelBusinessBarEntry succeeded. Message is shown to user.")):(r=this,this.d.h(t.e,t.d,t.a,function(n){t.b(n);r.d.c(34)&&r.d.b(34)}),Diag.a.a(51241998,306,50,"Add entry to AutomaticSensitivityLabelBusinessBarEntry succeeded. Message is shown to user."))}};_Ewa.rD.a=function(){};_Ewa.rD.a.prototype={c:null,d:null,a:!1,b:!1};_Ewa.zf=function(n){_Ewa.zf.initializeBase(this,[n,_Ewa.zf.a(n)])};_Ewa.zf.a=function(n){return n.t()&2?_Ewa.j.b(3,1,0,1776,0,-1237306487,"SensitivityLabelBlockApplyLabelOpenInDesktop"):_Ewa.j.b(1,1,0,1777,0,-313914360,"SensitivityLabelBlockApplyLabel")};_Ewa.zf.prototype={K:function(){var t,n;_Ewa.dw.prototype.K.call(this);this.B.Appearance&1&&this.D.t()&2&&(t=this.n(0),_Ewa.a.R(t.get_element(),_Ewa.ClientStringManager.a().a(1195)),n=this,this.d(function(){0===n.P&&n.D.t()&2&&(Diag.a.a(50373725,306,50,"BlockSenitivityLabelActionDialog : Opening the book in excel desktop."),_Ewa.g.a(_Ewa.n.b(_Ewa.gU,n.D.b(),55,56,0,null),function(n){n.a().a()},n.D.i(),3,null,null))}))}};_Ewa.zg=function(n){_Ewa.zg.initializeBase(this);this.h=n;this.l()};_Ewa.zg.a=function(n){n.b().b(_Ewa.bgS.$$(_Ewa.jC),275,new _Ewa.zg(n))};_Ewa.zg.prototype={h:null,b:function(){var t=_Ewa.n.b(_Ewa.cM,this.h.b(),5,4,this.j,null),i=Common.a.e,r=Common.a.a,n=this;_Ewa.g.a(t,function(){try{var f=new($$sc.z.$$(Common.App.Policy.Contracts.c))(function(){return new Common.App.Policy.f(r,i,Common.a.b().c(),n.h.f().MaxGetPolicyRetries,Common.Utils.a.a().c(Common.App.ApplicationFeatureHelper.a,null),0)}),o=new($$sc.z.$$(Common.App.Policy.c))(function(){return new Common.App.Policy.c(Common.a.c(),Common.a.b(),Common.a.a,f)}),u=n.h.b().a(_Ewa.jC,274,!1,null);u||(u=new _Ewa.PolicyManagerWrapper(f.a(),o.a(),t.a(),n.h,Common.a.a),u.bh());n.k(u)}catch(e){Diag.a.a(36444224,306,10,"PolicyManager was not created successfully [Exception: {0}]",e.toString());throw e;}},this.i(),3,null,null)}};_Ewa.PolicyManagerWrapper=function(n,t,i,r,u){this.E=Function.createDelegate(this,this.bl);this.z=Function.createDelegate(this,this.V);this.R=Function.createDelegate(this,this.bv);this.B=Function.createDelegate(this,this.bd);this.A=Function.createDelegate(this,this.X);this.D=Function.createDelegate(this,this.bk);this.H=Function.createDelegate(this,this.bp);this.y=Function.createDelegate(this,this.U);this.F=Function.createDelegate(this,this.bm);this.C=Function.createDelegate(this,this.be);this.G=Function.createDelegate(this,this.bn);this.I=Function.createDelegate(this,this.bs);this.P=Function.createDelegate(this,this.bj);this.O=Function.createDelegate(this,this.bi);this.N=Function.createDelegate(this,this.W);this.Q=Function.createDelegate(this,this.br);_Ewa.PolicyManagerWrapper.initializeBase(this,[!1]);Diag.a.a(34402886,306,50,"DataLossPrevention feature is Enabled and launched on Excel.");this.h=r;this.i=n;this.q=i;this.m=u;this.i.h(this.Q);this.bb();this.o=t};_Ewa.PolicyManagerWrapper.prototype={i:null,h:null,m:null,u:null,o:null,w:!1,q:null,j:null,v:!1,s:null,r:!1,t:!1,bh:function(){if(this.m.a("SupportsPolicies")){this.l=this.m.b("AppliedPolicyId");this.o.be();var n=this;this.h.b().c(_Ewa.bU,29,function(t){n.u=t;t.c(n)},null);this.T();this.bo();this.o.u=this.N;this.o.w=this.O;this.h.a(727)&&this.i.w(this.P)}},p:function(n){this.dW("LabelInfoChangedKey",n)},n:function(n){this.dX("LabelInfoChangedKey",n)},k:function(){return!0},e:function(n,t){if(n!=="QueryPolicyLabel")return!1;var i=Common.a.c().b(497870830,2,t,null);return i===32},dispose:function(){if(this.u&&(this.u.b(this),this.u=null),this.o.bE(),this.w=!1,this.i.D(this.I),this.i.E(this.G),this.h.c().u(this.C),this.h.a(727)&&this.m.a("SupportsOfficeClientCoauthoring")){var n=this.h.b().a(_Ewa.hE,292,!1,null);n&&n.f(this.F)}this.h.a(1102)&&(this.i.y(this.y),this.i.C(this.H),this.i.A(this.D));this.h.a(351)&&(!_Ewa.c.a("OfficeVSO:4910567_DecoupleAutoPolicyManagerAndAugloop")&&this.j&&this.j.dispose(),this.h.a(412)&&(this.i.z(this.A),!_Ewa.c.a("OfficeVSO:4910567_DecoupleAutoPolicyManagerAndAugloop")&&this.t&&(this.h.c().J(this.B),this.t=!1)));_Ewa.c.a("OfficeVSO:4910567_DecoupleAutoPolicyManagerAndAugloop")&&this.j&&(this.j.dispose(),this.j=null);_Ewa.cb.prototype.dispose.call(this)},M:null,d:function(){return this.M},L:null,c:function(){return this.L},J:null,a:function(){return this.J},K:null,b:function(){return this.K},l:null,T:function(){this.dU("LabelInfoChangedKey",null,null)},bb:function(){this.i.l()},bc:function(){return this.h.f().DocumentHostInfo.TenantId},bo:function(){var n=this;Common.App.AppLifecycleManager.get_instance().a(10,function(){if(n.i.d(n.R),n.i.e(n.I),n.i.k(n.G),n.h.c().s(n.C),n.h.a(1102)&&(n.i.g(n.y),n.i.j(n.H),n.i.q(n.D)),n.h.a(727)&&n.m.a("SupportsOfficeClientCoauthoring")){var t=n.h.b().a(_Ewa.hE,292,!1,null);t&&t.d(n.F)}n.h.a(351)&&n.h.a(412)&&(Diag.a.a(589177409,306,50,"PolicyManagerWrapper: ApplyAutomaticPolicyLabel enabled and registered GetAutoPolicyLabelHandler"),n.i.p(n.A));n.Z()},3)},Z:function(){this.h.a(727)&&this.m.a("SupportsOfficeClientCoauthoring")||this.l&&this.l.length?this.x():this.ba(this.bc())},X:function(){if(Diag.a.a(589177379,306,50,"PolicyManagerWrapper::EnableAutoLabellingInDocument - Triggered EnableAutoLabellingInDocument"),_Ewa.c.a("OfficeVSO:4910567_DecoupleAutoPolicyManagerAndAugloop")){var n=this.f(0);Diag.a.a(571479113,306,50,"PolicyManagerWrapper::EnableAutoLabellingInDocument - Annotation registration result: {0}.",n)}else this.t||(this.h.c().H(this.B),this.t=!0),this.g(0)},bd:function(){this.g(0)},g:function(n){var t,i;return this.h.k()?this.r?(this.j&&this.j.o(n),!0):(t=this.h.f().FlightingSettings.AutoCLPStartUpDelay,Diag.a.a(51709772,306,50,"HandleAutoLabellingInCurrentDocumentMode: Configured delay is {0} milliseconds",t),i=this,_Ewa.A.a().a(function(){i.bt(t,n)},t,_Ewa.o.bW,!0,!0),_Ewa.c.a("OfficeVSO:4786101_HandleTimingIssueWhenActivatingAnnotations")||(this.r=!0),!0):this.r?(this.r=!1,!this.j)?(Diag.a.a(593098975,306,15,"Autopolicy manager should not be null here"),!1):(this.j.dispose(),!1):!1},bt:function(n,t){Diag.a.a(51515659,306,50,"Auto Labelling is enabled. Configured delay is {0} milliseconds",n);var i=this;_Ewa.g.a(_Ewa.n.b(_Ewa.gs,this.h.b(),328,327,1,null),function(n){var r=n.a();if(!r){Diag.a.a(51515660,306,10,"Error occurred while creating an augmentationLoopManager instance");return}if(Diag.a.a(51515661,306,50,"AugmentationLoopManager instantiated successfully."),_Ewa.c.a("OfficeVSO:4786101_HandleTimingIssueWhenActivatingAnnotations")){if(!i.h.k())return;i.r&&i.j&&!i.j.e?i.j.o(t):(i.j=new _Ewa.rD(i.o,i.i,i.h,i.m,i.q,r),i.j.o(t),i.r=!0)}else i.j=new _Ewa.rD(i.o,i.i,i.h,i.m,i.q,r),i.j.o(t)},this.dY(),3,null,null)},bg:function(){this.j=new _Ewa.rD(this.o,this.i,this.h,this.m,this.q,null)},f:function(n){return this.m.a("SupportsPolicies")?(this.j||this.bg(),this.j.Q(n)):(Diag.a.a(571479112,306,10,"PolicyManagerWrapper::RegisterAugmentationLoopAnnotations called when CLP is disabled."),!1)},ba:function(n){Diag.a.a(41740191,306,50,"PolicyManagerWrapper: Doing GetPolicyLabelId web service call with tenantId length {0}",n.length);var t=this.h.d().a().b(!1),i=this;_Ewa.mA.d(this.h.d().a(),n,function(n){i.bu(n)},null,null,t)},bu:function(n){Diag.a.a(41740192,306,50,"PolicyManagerWrapper: GetPolicyLabelId web service call was successful");n&&!_Ewa.O.a(n)&&(this.l=n.Result);this.x();this.l?Diag.a.a(41740193,306,50,"PolicyManagerWrapper: Fetched LabelId length from custom.xml is {0}",this.l.length):Diag.a.a(41740194,306,50,"PolicyManagerWrapper: LabelId is invalid")},x:function(){this.i.u(this.l,0,null,!1)},br:function(n,t){if(!t){Diag.a.a(34402887,306,15,"ShowPolicyBusinessBar is called but PolicyTipventArgs is null.");return}this.M=t.d;this.L=t.c;this.J=t.a;this.K=t.b;this.q.a(28,null,null);Diag.a.a(34402888,306,50,"Add entry to BusinessBar succeeded. Message is shown to user.")},bs:function(n,t){var i=$$as(Common.App.Policy.Contracts.e,t);i?i.b?i.a===1?(Diag.a.a(578414677,306,15,"ShowSetPolicyLabelFailureInBusinessBar :: SetPolicyLabelFailure because of File too large"),this.q.a(42,null,null)):i.a===2?this.q.a(43,null,null):this.q.a(41,null,null):Diag.a.a(574226717,306,50,"ShowSetPolicyLabelFailureInBusinessBar :: SetPolicyLabelFailure ShowMessage is false"):(Diag.a.a(574226716,306,10,"ShowSetPolicyLabelFailureInBusinessBar :: SetPolicyLabelFailure args is null"),this.q.a(41,null,null))},bv:function(){var n,t;this.o&&(Diag.a.a(41961095,306,50,"PolicyManagerWrapper: UpdateLabelInfo called"),this.o.bh(),this.o.bg(),this.o.bd(),this.o.bf(),this.h.a(1102)&&this.o.bj());this.h.a(727)&&this.m.a("SupportsOfficeClientCoauthoring")&&(n=this.i.a(),this.l=n.AppliedPolicyId,this.l==="null"&&(this.l=""),this.v&&(t=4,t=n.PolicyLabelAssignmentMethod&&n.PolicyLabelAssignmentMethod.toUpperCase()===Common.App.Policy.Contracts.b.toString(0).toUpperCase()?4:2,this.S(this.l,t,!0)));this.Y();this.T()},bn:function(n,t){Diag.a.a(42322116,306,50,"PolicyManagerWrapper.OnSetLabelSucceeded: Applying outcomes for change in policy label. ProtectedFile = {0}, ApplyLabelFlag = {1}",Common.a.t,t.a);this.S(t.b,t.a,!1)},Y:function(){if(!this.w){this.h.v();this.w=!0;var n={};n.hasLabel=!!this.l&&this.l.length>0;n.isProtectedFile=this.m.a("ProtectedFile");n.SupportsPolicies=this.m.a("SupportsPolicies");n.AreLabelsAvailableForDisplay=this.i.c();n.SupportsOfficeClientCoauthoring=this.m.a("SupportsOfficeClientCoauthoring");Diag.a.a(51238051,306,50,"CLPUsage : {0}",JSON.stringify(n))}},bl:function(n,t){this.l=t},W:function(n,t){var f=this.i.a(),i,u;if(!f)return Diag.a.a(50341184,306,15,"PolicyManagerWrapper.BlockSetSensitivityCall: policyLabelsData is null."),!1;i=null;for(var e=f.SensitivityLabels,o=e.length,r=0;r<o;++r)u=e[r],_Ewa.f.b(u.Id,n,!1)&&(i=u);return i&&this.bf(i)?(Diag.a.a(50341186,306,50,"PolicyManagerWrapper.BlockSetSensitivityCall: selectedSensitivityLabel has watermark label action."),this.bq(t),!0):!1},bi:function(){var n=!1;return!this.h.f().IsNewWorkbook||this.l&&this.l.length||(n=!0),Diag.a.a(593065680,306,50,"PolicyManagerWrapper.IsANewFile: is this a new file : {0}",n),n},bk:function(n,t){1===t.a?(Diag.a.a(572002694,306,50,"MandatoryLabellingHandler : Swtiching to view-mode."),this.h.h().a(new _Ewa.L(-723527778,0,this.h.s(),10,null),null,null)):(this.s=t.b,this.h.c().H(this.z),this.h.bZ(),Diag.a.a(572002693,306,50,"MandatoryLabellingHandler : Swtiching to edit-mode."),this.h.h().a(new _Ewa.L(-8805455,0,this.h.s(),10,null),null,null))},U:function(n,t){if(!t){Diag.a.a(572002692,306,15,"AddMandatoryLabellingBusinessBar is called but MandatoryLabellingAppHandlerEventArgs is null.");return}var i=this;this.q.m(t.d,t.c,t.a,function(n){t.b(n)})},bp:function(){this.q.c(36)&&this.q.b(36)},V:function(){if(_Ewa.f.a(this.s)||!this.h.k()){Diag.a.a(572002691,306,15,"ApplyMandatoryLabel : mandatoryPolicyId empty {0} , edit mode : {1}.",_Ewa.f.a(this.s),this.h.k());return}this.o.bl(this.s);this.s=null;this.h.c().J(this.z)},bf:function(n){for(var r,i=n.LabelActions,u=i.length,t=0;t<u;++t)if(r=i[t],_Ewa.f.b(r.Name,"ApplyWatermark",!1))return!0;return!1},bq:function(n){if(!n){Diag.a.a(51654868,306,50,"PolicyManagerWrapper.showBlockApplyLabelDialogDialog: Watermark Dialog box called with showDialog set to false from autoapply.");return}var t=new _Ewa.zf(this.h);t.z(!1)},be:function(){var n=this.h.c().l();n&&!_Ewa.f.b(n.AppliedPolicyLabelId,this.l,!1)&&(Diag.a.a(42844434,306,50,"PolicyManagerWrapper.HandleWorkbookMetadataChanged: Calling GetPolicyLabels to update statusbar and ribbon control."),Diag.a.b(574375109,306,this.h.k(),"PolicyManagerWrapper.HandleWorkbookMetadataChanged policyId cannot change in read-only mode, this can happen if right policy id is not read from server."),this.m.a("SupportsOfficeClientCoauthoring")&&this.h.a(727)&&this.h.k()&&(this.v=!0),this.l=n.AppliedPolicyLabelId,this.x())},bj:function(){var n=!0,r;if(!this.h.c().G())for(var i=this.h.c().v(),u=i.length,t=0;t<u;++t)if(r=i[t],!r.SupportsClientIsMipTrusted){n=!1;break}return Diag.a.a(593007453,306,50,"PolicyManagerWrapper.IsEveryCoauthorInSessionClientMipTrusted : {0}",n),n},bm:function(){Diag.a.a(592723985,306,50,"PolicyManagerWrapper.OnLabelUpdate: RTC notification received");this.v=!0;this.x()},S:function(n,t,i){var e=this.i.a(),r=JSON.stringify(e);if(isNullOrUndefined(n)&&(n=""),this.h.a(727)){var o=this.h.d().a(),u=this,s=function(f){return _Ewa.mA.c(o,r,n,u.h.f().DocumentHostInfo.TenantId,t,i,_Ewa.p.a.call(null,f,u.E),null,n,null)},l=this;_Ewa.S.a(this.h.g(),s,function(n){return new _Ewa.J(222,0,n,0,null)},null)}else{var h=this.h.d().a(),f=this,c=function(i){return _Ewa.mA.b(h,r,n,f.h.f().DocumentHostInfo.TenantId,t,_Ewa.p.a.call(null,i,f.E),null,n,null)},a=this;_Ewa.S.a(this.h.g(),c,function(n){return new _Ewa.J(222,0,n,0,null)},null)}this.v=!1}};_Ewa.mA=function(){};_Ewa.mA.d=function(n,t,i,r,u,f){var e=n.a(1,f);return e.tenantId=t,_Ewa.l.a(n,"GetPolicyLabelId",e,i,r,u,4,null,null)};_Ewa.mA.b=function(n,t,i,r,u,f,e,o,s){var h=n.a(41,s);return h.labelsInfoJson=t,h.appliedLabelId=i,h.tenantId=r,h.applyLabelFlag=u,_Ewa.l.a(n,"ApplyPolicyLabel",h,f,e,o,0,null,null)};_Ewa.mA.c=function(n,t,i,r,u,f,e,o,s,h){var c=n.a(41,h);return c.labelsInfoJson=t,c.appliedLabelId=i,c.tenantId=r,c.applyLabelFlag=u,c.skipApplyOutcomes=f,_Ewa.l.a(n,"ApplyPolicyLabelV2",c,e,o,s,0,null,null)};_Ewa.mA.a=function(n,t,i,r,u,f){var e=n.a(1,f);return e.tenantId=t,_Ewa.l.a(n,"GetPolicyApplicationMethod",e,i,r,u,4,null,null)};_Ewa.Sn=function(n){this.a=n};_Ewa.Sn.prototype={a:null,y:function(){return!1},w:function(n,t,i){var r;switch(t.a){case 2935633379:return this.a.l().FileCoauthorable||(i[Common.App.Policy.a.c]=this.a.l().ExclusiveLockId),r=Common.a.c().b(2935633379,2,i,null),$$sc.a.a(Boolean,r===32);case 2875864574:return r=Common.a.c().b(2875864574,2,i,null),$$sc.a.a(Boolean,r===32);case 991261903:return r=Common.a.c().b(991261903,2,i,null),$$sc.a.a(Boolean,r===32);default:return _Ewa.V.a(t.a)}},v:function(n,t){switch(t.a){case 2935633379:case 2875864574:case 991261903:return!0;default:return!1}},x:function(n,t,i){switch(t){case"PopulateSensitivityFlyout":var r=Common.a.c().b(1145315516,2,i,null);return r===32;default:return!1}}};_Ewa.zh=function(n){_Ewa.zh.initializeBase(this,[n])};_Ewa.zh.a=function(n){_Ewa.bg.a(316,new _Ewa.zh(n))};_Ewa.zh.prototype={m:function(){this.n([new _Ewa.Sn(this.h)],null)}};_Ewa.rD.registerClass("_Ewa.rD",_Ewa.cb,Sys.IDisposable);_Ewa.rD.a.registerClass("_Ewa.rD.a");_Ewa.zf.registerClass("_Ewa.zf",_Ewa.dw);_Ewa.zg.registerClass("_Ewa.zg",_Ewa.rR.$$(_Ewa.jC));_Ewa.PolicyManagerWrapper.registerClass("_Ewa.PolicyManagerWrapper",_Ewa.cb,_Ewa.xo,Common.IRootUser,_Ewa.jC);_Ewa.Sn.registerClass("_Ewa.Sn",null,_Ewa.kR);_Ewa.zh.registerClass("_Ewa.zh",_Ewa.bg);Type.registerNamespace("_Ewa");_Ewa.biN=function(){};_Ewa.biN.a=function(){_Ewa.m.a(function(n){_Ewa.zg.a(n);_Ewa.zh.a(n)})};_Ewa.biN.a();